LeetCode SQL Problem Solving Questions With Solutions

!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()

[

](/)

[Articles](/articles)[Works](/works)[Shiny](/works/shiny-apps)[Snippets](/snippets)[Resume](/resume)[About](/about)[Contact](/contact)

[Guestbook](/guestbook)

Open main menu

Published on

November 6, 2020

52830 words265 min read––– views

LeetCode SQL Problem Solving Questions With Solutions
=====================================================

![LeetCode SQL Problem Solving Questions With Solutions](/_next/image?url=%2Fstatic%2Fimages%2Farticles%2Fleetcode-sql.png&w=3840&q=75)

#Related Topics:

[SQL](/tags/sql)[SQL-Problem-Solving](/tags/sql-problem-solving)[LeetCode](/tags/leetcode)

On this page
------------

1.  ### [175\. Combine Two Tables | Easy | LeetCode](/articles/sql/leetcode-sql-problem-solving#175-combine-two-tables--easy--leetcode)
    
2.  ### [176\. Second Highest Salary | Easy | LeetCode](/articles/sql/leetcode-sql-problem-solving#176-second-highest-salary--easy--leetcode)
    
3.  ### [177\. Nth Highest Salary | Medium | LeetCode](/articles/sql/leetcode-sql-problem-solving#177-nth-highest-salary--medium--leetcode)
    
4.  ### [178\. Rank Scores | Medium | LeetCode](/articles/sql/leetcode-sql-problem-solving#178-rank-scores--medium--leetcode)
    
5.  ### [180\. Consecutive Numbers | Medium | LeetCode](/articles/sql/leetcode-sql-problem-solving#180-consecutive-numbers--medium--leetcode)
    
6.  ### [181\. Employees Earning More Than Their Managers | Easy | LeetCode](/articles/sql/leetcode-sql-problem-solving#181-employees-earning-more-than-their-managers--easy--leetcode)
    
7.  ### [182\. Duplicate Emails | Easy | LeetCode](/articles/sql/leetcode-sql-problem-solving#182-duplicate-emails--easy--leetcode)
    
8.  ### [183\. Customers Who Never Order | Easy | LeetCode](/articles/sql/leetcode-sql-problem-solving#183-customers-who-never-order--easy--leetcode)
    
9.  ### [184\. Department Highest Salary | Medium | LeetCode](/articles/sql/leetcode-sql-problem-solving#184-department-highest-salary--medium--leetcode)
    
10.  ### [185\. Department Top Three Salaries | Hard | LeetCode](/articles/sql/leetcode-sql-problem-solving#185-department-top-three-salaries--hard--leetcode)
    
11.  ### [196\. Delete Duplicate Emails | Easy | LeetCode](/articles/sql/leetcode-sql-problem-solving#196-delete-duplicate-emails--easy--leetcode)
    
12.  ### [197\. Rising Temperature | Easy | LeetCode](/articles/sql/leetcode-sql-problem-solving#197-rising-temperature--easy--leetcode)
    
13.  ### [262\. Trips and Users | Hard | LeetCode](/articles/sql/leetcode-sql-problem-solving#262-trips-and-users--hard--leetcode)
    
14.  ### [511\. Game Play Analysis I | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#511-game-play-analysis-i--easy---leetcode)
    
15.  ### [512\. Game Play Analysis II | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#512-game-play-analysis-ii--easy---leetcode)
    
16.  ### [534\. Game Play Analysis III | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#534-game-play-analysis-iii--medium---leetcode)
    
17.  ### [550\. Game Play Analysis IV | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#550-game-play-analysis-iv--medium---leetcode)
    
18.  ### [569\. Median Employee Salary | Hard | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#569-median-employee-salary--hard---leetcode)
    
19.  ### [570\. Managers with at Least 5 Direct Reports | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#570-managers-with-at-least-5-direct-reports--medium---leetcode)
    
20.  ### [571\. Find Median Given Frequency of Numbers | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#571-find-median-given-frequency-of-numbers---leetcode)
    
21.  ### [574\. Winning Candidate | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#574-winning-candidate--medium---leetcode)
    
22.  ### [577\. Employee Bonus | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#577-employee-bonus--easy---leetcode)
    
23.  ### [578\. Get Highest Answer Rate Question | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#578-get-highest-answer-rate-question--medium---leetcode)
    
24.  ### [579\. Find Cumulative Salary of an Employee | Hard | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#579-find-cumulative-salary-of-an-employee--hard---leetcode)
    
25.  ### [580\. Count Student Number in Departments | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#580-count-student-number-in-departments--medium---leetcode)
    
26.  ### [584\. Find Customer Referee | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#584-find-customer-referee--easy---leetcode)
    
27.  ### [585\. Investments in 2016 | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#585-investments-in-2016--medium---leetcode)
    
28.  ### [586\. Customer Placing the Largest Number of Orders | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#586-customer-placing-the-largest-number-of-orders--easy---leetcode)
    
29.  ### [595\. Big Countries | Easy | LeetCode](/articles/sql/leetcode-sql-problem-solving#595-big-countries--easy--leetcode)
    
30.  ### [596\. Classes More Than 5 Students | Easy | LeetCode](/articles/sql/leetcode-sql-problem-solving#596-classes-more-than-5-students--easy--leetcode)
    
31.  ### [597\. Friend Requests I: Overall Acceptance Rate | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#597-friend-requests-i-overall-acceptance-rate--easy---leetcode)
    
32.  ### [601\. Human Traffic of Stadium | Hard | LeetCode](/articles/sql/leetcode-sql-problem-solving#601-human-traffic-of-stadium--hard--leetcode)
    
33.  ### [602\. Friend Requests II: Who Has the Most Friends | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#602-friend-requests-ii-who-has-the-most-friends--medium---leetcode)
    
34.  ### [603\. Consecutive Available Seats | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#603-consecutive-available-seats--easy---leetcode)
    
35.  ### [607.Sales Person | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#607sales-person--easy---leetcode)
    
36.  ### [608\. Tree Node | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#608-tree-node--medium---leetcode)
    
37.  ### [610\. Triangle Judgement | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#610-triangle-judgement--easy---leetcode)
    
38.  ### [612\. Shortest Distance in a Plane | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#612-shortest-distance-in-a-plane--medium---leetcode)
    
39.  ### [613\. Shortest Distance in a Line | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#613-shortest-distance-in-a-line--easy---leetcode)
    
40.  ### [614\. Second Degree Follower | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#614-second-degree-follower--medium---leetcode)
    
41.  ### [615\. Average Salary: Departments VS Company | Hard | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#615-average-salary-departments-vs-company--hard---leetcode)
    
42.  ### [618\. Students Report By Geography | Hard | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#618-students-report-by-geography--hard---leetcode)
    
43.  ### [619\. Biggest Single Number | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#619-biggest-single-number--easy---leetcode)
    
44.  ### [620\. Not Boring Movies | Easy | LeetCode](/articles/sql/leetcode-sql-problem-solving#620-not-boring-movies--easy--leetcode)
    
45.  ### [626\. Exchange Seats | Medium | LeetCode](/articles/sql/leetcode-sql-problem-solving#626-exchange-seats--medium--leetcode)
    
46.  ### [627\. Swap Salary | LeetCode](/articles/sql/leetcode-sql-problem-solving#627-swap-salary--leetcode)
    
47.  ### [1045\. Customers Who Bought All Products | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1045-customers-who-bought-all-products--medium---leetcode)
    
48.  ### [1050\. Actors and Directors Who Cooperated At Least Three Times | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1050-actors-and-directors-who-cooperated-at-least-three-times--easy---leetcode)
    
49.  ### [1068\. Product Sales Analysis I | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1068-product-sales-analysis-i--easy---leetcode)
    
50.  ### [1069\. Product Sales Analysis II | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1069-product-sales-analysis-ii--easy---leetcode)
    
51.  ### [1070\. Product Sales Analysis III | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1070-product-sales-analysis-iii--medium---leetcode)
    
52.  ### [1075\. Project Employees I | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1075-project-employees-i--easy---leetcode)
    
53.  ### [1076\. Project Employees II | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1076-project-employees-ii--easy---leetcode)
    
54.  ### [1077\. Project Employees III | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1077-project-employees-iii--medium---leetcode)
    
55.  ### [1082\. Sales Analysis I | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1082-sales-analysis-i--easy---leetcode)
    
56.  ### [1083\. Sales Analysis II | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1083-sales-analysis-ii--easy---leetcode)
    
57.  ### [1084\. Sales Analysis III | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1084-sales-analysis-iii--easy---leetcode)
    
58.  ### [1097\. Game Play Analysis V | Hard | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1097-game-play-analysis-v--hard---leetcode)
    
59.  ### [1098\. Unpopular Books | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1098-unpopular-books--medium---leetcode)
    
60.  ### [1107\. New Users Daily Count | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1107-new-users-daily-count--medium---leetcode)
    
61.  ### [1112\. Highest Grade For Each Student | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1112-highest-grade-for-each-student--medium---leetcode)
    
62.  ### [1113.Reported Posts | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1113reported-posts--easy---leetcode)
    
63.  ### [1126\. Active Businesses | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1126-active-businesses--medium---leetcode)
    
64.  ### [1127\. User Purchase Platform | Hard | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1127-user-purchase-platform--hard---leetcode)
    
65.  ### [1132\. Reported Posts II | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1132-reported-posts-ii--medium---leetcode)
    
66.  ### [1141\. User Activity for the Past 30 Days I | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1141-user-activity-for-the-past-30-days-i--easy---leetcode)
    
67.  ### [1142\. User Activity for the Past 30 Days II | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1142-user-activity-for-the-past-30-days-ii--easy---leetcode)
    
68.  ### [1148\. Article Views I | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1148-article-views-i--easy---leetcode)
    
69.  ### [1149\. Article Views II | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1149-article-views-ii--medium---leetcode)
    
70.  ### [1158\. Market Analysis I | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1158-market-analysis-i--medium---leetcode)
    
71.  ### [1159\. Market Analysis II | Hard | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1159-market-analysis-ii--hard---leetcode)
    
72.  ### [1164\. Product Price at a Given Date | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1164-product-price-at-a-given-date--medium---leetcode)
    
73.  ### [1173\. Immediate Food Delivery I | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1173-immediate-food-delivery-i--easy---leetcode)
    
74.  ### [1174\. Immediate Food Delivery II | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1174-immediate-food-delivery-ii--medium---leetcode)
    
75.  ### [1179\. Reformat Department Table | Easy | LeetCode](/articles/sql/leetcode-sql-problem-solving#1179-reformat-department-table--easy--leetcode)
    
76.  ### [1193\. Monthly Transactions I | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1193-monthly-transactions-i--medium---leetcode)
    
77.  ### [1194\. Tournament Winners | Hard | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1194-tournament-winners--hard---leetcode)
    
78.  ### [1204\. Last Person to Fit in the Elevator | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1204-last-person-to-fit-in-the-elevator--medium---leetcode)
    
79.  ### [1205\. Monthly Transactions II | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1205-monthly-transactions-ii--medium---leetcode)
    
80.  ### [1211\. Queries Quality and Percentage | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1211-queries-quality-and-percentage--easy---leetcode)
    
81.  ### [1212\. Team Scores in Football Tournament | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1212-team-scores-in-football-tournament--medium---leetcode)
    
82.  ### [1225\. Report Contiguous Dates | Hard | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1225-report-contiguous-dates--hard---leetcode)
    
83.  ### [1241\. Number of Comments per Post | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1241-number-of-comments-per-post--easy---leetcode)
    
84.  ### [1251\. Average Selling Price | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1251-average-selling-price--easy---leetcode)
    
85.  ### [1264\. Page Recommendations | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1264-page-recommendations--medium---leetcode)
    
86.  ### [1270\. All People Report to the Given Manager | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1270-all-people-report-to-the-given-manager--medium---leetcode)
    
87.  ### [1280\. Students and Examinations| Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1280-students-and-examinations-easy---leetcode)
    
88.  ### [1285\. Find the Start and End Number of Continuous Ranges | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1285-find-the-start-and-end-number-of-continuous-ranges--medium---leetcode)
    
89.  ### [1294\. Weather Type in Each Country | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1294-weather-type-in-each-country--easy---leetcode)
    
90.  ### [1303\. Find the Team Size | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1303-find-the-team-size--easy---leetcode)
    
91.  ### [1308\. Running Total for Different Genders | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1308-running-total-for-different-genders--medium---leetcode)
    
92.  ### [1321\. Restaurant Growth | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1321-restaurant-growth--medium---leetcode)
    
93.  ### [1322\. Ads Performance | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1322-ads-performance--easy---leetcode)
    
94.  ### [1327\. List the Products Ordered in a Period | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1327-list-the-products-ordered-in-a-period--easy---leetcode)
    
95.  ### [1336\. Number of Transactions per Visit | Hard | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1336-number-of-transactions-per-visit--hard---leetcode)
    
96.  ### [1341\. Movie Rating | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1341-movie-rating--medium---leetcode)
    
97.  ### [1350\. Students With Invalid Departments | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1350-students-with-invalid-departments--easy---leetcode)
    
98.  ### [1355\. Activity Participants | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1355-activity-participants--medium---leetcode)
    
99.  ### [1364\. Number of Trusted Contacts of a Customer | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1364-number-of-trusted-contacts-of-a-customer--medium---leetcode)
    
100.  ### [1369\. Get the Second Most Recent Activity | Hard | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1369-get-the-second-most-recent-activity--hard---leetcode)
    
101.  ### [1378\. Replace Employee ID With The Unique Identifier | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1378-replace-employee-id-with-the-unique-identifier--easy---leetcode)
    
102.  ### [1384\. Total Sales Amount by Year | Hard | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1384-total-sales-amount-by-year--hard---leetcode)
    
103.  ### [1393\. Capital Gain/Loss | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1393-capital-gainloss--medium---leetcode)
    
104.  ### [1398\. Customers Who Bought Products A and B but Not C | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1398-customers-who-bought-products-a-and-b-but-not-c--medium---leetcode)
    
105.  ### [1407\. Top Travellers | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1407-top-travellers--easy---leetcode)
    
106.  ### [1412\. Find the Quiet Students in All Exams | Hard | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1412-find-the-quiet-students-in-all-exams--hard---leetcode)
    
107.  ### [1421\. NPV Queries | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1421-npv-queries--medium---leetcode)
    
108.  ### [1435\. Create a Session Bar Chart | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1435-create-a-session-bar-chart--easy---leetcode)
    
109.  ### [1440\. Evaluate Boolean Expression | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1440-evaluate-boolean-expression--medium---leetcode)
    
110.  ### [1445\. Apples & Oranges | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1445-apples--oranges--medium---leetcode)
    
111.  ### [1454\. Active Users | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1454-active-users--medium---leetcode)
    
112.  ### [1459\. Rectangles Area | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1459-rectangles-area--medium---leetcode)
    
113.  ### [1468\. Calculate Salaries | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1468-calculate-salaries--medium---leetcode)
    
114.  ### [1479\. Sales by Day of the Week | Hard | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1479-sales-by-day-of-the-week--hard---leetcode)
    
115.  ### [1484\. Group Sold Products By The Date | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1484-group-sold-products-by-the-date--easy---leetcode)
    
116.  ### [1495\. Friendly Movies Streamed Last Month | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1495-friendly-movies-streamed-last-month--easy---leetcode)
    
117.  ### [1501\. Countries You Can Safely Invest In | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1501-countries-you-can-safely-invest-in--medium---leetcode)
    
118.  ### [1511\. Customer Order Frequency | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1511-customer-order-frequency--easy---leetcode)
    
119.  ### [1517\. Find Users With Valid E-Mails | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1517-find-users-with-valid-e-mails--easy---leetcode)
    
120.  ### [1527\. Patients With a Condition | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1527-patients-with-a-condition--easy---leetcode)
    
121.  ### [1532\. The Most Recent Three Orders | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1532-the-most-recent-three-orders--medium---leetcode)
    
122.  ### [1543\. Fix Product Name Format | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1543-fix-product-name-format--easy---leetcode)
    
123.  ### [1549\. The Most Recent Orders for Each Product | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1549-the-most-recent-orders-for-each-product--medium---leetcode)
    
124.  ### [1555\. Bank Account Summary | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1555-bank-account-summary--medium---leetcode)
    
125.  ### [1565\. Unique Orders and Customers Per Month | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1565-unique-orders-and-customers-per-month--easy---leetcode)
    
126.  ### [1571\. Warehouse Manager | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1571-warehouse-manager--easy---leetcode)
    
127.  ### [1581\. Customer Who Visited but Did Not Make Any Transactions | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1581-customer-who-visited-but-did-not-make-any-transactions--easy---leetcode)
    
128.  ### [1587\. Bank Account Summary II | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1587-bank-account-summary-ii--easy---leetcode)
    
129.  ### [1596\. The Most Frequently Ordered Products for Each Customer | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1596-the-most-frequently-ordered-products-for-each-customer--medium---leetcode)
    
130.  ### [1607\. Sellers With No Sales | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1607-sellers-with-no-sales--easy---leetcode)
    
131.  ### [1613\. Find the Missing IDs | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1613-find-the-missing-ids--medium---leetcode)
    
132.  ### [1623\. All Valid Triplets That Can Represent a Country | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1623-all-valid-triplets-that-can-represent-a-country--easy---leetcode)
    
133.  ### [1633\. Percentage of Users Attended a Contest | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1633-percentage-of-users-attended-a-contest--easy---leetcode)
    
134.  ### [1635\. Hopper Company Queries I | Hard | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1635-hopper-company-queries-i--hard---leetcode)
    
135.  ### [1645\. Hopper Company Queries II | Hard | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1645-hopper-company-queries-ii--hard---leetcode)
    
136.  ### [1651\. Hopper Company Queries III | Hard | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1651-hopper-company-queries-iii--hard---leetcode)
    
137.  ### [1661\. Average Time of Process per Machine | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1661-average-time-of-process-per-machine--easy---leetcode)
    
138.  ### [1667\. Fix Names in a Table | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1667-fix-names-in-a-table--easy---leetcode)
    
139.  ### [1677\. Product's Worth Over Invoices | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1677-products-worth-over-invoices--easy---leetcode)
    
140.  ### [1683\. Invalid Tweets | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1683-invalid-tweets--easy---leetcode)
    
141.  ### [1693\. Daily Leads and Partners | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1693-daily-leads-and-partners--easy---leetcode)
    
142.  ### [1699\. Number of Calls Between Two Persons | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1699-number-of-calls-between-two-persons--medium---leetcode)
    
143.  ### [1709\. Biggest Window Between Visits | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1709-biggest-window-between-visits--medium---leetcode)
    
144.  ### [1715\. Count Apples and Oranges | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1715-count-apples-and-oranges--medium---leetcode)
    
145.  ### [1729\. Find Followers Count | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1729-find-followers-count--easy---leetcode)
    
146.  ### [1731\. The Number of Employees Which Report to Each Employee | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1731-the-number-of-employees-which-report-to-each-employee--easy---leetcode)
    
147.  ### [1741\. Find Total Time Spent by Each Employee | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1741-find-total-time-spent-by-each-employee--easy---leetcode)
    
148.  ### [1747\. Leetflex Banned Accounts | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1747-leetflex-banned-accounts--medium---leetcode)
    
149.  ### [1757\. Recyclable and Low Fat Products | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1757-recyclable-and-low-fat-products--easy---leetcode)
    
150.  ### [1767\. Find the Subtasks That Did Not Execute | Hard | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1767-find-the-subtasks-that-did-not-execute--hard---leetcode)
    
151.  ### [1777\. Product's Price for Each Store | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1777-products-price-for-each-store--easy---leetcode)
    
152.  ### [1783\. Grand Slam Titles | Medium | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1783-grand-slam-titles--medium---leetcode)
    
153.  ### [1789\. Primary Department for Each Employee | Easy | 🔒 LeetCode](/articles/sql/leetcode-sql-problem-solving#1789-primary-department-for-each-employee--easy---leetcode)
    

[](#175-combine-two-tables--easy--leetcode)175\. Combine Two Tables | Easy | [LeetCode](https://leetcode.com/problems/combine-two-tables/)
------------------------------------------------------------------------------------------------------------------------------------------

Table: `Person`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| PersonId    | int     |

| FirstName   | varchar |

| LastName    | varchar |

+-------------+---------+

PersonId is the primary key column for this table.

Table: `Address`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| AddressId   | int     |

| PersonId    | int     |

| City        | varchar |

| State       | varchar |

+-------------+---------+

AddressId is the primary key column for this table.

Write a SQL query for a report that provides the following information for each person in the Person table, regardless if there is an address for each of those people:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

FirstName, LastName, City, State

### [](#solution)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT p.FirstName, p.LastName, a.City, a.State

FROM Person p

LEFT JOIN Address a

ON p.PersonId \= a.PersonId;

[](#176-second-highest-salary--easy--leetcode)176\. Second Highest Salary | Easy | [LeetCode](https://leetcode.com/problems/second-highest-salary/)
---------------------------------------------------------------------------------------------------------------------------------------------------

Write a SQL query to get the second highest salary from the `Employee` table.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----+--------+

| Id | Salary |

+----+--------+

| 1  | 100    |

| 2  | 200    |

| 3  | 300    |

+----+--------+

For example, given the above Employee table, the query should return `200` as the second highest salary. If there is no second highest salary, then the query should return `null`.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------------+

| SecondHighestSalary |

+---------------------+

| 200                 |

+---------------------+

### [](#solution-1)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

SELECT Max(Salary) SecondHighestSalary

FROM Employee WHERE Salary < (SELECT MAX(Salary) FROM Employee)

#Solution 2:

WITH CTE AS (SELECT DISTINCT Salary

FROM Employee

ORDER BY Salary DESC

LIMIT 2)

SELECT Salary as SecondHighestSalary

FROM CTE

ORDER BY Salary Asc

LIMIT 1;

#Solution 3:

WITH CTE AS

(

    SELECT Salary,

           DENSE\_RANK() OVER (ORDER BY Salary DESC) AS DENSERANK

    FROM Employee

)

SELECT Salary SecondHighestSalary

FROM CTE

WHERE DENSERANK \= 2;

[](#177-nth-highest-salary--medium--leetcode)177\. Nth Highest Salary | Medium | [LeetCode](https://leetcode.com/problems/nth-highest-salary/)
----------------------------------------------------------------------------------------------------------------------------------------------

Write a SQL query to get the nth highest salary from the Employee table.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----+--------+

| Id | Salary |

+----+--------+

| 1  | 100    |

| 2  | 200    |

| 3  | 300    |

+----+--------+

For example, given the above Employee table, the nth highest salary where n = 2 is 200. If there is no nth highest salary, then the query should return null.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+------------------------+

| getNthHighestSalary(2) |

+------------------------+

| 200                    |

+------------------------+

### [](#solution-2)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

CREATE FUNCTION getNthHighestSalary(N INT) RETURNS INT

BEGIN

SET N \= N\-1;

    RETURN(

        SELECT DISTINCT Salary FROM Employee ORDER BY Salary DESC

        LIMIT 1 OFFSET N

    );

END

[](#178-rank-scores--medium--leetcode)178\. Rank Scores | Medium | [LeetCode](https://leetcode.com/problems/rank-scores/)
-------------------------------------------------------------------------------------------------------------------------

Write a SQL query to rank scores. If there is a tie between two scores, both should have the same ranking. Note that after a tie, the next ranking number should be the next consecutive integer value. In other words, there should be no "holes" between ranks.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----+-------+

| Id | Score |

+----+-------+

| 1  | 3.50  |

| 2  | 3.65  |

| 3  | 4.00  |

| 4  | 3.85  |

| 5  | 4.00  |

| 6  | 3.65  |

+----+-------+

For example, given the above `Scores` table, your query should generate the following report (order by highest score):

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------+---------+

| score | Rank    |

+-------+---------+

| 4.00  | 1       |

| 4.00  | 1       |

| 3.85  | 2       |

| 3.65  | 3       |

| 3.65  | 3       |

| 3.50  | 4       |

+-------+---------+

**Important Note:** For MySQL solutions, to escape reserved words used as column names, you can use an apostrophe before and after the keyword. For example `Rank`.

### [](#solution-3)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT score, DENSE\_RANK() OVER (ORDER By Score DESC) AS "Rank"

FROM Scores;

[](#180-consecutive-numbers--medium--leetcode)180\. Consecutive Numbers | Medium | [LeetCode](https://leetcode.com/problems/consecutive-numbers/)
-------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Logs`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| id          | int     |

| num         | varchar |

+-------------+---------+

id is the primary key for this table.

Write an SQL query to find all numbers that appear at least three times consecutively.

Return the result table in any order.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Logs table:

+----+-----+

| Id | Num |

+----+-----+

| 1  | 1   |

| 2  | 1   |

| 3  | 1   |

| 4  | 2   |

| 5  | 1   |

| 6  | 2   |

| 7  | 2   |

+----+-----+

Result table:

+-----------------+

| ConsecutiveNums |

+-----------------+

| 1               |

+-----------------+

1 is the only number that appears consecutively for at least three times.

### [](#solution-4)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT a.Num as ConsecutiveNums

FROM Logs a

JOIN Logs b

ON a.id \= b.id+1 AND a.num \= b.num

JOIN Logs c

ON a.id \= c.id+2 AND a.num \= c.num;

[](#181-employees-earning-more-than-their-managers--easy--leetcode)181\. Employees Earning More Than Their Managers | Easy | [LeetCode](https://leetcode.com/problems/employees-earning-more-than-their-managers/)
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

The `Employee` table holds all employees including their managers. Every employee has an Id, and there is also a column for the manager Id.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----+-------+--------+-----------+

| Id | Name  | Salary | ManagerId |

+----+-------+--------+-----------+

| 1  | Joe   | 70000  | 3         |

| 2  | Henry | 80000  | 4         |

| 3  | Sam   | 60000  | NULL      |

| 4  | Max   | 90000  | NULL      |

+----+-------+--------+-----------+

Given the `Employee` table, write a SQL query that finds out employees who earn more than their managers. For the above table, Joe is the only employee who earns more than his manager.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----------+

| Employee |

+----------+

| Joe      |

+----------+

### [](#solution-5)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT E.Name as "Employee"

FROM Employee E

JOIN Employee M

ON E.ManagerId \= M.Id

AND E.Salary \> M.Salary;

[](#182-duplicate-emails--easy--leetcode)182\. Duplicate Emails | Easy | [LeetCode](https://leetcode.com/problems/duplicate-emails/)
------------------------------------------------------------------------------------------------------------------------------------

Write a SQL query to find all duplicate emails in a table named `Person`.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----+---------+

| Id | Email   |

+----+---------+

| 1  | [\[email protected\]](/cdn-cgi/l/email-protection) |

| 2  | [\[email protected\]](/cdn-cgi/l/email-protection) |

| 3  | [\[email protected\]](/cdn-cgi/l/email-protection) |

+----+---------+

For example, your query should return the following for the above table:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------+

| Email   |

+---------+

| [\[email protected\]](/cdn-cgi/l/email-protection) |

+---------+

**Note:** All emails are in lowercase.

### [](#solution-6)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution- 1:

SELECT Email

FROM Person

GROUP BY Email

HAVING count(\*) \> 1

#Solution- 2:

WITH CTE AS(

SELECT Email, ROW\_NUMBER() OVER(PARTITION BY Email ORDER BY Email) AS RN

    FROM Person

)

SELECT Email

FROM CTE

WHERE RN \> 1;

[](#183-customers-who-never-order--easy--leetcode)183\. Customers Who Never Order | Easy | [LeetCode](https://leetcode.com/problems/customers-who-never-order/)
---------------------------------------------------------------------------------------------------------------------------------------------------------------

Suppose that a website contains two tables, the `Customers` table and the `Orders` table. Write a SQL query to find all customers who never order anything.

Table: `Customers`.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----+-------+

| Id | Name  |

+----+-------+

| 1  | Joe   |

| 2  | Henry |

| 3  | Sam   |

| 4  | Max   |

+----+-------+

Table: `Orders`.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----+------------+

| Id | CustomerId |

+----+------------+

| 1  | 3          |

| 2  | 1          |

+----+------------+

Using the above tables as example, return the following:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-----------+

| Customers |

+-----------+

| Henry     |

| Max       |

+-----------+

### [](#solution-7)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution- 1:

SELECT Name AS Customers

FROM Customers

LEFT JOIN Orders

ON Customers.Id \= Orders.CustomerId

WHERE CustomerId IS NULL;

#Solution- 2:

SELECT Name as Customers

FROM Customers

WHERE Id NOT IN(

    SELECT CustomerId

    FROM Orders

)

[](#184-department-highest-salary--medium--leetcode)184\. Department Highest Salary | Medium | [LeetCode](https://leetcode.com/problems/department-highest-salary/)
-------------------------------------------------------------------------------------------------------------------------------------------------------------------

The `Employee` table holds all employees. Every employee has an Id, a salary, and there is also a column for the department Id.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----+-------+--------+--------------+

| Id | Name  | Salary | DepartmentId |

+----+-------+--------+--------------+

| 1  | Joe   | 70000  | 1            |

| 2  | Jim   | 90000  | 1            |

| 3  | Henry | 80000  | 2            |

| 4  | Sam   | 60000  | 2            |

| 5  | Max   | 90000  | 1            |

+----+-------+--------+--------------+

The `Department` table holds all departments of the company.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----+----------+

| Id | Name     |

+----+----------+

| 1  | IT       |

| 2  | Sales    |

+----+----------+

Write a SQL query to find employees who have the highest salary in each of the departments. For the above tables, your SQL query should return the following rows (order of rows does not matter).

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+------------+----------+--------+

| Department | Employee | Salary |

+------------+----------+--------+

| IT         | Max      | 90000  |

| IT         | Jim      | 90000  |

| Sales      | Henry    | 80000  |

+------------+----------+--------+

**_Explanation:_**  
Max and Jim both have the highest salary in the IT department and Henry has the highest salary in the Sales department.

### [](#solution-8)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT Department.Name AS Department, Employee.Name AS Employee, Salary

FROM Employee

JOIN Department

ON Employee.DepartmentId \= Department.Id

WHERE (DepartmentId, Salary) IN(

        SELECT  DepartmentId, MAX(Salary) AS Salary

        FROM Employee

        GROUP BY DepartmentId

        );

[](#185-department-top-three-salaries--hard--leetcode)185\. Department Top Three Salaries | Hard | [LeetCode](https://leetcode.com/problems/department-top-three-salaries/)
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------

The `Employee` table holds all employees. Every employee has an Id, and there is also a column for the department Id.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----+-------+--------+--------------+

| Id | Name\` | Salary | DepartmentId |

+----+-------+--------+--------------+

| 1  | Joe   | 85000  | 1            |

| 2  | Henry | 80000  | 2            |

| 3  | Sam   | 60000  | 2            |

| 4  | Max   | 90000  | 1            |

| 5  | Janet | 69000  | 1            |

| 6  | Randy | 85000  | 1            |

| 7  | Will  | 70000  | 1            |

+----+-------+--------+--------------+

The `Department` table holds all departments of the company.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----+----------+

| Id | Name     |

+----+----------+

| 1  | IT       |

| 2  | Sales    |

+----+----------+

Write a SQL query to find employees who earn the top three salaries in each of the department. For the above tables, your SQL query should return the following rows (order of rows does not matter).

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+------------+----------+--------+

| Department | Employee | Salary |

+------------+----------+--------+

| IT         | Max      | 90000  |

| IT         | Randy    | 85000  |

| IT         | Joe      | 85000  |

| IT         | Will     | 70000  |

| Sales      | Henry    | 80000  |

| Sales      | Sam      | 60000  |

+------------+----------+--------+

**_Explanation:_**  
In IT department, Max earns the highest salary, both Randy and Joe earn the second highest salary, and Will earns the third highest salary. There are only two employees in the Sales department, Henry earns the highest salary while Sam earns the second highest salary.

### [](#solution-9)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

WITH department\_ranking AS (

SELECT Name AS Employee, Salary ,DepartmentId

  ,DENSE\_RANK() OVER (PARTITION BY DepartmentId ORDER BY Salary DESC) AS rnk

FROM Employee

)

SELECT d.Name AS Department, r.Employee, r.Salary

FROM department\_ranking AS r

JOIN Department AS d

ON r.DepartmentId \= d.Id

WHERE r.rnk <= 3

ORDER BY d.Name ASC, r.Salary DESC;

[](#196-delete-duplicate-emails--easy--leetcode)196\. Delete Duplicate Emails | Easy | [LeetCode](https://leetcode.com/problems/delete-duplicate-emails/)
---------------------------------------------------------------------------------------------------------------------------------------------------------

Write a SQL query to delete all duplicate email entries in a table named `Person`, keeping only unique emails based on its smallest Id.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----+------------------+

| Id | Email            |

+----+------------------+

| 1  | [\[email protected\]](/cdn-cgi/l/email-protection) |

| 2  | [\[email protected\]](/cdn-cgi/l/email-protection)  |

| 3  | [\[email protected\]](/cdn-cgi/l/email-protection) |

+----+------------------+

Id is the primary key column for this table. For example, after running your query, the above `Person` table should have the following rows:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----+------------------+

| Id | Email            |

+----+------------------+

| 1  | [\[email protected\]](/cdn-cgi/l/email-protection) |

| 2  | [\[email protected\]](/cdn-cgi/l/email-protection)  |

+----+------------------+

**Note:**  
Your output is the whole `Person` table after executing your sql. Use `delete` statement.

### [](#solution-10)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

DELETE p2

FROM Person p1

JOIN Person p2

ON p1.Email \= p2.Email

AND p1.id < p2.id

[](#197-rising-temperature--easy--leetcode)197\. Rising Temperature | Easy | [LeetCode](https://leetcode.com/problems/rising-temperature/)
------------------------------------------------------------------------------------------------------------------------------------------

Table: `Weather`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| id            | int     |

| recordDate    | date    |

| temperature   | int     |

+---------------+---------+

id is the primary key for this table.

This table contains information about the temperature in a certain day.

Write an SQL query to find all dates' `id` with higher temperature compared to its previous dates (yesterday).

Return the result table in any order.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Weather

+----+------------+-------------+

| id | recordDate | Temperature |

+----+------------+-------------+

| 1  | 2015-01-01 | 10          |

| 2  | 2015-01-02 | 25          |

| 3  | 2015-01-03 | 20          |

| 4  | 2015-01-04 | 30          |

+----+------------+-------------+

Result table:

+----+

| id |

+----+

| 2  |

| 4  |

+----+

In 2015-01-02, temperature was higher than the previous day (10 -> 25).

In 2015-01-04, temperature was higher than the previous day (20 -> 30).

### [](#solution-11)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution- 1:

SELECT t.Id

FROM Weather AS t, Weather AS y

WHERE DATEDIFF(t.RecordDate, y.RecordDate) \= 1

AND t.Temperature \> y.Temperature;

#Solution- 2:

SELECT t.Id

FROM Weather t

JOIN Weather y

ON DATEDIFF(t.recordDate, y.recordDate) \= 1 AND

t.temperature \> y.temperature;

[](#262-trips-and-users--hard--leetcode)262\. Trips and Users | Hard | [LeetCode](https://leetcode.com/problems/trips-and-users/)
---------------------------------------------------------------------------------------------------------------------------------

Table: `Trips`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+----------+

| Column Name | Type     |

+-------------+----------+

| Id          | int      |

| Client\_Id   | int      |

| Driver\_Id   | int      |

| City\_Id     | int      |

| Status      | enum     |

| Request\_at  | date     |

+-------------+----------+

Id is the primary key for this table.

The table holds all taxi trips. Each trip has a unique Id, while Client\_Id and Driver\_Id are foreign keys to the Users\_Id at the Users table.

Status is an ENUM type of (‘completed’, ‘cancelled\_by\_driver’, ‘cancelled\_by\_client’).

Table: `Users`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+----------+

| Column Name | Type     |

+-------------+----------+

| Users\_Id    | int      |

| Banned      | enum     |

| Role        | enum     |

+-------------+----------+

Users\_Id is the primary key for this table.

The table holds all users. Each user has a unique Users\_Id, and Role is an ENUM type of (‘client’, ‘driver’, ‘partner’).

Status is an ENUM type of (‘Yes’, ‘No’).

Write a SQL query to find the cancellation rate of requests with unbanned users (both client and driver must not be banned) each day between `"2013-10-01"` and `"2013-10-03"`.

The cancellation rate is computed by dividing the number of canceled (by client or driver) requests with unbanned users by the total number of requests with unbanned users on that day.

Return the result table in any order. Round `Cancellation Rate` to two decimal points.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Trips table:

+----+-----------+-----------+---------+---------------------+------------+

| Id | Client\_Id | Driver\_Id | City\_Id | Status              | Request\_at |

+----+-----------+-----------+---------+---------------------+------------+

| 1  | 1         | 10        | 1       | completed           | 2013-10-01 |

| 2  | 2         | 11        | 1       | cancelled\_by\_driver | 2013-10-01 |

| 3  | 3         | 12        | 6       | completed           | 2013-10-01 |

| 4  | 4         | 13        | 6       | cancelled\_by\_client | 2013-10-01 |

| 5  | 1         | 10        | 1       | completed           | 2013-10-02 |

| 6  | 2         | 11        | 6       | completed           | 2013-10-02 |

| 7  | 3         | 12        | 6       | completed           | 2013-10-02 |

| 8  | 2         | 12        | 12      | completed           | 2013-10-03 |

| 9  | 3         | 10        | 12      | completed           | 2013-10-03 |

| 10 | 4         | 13        | 12      | cancelled\_by\_driver | 2013-10-03 |

+----+-----------+-----------+---------+---------------------+------------+

Users table:

+----------+--------+--------+

| Users\_Id | Banned | Role   |

+----------+--------+--------+

| 1        | No     | client |

| 2        | Yes    | client |

| 3        | No     | client |

| 4        | No     | client |

| 10       | No     | driver |

| 11       | No     | driver |

| 12       | No     | driver |

| 13       | No     | driver |

+----------+--------+--------+

Result table:

+------------+-------------------+

| Day        | Cancellation Rate |

+------------+-------------------+

| 2013-10-01 | 0.33              |

| 2013-10-02 | 0.00              |

| 2013-10-03 | 0.50              |

+------------+-------------------+

On 2013-10-01:

\- There were 4 requests in total, 2 of which were canceled.

\- However, the request with Id=2 was made by a banned client (User\_Id=2), so it is ignored in the calculation.

\- Hence there are 3 unbanned requests in total, 1 of which was canceled.

\- The Cancellation Rate is (1 / 3) = 0.33

  On 2013-10-02:

\- There were 3 requests in total, 0 of which were canceled.

\- The request with Id=6 was made by a banned client, so it is ignored.

\- Hence there are 2 unbanned requests in total, 0 of which were canceled.

\- The Cancellation Rate is (0 / 2) = 0.00

  On 2013-10-03:

\- There were 3 requests in total, 1 of which was canceled.

\- The request with Id=8 was made by a banned client, so it is ignored.

\- Hence there are 2 unbanned request in total, 1 of which were canceled.

\- The Cancellation Rate is (1 / 2) = 0.50

### [](#solution-12)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT Request\_at AS Day,

ROUND(SUM(IF(Status<>"completed", 1, 0))/COUNT(Status),2) AS "Cancellation Rate"

FROM Trips

WHERE Request\_at BETWEEN "2013-10-01" AND "2013-10-03"

AND Client\_Id NOT IN (SELECT Users\_Id FROM Users WHERE Banned \= 'Yes')

AND Driver\_Id NOT IN (SELECT Users\_Id FROM Users WHERE Banned \= 'Yes')

GROUP BY Request\_at;

[](#511-game-play-analysis-i--easy---leetcode)511\. Game Play Analysis I | Easy | 🔒 [LeetCode](https://leetcode.com/problems/game-play-analysis-i/)
----------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Activity`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+---------+

| Column Name  | Type    |

+--------------+---------+

| player\_id    | int     |

| device\_id    | int     |

| event\_date   | date    |

| games\_played | int     |

+--------------+---------+

(player\_id, event\_date) is the primary key of this table.

This table shows the activity of players of some game.

Each row is a record of a player who logged in and played a number of games (possibly 0) before logging out on some day using some device.

Write an SQL query that reports the **first login date** for each player.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Activity table:

+-----------+-----------+------------+--------------+

| player\_id | device\_id | event\_date | games\_played |

+-----------+-----------+------------+--------------+

| 1         | 2         | 2016-03-01 | 5            |

| 1         | 2         | 2016-05-02 | 6            |

| 2         | 3         | 2017-06-25 | 1            |

| 3         | 1         | 2016-03-02 | 0            |

| 3         | 4         | 2018-07-03 | 5            |

+-----------+-----------+------------+--------------+

Result table:

+-----------+-------------+

| player\_id | first\_login |

+-----------+-------------+

| 1         | 2016-03-01  |

| 2         | 2017-06-25  |

| 3         | 2016-03-02  |

+-----------+-------------+

### [](#solution-13)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT player\_id, MIN(event\_date) as first\_login

FROM Activity

GROUP BY player\_id

[](#512-game-play-analysis-ii--easy---leetcode)512\. Game Play Analysis II | Easy | 🔒 [LeetCode](https://leetcode.com/problems/game-play-analysis-ii/)
-------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Activity`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+---------+

| Column Name  | Type    |

+--------------+---------+

| player\_id    | int     |

| device\_id    | int     |

| event\_date   | date    |

| games\_played | int     |

+--------------+---------+

(player\_id, event\_date) is the primary key of this table.

This table shows the activity of players of some game.

Each row is a record of a player who logged in and played a number of games (possibly 0) before logging out on some day using some device.

Write a SQL query that reports the device that is first logged in for each player.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Activity table:

+-----------+-----------+------------+--------------+

| player\_id | device\_id | event\_date | games\_played |

+-----------+-----------+------------+--------------+

| 1         | 2         | 2016-03-01 | 5            |

| 1         | 2         | 2016-05-02 | 6            |

| 2         | 3         | 2017-06-25 | 1            |

| 3         | 1         | 2016-03-02 | 0            |

| 3         | 4         | 2018-07-03 | 5            |

+-----------+-----------+------------+--------------+

Result table:

+-----------+-----------+

| player\_id | device\_id |

+-----------+-----------+

| 1         | 2         |

| 2         | 3         |

| 3         | 1         |

+-----------+-----------+

### [](#solution-14)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution- 1:

SELECT DISTINCT player\_id, device\_id

FROM Activity

WHERE (player\_id, event\_date) in (

    SELECT player\_id, min(event\_date)

    FROM Activity

    GROUP BY player\_id)

#Solution- 2:

SELECT a.player\_id, b.device\_id

FROM

(SELECT player\_id, MIN(event\_date) AS event\_date FROM Activity

GROUP BY player\_id) a

JOIN Activity b

ON a.player\_id \= b.player\_id AND a.event\_date \= b.event\_date;

#Solution- 3:

SELECT player\_id, device\_id

FROM

(SELECT player\_id, device\_id, event\_date,

ROW\_NUMBER() OVER (PARTITION BY player\_id ORDER BY event\_date) AS r

FROM Activity) lookup

WHERE r \= 1;

[](#534-game-play-analysis-iii--medium---leetcode)534\. Game Play Analysis III | Medium | 🔒 [LeetCode](https://leetcode.com/problems/game-play-analysis-iii/)
--------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Activity`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+---------+

| Column Name  | Type    |

+--------------+---------+

| player\_id    | int     |

| device\_id    | int     |

| event\_date   | date    |

| games\_played | int     |

+--------------+---------+

(player\_id, event\_date) is the primary key of this table.

This table shows the activity of players of some game.

Each row is a record of a player who logged in and played a number of games (possibly 0) before logging out on some day using some device.

Write an SQL query that reports for each player and date, how many games played so far by the player. That is, the total number of games played by the player until that date. Check the example for clarity.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Activity table:

+-----------+-----------+------------+--------------+

| player\_id | device\_id | event\_date | games\_played |

+-----------+-----------+------------+--------------+

| 1         | 2         | 2016-03-01 | 5            |

| 1         | 2         | 2016-05-02 | 6            |

| 1         | 3         | 2017-06-25 | 1            |

| 3         | 1         | 2016-03-02 | 0            |

| 3         | 4         | 2018-07-03 | 5            |

+-----------+-----------+------------+--------------+

Result table:

+-----------+------------+---------------------+

| player\_id | event\_date | games\_played\_so\_far |

+-----------+------------+---------------------+

| 1         | 2016-03-01 | 5                   |

| 1         | 2016-05-02 | 11                  |

| 1         | 2017-06-25 | 12                  |

| 3         | 2016-03-02 | 0                   |

| 3         | 2018-07-03 | 5                   |

+-----------+------------+---------------------+

For the player with id 1, 5 + 6 = 11 games played by 2016-05-02, and 5 + 6 + 1 = 12 games played by 2017-06-25.

For the player with id 3, 0 + 5 = 5 games played by 2018-07-03.

Note that for each player we only care about the days when the player logged in.

### [](#solution-15)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution- 1:

SELECT t1.player\_id, t1.event\_date, SUM(t2.games\_played) as games\_played\_so\_far

FROM Activity t1

JOIN Activity t2

ON t1.player\_id \= t2.player\_id

WHERE t1.event\_date \>= t2.event\_date

GROUP BY t1.player\_id, t1.event\_date;

#Solution- 2:

SELECT player\_id, event\_date,

SUM(games\_played) OVER (PARTITION BY player\_id ORDER BY event\_date) AS games\_played\_so\_far

FROM Activity;

[](#550-game-play-analysis-iv--medium---leetcode)550\. Game Play Analysis IV | Medium | 🔒 [LeetCode](https://leetcode.com/problems/game-play-analysis-iv/)
-----------------------------------------------------------------------------------------------------------------------------------------------------------

Table: Activity

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+---------+

| Column Name  | Type    |

+--------------+---------+

| player\_id    | int     |

| device\_id    | int     |

| event\_date   | date    |

| games\_played | int     |

+--------------+---------+

(player\_id, event\_date) is the primary key of this table.

This table shows the activity of players of some game.

Each row is a record of a player who logged in and played a number of games (possibly 0) before logging out on some day using some device.

Write an SQL query that reports the fraction of players that logged in again on the day after the day they first logged in, rounded to 2 decimal places. In other words, you need to count the number of players that logged in for at least two consecutive days starting from their first login date, then divide that number by the total number of players.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Activity table:

+-----------+-----------+------------+--------------+

| player\_id | device\_id | event\_date | games\_played |

+-----------+-----------+------------+--------------+

| 1         | 2         | 2016-03-01 | 5            |

| 1         | 2         | 2016-03-02 | 6            |

| 2         | 3         | 2017-06-25 | 1            |

| 3         | 1         | 2016-03-02 | 0            |

| 3         | 4         | 2018-07-03 | 5            |

+-----------+-----------+------------+--------------+

Result table:

+-----------+

| fraction  |

+-----------+

| 0.33      |

+-----------+

Only the player with id 1 logged back in after the first day he had logged in so the answer is 1/3 = 0.33

### [](#solution-16)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution- 1:

SELECT ROUND(sum(CASE WHEN t1.event\_date \= t2.first\_event+1 THEN 1 ELSE 0 END)/COUNT(DISTINCT t1.player\_id), 2) AS fraction

FROM Activity t1

JOIN

    (SELECT player\_id, MIN(event\_date) AS first\_event

    FROM Activity

    GROUP BY player\_id) t2

    ON t1.player\_id \= t2.player\_id;

#Solution- 2:

SELECT ROUND(COUNT(DISTINCT b.player\_id)/COUNT(DISTINCT a.player\_id),2) AS fraction

FROM

  (SELECT player\_id, MIN(event\_date) AS event\_date FROM Activity

  GROUP BY player\_id) a

  LEFT JOIN Activity b

  ON a.player\_id \= b.player\_id AND a.event\_date+1 \= b.event\_date;

[](#569-median-employee-salary--hard---leetcode)569\. Median Employee Salary | Hard | 🔒 [LeetCode](https://leetcode.com/problems/median-employee-salary/)
----------------------------------------------------------------------------------------------------------------------------------------------------------

The `Employee` table holds all employees. The employee table has three columns: Employee Id, Company Name, and Salary.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-----+------------+--------+

|Id   | Company    | Salary |

+-----+------------+--------+

|1    | A          | 2341   |

|2    | A          | 341    |

|3    | A          | 15     |

|4    | A          | 15314  |

|5    | A          | 451    |

|6    | A          | 513    |

|7    | B          | 15     |

|8    | B          | 13     |

|9    | B          | 1154   |

|10   | B          | 1345   |

|11   | B          | 1221   |

|12   | B          | 234    |

|13   | C          | 2345   |

|14   | C          | 2645   |

|15   | C          | 2645   |

|16   | C          | 2652   |

|17   | C          | 65     |

+-----+------------+--------+

Write a SQL query to find the median salary of each company. Bonus points if you can solve it without using any built-in SQL functions.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-----+------------+--------+

|Id   | Company    | Salary |

+-----+------------+--------+

|5    | A          | 451    |

|6    | A          | 513    |

|12   | B          | 234    |

|9    | B          | 1154   |

|14   | C          | 2645   |

+-----+------------+--------+

### [](#solution-17)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT t1.Id AS Id, t1.Company, t1.Salary

FROM Employee AS t1 JOIN Employee AS t2

ON t1.Company \= t2.Company

GROUP BY t1.Id

HAVING abs(sum(CASE WHEN t2.Salary<t1.Salary THEN 1

                  WHEN t2.Salary\>t1.Salary THEN \-1

                  WHEN t2.Salary\=t1.Salary AND t2.Id<t1.Id THEN 1

                  WHEN t2.Salary\=t1.Salary AND t2.Id\>t1.Id THEN \-1

                  ELSE 0 END)) <= 1

ORDER BY t1.Company, t1.Salary, t1.Id

[](#570-managers-with-at-least-5-direct-reports--medium---leetcode)570\. Managers with at Least 5 Direct Reports | Medium | 🔒 [LeetCode](https://leetcode.com/problems/managers-with-at-least-5-direct-reports/)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

The `Employee` table holds all employees including their managers. Every employee has an Id, and there is also a column for the manager Id.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+------+----------+-----------+----------+

|Id    |Name 	    |Department |ManagerId |

+------+----------+-----------+----------+

|101   |John 	    |A 	        |null      |

|102   |Dan 	    |A 	        |101       |

|103   |James 	  |A 	        |101       |

|104   |Amy 	    |A 	        |101       |

|105   |Anne 	    |A 	        |101       |

|106   |Ron 	    |B 	        |101       |

+------+----------+-----------+----------+

Given the `Employee` table, write a SQL query that finds out managers with at least 5 direct report. For the above table, your SQL query should return:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------+

| Name  |

+-------+

| John  |

+-------+

Note: No one would report to himself.

### [](#solution-18)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT Name

FROM Employee

WHERE id IN

   (SELECT ManagerId

    FROM Employee

    GROUP BY ManagerId

    HAVING COUNT(DISTINCT Id) \>= 5)

[](#571-find-median-given-frequency-of-numbers---leetcode)571\. Find Median Given Frequency of Numbers | 🔒 [LeetCode](https://leetcode.com/problems/find-median-given-frequency-of-numbers/)
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

The `Numbers` table keeps the value of number and its frequency.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----------+-------------+

|  Number  |  Frequency  |

+----------+-------------|

|  0       |  7          |

|  1       |  1          |

|  2       |  3          |

|  3       |  1          |

+----------+-------------+

In this table, the numbers are 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 3, so the median is (0 + 0) / 2 = 0.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------+

| median |

+--------|

| 0.0000 |

+--------+

Write a query to find the median of all numbers and name the result as median.

### [](#solution-19)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT avg(t3.Number) as median

FROM Numbers as t3

JOIN

    (SELECT t1.Number,

        abs(SUM(CASE WHEN t1.Number\>t2.Number THEN t2.Frequency ELSE 0 END) \-

            SUM(CASE WHEN t1.Number<t2.Number THEN t2.Frequency ELSE 0 END)) AS count\_diff

    FROM numbers AS t1, numbers AS t2

    GROUP BY t1.Number) AS t4

ON t3.Number \= t4.Number

WHERE t3.Frequency\>=t4.count\_diff

[](#574-winning-candidate--medium---leetcode)574\. Winning Candidate | Medium | 🔒 [LeetCode](https://leetcode.com/problems/winning-candidate/)
-----------------------------------------------------------------------------------------------------------------------------------------------

Table: `Candidate`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-----+---------+

| id  | Name    |

+-----+---------+

| 1   | A       |

| 2   | B       |

| 3   | C       |

| 4   | D       |

| 5   | E       |

+-----+---------+

Table: `Vote`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-----+--------------+

| id  | CandidateId  |

+-----+--------------+

| 1   |     2        |

| 2   |     4        |

| 3   |     3        |

| 4   |     2        |

| 5   |     5        |

+-----+--------------+

`id` is the auto-increment primary key, `CandidateId` is the id appeared in Candidate table. Write a sql to find the name of the winning candidate, the above example will return the winner B.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+------+

| Name |

+------+

| B    |

+------+

Notes: You may assume there is no tie, in other words there will be at most one winning candidate.

### [](#solution-20)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT Name

FROM Candidate

WHERE id \= (SELECT CandidateId

     FROM Vote

     GROUP BY CandidateId

     ORDER BY COUNT(1) desc

     LIMIT 1)

\## Assumption: if we have two candidates with the same votes, we choose the one who get the first vote

\# SELECT Name

\# FROM Candidate JOIN

\#     (SELECT CandidateId

\#     FROM Vote

\#     GROUP BY CandidateId

\#     ORDER BY count(1) DESC

\#     LIMIT 1) AS t

\# ON Candidate.id = t.CandidateId

[](#577-employee-bonus--easy---leetcode)577\. Employee Bonus | Easy | 🔒 [LeetCode](https://leetcode.com/problems/employee-bonus/https://leetcode.com/problems/employee-bonus/)
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Select all employee’s name and bonus whose bonus is < 1000.

Table:Employee

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------+--------+-----------+--------+

| empId |  name  | supervisor| salary |

+-------+--------+-----------+--------+

|   1   | John   |  3        | 1000   |

|   2   | Dan    |  3        | 2000   |

|   3   | Brad   |  null     | 4000   |

|   4   | Thomas |  3        | 4000   |

+-------+--------+-----------+--------+

empId is the primary key column for this table.

Table: Bonus

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------+-------+

| empId | bonus |

+-------+-------+

| 2     | 500   |

| 4     | 2000  |

+-------+-------+

empId is the primary key column for this table.

Example ouput:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------+-------+

| name  | bonus |

+-------+-------+

| John  | null  |

| Dan   | 500   |

| Brad  | null  |

+-------+-------+

### [](#solution-21)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT name, bonus

FROM Employee LEFT JOIN Bonus

ON Employee.empId \= Bonus.empId

WHERE bonus<1000 OR bonus IS NULL;

[](#578-get-highest-answer-rate-question--medium---leetcode)578\. Get Highest Answer Rate Question | Medium | 🔒 [LeetCode](https://leetcode.com/problems/get-highest-answer-rate-question/)
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Get the highest answer rate question from a table survey\_log with these columns: uid, action, question\_id, answer\_id, q\_num, timestamp.

uid means user id; action has these kind of values: “show”, “answer”, “skip”; answer\_id is not null when action column is “answer”, while is null for “show” and “skip”; q\_num is the numeral order of the question in current session.

Write a sql query to identify the question which has the highest answer rate.

Example: Input:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+------+-----------+--------------+------------+-----------+------------+

| uid  | action    | question\_id  | answer\_id  | q\_num     | timestamp  |

+------+-----------+--------------+------------+-----------+------------+

| 5    | show      | 285          | null       | 1         | 123        |

| 5    | answer    | 285          | 124124     | 1         | 124        |

| 5    | show      | 369          | null       | 2         | 125        |

| 5    | skip      | 369          | null       | 2         | 126        |

+------+-----------+--------------+------------+-----------+------------+

Output:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+

| survey\_log  |

+-------------+

|    285      |

+-------------+

Explanation: question 285 has answer rate 1/1, while question 369 has 0/1 answer rate, so output 285.

Note: The highest answer rate meaning is: answer number’s ratio in show number in the same question.

### [](#solution-22)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution- 1::

SELECT question\_id AS survey\_log FROM

(SELECT question\_id,

        SUM(IF(action\='show', 1, 0)) AS num\_show,

        SUM(IF(action\='answer', 1, 0)) AS num\_answer

 FROM survey\_log GROUP BY question\_id) AS t

ORDER BY (num\_answer/num\_show) DESC LIMIT 1;

#Solution- 2:

SELECT question\_id AS survey\_log

FROM (SELECT question\_id,

      sum(CASE WHEN  action\='show' THEN 1 ELSE 0 END) AS show\_count,

      sum(CASE WHEN  action\='answer' THEN 1 ELSE 0 END) AS answer\_count

    FROM survey\_log

    GROUP BY question\_id) AS t

ORDER BY answer\_count/show\_count DESC LIMIT 1;

[](#579-find-cumulative-salary-of-an-employee--hard---leetcode)579\. Find Cumulative Salary of an Employee | Hard | 🔒 [LeetCode](https://leetcode.com/problems/find-cumulative-salary-of-an-employee/)
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

The `Employee` table holds the salary information in a year.

Write a SQL to get the cumulative sum of an employee’s salary over a period of 3 months but exclude the most recent month.

The result should be displayed by ‘Id’ ascending, and then by ‘Month’ descending.

Example Input

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| Id | Month | Salary |

|----|-------|--------|

| 1  | 1     | 20     |

| 2  | 1     | 20     |

| 1  | 2     | 30     |

| 2  | 2     | 30     |

| 3  | 2     | 40     |

| 1  | 3     | 40     |

| 3  | 3     | 60     |

| 1  | 4     | 60     |

| 3  | 4     | 70     |

Output

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| Id | Month | Salary |

|----|-------|--------|

| 1  | 3     | 90     |

| 1  | 2     | 50     |

| 1  | 1     | 20     |

| 2  | 1     | 20     |

| 3  | 3     | 100    |

| 3  | 2     | 40     |

Explanation Employee ‘1’ has 3 salary records for the following 3 months except the most recent month ‘4’: salary 40 for month ‘3’, 30 for month ‘2’ and 20 for month ‘1’ So the cumulative sum of salary of this employee over 3 months is 90(40+30+20), 50(30+20) and 20 respectively.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| Id | Month | Salary |

|----|-------|--------|

| 1  | 3     | 90     |

| 1  | 2     | 50     |

| 1  | 1     | 20     |

Employee ‘2’ only has one salary record (month ‘1’) except its most recent month ‘2’.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| Id | Month | Salary |

|----|-------|--------|

| 2  | 1     | 20     |

Employ ‘3’ has two salary records except its most recent pay month ‘4’: month ‘3’ with 60 and month ‘2’ with 40. So the cumulative salary is as following.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| Id | Month | Salary |

|----|-------|--------|

| 3  | 3     | 100    |

| 3  | 2     | 40     |

### [](#solution-23)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT

    a.id,

    a.month,

    SUM(b.salary) Salary

FROM

    Employee a JOIN Employee b ON

    a.id \= b.id AND

    a.month \- b.month \>= 0 AND

    a.month \- b.month < 3

GROUP BY

    a.id, a.month

HAVING

    (a.id, a.month) NOT IN (SELECT id, MAX(month) FROM Employee GROUP BY id)

ORDER BY

    a.id, a.month DESC

[](#580-count-student-number-in-departments--medium---leetcode)580\. Count Student Number in Departments | Medium | 🔒 [LeetCode](https://leetcode.com/problems/count-student-number-in-departments/)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

A university uses 2 data tables, `student` and `department`, to store data about its students and the departments associated with each major.

Write a query to print the respective department name and number of students majoring in each department for all departments in the department table (even ones with no current students).

Sort your results by descending number of students; if two or more departments have the same number of students, then sort those departments alphabetically by department name.

The `student` is described as follow:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| Column Name  | Type      |

|--------------|-----------|

| student\_id   | Integer   |

| student\_name | String    |

| gender       | Character |

| dept\_id      | Integer   |

where student\_id is the student’s ID number, student\_name is the student’s name, gender is their gender, and dept\_id is the department ID associated with their declared major.

And the department table is described as below:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| Column Name | Type    |

|-------------|---------|

| dept\_id     | Integer |

| dept\_name   | String  |

where dept\_id is the department’s ID number and dept\_name is the department name.

Here is an example input: `student` table:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| student\_id | student\_name | gender | dept\_id |

|------------|--------------|--------|---------|

| 1          | Jack         | M      | 1       |

| 2          | Jane         | F      | 1       |

| 3          | Mark         | M      | 2       |

`department` table:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| dept\_id | dept\_name   |

|---------|-------------|

| 1       | Engineering |

| 2       | Science     |

| 3       | Law         |

The Output should be:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| dept\_name   | student\_number |

|-------------|----------------|

| Engineering | 2              |

| Science     | 1              |

| Law         | 0              |

### [](#solution-24)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT dept\_name,

  SUM(CASE WHEN student\_id IS NULL THEN 0 ELSE 1 END) AS student\_number

FROM department

LEFT JOIN student

ON department.dept\_id \= student.dept\_id

GROUP BY department.dept\_id

ORDER BY student\_number DESC, dept\_name

[](#584-find-customer-referee--easy---leetcode)584\. Find Customer Referee | Easy | 🔒 [LeetCode](https://leetcode.com/problems/find-customer-referee/)
-------------------------------------------------------------------------------------------------------------------------------------------------------

Given a table `customer` holding customers information and the referee.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+------+------+-----------+

| id   | name | referee\_id|

+------+------+-----------+

|    1 | Will |      NULL |

|    2 | Jane |      NULL |

|    3 | Alex |         2 |

|    4 | Bill |      NULL |

|    5 | Zack |         1 |

|    6 | Mark |         2 |

+------+------+-----------+

Write a query to return the list of customers NOT referred by the person with id ‘2’.

For the sample data above, the result is:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+------+

| name |

+------+

| Will |

| Jane |

| Bill |

| Zack |

+------+

### [](#solution-25)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT name

FROM customer

WHERE referee\_id != '2' OR referee\_id IS NULL;

[](#585-investments-in-2016--medium---leetcode)585\. Investments in 2016 | Medium | 🔒 [LeetCode](https://leetcode.com/problems/investments-in-2016/)
-----------------------------------------------------------------------------------------------------------------------------------------------------

Write a query to print the sum of all total investment values in 2016 (TIV\_2016), to a scale of 2 decimal places, for all policy holders who meet the following criteria:

1.  Have the same TIV\_2015 value as one or more other policyholders.
2.  Are not located in the same city as any other policyholder (i.e.: the (latitude, longitude) attribute pairs must be unique). Input Format: The insurance table is described as follows:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| Column Name | Type          |

|-------------|---------------|

| PID         | INTEGER(11)   |

| TIV\_2015    | NUMERIC(15,2) |

| TIV\_2016    | NUMERIC(15,2) |

| LAT         | NUMERIC(5,2)  |

| LON         | NUMERIC(5,2)  |

where PID is the policyholder’s policy ID, TIV\_2015 is the total investment value in 2015, TIV\_2016 is the total investment value in 2016, LAT is the latitude of the policy holder’s city, and LON is the longitude of the policy holder’s city.

Sample Input

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| PID | TIV\_2015 | TIV\_2016 | LAT | LON |

|-----|----------|----------|-----|-----|

| 1   | 10       | 5        | 10  | 10  |

| 2   | 20       | 20       | 20  | 20  |

| 3   | 10       | 30       | 20  | 20  |

| 4   | 10       | 40       | 40  | 40  |

Sample Output

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| TIV\_2016 |

|----------|

| 45.00    |

Explanation

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

The first record in the table, like the last record, meets both of the two criteria.

The TIV\_2015 value '10' is as the same as the third and forth record, and its location unique.

The second record does not meet any of the two criteria. Its TIV\_2015 is not like any other policyholders.

And its location is the same with the third record, which makes the third record fail, too.

So, the result is the sum of TIV\_2016 of the first and last record, which is 45.

### [](#solution-26)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT SUM(TIV\_2016) AS TIV\_2016

FROM insurance

WHERE CONCAT(LAT, ',', LON)

    IN (SELECT CONCAT(LAT, ',', LON)

       FROM insurance

       GROUP BY LAT, LON

       HAVING COUNT(1) \= 1)

AND TIV\_2015 in

    (SELECT TIV\_2015

    FROM insurance

    GROUP BY TIV\_2015

    HAVING COUNT(1)\>1)

[](#586-customer-placing-the-largest-number-of-orders--easy---leetcode)586\. Customer Placing the Largest Number of Orders | Easy | 🔒 [LeetCode](https://leetcode.com/problems/customer-placing-the-largest-number-of-orders/)
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Query the customer\_number from the orders table for the customer who has placed the largest number of orders.

It is guaranteed that exactly one customer will have placed more orders than any other customer.

The orders table is defined as follows:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| Column            | Type      |

|-------------------|-----------|

| order\_number (PK) | int       |

| customer\_number   | int       |

| order\_date        | date      |

| required\_date     | date      |

| shipped\_date      | date      |

| status            | char(15)  |

| comment           | char(200) |

Sample Input

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| order\_number | customer\_number | order\_date | required\_date | shipped\_date | status | comment |

|--------------|-----------------|------------|---------------|--------------|--------|---------|

| 1            | 1               | 2017-04-09 | 2017-04-13    | 2017-04-12   | Closed |         |

| 2            | 2               | 2017-04-15 | 2017-04-20    | 2017-04-18   | Closed |         |

| 3            | 3               | 2017-04-16 | 2017-04-25    | 2017-04-20   | Closed |         |

| 4            | 3               | 2017-04-18 | 2017-04-28    | 2017-04-25   | Closed |         |

Sample Output

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| customer\_number |

|-----------------|

| 3               |

Explanation

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

The customer with number '3' has two orders, which is greater than either customer '1' or '2' because each of them  only has one order.

So the result is customer\_number '3'.

### [](#solution-27)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

\# assume: only one match

SELECT customer\_number FROM orders

GROUP BY customer\_number

ORDER BY COUNT(1) DESC

LIMIT 1

\## assume: multiple matches

\##  1 1

\##  2 1

\##  3 1

##

\##  1 1 1 1

\##  1 1 2 1

\##  1 1 3 1

##

\##  SELECT t1.customer\_number

\##  FROM (SELECT customer\_number, COUNT(1) AS count

\##        FROM orders GROUP BY customer\_number) AS t1,

\##        (SELECT customer\_number, COUNT(1) AS count

\##        FROM orders GROUP BY customer\_number) AS t2

\##  GROUP BY t1.customer\_number

\##  HAVING max(t1.count) = max(t2.count)

[](#595-big-countries--easy--leetcode)595\. Big Countries | Easy | [LeetCode](https://leetcode.com/problems/big-countries/)
---------------------------------------------------------------------------------------------------------------------------

There is a table `World`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-----------------+------------+------------+--------------+---------------+

| name            | continent  | area       | population   | gdp           |

+-----------------+------------+------------+--------------+---------------+

| Afghanistan     | Asia       | 652230     | 25500100     | 20343000      |

| Albania         | Europe     | 28748      | 2831741      | 12960000      |

| Algeria         | Africa     | 2381741    | 37100000     | 188681000     |

| Andorra         | Europe     | 468        | 78115        | 3712000       |

| Angola          | Africa     | 1246700    | 20609294     | 100990000     |

+-----------------+------------+------------+--------------+---------------+

A country is big if it has an area of bigger than 3 million square km or a population of more than 25 million.

Write a SQL solution to output big countries' name, population and area.

For example, according to the above table, we should output:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+-------------+--------------+

| name         | population  | area         |

+--------------+-------------+--------------+

| Afghanistan  | 25500100    | 652230       |

| Algeria      | 37100000    | 2381741      |

+--------------+-------------+--------------+

### [](#solution-28)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT name, population, area

FROM World

WHERE area \>= 3000000 OR population \> 25000000;

[](#596-classes-more-than-5-students--easy--leetcode)596\. Classes More Than 5 Students | Easy | [LeetCode](https://leetcode.com/problems/classes-more-than-5-students/)
------------------------------------------------------------------------------------------------------------------------------------------------------------------------

There is a table `courses` with columns: **student** and **class**

Please list out all classes which have more than or equal to 5 students.

For example, the table:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------+------------+

| student | class      |

+---------+------------+

| A       | Math       |

| B       | English    |

| C       | Math       |

| D       | Biology    |

| E       | Math       |

| F       | Computer   |

| G       | Math       |

| H       | Math       |

| I       | Math       |

+---------+------------+

Should output:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------+

| class   |

+---------+

| Math    |

+---------+

### [](#solution-29)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT class

FROM courses

GROUP BY class

HAVING count(DISTINCT Student)\>=5;

[](#597-friend-requests-i-overall-acceptance-rate--easy---leetcode)597\. Friend Requests I: Overall Acceptance Rate | Easy | 🔒 [LeetCode](https://leetcode.com/problems/friend-requests-i-overall-acceptance-rate/)
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

In social network like Facebook or Twitter, people send friend requests and accept others’ requests as well. Now given two tables as below: Table: `friend_request`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| sender\_id | send\_to\_id |request\_date|

|-----------|------------|------------|

| 1         | 2          | 2016\_06-01 |

| 1         | 3          | 2016\_06-01 |

| 1         | 4          | 2016\_06-01 |

| 2         | 3          | 2016\_06-02 |

| 3         | 4          | 2016-06-09 |

Table: `request_accepted`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| requester\_id | accepter\_id |accept\_date |

|--------------|-------------|------------|

| 1            | 2           | 2016\_06-03 |

| 1            | 3           | 2016-06-08 |

| 2            | 3           | 2016-06-08 |

| 3            | 4           | 2016-06-09 |

| 3            | 4           | 2016-06-10 |

Write a query to find the overall acceptance rate of requests rounded to 2 decimals, which is the number of acceptance divide the number of requests. For the sample data above, your query should return the following result.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

|accept\_rate|

|-----------|

|       0.80|

Note:

The accepted requests are not necessarily from the table friend\_request. In this case, you just need to simply count the total accepted requests (no matter whether they are in the original requests), and divide it by the number of requests to get the acceptance rate. It is possible that a sender sends multiple requests to the same receiver, and a request could be accepted more than once. In this case, the ‘duplicated’ requests or acceptances are only counted once. If there is no requests at all, you should return 0.00 as the accept\_rate. Explanation: There are 4 unique accepted requests, and there are 5 requests in total. So the rate is 0.80.

Follow-up:

Can you write a query to return the accept rate but for every month? How about the cumulative accept rate for every day?

### [](#solution-30)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT IFNULL((round(accepts/requests, 2)), 0.0) AS accept\_rate

FROM

    (SELECT count(DISTINCT sender\_id, send\_to\_id) AS requests FROM friend\_request) AS t1,

    (SELECT count(DISTINCT requester\_id, accepter\_id) AS accepts FROM request\_accepted) AS t2

[](#601-human-traffic-of-stadium--hard--leetcode)601\. Human Traffic of Stadium | Hard | [LeetCode](https://leetcode.com/problems/human-traffic-of-stadium/)
------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Stadium`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| id            | int     |

| visit\_date    | date    |

| people        | int     |

+---------------+---------+

visit\_date is the primary key for this table. Each row of this table contains the visit date and visit id to the stadium with the number of people during the visit. No two rows will have the same visit\_date, and as the id increases, the dates increase as well.

Write an SQL query to display the records with three or more rows with **consecutive** `id`'s, and the number of people is greater than or equal to 100 for each.

Return the result table ordered by `visit_date` in **ascending order**.

The query result format is in the following example.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Stadium table:

+------+------------+-----------+

| id   | visit\_date | people    |

+------+------------+-----------+

| 1    | 2017-01-01 | 10        |

| 2    | 2017-01-02 | 109       |

| 3    | 2017-01-03 | 150       |

| 4    | 2017-01-04 | 99        |

| 5    | 2017-01-05 | 145       |

| 6    | 2017-01-06 | 1455      |

| 7    | 2017-01-07 | 199       |

| 8    | 2017-01-09 | 188       |

+------+------------+-----------+

Result table:

+------+------------+-----------+

| id   | visit\_date | people    |

+------+------------+-----------+

| 5    | 2017-01-05 | 145       |

| 6    | 2017-01-06 | 1455      |

| 7    | 2017-01-07 | 199       |

| 8    | 2017-01-09 | 188       |

+------+------------+-----------+

The four rows with ids 5, 6, 7, and 8 have consecutive ids and each of them has >= 100 people attended. Note that row 8 was included even though the visit\_date was not the next day after row 7.

The rows with ids 2 and 3 are not included because we need at least three consecutive ids.

### [](#solution-31)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT DISTINCT s1.\*

FROM Stadium s1 JOIN Stadium s2 JOIN Stadium s3

ON (s1.id \= s2.id\-1 AND s1.id \= s3.id\-2) OR

 (s1.id \= s2.id+1 AND s1.id \= s3.id\-1) OR

 (s1.id \= s2.id+1 AND s1.id \= s3.id+2)

    WHERE s1.people \>= 100 AND s2.people \>= 100 AND s3.people\>=100

  ORDER BY visit\_date

[](#602-friend-requests-ii-who-has-the-most-friends--medium---leetcode)602\. Friend Requests II: Who Has the Most Friends | Medium | 🔒 [LeetCode](https://leetcode.com/problems/friend-requests-ii-who-has-the-most-friends/)
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

In social network like Facebook or Twitter, people send friend requests and accept others’ requests as well. Table `request_accepted` holds the data of friend acceptance, while requester\_id and accepter\_id both are the id of a person.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| requester\_id | accepter\_id | accept\_date|

|--------------|-------------|------------|

| 1            | 2           | 2016\_06-03 |

| 1            | 3           | 2016-06-08 |

| 2            | 3           | 2016-06-08 |

| 3            | 4           | 2016-06-09 |

Write a query to find the the people who has most friends and the most friends number. For the sample data above, the result is:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| id | num |

|----|-----|

| 3  | 3   |

Note:

It is guaranteed there is only 1 people having the most friends. The friend request could only been accepted once, which mean there is no multiple records with the same requester\_id and accepter\_id value. Explanation: The person with id ‘3’ is a friend of people ‘1’, ‘2’ and ‘4’, so he has 3 friends in total, which is the most number than any others.

Follow-up: In the real world, multiple people could have the same most number of friends, can you find all these people in this case?

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT t.id, sum(t.num) AS num

FROM (

      (SELECT requester\_id AS id, COUNT(1) AS num

       FROM request\_accepted

       GROUP BY requester\_id)

      union all

       (SELECT accepter\_id AS id, COUNT(1) AS num

        FROM request\_accepted

        GROUP BY accepter\_id)) AS t

GROUP BY t.id

ORDER BY num DESC

LIMIT 1;

[](#603-consecutive-available-seats--easy---leetcode)603\. Consecutive Available Seats | Easy | 🔒 [LeetCode](https://leetcode.com/problems/consecutive-available-seats/)
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Several friends at a cinema ticket office would like to reserve consecutive available seats. Can you help to query all the consecutive available seats order by the seat\_id using the following cinema table?

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| seat\_id | free |

|---------|------|

| 1       | 1    |

| 2       | 0    |

| 3       | 1    |

| 4       | 1    |

| 5       | 1    |

Your query should return the following result for the sample case above.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| seat\_id |

|---------|

| 3       |

| 4       |

| 5       |

Note:

The seat\_id is an auto increment int, and free is bool (‘1’ means free, and ‘0’ means occupied.). Consecutive available seats are more than 2(inclusive) seats consecutively available.

### [](#solution-32)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT DISTINCT t1.seat\_id

FROM cinema AS t1 JOIN cinema AS t2

ON abs(t1.seat\_id\-t2.seat\_id)\=1

WHERE t1.free\='1' AND t2.free\='1'

ORDER BY t1.seat\_id

[](#607sales-person--easy---leetcode)607.Sales Person | Easy | 🔒 [LeetCode](https://leetcode.com/problems/sales-person/)
-------------------------------------------------------------------------------------------------------------------------

Description

Given three tables: `salesperson`, `company`, `orders`. Output all the names in the table salesperson, who didn’t have sales to company ‘RED’.

Example Input

Table: `salesperson`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----------+------+--------+-----------------+-----------+

| sales\_id | name | salary | commission\_rate | hire\_date |

+----------+------+--------+-----------------+-----------+

|   1      | John | 100000 |     6           | 4/1/2006  |

|   2      | Amy  | 120000 |     5           | 5/1/2010  |

|   3      | Mark | 65000  |     12          | 12/25/2008|

|   4      | Pam  | 25000  |     25          | 1/1/2005  |

|   5      | Alex | 50000  |     10          | 2/3/2007  |

+----------+------+--------+-----------------+-----------+

The table salesperson holds the salesperson information. Every salesperson has a sales\_id and a name. Table: `company`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------+--------+------------+

| com\_id  |  name  |    city    |

+---------+--------+------------+

|   1     |  RED   |   Boston   |

|   2     | ORANGE |   New York |

|   3     | YELLOW |   Boston   |

|   4     | GREEN  |   Austin   |

+---------+--------+------------+

The table company holds the company information. Every company has a com\_id and a name. Table: `orders`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----------+----------+---------+----------+--------+

| order\_id |  date    | com\_id  | sales\_id | amount |

+----------+----------+---------+----------+--------+

| 1        | 1/1/2014 |    3    |    4     | 100000 |

| 2        | 2/1/2014 |    4    |    5     | 5000   |

| 3        | 3/1/2014 |    1    |    1     | 50000  |

| 4        | 4/1/2014 |    1    |    4     | 25000  |

+----------+----------+---------+----------+--------+

The table orders holds the sales record information, salesperson and customer company are represented by sales\_id and com\_id. output

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+------+

| name |

+------+

| Amy  |

| Mark |

| Alex |

+------+

Explanation

According to order ‘3’ and ‘4’ in table orders, it is easy to tell only salesperson ‘John’ and ‘Alex’ have sales to company ‘RED’, so we need to output all the other names in table salesperson.

### [](#solution-33)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT name

FROM salesperson

WHERE name NOT IN

    (SELECT DISTINCT salesperson.name

    FROM salesperson, orders, company

    WHERE company.name \= 'RED'

    AND salesperson.sales\_id \= orders.sales\_id

    AND orders.com\_id \= company.com\_id)

[](#608-tree-node--medium---leetcode)608\. Tree Node | Medium | 🔒 [LeetCode](https://leetcode.com/problems/tree-node/)
-----------------------------------------------------------------------------------------------------------------------

Given a table tree, id is identifier of the tree node and p\_id is its parent node’s id.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----+------+

| id | p\_id |

+----+------+

| 1  | null |

| 2  | 1    |

| 3  | 1    |

| 4  | 2    |

| 5  | 2    |

+----+------+

Each node in the tree can be one of three types:

Leaf: if the node is a leaf node. Root: if the node is the root of the tree. Inner: If the node is neither a leaf node nor a root node. Write a query to print the node id and the type of the node. Sort your output by the node id. The result for the above sample is:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----+------+

| id | Type |

+----+------+

| 1  | Root |

| 2  | Inner|

| 3  | Leaf |

| 4  | Leaf |

| 5  | Leaf |

+----+------+

Explanation

Node ‘1’ is root node, because its parent node is NULL and it has child node ‘2’ and ‘3’. Node ‘2’ is inner node, because it has parent node ‘1’ and child node ‘4’ and ‘5’. Node ‘3’, ‘4’ and ‘5’ is Leaf node, because they have parent node and they don’t have child node. And here is the image of the sample tree as below:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

1

      /   \\

    2       3

  /   \\

4       5

Note

If there is only one node on the tree, you only need to output its root attributes.

### [](#solution-34)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

\## Basic Ideas: LEFT JOIN

\# In tree, each node can only one parent or no parent

\## | id | p\_id | id (child) |

\## |----+------+------------|

\## |  1 | null |          1 |

\## |  1 | null |          2 |

\## |  2 |    1 |          4 |

\## |  2 |    1 |          5 |

\## |  3 |    1 |       null |

\## |  4 |    2 |       null |

\## |  5 |    2 |       null |

SELECT t1.id,

    CASE

        WHEN ISNULL(t1.p\_id) THEN 'Root'

        WHEN ISNULL(MAX(t2.id)) THEN 'Leaf'

        ELSE 'Inner'

    END AS Type

FROM tree AS t1 LEFT JOIN tree AS t2

ON t1.id \= t2.p\_id

GROUP BY t1.id, t1.p\_id

[](#610-triangle-judgement--easy---leetcode)610\. Triangle Judgement | Easy | 🔒 [LeetCode](https://leetcode.com/problems/triangle-judgement/)
----------------------------------------------------------------------------------------------------------------------------------------------

A pupil Tim gets homework to identify whether three line segments could possibly form a triangle. However, this assignment is very heavy because there are hundreds of records to calculate. Could you help Tim by writing a query to judge whether these three sides can form a triangle, assuming table triangle holds the length of the three sides x, y and z.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| x  | y  | z  |

|----|----|----|

| 13 | 15 | 30 |

| 10 | 20 | 15 |

For the sample data above, your query should return the follow result:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| x  | y  | z  | triangle |

|----|----|----|----------|

| 13 | 15 | 30 | No       |

| 10 | 20 | 15 | Yes      |

### [](#solution-35)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT x, y, z,

       CASE

           WHEN x+y\>z AND y+z\>x AND x+z\>y THEN 'Yes'

           ELSE 'No'

       END AS triangle

FROM triangle

[](#612-shortest-distance-in-a-plane--medium---leetcode)612\. Shortest Distance in a Plane | Medium | 🔒 [LeetCode](https://leetcode.com/problems/shortest-distance-in-a-plane/)
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table point\_2d holds the coordinates (x,y) of some unique points (more than two) in a plane. Write a query to find the shortest distance between these points rounded to 2 decimals.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| x  | y  |

|----|----|

| -1 | -1 |

| 0  | 0  |

| -1 | -2 |

The shortest distance is 1.00 from point (-1,-1) to (-1,2). So the output should be:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| shortest |

|----------|

| 1.00     |

Note: The longest distance among all the points are less than 10000.

### [](#solution-36)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT ROUND(MIN(SQRT((t1.x\-t2.x)\*(t1.x\-t2.x) + (t1.y\-t2.y)\*(t1.y\-t2.y))), 2) as shortest

FROM point\_2d AS t1, point\_2d AS t2

WHERE t1.x!=t2.x OR t1.y!=t2.y

\# SELECT ROUND(SQRT((t1.x-t2.x)\*(t1.x-t2.x) + (t1.y-t2.y)\*(t1.y-t2.y)), 2) AS shortest

\# FROM point\_2d AS t1, point\_2d AS t2

\# WHERE t1.x!=t2.x OR t1.y!=t2.y

\# ORDER BY shortest ASC

\# LIMIT 1

[](#613-shortest-distance-in-a-line--easy---leetcode)613\. Shortest Distance in a Line | Easy | 🔒 [LeetCode](https://leetcode.com/problems/shortest-distance-in-a-line/)
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table point holds the x coordinate of some points on x-axis in a plane, which are all integers. Write a query to find the shortest distance between two points in these points.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| x   |

|-----|

| -1  |

| 0   |

| 2   |

The shortest distance is ‘1’ obviously, which is from point ‘-1’ to ‘0’. So the output is as below:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| shortest|

|---------|

| 1       |

Note: Every point is unique, which means there is no duplicates in table point.

Follow-up: What if all these points have an id and are arranged from the left most to the right most of x axis?

### [](#solution-37)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT t1.x\-t2.x AS shortest

FROM point AS t1 JOIN point AS t2

WHERE t1.x\>t2.x

ORDER BY (t1.x\-t2.x) ASC

LIMIT 1

[](#614-second-degree-follower--medium---leetcode)614\. Second Degree Follower | Medium | 🔒 [LeetCode](https://leetcode.com/problems/second-degree-follower/)
--------------------------------------------------------------------------------------------------------------------------------------------------------------

In facebook, there is a follow table with two columns: followee, follower.

Please write a sql query to get the amount of each follower’s follower if he/she has one.

For example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+------------+

| followee    | follower   |

+-------------+------------+

|     A       |     B      |

|     B       |     C      |

|     B       |     D      |

|     D       |     E      |

+-------------+------------+

should output:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+------------+

| follower    | num        |

+-------------+------------+

|     B       |  2         |

|     D       |  1         |

+-------------+------------+

Explanation: Both B and D exist in the follower list, when as a followee, B’s follower is C and D, and D’s follower is E. A does not exist in follower list.

Note: Followee would not follow himself/herself in all cases. Please display the result in follower’s alphabet order.

### [](#solution-38)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

\## Explain the business logic

\##   A follows B. Then A is follwer, B is followee

\## What are second degree followers?

\##   A follows B, and B follows C.

\##   Then A is the second degree followers of C

SELECT f1.follower, COUNT(DISTINCT f2.follower) AS num

FROM follow AS f1 JOIN follow AS f2

ON f1.follower \= f2.followee

GROUP BY f1.follower;

[](#615-average-salary-departments-vs-company--hard---leetcode)615\. Average Salary: Departments VS Company | Hard | 🔒 [LeetCode](https://leetcode.com/problems/average-salary-departments-vs-company)
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Given two tables as below, write a query to display the comparison result (higher/lower/same) of the average salary of employees in a department to the company’s average salary. Table: salary

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| id | employee\_id | amount | pay\_date   |

|----|-------------|--------|------------|

| 1  | 1           | 9000   | 2017-03-31 |

| 2  | 2           | 6000   | 2017-03-31 |

| 3  | 3           | 10000  | 2017-03-31 |

| 4  | 1           | 7000   | 2017-02-28 |

| 5  | 2           | 6000   | 2017-02-28 |

| 6  | 3           | 8000   | 2017-02-28 |

The employee\_id column refers to the employee\_id in the following table employee.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| employee\_id | department\_id |

|-------------|---------------|

| 1           | 1             |

| 2           | 2             |

| 3           | 2             |

So for the sample data above, the result is:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| pay\_month | department\_id | comparison  |

|-----------|---------------|-------------|

| 2017-03   | 1             | higher      |

| 2017-03   | 2             | lower       |

| 2017-02   | 1             | same        |

| 2017-02   | 2             | same        |

Explanation In March, the company’s average salary is (9000+6000+10000)/3 = 8333.33… The average salary for department ‘1’ is 9000, which is the salary of employee\_id ‘1’ since there is only one employee in this department. So the comparison result is ‘higher’ since 9000 > 8333.33 obviously. The average salary of department ‘2’ is (6000 + 10000)/2 = 8000, which is the average of employee\_id ‘2’ and ‘3’. So the comparison result is ‘lower’ since 8000 < 8333.33. With he same formula for the average salary comparison in February, the result is ‘same’ since both the department ‘1’ and ‘2’ have the same average salary with the company, which is 7000.

### [](#solution-39)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT t1.pay\_month, t1.department\_id,

    (CASE WHEN t1.amount \= t2.amount THEN 'same'

          WHEN t1.amount \> t2.amount THEN 'higher'

          WHEN t1.amount < t2.amount THEN 'lower' END) AS comparison

FROM

    (SELECT left(pay\_date, 7) AS pay\_month, department\_id, avg(amount) AS amount

    FROM salary JOIN employee

    ON salary.employee\_id \= employee.employee\_id

    GROUP BY pay\_month, department\_id

    ORDER BY pay\_month DESC, department\_id) AS t1

    JOIN

    (SELECT left(pay\_date, 7) AS pay\_month, avg(amount) AS amount

    FROM salary JOIN employee

    ON salary.employee\_id \= employee.employee\_id

    GROUP BY pay\_month) AS t2

    ON t1.pay\_month \= t2.pay\_month

[](#618-students-report-by-geography--hard---leetcode)618\. Students Report By Geography | Hard | 🔒 [LeetCode](https://leetcode.com/problems/students-report-by-geography)
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------

A U.S graduate school has students from Asia, Europe and America. The students’ location information are stored in table student as below.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| name   | continent |

|--------|-----------|

| Jack   | America   |

| Pascal | Europe    |

| Xi     | Asia      |

| Jane   | America   |

Pivot the continent column in this table so that each name is sorted alphabetically and displayed underneath its corresponding continent. The output headers should be America, Asia and Europe respectively. It is guaranteed that the student number from America is no less than either Asia or Europe. For the sample input, the output is:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

| America | Asia | Europe |

|---------|------|--------|

| Jack    | Xi   | Pascal |

| Jane    |      |        |

Follow-up: If it is unknown which continent has the most students, can you write a query to generate the student report?

### [](#solution-40)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT t1.name AS America, t2.name AS Asia, t3.name AS Europe

FROM

    (SELECT (@cnt1 :\= @cnt1 + 1) AS id, name

    FROM student

    CROSS JOIN (SELECT @cnt1 :\= 0) AS dummy

    WHERE continent\='America'

    ORDER BY name) AS t1

    LEFT JOIN

    (SELECT (@cnt2 :\= @cnt2 + 1) AS id, name

    FROM student

    CROSS JOIN (SELECT @cnt2 :\= 0) AS dummy

    WHERE continent\='Asia'

    ORDER BY name) AS t2

    ON t1.id \= t2.id

    LEFT JOIN

    (SELECT (@cnt3 :\= @cnt3 + 1) AS id, name

    FROM student

    CROSS JOIN (SELECT @cnt3 :\= 0) AS dummy

    WHERE continent\='Europe'

    ORDER BY name) AS t3

    ON t1.id \= t3.id

[](#619-biggest-single-number--easy---leetcode)619\. Biggest Single Number | Easy | 🔒 [LeetCode](https://leetcode.com/problems/biggest-single-number)
------------------------------------------------------------------------------------------------------------------------------------------------------

Table number contains many numbers in column num including duplicated ones. Can you write a SQL query to find the biggest number, which only appears once.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---+

|num|

+---+

| 8 |

| 8 |

| 3 |

| 3 |

| 1 |

| 4 |

| 5 |

| 6 |

For the sample data above, your query should return the following result:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---+

|num|

+---+

| 6 |

Note: If there is no such number, just output null.

### [](#solution-41)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT IFNULL((

    SELECT num

    FROM number

    GROUP BY num

    HAVING count(1) \= 1

    ORDER BY num DESC

    LIMIT 0, 1), NULL) AS num

[](#620-not-boring-movies--easy--leetcode)620\. Not Boring Movies | Easy | [LeetCode](https://leetcode.com/problems/not-boring-movies/)
---------------------------------------------------------------------------------------------------------------------------------------

X city opened a new cinema, many people would like to go to this cinema. The cinema also gives out a poster indicating the movies’ ratings and descriptions. Please write a SQL query to output movies with an odd numbered ID and a description that is not 'boring'. Order the result by rating.

For example, table `cinema`:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------+-----------+--------------+-----------+

|   id    | movie     |  description |  rating   |

+---------+-----------+--------------+-----------+

|   1     | War       |   great 3D   |   8.9     |

|   2     | Science   |   fiction    |   8.5     |

|   3     | irish     |   boring     |   6.2     |

|   4     | Ice song  |   Fantacy    |   8.6     |

|   5     | House card|   Interesting|   9.1     |

+---------+-----------+--------------+-----------+

For the example above, the output should be:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------+-----------+--------------+-----------+

|   id    | movie     |  description |  rating   |

+---------+-----------+--------------+-----------+

|   5     | House card|   Interesting|   9.1     |

|   1     | War       |   great 3D   |   8.9     |

+---------+-----------+--------------+-----------+

### [](#solution-42)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT \*

FROM Cinema

WHERE description <> 'boring' AND ID % 2 \= 1

ORDER BY rating DESC;

[](#626-exchange-seats--medium--leetcode)626\. Exchange Seats | Medium | [LeetCode](https://leetcode.com/problems/exchange-seats/)
----------------------------------------------------------------------------------------------------------------------------------

Mary is a teacher in a middle school and she has a table `seat` storing students' names and their corresponding seat ids.

The column id is continuous increment.

Mary wants to change seats for the adjacent students.

Can you write a SQL query to output the result for Mary?

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------+---------+

|    id   | student |

+---------+---------+

|    1    | Abbot   |

|    2    | Doris   |

|    3    | Emerson |

|    4    | Green   |

|    5    | Jeames  |

+---------+---------+

For the sample input, the output is:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------+---------+

|    id   | student |

+---------+---------+

|    1    | Doris   |

|    2    | Abbot   |

|    3    | Green   |

|    4    | Emerson |

|    5    | Jeames  |

+---------+---------+

**_Note:_**  
If the number of students is odd, there is no need to change the last one's seat.

### [](#solution-43)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT

IF(id<(SELECT MAX(id) FROM seat),IF(id%2\=0,id\-1, id+1),IF(id%2\=0, id\-1, id)) AS id, student

FROM seat

ORDER BY id;

[](#627-swap-salary--leetcode)627\. Swap Salary | [LeetCode](https://leetcode.com/problems/swap-salary/)
--------------------------------------------------------------------------------------------------------

Table: `Salary`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+----------+

| Column Name | Type     |

+-------------+----------+

| id          | int      |

| name        | varchar  |

| sex         | ENUM     |

| salary      | int      |

+-------------+----------+

id is the primary key for this table.

The sex column is ENUM value of type ('m', 'f').

The table contains information about an employee.

Write an SQL query to swap all `'f'` and `'m'` values (i.e., change all `'f'` values to `'m'` and vice versa) with a single update statement and no intermediate temp table(s).

Note that you must write a single update statement, DO NOT write any select statement for this problem.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Salary table:

+----+------+-----+--------+

| id | name | sex | salary |

+----+------+-----+--------+

| 1  | A    | m   | 2500   |

| 2  | B    | f   | 1500   |

| 3  | C    | m   | 5500   |

| 4  | D    | f   | 500    |

+----+------+-----+--------+

Result table:

+----+------+-----+--------+

| id | name | sex | salary |

+----+------+-----+--------+

| 1  | A    | f   | 2500   |

| 2  | B    | m   | 1500   |

| 3  | C    | f   | 5500   |

| 4  | D    | m   | 500    |

+----+------+-----+--------+

(1, A) and (2, C) were changed from 'm' to 'f'.

(2, B) and (4, D) were changed from 'f' to 'm'.

### [](#solution-44)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

\# With IF

UPDATE Salary SET sex \= IF(sex\='m', 'f', 'm')

\# With CASE

UPDATE Salary SET sex \= CASE WHEN sex\='m' THEN 'f' ELSE 'm' END

[](#1045-customers-who-bought-all-products--medium---leetcode)1045\. Customers Who Bought All Products | Medium | 🔒 [LeetCode](https://leetcode.com/problems/customers-who-bought-all-products)
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Customer`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| customer\_id | int     |

| product\_key | int     |

+-------------+---------+

product\_key is a foreign key to Product table. Table: `Product`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| product\_key | int     |

+-------------+---------+

product\_key is the primary key column for this table.

Write an SQL query for a report that provides the customer ids from the Customer table that bought all the products in the Product table.

For example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Customer table:

+-------------+-------------+

| customer\_id | product\_key |

+-------------+-------------+

| 1           | 5           |

| 2           | 6           |

| 3           | 5           |

| 3           | 6           |

| 1           | 6           |

+-------------+-------------+

Product table:

+-------------+

| product\_key |

+-------------+

| 5           |

| 6           |

+-------------+

Result table:

+-------------+

| customer\_id |

+-------------+

| 1           |

| 3           |

+-------------+

The customers who bought all the products (5 and 6) are customers with id 1 and 3.

### [](#solution-45)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT customer\_id

FROM Customer

GROUP NY customer\_id

HAVING count(DISTINCT product\_key) \= (

    SELECT count(1)

    FROM Product)

[](#1050-actors-and-directors-who-cooperated-at-least-three-times--easy---leetcode)1050\. Actors and Directors Who Cooperated At Least Three Times | Easy | 🔒 [LeetCode](https://leetcode.com/problems/actors-and-directors-who-cooperated-at-least-three-times)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `ActorDirector`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| actor\_id    | int     |

| director\_id | int     |

| timestamp   | int     |

+-------------+---------+

timestamp is the primary key column for this table.

Write a SQL query for a report that provides the pairs (actor\_id, director\_id) where the actor have cooperated with the director at least 3 times.

Example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

ActorDirector table:

+-------------+-------------+-------------+

| actor\_id    | director\_id | timestamp   |

+-------------+-------------+-------------+

| 1           | 1           | 0           |

| 1           | 1           | 1           |

| 1           | 1           | 2           |

| 1           | 2           | 3           |

| 1           | 2           | 4           |

| 2           | 1           | 5           |

| 2           | 1           | 6           |

+-------------+-------------+-------------+

Result table:

+-------------+-------------+

| actor\_id    | director\_id |

+-------------+-------------+

| 1           | 1           |

+-------------+-------------+

The only pair is (1, 1) where they cooperated exactly 3 times.

### [](#solution-46)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT actor\_id, director\_id

FROM ActorDirector

GROUP BY actor\_id, director\_id

HAVING COUNT(1)\>=3

[](#1068-product-sales-analysis-i--easy---leetcode)1068\. Product Sales Analysis I | Easy | 🔒 [LeetCode](https://leetcode.com/problems/product-sales-analysis-i)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Sales`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+-------+

| Column Name | Type  |

+-------------+-------+

| sale\_id     | int   |

| product\_id  | int   |

| year        | int   |

| quantity    | int   |

| price       | int   |

+-------------+-------+

(sale\_id, year) is the primary key of this table.

product\_id is a foreign key to Product table.

Note that the price is per unit.

Table: `Product`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+---------+

| Column Name  | Type    |

+--------------+---------+

| product\_id   | int     |

| product\_name | varchar |

+--------------+---------+

product\_id is the primary key of this table.

Write an SQL query that reports all product names of the products in the Sales table along with their selling year and price.

For example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Sales table:

+---------+------------+------+----------+-------+

| sale\_id | product\_id | year | quantity | price |

+---------+------------+------+----------+-------+

| 1       | 100        | 2008 | 10       | 5000  |

| 2       | 100        | 2009 | 12       | 5000  |

| 7       | 200        | 2011 | 15       | 9000  |

+---------+------------+------+----------+-------+

Product table:

+------------+--------------+

| product\_id | product\_name |

+------------+--------------+

| 100        | Nokia        |

| 200        | Apple        |

| 300        | Samsung      |

+------------+--------------+

Result table:

+--------------+-------+-------+

| product\_name | year  | price |

+--------------+-------+-------+

| Nokia        | 2008  | 5000  |

| Nokia        | 2009  | 5000  |

| Apple        | 2011  | 9000  |

+--------------+-------+-------+

### [](#solution-47)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT product\_name, year, price

FROM Sales JOIN Product

ON Product.product\_id \= Sales.product\_id

[](#1069-product-sales-analysis-ii--easy---leetcode)1069\. Product Sales Analysis II | Easy | 🔒 [LeetCode](https://leetcode.com/problems/product-sales-analysis-ii)
--------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Sales`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+-------+

| Column Name | Type  |

+-------------+-------+

| sale\_id     | int   |

| product\_id  | int   |

| year        | int   |

| quantity    | int   |

| price       | int   |

+-------------+-------+

sale\_id is the primary key of this table.

product\_id is a foreign key to Product table.

Note that the price is per unit.

Table: `Product`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+---------+

| Column Name  | Type    |

+--------------+---------+

| product\_id   | int     |

| product\_name | varchar |

+--------------+---------+

product\_id is the primary key of this table.

Write an SQL query that reports the total quantity sold for every product id.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Sales table:

+---------+------------+------+----------+-------+

| sale\_id | product\_id | year | quantity | price |

+---------+------------+------+----------+-------+

| 1       | 100        | 2008 | 10       | 5000  |

| 2       | 100        | 2009 | 12       | 5000  |

| 7       | 200        | 2011 | 15       | 9000  |

+---------+------------+------+----------+-------+

Product table:

+------------+--------------+

| product\_id | product\_name |

+------------+--------------+

| 100        | Nokia        |

| 200        | Apple        |

| 300        | Samsung      |

+------------+--------------+

Result table:

+--------------+----------------+

| product\_id   | total\_quantity |

+--------------+----------------+

| 100          | 22             |

| 200          | 15             |

+--------------+----------------+

### [](#solution-48)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT product\_id, sum(quantity) AS total\_quantity

FROM Sales

GROUP BY product\_id;

[](#1070-product-sales-analysis-iii--medium---leetcode)1070\. Product Sales Analysis III | Medium | 🔒 [LeetCode](https://leetcode.com/problems/product-sales-analysis-iii)
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Sales`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+-------+

| Column Name | Type  |

+-------------+-------+

| sale\_id     | int   |

| product\_id  | int   |

| year        | int   |

| quantity    | int   |

| price       | int   |

+-------------+-------+

sale\_id is the primary key of this table.

product\_id is a foreign key to Product table.

Note that the price is per unit.

Table: `Product`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+---------+

| Column Name  | Type    |

+--------------+---------+

| product\_id   | int     |

| product\_name | varchar |

+--------------+---------+

product\_id is the primary key of this table.

Write an SQL query that selects the product id, year, quantity, and price for the first year of every product sold.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Sales table:

+---------+------------+------+----------+-------+

| sale\_id | product\_id | year | quantity | price |

+---------+------------+------+----------+-------+

| 1       | 100        | 2008 | 10       | 5000  |

| 2       | 100        | 2009 | 12       | 5000  |

| 7       | 200        | 2011 | 15       | 9000  |

+---------+------------+------+----------+-------+

Product table:

+------------+--------------+

| product\_id | product\_name |

+------------+--------------+

| 100        | Nokia        |

| 200        | Apple        |

| 300        | Samsung      |

+------------+--------------+

Result table:

+------------+------------+----------+-------+

| product\_id | first\_year | quantity | price |

+------------+------------+----------+-------+

| 100        | 2008       | 10       | 5000  |

| 200        | 2011       | 15       | 9000  |

+------------+------------+----------+-------+

### [](#solution-49)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT

    product\_id,

    year first\_year,

    quantity,

    price

FROM Sales

WHERE (product\_id, year) IN (SELECT product\_id, MIN(year)

                             FROM Sales

                             GROUP BY product\_id)

[](#1075-project-employees-i--easy---leetcode)1075\. Project Employees I | Easy | 🔒 [LeetCode](https://leetcode.com/problems/project-employees-i)
--------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Project`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| project\_id  | int     |

| employee\_id | int     |

+-------------+---------+

(project\_id, employee\_id) is the primary key of this table.

employee\_id is a foreign key to Employee table.

Table: `Employee`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+------------------+---------+

| Column Name      | Type    |

+------------------+---------+

| employee\_id      | int     |

| name             | varchar |

| experience\_years | int     |

+------------------+---------+

employee\_id is the primary key of this table.

Write an SQL query that reports the average experience years of all the employees for each project, rounded to 2 digits.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Project table:

+-------------+-------------+

| project\_id  | employee\_id |

+-------------+-------------+

| 1           | 1           |

| 1           | 2           |

| 1           | 3           |

| 2           | 1           |

| 2           | 4           |

+-------------+-------------+

Employee table:

+-------------+--------+------------------+

| employee\_id | name   | experience\_years |

+-------------+--------+------------------+

| 1           | Khaled | 3                |

| 2           | Ali    | 2                |

| 3           | John   | 1                |

| 4           | Doe    | 2                |

+-------------+--------+------------------+

Result table:

+-------------+---------------+

| project\_id  | average\_years |

+-------------+---------------+

| 1           | 2.00          |

| 2           | 2.50          |

+-------------+---------------+

The average experience years for the first project is (3 + 2 + 1) / 3 = 2.00 and for the second project is (3 + 2) / 2 = 2.50

### [](#solution-50)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT

    p.project\_id,

    ROUND(AVG(e.experience\_years),2) average\_years

FROM

    Project p JOIN Employee e ON

    p.employee\_id \= e.employee\_id

GROUP BY

    p.project\_id

[](#1076-project-employees-ii--easy---leetcode)1076\. Project Employees II | Easy | 🔒 [LeetCode](https://leetcode.com/problems/project-employees-ii)
-----------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Project`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| project\_id  | int     |

| employee\_id | int     |

+-------------+---------+

(project\_id, employee\_id) is the primary key of this table.

employee\_id is a foreign key to Employee table.

Table: `Employee`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+------------------+---------+

| Column Name      | Type    |

+------------------+---------+

| employee\_id      | int     |

| name             | varchar |

| experience\_years | int     |

+------------------+---------+

employee\_id is the primary key of this table.

Write an SQL query that reports all the projects that have the most employees.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Project table:

+-------------+-------------+

| project\_id  | employee\_id |

+-------------+-------------+

| 1           | 1           |

| 1           | 2           |

| 1           | 3           |

| 2           | 1           |

| 2           | 4           |

+-------------+-------------+

Employee table:

+-------------+--------+------------------+

| employee\_id | name   | experience\_years |

+-------------+--------+------------------+

| 1           | Khaled | 3                |

| 2           | Ali    | 2                |

| 3           | John   | 1                |

| 4           | Doe    | 2                |

+-------------+--------+------------------+

Result table:

+-------------+

| project\_id  |

+-------------+

| 1           |

+-------------+

The first project has 3 employees while the second one has 2.

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT project\_id

FROM Project

GROUP BY project\_id

HAVING COUNT(employee\_id) \= (SELECT COUNT(employee\_id)

                            FROM Project

                            GROUP BY project\_id

                            ORDER BY COUNT(employee\_id) DESC

                            LIMIT 1)

[](#1077-project-employees-iii--medium---leetcode)1077\. Project Employees III | Medium | 🔒 [LeetCode](https://leetcode.com/problems/project-employees-iii)
------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Project`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| project\_id  | int     |

| employee\_id | int     |

+-------------+---------+

(project\_id, employee\_id) is the primary key of this table.

employee\_id is a foreign key to Employee table.

Table: `Employee`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+------------------+---------+

| Column Name      | Type    |

+------------------+---------+

| employee\_id      | int     |

| name             | varchar |

| experience\_years | int     |

+------------------+---------+

employee\_id is the primary key of this table.

Write an SQL query that reports the most experienced employees in each project. In case of a tie, report all employees with the maximum number of experience years.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Project table:

+-------------+-------------+

| project\_id  | employee\_id |

+-------------+-------------+

| 1           | 1           |

| 1           | 2           |

| 1           | 3           |

| 2           | 1           |

| 2           | 4           |

+-------------+-------------+

Employee table:

+-------------+--------+------------------+

| employee\_id | name   | experience\_years |

+-------------+--------+------------------+

| 1           | Khaled | 3                |

| 2           | Ali    | 2                |

| 3           | John   | 3                |

| 4           | Doe    | 2                |

+-------------+--------+------------------+

Result table:

+-------------+---------------+

| project\_id  | employee\_id   |

+-------------+---------------+

| 1           | 1             |

| 1           | 3             |

| 2           | 1             |

+-------------+---------------+

Both employees with id 1 and 3 have the most experience among the employees of the first project. For the second project, the employee with id 1 has the most experience.

### [](#solution-51)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT

    p.project\_id,

    e.employee\_id

FROM

    Project p LEFT JOIN Employee e ON

    p.employee\_id \= e.employee\_id

WHERE (p.project\_id,

       e.experience\_years) IN (SELECT

                                p.project\_id,

                                MAX(e.experience\_years)

                            FROM

                                Project p JOIN Employee e ON

                                p.employee\_id \= e.employee\_id

                            GROUP BY

                                p.project\_id)

[](#1082-sales-analysis-i--easy---leetcode)1082\. Sales Analysis I | Easy | 🔒 [LeetCode](https://leetcode.com/problems/sales-analysis-i)
-----------------------------------------------------------------------------------------------------------------------------------------

Table: `Product`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+---------+

| Column Name  | Type    |

+--------------+---------+

| product\_id   | int     |

| product\_name | varchar |

| unit\_price   | int     |

+--------------+---------+

product\_id is the primary key of this table.

Table: Sales

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| seller\_id   | int     |

| product\_id  | int     |

| buyer\_id    | int     |

| sale\_date   | date    |

| quantity    | int     |

| price       | int     |

+------ ------+---------+

This table has no primary key, it can have repeated rows.

product\_id is a foreign key to Product table.

Write an SQL query that reports the best seller by total sales price, If there is a tie, report them all.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Product table:

+------------+--------------+------------+

| product\_id | product\_name | unit\_price |

+------------+--------------+------------+

| 1          | S8           | 1000       |

| 2          | G4           | 800        |

| 3          | iPhone       | 1400       |

+------------+--------------+------------+

Sales table:

+-----------+------------+----------+------------+----------+-------+

| seller\_id | product\_id | buyer\_id | sale\_date  | quantity | price |

+-----------+------------+----------+------------+----------+-------+

| 1         | 1          | 1        | 2019-01-21 | 2        | 2000  |

| 1         | 2          | 2        | 2019-02-17 | 1        | 800   |

| 2         | 2          | 3        | 2019-06-02 | 1        | 800   |

| 3         | 3          | 4        | 2019-05-13 | 2        | 2800  |

+-----------+------------+----------+------------+----------+-------+

Result table:

+-------------+

| seller\_id   |

+-------------+

| 1           |

| 3           |

+-------------+

Both sellers with id 1 and 3 sold products with the most total price of 2800.

### [](#solution-52)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT seller\_id

FROM Sales

GROUP BY seller\_id

HAVING SUM(price) \= (SELECT SUM(price)

                    FROM Sales

                    GROUP BY seller\_id

                    ORDER BY SUM(price) DESC

                    LIMIT 1)

[](#1083-sales-analysis-ii--easy---leetcode)1083\. Sales Analysis II | Easy | 🔒 [LeetCode](https://leetcode.com/problems/sales-analysis-ii)
--------------------------------------------------------------------------------------------------------------------------------------------

Table: `Product`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+---------+

| Column Name  | Type    |

+--------------+---------+

| product\_id   | int     |

| product\_name | varchar |

| unit\_price   | int     |

+--------------+---------+

product\_id is the primary key of this table.

Table: `Sales`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| seller\_id   | int     |

| product\_id  | int     |

| buyer\_id    | int     |

| sale\_date   | date    |

| quantity    | int     |

| price       | int     |

+------ ------+---------+

This table has no primary key, it can have repeated rows.

product\_id is a foreign key to Product table.

Write an SQL query that reports the buyers who have bought S8 but not iPhone. Note that S8 and iPhone are products present in the Product table.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Product table:

+------------+--------------+------------+

| product\_id | product\_name | unit\_price |

+------------+--------------+------------+

| 1          | S8           | 1000       |

| 2          | G4           | 800        |

| 3          | iPhone       | 1400       |

+------------+--------------+------------+

Sales table:

+-----------+------------+----------+------------+----------+-------+

| seller\_id | product\_id | buyer\_id | sale\_date  | quantity | price |

+-----------+------------+----------+------------+----------+-------+

| 1         | 1          | 1        | 2019-01-21 | 2        | 2000  |

| 1         | 2          | 2        | 2019-02-17 | 1        | 800   |

| 2         | 1          | 3        | 2019-06-02 | 1        | 800   |

| 3         | 3          | 3        | 2019-05-13 | 2        | 2800  |

+-----------+------------+----------+------------+----------+-------+

Result table:

+-------------+

| buyer\_id    |

+-------------+

| 1           |

+-------------+

The buyer with id 1 bought an S8 but didn't buy an iPhone. The buyer with id 3 bought both.

### [](#solution-53)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT DISTINCT s.buyer\_id

FROM Sales s LEFT JOIN Product p ON

    s.product\_id \= p.product\_id

WHERE p.product\_name \= 'S8' AND

      s.buyer\_id NOT IN (SELECT s.buyer\_id

                        FROM Sales s LEFT JOIN Product p ON

                            s.product\_id \= p.product\_id

                        WHERE p.product\_name \= 'iPhone')

[](#1084-sales-analysis-iii--easy---leetcode)1084\. Sales Analysis III | Easy | 🔒 [LeetCode](https://leetcode.com/problems/sales-analysis-iii)
-----------------------------------------------------------------------------------------------------------------------------------------------

Reports the products that were only sold in spring 2019. That is, between 2019-01-01 and 2019-03-31 inclusive. Select the product that were only sold in spring 2019.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Product table:

+------------+--------------+------------+

| product\_id | product\_name | unit\_price |

+------------+--------------+------------+

| 1          | S8           | 1000       |

| 2          | G4           | 800        |

| 3          | iPhone       | 1400       |

+------------+--------------+------------+

Sales table:

+-----------+------------+----------+------------+----------+-------+

| seller\_id | product\_id | buyer\_id | sale\_date  | quantity | price |

+-----------+------------+----------+------------+----------+-------+

| 1         | 1          | 1        | 2019-01-21 | 2        | 2000  |

| 1         | 2          | 2        | 2019-02-17 | 1        | 800   |

| 2         | 2          | 3        | 2019-06-02 | 1        | 800   |

| 3         | 3          | 4        | 2019-05-13 | 2        | 2800  |

+-----------+------------+----------+------------+----------+-------+

Result table:

+-------------+--------------+

| product\_id  | product\_name |

+-------------+--------------+

| 1           | S8           |

+-------------+--------------+

The product with id 1 was only sold in spring 2019 while the other two were sold after.

### [](#solution-54)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

(SELECT DISTINCT s.product\_id, p.product\_name

FROM Sales s LEFT JOIN Product p ON

    s.product\_id \= p.product\_id

WHERE s.sale\_date \>= '2019-01-01' AND

      s.sale\_date <= '2019-03-31')

EXCEPT \-- MINUS if Oracle

(SELECT DISTINCT s.product\_id, p.product\_name

FROM Sales s LEFT JOIN Product p ON

    s.product\_id \= p.product\_id

WHERE s.sale\_date < '2019-01-01' OR

      s.sale\_date \> '2019-03-31')

[](#1097-game-play-analysis-v--hard---leetcode)1097\. Game Play Analysis V | Hard | 🔒 [LeetCode](https://leetcode.com/problems/game-play-analysis-v)
-----------------------------------------------------------------------------------------------------------------------------------------------------

We define the install date of a player to be the first login day of that player. We also define day 1 retention of some date X to be the number of players whose install date is X and they logged back in on the day right after X , divided by the number of players whose install date is X, rounded to 2 decimal places. Write an SQL query that reports for each install date, the number of players that installed the game on that day and the day 1 retention. The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Activity table:

+-----------+-----------+------------+--------------+

| player\_id | device\_id | event\_date | games\_played |

+-----------+-----------+------------+--------------+

| 1         | 2         | 2016-03-01 | 5            |

| 1         | 2         | 2016-03-02 | 6            |

| 2         | 3         | 2017-06-25 | 1            |

| 3         | 1         | 2016-03-01 | 0            |

| 3         | 4         | 2016-07-03 | 5            |

+-----------+-----------+------------+--------------+

Result table:

+------------+----------+----------------+

| install\_dt | installs | Day1\_retention |

+------------+----------+----------------+

| 2016-03-01 | 2        | 0.50           |

| 2017-06-25 | 1        | 0.00           |

+------------+----------+----------------+

Player 1 and 3 installed the game on 2016-03-01 but only player 1 logged back in on 2016-03-02 so the day 1 retention of 2016-03-01 is 1/2 = 0.50

Player 2 installed the game on 2017 -06-25 but didn't log back in on 2017-06-26 so the day 1 retention of 2017-06-25 is 0/1 = 0.00

### [](#solution-55)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT

    install\_dt,

    COUNT(player\_id) installs,

    ROUND(COUNT(retention)/COUNT(player\_id),2) Day1\_retention  \--the number of record on the next day / the total number of id on the day = retention rate

FROM

    (

    SELECT a.player\_id, a.install\_dt, b.event\_date retention \-- id, the record of the first installation day and next day

    FROM

        (SELECT player\_id, MIN(event\_date) install\_dt   \--subquery 1 take the first installation of date of each id

        FROM Activity

        GROUP BY player\_id) a LEFT JOIN Activity b ON   \--sq1 left join the original table, find the login status the next day after the first installation

            a.player\_id \= b.player\_id AND

            a.install\_dt + 1\=b.event\_date

    ) AS tmp

GROUP BY

    install\_dt

[](#1098-unpopular-books--medium---leetcode)1098\. Unpopular Books | Medium | 🔒 [LeetCode](https://leetcode.com/problems/unpopular-books)
------------------------------------------------------------------------------------------------------------------------------------------

Table: `Books`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----------------+---------+

| Column Name    | Type    |

+----------------+---------+

| book\_id        | int     |

| name           | varchar |

| available\_from | date    |

+----------------+---------+

book\_id is the primary key of this table.

Table: `Orders`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----------------+---------+

| Column Name    | Type    |

+----------------+---------+

| order\_id       | int     |

| book\_id        | int     |

| quantity       | int     |

| dispatch\_date  | date    |

+----------------+---------+

order\_id is the primary key of this table.

book\_id is a foreign key to the Books table.

Write an SQL query that reports the books that have sold less than 10 copies in the last year, excluding books that have been available for less than 1 month from today. Assume today is 2019-06-23.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Books table:

+---------+--------------------+----------------+

| book\_id | name               | available\_from |

+---------+--------------------+----------------+

| 1       | "Kalila And Demna" | 2010-01-01     |

| 2       | "28 Letters"       | 2012-05-12     |

| 3       | "The Hobbit"       | 2019-06-10     |

| 4       | "13 Reasons Why"   | 2019-06-01     |

| 5       | "The Hunger Games" | 2008-09-21     |

+---------+--------------------+----------------+

Orders table:

+----------+---------+----------+---------------+

| order\_id | book\_id | quantity | dispatch\_date |

+----------+---------+----------+---------------+

| 1        | 1       | 2        | 2018-07-26    |

| 2        | 1       | 1        | 2018-11-05    |

| 3        | 3       | 8        | 2019-06-11    |

| 4        | 4       | 6        | 2019-06-05    |

| 5        | 4       | 5        | 2019-06-20    |

| 6        | 5       | 9        | 2009-02-02    |

| 7        | 5       | 8        | 2010-04-13    |

+----------+---------+----------+---------------+

Result table:

+-----------+--------------------+

| book\_id   | name               |

+-----------+--------------------+

| 1         | "Kalila And Demna" |

| 2         | "28 Letters"       |

| 5         | "The Hunger Games" |

+-----------+--------------------+

### [](#solution-56)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT

    b.book\_id, b.name

FROM

    Books b LEFT JOIN (                    \-- subquery calculates last year's sales

        SELECT book\_id, SUM(quantity) nsold

        FROM Orders

        WHERE dispatch\_date BETWEEN '2018-06-23' AND '2019-06-23'

        GROUP BY book\_id

    ) o

    ON b.book\_id \= o.book\_id

WHERE

    (o.nsold < 10 OR o.nsold IS NULL) AND           \-- Sales less than 10 or no sales

    DATEDIFF('2019-06-23', b.available\_from) \> 30   \-- Not a new book within 1 month

[](#1107-new-users-daily-count--medium---leetcode)1107\. New Users Daily Count | Medium | 🔒 [LeetCode](https://leetcode.com/problems/new-users-daily-count)
------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Traffic`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| user\_id       | int     |

| activity      | enum    |

| activity\_date | date    |

+---------------+---------+

There is no primary key for this table, it may have duplicate rows.

The activity column is an ENUM type of ('login', 'logout', 'jobs', 'groups', 'homepage').

Write an SQL query that reports for every date within at most 90 days from today, the number of users that logged in for the first time on that date. Assume today is 2019-06-30.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Traffic table:

+---------+----------+---------------+

| user\_id | activity | activity\_date |

+---------+----------+---------------+

| 1       | login    | 2019-05-01    |

| 1       | homepage | 2019-05-01    |

| 1       | logout   | 2019-05-01    |

| 2       | login    | 2019-06-21    |

| 2       | logout   | 2019-06-21    |

| 3       | login    | 2019-01-01    |

| 3       | jobs     | 2019-01-01    |

| 3       | logout   | 2019-01-01    |

| 4       | login    | 2019-06-21    |

| 4       | groups   | 2019-06-21    |

| 4       | logout   | 2019-06-21    |

| 5       | login    | 2019-03-01    |

| 5       | logout   | 2019-03-01    |

| 5       | login    | 2019-06-21    |

| 5       | logout   | 2019-06-21    |

+---------+----------+---------------+

Result table:

+------------+-------------+

| login\_date | user\_count  |

+------------+-------------+

| 2019-05-01 | 1           |

| 2019-06-21 | 2           |

+------------+-------------+

Note that we only care about dates with non zero user count.

The user with id 5 first logged in on 2019-03-01 so he's not counted on 2019-06-21.

### [](#solution-57)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution- 1:

SELECT login\_date, COUNT(user\_id) AS user\_count

FROM (SELECT user\_id, MIN(activity\_date) AS login\_date

    FROM Traffic

    WHERE activity \= 'login'

    GROUP BY user\_id) AS t

WHERE login\_date \>= DATE\_ADD('2019-06-30', INTERVAL \-90 DAY) AND login\_date <= '2019-06-30'

GROUP BY login\_date

#Solution- 2:

SELECT login\_date, COUNT(user\_id) user\_count

FROM

    (SELECT user\_id, MIN(activity\_date) as login\_date

    FROM Traffic

    WHERE activity\='login'

    GROUP BY user\_id) as t

WHERE DATEDIFF('2019-06-30', login\_date) <= 90

GROUP BY login\_date

[](#1112-highest-grade-for-each-student--medium---leetcode)1112\. Highest Grade For Each Student | Medium | 🔒 [LeetCode](https://leetcode.com/problems/highest-grade-for-each-student)
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Enrollments`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| student\_id    | int     |

| course\_id     | int     |

| grade         | int     |

+---------------+---------+

(student\_id, course\_id) is the primary key of this table.

Write a SQL query to find the highest grade with its corresponding course for each student. In case of a tie, you should find the course with the smallest course\_id. The output must be sorted by increasing student\_id.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Enrollments table:

+------------+-------------------+

| student\_id | course\_id | grade |

+------------+-----------+-------+

| 2          | 2         | 95    |

| 2          | 3         | 95    |

| 1          | 1         | 90    |

| 1          | 2         | 99    |

| 3          | 1         | 80    |

| 3          | 2         | 75    |

| 3          | 3         | 82    |

+------------+-----------+-------+

Result table:

+------------+-------------------+

| student\_id | course\_id | grade |

+------------+-----------+-------+

| 1          | 2         | 99    |

| 2          | 2         | 95    |

| 3          | 3         | 82    |

+------------+-----------+-------+

### [](#solution-58)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT student\_id, MIN(course\_id) course\_id, grade

FROM Enrollments

WHERE (student\_id, grade) IN

        (SELECT student\_id, MAX(grade)

        FROM Enrollments

        GROUP BY student\_id)

GROUP BY student\_id

ORDER BY student\_id;

[](#1113reported-posts--easy---leetcode)1113.Reported Posts | Easy | 🔒 [LeetCode](https://leetcode.com/problems/reported-posts)
--------------------------------------------------------------------------------------------------------------------------------

Table: `Actions`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| user\_id       | int     |

| post\_id       | int     |

| action\_date   | date    |

| action        | enum    |

| extra         | varchar |

+---------------+---------+

There is no primary key for this table, it may have duplicate rows.

The action column is an ENUM type of ('view', 'like', 'reaction', 'comment', 'report', 'share').

The extra column has optional information about the action such as a reason for report or a type of reaction.

Write an SQL query that reports the number of posts reported yesterday for each report reason. Assume today is 2019-07-05.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Actions table:

+---------+---------+-------------+--------+--------+

| user\_id | post\_id | action\_date | action | extra  |

+---------+---------+-------------+--------+--------+

| 1       | 1       | 2019-07-01  | view   | null   |

| 1       | 1       | 2019-07-01  | like   | null   |

| 1       | 1       | 2019-07-01  | share  | null   |

| 2       | 4       | 2019-07-04  | view   | null   |

| 2       | 4       | 2019-07-04  | report | spam   |

| 3       | 4       | 2019-07-04  | view   | null   |

| 3       | 4       | 2019-07-04  | report | spam   |

| 4       | 3       | 2019-07-02  | view   | null   |

| 4       | 3       | 2019-07-02  | report | spam   |

| 5       | 2       | 2019-07-04  | view   | null   |

| 5       | 2       | 2019-07-04  | report | racism |

| 5       | 5       | 2019-07-04  | view   | null   |

| 5       | 5       | 2019-07-04  | report | racism |

+---------+---------+-------------+--------+--------+

Result table:

+---------------+--------------+

| report\_reason | report\_count |

+---------------+--------------+

| spam          | 1            |

| racism        | 2            |

+---------------+--------------+

Note that we only care about report reasons with non zero number of reports.

### [](#solution-59)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT extra report\_reason, COUNT(DISTINCT post\_id) report\_count

FROM

    (SELECT post\_id, extra

    FROM Actions

    WHERE action\_date \= DATE\_SUB('2019-07-05', INTERVAL 1 DAY) AND

          action \= 'report') AS tmp

GROUP BY extra

[](#1126-active-businesses--medium---leetcode)1126\. Active Businesses | Medium | 🔒 [LeetCode](https://leetcode.com/problems/active-businesses)
------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Events`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| business\_id   | int     |

| event\_type    | varchar |

| occurences    | int     |

+---------------+---------+

(business\_id, event\_type) is the primary key of this table.

Each row in the table logs the info that an event of some type occured at some business for a number of times.

Write an SQL query to find all active businesses.

An active business is a business that has more than one event type with occurences greater than the average occurences of that event type among all businesses.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Events table:

+-------------+------------+------------+

| business\_id | event\_type | occurences |

+-------------+------------+------------+

| 1           | reviews    | 7          |

| 3           | reviews    | 3          |

| 1           | ads        | 11         |

| 2           | ads        | 7          |

| 3           | ads        | 6          |

| 1           | page views | 3          |

| 2           | page views | 12         |

+-------------+------------+------------+

Result table:

+-------------+

| business\_id |

+-------------+

| 1           |

+-------------+

Average for 'reviews', 'ads' and 'page views' are (7+3)/2=5, (11+7+6)/3=8, (3+12)/2=7.5 respectively.

Business with id 1 has 7 'reviews' events (more than 5) and 11 'ads' events (more than 8) so it is an active business.

### [](#solution-60)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT business\_id

FROM (SELECT a.business\_id, a.event\_type, a.occurences, b.event\_avg  \-- sub 2

      FROM Events a LEFT JOIN

        (SELECT event\_type, AVG(occurences) event\_avg   \-- sub 1

         FROM Events

         GROUP BY event\_type) b ON

      a.event\_type \= b.event\_type) tmp

WHERE occurences \> event\_avg

GROUP BY business\_id

HAVING COUNT(event\_type) \> 1

[](#1127-user-purchase-platform--hard---leetcode)1127\. User Purchase Platform | Hard | 🔒 [LeetCode](https://leetcode.com/problems/user-purchase-platform)
-----------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Spending`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| user\_id     | int     |

| spend\_date  | date    |

| platform    | enum    |

| amount      | int     |

+-------------+---------+

The table logs the spendings history of users that make purchases from an online shopping website which has a desktop and a mobile application.

(user\_id, spend\_date, platform) is the primary key of this table.

The platform column is an ENUM type of ('desktop', 'mobile').

Write an SQL query to find the total number of users and the total amount spent using mobile only, desktop only and both mobile and desktop together for each date.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Spending table:

+---------+------------+----------+--------+

| user\_id | spend\_date | platform | amount |

+---------+------------+----------+--------+

| 1       | 2019-07-01 | mobile   | 100    |

| 1       | 2019-07-01 | desktop  | 100    |

| 2       | 2019-07-01 | mobile   | 100    |

| 2       | 2019-07-02 | mobile   | 100    |

| 3       | 2019-07-01 | desktop  | 100    |

| 3       | 2019-07-02 | desktop  | 100    |

+---------+------------+----------+--------+

Result table:

+------------+----------+--------------+-------------+

| spend\_date | platform | total\_amount | total\_users |

+------------+----------+--------------+-------------+

| 2019-07-01 | desktop  | 100          | 1           |

| 2019-07-01 | mobile   | 100          | 1           |

| 2019-07-01 | both     | 200          | 1           |

| 2019-07-02 | desktop  | 100          | 1           |

| 2019-07-02 | mobile   | 100          | 1           |

| 2019-07-02 | both     | 0            | 0           |

+------------+----------+--------------+-------------+

On 2019-07-01, user 1 purchased using both desktop and mobile, user 2 purchased using mobile only and user 3 purchased using desktop only.

On 2019-07-02, user 2 purchased using mobile only, user 3 purchased using desktop only and no one purchased using both platforms.

### [](#solution-61)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT aa.spend\_date,

       aa.platform,

       COALESCE(bb.total\_amount, 0) total\_amount,

       COALESCE(bb.total\_users,0) total\_users

FROM

    (SELECT DISTINCT(spend\_date), a.platform   \-- table aa

    FROM Spending JOIN

        (SELECT 'desktop' AS platform UNION

        SELECT 'mobile' AS platform UNION

        SELECT 'both' AS platform

        ) a

    ) aa

    LEFT JOIN

    (SELECT spend\_date,                      \-- table bb

            platform,

            SUM(amount) total\_amount,

            COUNT(user\_id) total\_users

    FROM

        (SELECT spend\_date,

                user\_id,

                (CASE COUNT(DISTINCT platform)

                    WHEN 1 THEN platform

                    WHEN 2 THEN 'both'

                    END) platform,

                SUM(amount) amount

        FROM Spending

        GROUP BY spend\_date, user\_id

        ) b

    GROUP BY spend\_date, platform

    ) bb

    ON aa.platform \= bb.platform AND

    aa.spend\_date \= bb.spend\_date

[](#1132-reported-posts-ii--medium---leetcode)1132\. Reported Posts II | Medium | 🔒 [LeetCode](https://leetcode.com/problems/reported-posts-ii)
------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Actions`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| user\_id       | int     |

| post\_id       | int     |

| action\_date   | date    |

| action        | enum    |

| extra         | varchar |

+---------------+---------+

There is no primary key for this table, it may have duplicate rows.

The action column is an ENUM type of ('view', 'like', 'reaction', 'comment', 'report', 'share').

The extra column has optional information about the action such as a reason for report or a type of reaction.

Table: `Removals`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| post\_id       | int     |

| remove\_date   | date    |

+---------------+---------+

post\_id is the primary key of this table.

Each row in this table indicates that some post was removed as a result of being reported or as a result of an admin review.

Write an SQL query to find the average for daily percentage of posts that got removed after being reported as spam, rounded to 2 decimal places.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Actions table:

+---------+---------+-------------+--------+--------+

| user\_id | post\_id | action\_date | action | extra  |

+---------+---------+-------------+--------+--------+

| 1       | 1       | 2019-07-01  | view   | null   |

| 1       | 1       | 2019-07-01  | like   | null   |

| 1       | 1       | 2019-07-01  | share  | null   |

| 2       | 2       | 2019-07-04  | view   | null   |

| 2       | 2       | 2019-07-04  | report | spam   |

| 3       | 4       | 2019-07-04  | view   | null   |

| 3       | 4       | 2019-07-04  | report | spam   |

| 4       | 3       | 2019-07-02  | view   | null   |

| 4       | 3       | 2019-07-02  | report | spam   |

| 5       | 2       | 2019-07-03  | view   | null   |

| 5       | 2       | 2019-07-03  | report | racism |

| 5       | 5       | 2019-07-03  | view   | null   |

| 5       | 5       | 2019-07-03  | report | racism |

+---------+---------+-------------+--------+--------+

Removals table:

+---------+-------------+

| post\_id | remove\_date |

+---------+-------------+

| 2       | 2019-07-20  |

| 3       | 2019-07-18  |

+---------+-------------+

Result table:

+-----------------------+

| average\_daily\_percent |

+-----------------------+

| 75.00                 |

+-----------------------+

The percentage for 2019-07-04 is 50% because only one post of two spam reported posts was removed.

The percentage for 2019-07-02 is 100% because one post was reported as spam and it was removed.

The other days had no spam reports so the average is (50 + 100) / 2 = 75%

Note that the output is only one number and that we do not care about the remove dates.

### [](#solution-62)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

WITH t1 AS(

SELECT a.action\_date, (COUNT(DISTINCT r.post\_id))/(COUNT(DISTINCT a.post\_id)) AS result

FROM (SELECT action\_date, post\_id

FROM actions

WHERE extra \= 'spam' AND action \= 'report') a

LEFT JOIN

removals r

ON a.post\_id \= r.post\_id

GROUP BY a.action\_date)

SELECT ROUND(AVG(t1.result)\*100,2) AS  average\_daily\_percent

FROM t1

[](#1141-user-activity-for-the-past-30-days-i--easy---leetcode)1141\. User Activity for the Past 30 Days I | Easy | 🔒 [LeetCode](https://leetcode.com/problems/user-activity-for-the-past-30-days-i)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Activity`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| user\_id       | int     |

| session\_id    | int     |

| activity\_date | date    |

| activity\_type | enum    |

+---------------+---------+

There is no primary key for this table, it may have duplicate rows.

The activity\_type column is an ENUM of type ('open\_session', 'end\_session', 'scroll\_down', 'send\_message').

The table shows the user activities for a social media website.

Note that each session belongs to exactly one user.

Write an SQL query to find the daily active user count for a period of 30 days ending 2019-07-27 inclusively. A user was active on some day if he/she made at least one activity on that day.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Activity table:

+---------+------------+---------------+---------------+

| user\_id | session\_id | activity\_date | activity\_type |

+---------+------------+---------------+---------------+

| 1       | 1          | 2019-07-20    | open\_session  |

| 1       | 1          | 2019-07-20    | scroll\_down   |

| 1       | 1          | 2019-07-20    | end\_session   |

| 2       | 4          | 2019-07-20    | open\_session  |

| 2       | 4          | 2019-07-21    | send\_message  |

| 2       | 4          | 2019-07-21    | end\_session   |

| 3       | 2          | 2019-07-21    | open\_session  |

| 3       | 2          | 2019-07-21    | send\_message  |

| 3       | 2          | 2019-07-21    | end\_session   |

| 4       | 3          | 2019-06-25    | open\_session  |

| 4       | 3          | 2019-06-25    | end\_session   |

+---------+------------+---------------+---------------+

Result table:

+------------+--------------+

| day        | active\_users |

+------------+--------------+

| 2019-07-20 | 2            |

| 2019-07-21 | 2            |

+------------+--------------+

Note that we do not care about days with zero active users.

### [](#solution-63)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT activity\_date AS day, COUNT(DISTINCT user\_id) AS active\_users

FROM activity

WHERE activity\_date \> '2019-06-26' AND activity\_date < '2019-07-27'

GROUP BY activity\_date

[](#1142-user-activity-for-the-past-30-days-ii--easy---leetcode)1142\. User Activity for the Past 30 Days II | Easy | 🔒 [LeetCode](https://leetcode.com/problems/user-activity-for-the-past-30-days-ii)
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Activity`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| user\_id       | int     |

| session\_id    | int     |

| activity\_date | date    |

| activity\_type | enum    |

+---------------+---------+

There is no primary key for this table, it may have duplicate rows.

The activity\_type column is an ENUM of type ('open\_session', 'end\_session', 'scroll\_down', 'send\_message').

The table shows the user activities for a social media website.

Note that each session belongs to exactly one user.

Write an SQL query to find the average number of sessions per user for a period of 30 days ending 2019-07-27 inclusively, rounded to 2 decimal places. The sessions we want to count for a user are those with at least one activity in that time period.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Activity table:

+---------+------------+---------------+---------------+

| user\_id | session\_id | activity\_date | activity\_type |

+---------+------------+---------------+---------------+

| 1       | 1          | 2019-07-20    | open\_session  |

| 1       | 1          | 2019-07-20    | scroll\_down   |

| 1       | 1          | 2019-07-20    | end\_session   |

| 2       | 4          | 2019-07-20    | open\_session  |

| 2       | 4          | 2019-07-21    | send\_message  |

| 2       | 4          | 2019-07-21    | end\_session   |

| 3       | 2          | 2019-07-21    | open\_session  |

| 3       | 2          | 2019-07-21    | send\_message  |

| 3       | 2          | 2019-07-21    | end\_session   |

| 3       | 5          | 2019-07-21    | open\_session  |

| 3       | 5          | 2019-07-21    | scroll\_down   |

| 3       | 5          | 2019-07-21    | end\_session   |

| 4       | 3          | 2019-06-25    | open\_session  |

| 4       | 3          | 2019-06-25    | end\_session   |

+---------+------------+---------------+---------------+

Result table:

+---------------------------+

| average\_sessions\_per\_user |

+---------------------------+

| 1.33                      |

+---------------------------+

User 1 and 2 each had 1 session in the past 30 days while user 3 had 2 sessions so the average is (1 + 1 + 2) / 3 = 1.33.

### [](#solution-64)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT IFNULL(ROUND(AVG(a.num),2),0) AS average\_sessions\_per\_user

FROM (

SELECT COUNT(DISTINCT session\_id) AS num

FROM activity

WHERE activity\_date BETWEEN '2019-06-28' AND '2019-07-27'

GROUP BY user\_id) a

[](#1148-article-views-i--easy---leetcode)1148\. Article Views I | Easy | 🔒 [LeetCode](https://leetcode.com/problems/article-views-i)
--------------------------------------------------------------------------------------------------------------------------------------

Table: `Views`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| article\_id    | int     |

| author\_id     | int     |

| viewer\_id     | int     |

| view\_date     | date    |

+---------------+---------+

There is no primary key for this table, it may have duplicate rows.

Each row of this table indicates that some viewer viewed an article (written by some author) on some date.

Note that equal author\_id and viewer\_id indicate the same person.

Write an SQL query to find all the authors that viewed at least one of their own articles, sorted in ascending order by their id.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Views table:

+------------+-----------+-----------+------------+

| article\_id | author\_id | viewer\_id | view\_date  |

+------------+-----------+-----------+------------+

| 1          | 3         | 5         | 2019-08-01 |

| 1          | 3         | 6         | 2019-08-02 |

| 2          | 7         | 7         | 2019-08-01 |

| 2          | 7         | 6         | 2019-08-02 |

| 4          | 7         | 1         | 2019-07-22 |

| 3          | 4         | 4         | 2019-07-21 |

| 3          | 4         | 4         | 2019-07-21 |

+------------+-----------+-----------+------------+

Result table:

+------+

| id   |

+------+

| 4    |

| 7    |

+------+

### [](#solution-65)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT DISTINCT author\_id AS id

FROM Views

WHERE author\_id \= viewer\_id

ORDER BY author\_id

[](#1149-article-views-ii--medium---leetcode)1149\. Article Views II | Medium | 🔒 [LeetCode](https://leetcode.com/problems/article-views-ii)
---------------------------------------------------------------------------------------------------------------------------------------------

Table: `Views`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| article\_id    | int     |

| author\_id     | int     |

| viewer\_id     | int     |

| view\_date     | date    |

+---------------+---------+

There is no primary key for this table, it may have duplicate rows.

Each row of this table indicates that some viewer viewed an article (written by some author) on some date.

Note that equal author\_id and viewer\_id indicate the same person.

Write an SQL query to find all the people who viewed more than one article on the same date, sorted in ascending order by their id.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Views table:

+------------+-----------+-----------+------------+

| article\_id | author\_id | viewer\_id | view\_date  |

+------------+-----------+-----------+------------+

| 1          | 3         | 5         | 2019-08-01 |

| 3          | 4         | 5         | 2019-08-01 |

| 1          | 3         | 6         | 2019-08-02 |

| 2          | 7         | 7         | 2019-08-01 |

| 2          | 7         | 6         | 2019-08-02 |

| 4          | 7         | 1         | 2019-07-22 |

| 3          | 4         | 4         | 2019-07-21 |

| 3          | 4         | 4         | 2019-07-21 |

+------------+-----------+-----------+------------+

Result table:

+------+

| id   |

+------+

| 5    |

| 6    |

+------+

### [](#solution-66)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT DISTINCT viewer\_id AS id#, COUNT(DISTINCT article\_id) AS total

FROM views

GROUP BY viewer\_id, view\_date

HAVING count(DISTINCT article\_id)\>1

ORDER BY 1

[](#1158-market-analysis-i--medium---leetcode)1158\. Market Analysis I | Medium | 🔒 [LeetCode](https://leetcode.com/problems/market-analysis-i)
------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Users`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----------------+---------+

| Column Name    | Type    |

+----------------+---------+

| user\_id        | int     |

| join\_date      | date    |

| favorite\_brand | varchar |

+----------------+---------+

user\_id is the primary key of this table.

This table has the info of the users of an online shopping website where users can sell and buy items.

Table: `Orders`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| order\_id      | int     |

| order\_date    | date    |

| item\_id       | int     |

| buyer\_id      | int     |

| seller\_id     | int     |

+---------------+---------+

order\_id is the primary key of this table.

item\_id is a foreign key to the Items table.

buyer\_id and seller\_id are foreign keys to the Users table.

Table: `Items`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| item\_id       | int     |

| item\_brand    | varchar |

+---------------+---------+

item\_id is the primary key of this table.

Write an SQL query to find for each user, the join date and the number of orders they made as a buyer in 2019.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Users table:

+---------+------------+----------------+

| user\_id | join\_date  | favorite\_brand |

+---------+------------+----------------+

| 1       | 2018-01-01 | Lenovo         |

| 2       | 2018-02-09 | Samsung        |

| 3       | 2018-01-19 | LG             |

| 4       | 2018-05-21 | HP             |

+---------+------------+----------------+

Orders table:

+----------+------------+---------+----------+-----------+

| order\_id | order\_date | item\_id | buyer\_id | seller\_id |

+----------+------------+---------+----------+-----------+

| 1        | 2019-08-01 | 4       | 1        | 2         |

| 2        | 2018-08-02 | 2       | 1        | 3         |

| 3        | 2019-08-03 | 3       | 2        | 3         |

| 4        | 2018-08-04 | 1       | 4        | 2         |

| 5        | 2018-08-04 | 1       | 3        | 4         |

| 6        | 2019-08-05 | 2       | 2        | 4         |

+----------+------------+---------+----------+-----------+

Items table:

+---------+------------+

| item\_id | item\_brand |

+---------+------------+

| 1       | Samsung    |

| 2       | Lenovo     |

| 3       | LG         |

| 4       | HP         |

+---------+------------+

Result table:

+-----------+------------+----------------+

| buyer\_id  | join\_date  | orders\_in\_2019 |

+-----------+------------+----------------+

| 1         | 2018-01-01 | 1              |

| 2         | 2018-02-09 | 2              |

| 3         | 2018-01-19 | 0              |

| 4         | 2018-05-21 | 0              |

+-----------+------------+----------------+

### [](#solution-67)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT user\_id AS buyer\_id, join\_date, coalesce(a.orders\_in\_2019,0)

FROM users

LEFT JOIN

(

SELECT buyer\_id, coalesce(count(\*), 0) AS orders\_in\_2019

FROM orders o

JOIN users u

ON u.user\_id \= o.buyer\_id

WHERE extract('year' FROM order\_date) \= 2019

GROUP BY buyer\_id) a

ON users.user\_id \= a.buyer\_id

[](#1159-market-analysis-ii--hard---leetcode)1159\. Market Analysis II | Hard | 🔒 [LeetCode](https://leetcode.com/problems/market-analysis-ii)
-----------------------------------------------------------------------------------------------------------------------------------------------

Table: `Users`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----------------+---------+

| Column Name    | Type    |

+----------------+---------+

| user\_id        | int     |

| join\_date      | date    |

| favorite\_brand | varchar |

+----------------+---------+

user\_id is the primary key of this table.

This table has the info of the users of an online shopping website where users can sell and buy items.

Table: `Orders`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| order\_id      | int     |

| order\_date    | date    |

| item\_id       | int     |

| buyer\_id      | int     |

| seller\_id     | int     |

+---------------+---------+

order\_id is the primary key of this table.

item\_id is a foreign key to the Items table.

buyer\_id and seller\_id are foreign keys to the Users table.

Table: `Items`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| item\_id       | int     |

| item\_brand    | varchar |

+---------------+---------+

item\_id is the primary key of this table.

Write an SQL query to find for each user, whether the brand of the second item (by date) they sold is their favorite brand. If a user sold less than two items, report the answer for that user as no.

It is guaranteed that no seller sold more than one item on a day.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Users table:

+---------+------------+----------------+

| user\_id | join\_date  | favorite\_brand |

+---------+------------+----------------+

| 1       | 2019-01-01 | Lenovo         |

| 2       | 2019-02-09 | Samsung        |

| 3       | 2019-01-19 | LG             |

| 4       | 2019-05-21 | HP             |

+---------+------------+----------------+

Orders table:

+----------+------------+---------+----------+-----------+

| order\_id | order\_date | item\_id | buyer\_id | seller\_id |

+----------+------------+---------+----------+-----------+

| 1        | 2019-08-01 | 4       | 1        | 2         |

| 2        | 2019-08-02 | 2       | 1        | 3         |

| 3        | 2019-08-03 | 3       | 2        | 3         |

| 4        | 2019-08-04 | 1       | 4        | 2         |

| 5        | 2019-08-04 | 1       | 3        | 4         |

| 6        | 2019-08-05 | 2       | 2        | 4         |

+----------+------------+---------+----------+-----------+

Items table:

+---------+------------+

| item\_id | item\_brand |

+---------+------------+

| 1       | Samsung    |

| 2       | Lenovo     |

| 3       | LG         |

| 4       | HP         |

+---------+------------+

Result table:

+-----------+--------------------+

| seller\_id | 2nd\_item\_fav\_brand |

+-----------+--------------------+

| 1         | no                 |

| 2         | yes                |

| 3         | yes                |

| 4         | no                 |

+-----------+--------------------+

The answer for the user with id 1 is no because they sold nothing.

The answer for the users with id 2 and 3 is yes because the brands of their second sold items are their favorite brands.

The answer for the user with id 4 is no because the brand of their second sold item is not their favorite brand.

### [](#solution-68)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution- 1:

SELECT user\_id AS seller\_id,

       IF(ISNULL(item\_brand), "no", "yes") AS 2nd\_item\_fav\_brand

FROM Users LEFT JOIN

(SELECT seller\_id, item\_brand

FROM Orders INNER JOIN Items

ON Orders.item\_id \= Items.item\_id

WHERE (seller\_id, order\_date) IN

(SELECT seller\_id, MIN(order\_date) AS order\_date

 FROM Orders

 WHERE (seller\_id, order\_date) NOT IN

 (SELECT seller\_id, MIN(order\_date) FROM Orders GROUP BY seller\_id)

GROUP BY seller\_id)

 ) AS t

ON Users.user\_id \= t.seller\_id and favorite\_brand \= item\_brand

#Solution- 2:

WITH t1 AS(

SELECT user\_id,

CASE WHEN favorite\_brand \= item\_brand THEN "yes"

ELSE "no"

END AS 2nd\_item\_fav\_brand

FROM users u LEFT JOIN

(SELECT o.item\_id, seller\_id, item\_brand, RANK() OVER(PARTITION BY seller\_id ORDER BY order\_date) AS rk

FROM orders o join items i

USING (item\_id)) a

ON u.user\_id \= a.seller\_id

WHERE a.rk \= 2)

SELECT u.user\_id AS seller\_id, COALESCE(2nd\_item\_fav\_brand,"no") AS 2nd\_item\_fav\_brand

FROM users u LEFT JOIN t1

USING(user\_id)

[](#1164-product-price-at-a-given-date--medium---leetcode)1164\. Product Price at a Given Date | Medium | 🔒 [LeetCode](https://leetcode.com/problems/product-price-at-a-given-date)
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Products`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| product\_id    | int     |

| new\_price     | int     |

| change\_date   | date    |

+---------------+---------+

(product\_id, change\_date) is the primary key of this table.

Each row of this table indicates that the price of some product was changed to a new price at some date.

Write an SQL query to find the prices of all products on 2019-08-16. Assume the price of all products before any change is 10.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Products table:

+------------+-----------+-------------+

| product\_id | new\_price | change\_date |

+------------+-----------+-------------+

| 1          | 20        | 2019-08-14  |

| 2          | 50        | 2019-08-14  |

| 1          | 30        | 2019-08-15  |

| 1          | 35        | 2019-08-16  |

| 2          | 65        | 2019-08-17  |

| 3          | 20        | 2019-08-18  |

+------------+-----------+-------------+

Result table:

+------------+-------+

| product\_id | price |

+------------+-------+

| 2          | 50    |

| 1          | 35    |

| 3          | 10    |

+------------+-------+

### [](#solution-69)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution- 1:

WITH t1 AS (

SELECT a.product\_id, new\_price

FROM(

SELECT product\_id, max(change\_date) AS date

FROM products

WHERE change\_date<='2019-08-16'

GROUP BY product\_id) a

JOIN products p

ON a.product\_id \= p.product\_id AND a.date \= p.change\_date),

t2 AS (

SELECT distinct product\_id

	FROM products)

SELECT t2.product\_id, coalesce(new\_price,10) AS price

FROM t2 LEFT JOIN t1

ON t2.product\_id \= t1.product\_id

ORDER BY price DESC

#Solution- 2:

SELECT t1.product\_id AS product\_id, IF(ISNULL(t2.price), 10, t2.price) AS price

FROM

  (SELECT distinct product\_id

  FROM Products) AS t1 LEFT JOIN

  (SELECT product\_id, new\_price AS price

   FROM Products

   WHERE (product\_id, change\_date) in

      (SELECT product\_id, max(change\_date)

      FROM Products

      WHERE change\_date <='2019-08-16'

      GROUP BY product\_id)) AS t2

ON t1.product\_id \= t2.product\_id

[](#1173-immediate-food-delivery-i--easy---leetcode)1173\. Immediate Food Delivery I | Easy | 🔒 [LeetCode](https://leetcode.com/problems/immediate-food-delivery-i)
--------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Delivery`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-----------------------------+---------+

| Column Name                 | Type    |

+-----------------------------+---------+

| delivery\_id                 | int     |

| customer\_id                 | int     |

| order\_date                  | date    |

| customer\_pref\_delivery\_date | date    |

+-----------------------------+---------+

delivery\_id is the primary key of this table.

The table holds information about food delivery to customers that make orders at some date and specify a preferred delivery date (on the same order date or after it).

If the preferred delivery date of the customer is the same as the order date then the order is called immediate otherwise it's called scheduled.

Write an SQL query to find the percentage of immediate orders in the table, **rounded to 2 decimal places**.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Delivery table:

+-------------+-------------+------------+-----------------------------+

| delivery\_id | customer\_id | order\_date | customer\_pref\_delivery\_date |

+-------------+-------------+------------+-----------------------------+

| 1           | 1           | 2019-08-01 | 2019-08-02                  |

| 2           | 5           | 2019-08-02 | 2019-08-02                  |

| 3           | 1           | 2019-08-11 | 2019-08-11                  |

| 4           | 3           | 2019-08-24 | 2019-08-26                  |

| 5           | 4           | 2019-08-21 | 2019-08-22                  |

| 6           | 2           | 2019-08-11 | 2019-08-13                  |

+-------------+-------------+------------+-----------------------------+

Result table:

+----------------------+

| immediate\_percentage |

+----------------------+

| 33.33                |

+----------------------+

The orders with delivery id 2 and 3 are immediate while the others are scheduled.

### [](#solution-70)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution- 1:

SELECT

ROUND(SUM(CASE WHEN order\_date\=customer\_pref\_delivery\_date THEN 1 ELSE 0 END)/count(1)\*100, 2) immediate\_percentage

FROM Delivery;

#Solution- 2:

SELECT

ROUND(avg(CASE WHEN order\_date\=customer\_pref\_delivery\_date THEN 1 ELSE 0 END)\*100,2) AS immediate\_percentage

FROM delivery

[](#1174-immediate-food-delivery-ii--medium---leetcode)1174\. Immediate Food Delivery II | Medium | 🔒 [LeetCode](https://leetcode.com/problems/immediate-food-delivery-ii)
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Delivery`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-----------------------------+---------+

| Column Name                 | Type    |

+-----------------------------+---------+

| delivery\_id                 | int     |

| customer\_id                 | int     |

| order\_date                  | date    |

| customer\_pref\_delivery\_date | date    |

+-----------------------------+---------+

delivery\_id is the primary key of this table.

The table holds information about food delivery to customers that make orders at some date and specify a preferred delivery date (on the same order date or after it).

If the preferred delivery date of the customer is the same as the order date then the order is called immediate otherwise it's called scheduled.

The first order of a customer is the order with the earliest order date that customer made. It is guaranteed that a customer has exactly one first order.

Write an SQL query to find the percentage of immediate orders in the first orders of all customers, rounded to 2 decimal places.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Delivery table:

+-------------+-------------+------------+-----------------------------+

| delivery\_id | customer\_id | order\_date | customer\_pref\_delivery\_date |

+-------------+-------------+------------+-----------------------------+

| 1           | 1           | 2019-08-01 | 2019-08-02                  |

| 2           | 2           | 2019-08-02 | 2019-08-02                  |

| 3           | 1           | 2019-08-11 | 2019-08-12                  |

| 4           | 3           | 2019-08-24 | 2019-08-24                  |

| 5           | 3           | 2019-08-21 | 2019-08-22                  |

| 6           | 2           | 2019-08-11 | 2019-08-13                  |

| 7           | 4           | 2019-08-09 | 2019-08-09                  |

+-------------+-------------+------------+-----------------------------+

Result table:

+----------------------+

| immediate\_percentage |

+----------------------+

| 50.00                |

+----------------------+

The customer id 1 has a first order with delivery id 1 and it is scheduled.

The customer id 2 has a first order with delivery id 2 and it is immediate.

The customer id 3 has a first order with delivery id 5 and it is scheduled.

The customer id 4 has a first order with delivery id 7 and it is immediate.

Hence, half the customers have immediate first orders.

### [](#solution-71)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution- 1:

SELECT ROUND(SUM(CASE WHEN order\_date\=customer\_pref\_delivery\_date THEN 1 ELSE 0 END)/count(DISTINCT customer\_id)\*100, 2) immediate\_percentage

FROM Delivery

WHERE (customer\_id, order\_date) IN

    (SELECT customer\_id, MIN(order\_date)

    FROM Delivery

    GROUP BY customer\_id)

#Solution- 2:

SELECT ROUND(AVG(CASE WHEN order\_date \= customer\_pref\_delivery\_date THEN 1 ELSE 0 END)\*100,2) as

immediate\_percentage

FROM

(SELECT \*,

 RANK() OVER(PARTITION BY customer\_id ORDER BY order\_date) AS rk

FROM delivery) a

WHERE a.rk\=1

[](#1179-reformat-department-table--easy--leetcode)1179\. Reformat Department Table | Easy | [LeetCode](https://leetcode.com/problems/reformat-department-table/)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Department`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| id            | int     |

| revenue       | int     |

| month         | varchar |

+---------------+---------+

(id, month) is the primary key of this table.

The table has information about the revenue of each department per month.

The month has values in \["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"\].

Write an SQL query to reformat the table such that there is a department id column and a revenue column for each month.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Department table:

+------+---------+-------+

| id   | revenue | month |

+------+---------+-------+

| 1    | 8000    | Jan   |

| 2    | 9000    | Jan   |

| 3    | 10000   | Feb   |

| 1    | 7000    | Feb   |

| 1    | 6000    | Mar   |

+------+---------+-------+

Result table:

+------+-------------+-------------+-------------+-----+-------------+

| id   | Jan\_Revenue | Feb\_Revenue | Mar\_Revenue | ... | Dec\_Revenue |

+------+-------------+-------------+-------------+-----+-------------+

| 1    | 8000        | 7000        | 6000        | ... | null        |

| 2    | 9000        | null        | null        | ... | null        |

| 3    | null        | 10000       | null        | ... | null        |

+------+-------------+-------------+-------------+-----+-------------+

Note that the result table has 13 columns (1 for the department id + 12 for the months).

### [](#solution-72)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT id,

SUM(IF(month\='Jan', revenue, NULL)) AS Jan\_Revenue,

SUM(IF(month\='Feb', revenue, NULL)) AS Feb\_Revenue,

SUM(IF(month\='Mar', revenue, NULL)) AS Mar\_Revenue,

SUM(IF(month\='Apr', revenue, NULL)) AS Apr\_Revenue,

SUM(IF(month\='May', revenue, NULL)) AS May\_Revenue,

SUM(IF(month\='Jun', revenue, NULL)) AS Jun\_Revenue,

SUM(IF(month\='Jul', revenue, NULL)) AS Jul\_Revenue,

SUM(IF(month\='Aug', revenue, NULL)) AS Aug\_Revenue,

SUM(IF(month\='Sep', revenue, NULL)) AS Sep\_Revenue,

SUM(IF(month\='Oct', revenue, NULL)) AS Oct\_Revenue,

SUM(IF(month\='Nov', revenue, NULL)) AS Nov\_Revenue,

SUM(IF(month\='Dec', revenue, NULL)) AS Dec\_Revenue

FROM Department

Group BY id;

[](#1193-monthly-transactions-i--medium---leetcode)1193\. Monthly Transactions I | Medium | 🔒 [LeetCode](https://leetcode.com/problems/monthly-transactions-i)
---------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Transactions`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| id            | int     |

| country       | varchar |

| state         | enum    |

| amount        | int     |

| trans\_date    | date    |

+---------------+---------+

id is the primary key of this table.

The table has information about incoming transactions.

The state column is an enum of type \["approved", "declined"\].

Write an SQL query to find for each month and country, the number of transactions and their total amount, the number of approved transactions and their total amount.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Transactions table:

+------+---------+----------+--------+------------+

| id   | country | state    | amount | trans\_date |

+------+---------+----------+--------+------------+

| 121  | US      | approved | 1000   | 2018-12-18 |

| 122  | US      | declined | 2000   | 2018-12-19 |

| 123  | US      | approved | 2000   | 2019-01-01 |

| 124  | DE      | approved | 2000   | 2019-01-07 |

+------+---------+----------+--------+------------+

Result table:

+----------+---------+-------------+----------------+--------------------+-----------------------+

| month    | country | trans\_count | approved\_count | trans\_total\_amount | approved\_total\_amount |

+----------+---------+-------------+----------------+--------------------+-----------------------+

| 2018-12  | US      | 2           | 1              | 3000               | 1000                  |

| 2019-01  | US      | 1           | 1              | 2000               | 2000                  |

| 2019-01  | DE      | 1           | 1              | 2000               | 2000                  |

+----------+---------+-------------+----------------+--------------------+-----------------------+

### [](#solution-73)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

WITH t1 AS(

SELECT DATE\_FORMAT(trans\_date,'%Y-%m') AS month, country, COUNT(state) AS trans\_count, sum(amount) AS trans\_total\_amount

FROM transactions

GROUP BY country, month(trans\_date)),

t2 AS (

SELECT DATE\_FORMAT(trans\_date,'%Y-%m') AS month, country, COUNT(state) AS approved\_count, sum(amount) AS approved\_total\_amount

FROM transactions

WHERE state \= 'approved'

GROUP BY country, month(trans\_date))

SELECT t1.month, t1.country, COALESCE(t1.trans\_count,0) AS trans\_count, COALESCE(t2.approved\_count,0) AS approved\_count, COALESCE(t1.trans\_total\_amount,0) AS trans\_total\_amount, COALESCE(t2.approved\_total\_amount,0) AS approved\_total\_amount

FROM t1 LEFT JOIN t2

ON t1.country \= t2.country and t1.month \= t2.month

[](#1194-tournament-winners--hard---leetcode)1194\. Tournament Winners | Hard | 🔒 [LeetCode](https://leetcode.com/problems/tournament-winners)
-----------------------------------------------------------------------------------------------------------------------------------------------

Table: `Players`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+-------+

| Column Name | Type  |

+-------------+-------+

| player\_id   | int   |

| group\_id    | int   |

+-------------+-------+

player\_id is the primary key of this table.

Each row of this table indicates the group of each player.

Table: `Matches`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| match\_id      | int     |

| first\_player  | int     |

| second\_player | int     |

| first\_score   | int     |

| second\_score  | int     |

+---------------+---------+

match\_id is the primary key of this table.

Each row is a record of a match, first\_player and second\_player contain the player\_id of each match.

first\_score and second\_score contain the number of points of the first\_player and second\_player respectively.

You may assume that, in each match, players belongs to the same group.

The winner in each group is the player who scored the maximum total points within the group. In the case of a tie, the lowest player\_id wins.

Write an SQL query to find the winner in each group.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Players table:

+-----------+------------+

| player\_id | group\_id   |

+-----------+------------+

| 15        | 1          |

| 25        | 1          |

| 30        | 1          |

| 45        | 1          |

| 10        | 2          |

| 35        | 2          |

| 50        | 2          |

| 20        | 3          |

| 40        | 3          |

+-----------+------------+

Matches table:

+------------+--------------+---------------+-------------+--------------+

| match\_id   | first\_player | second\_player | first\_score | second\_score |

+------------+--------------+---------------+-------------+--------------+

| 1          | 15           | 45            | 3           | 0            |

| 2          | 30           | 25            | 1           | 2            |

| 3          | 30           | 15            | 2           | 0            |

| 4          | 40           | 20            | 5           | 2            |

| 5          | 35           | 50            | 1           | 1            |

+------------+--------------+---------------+-------------+--------------+

Result table:

+-----------+------------+

| group\_id  | player\_id  |

+-----------+------------+

| 1         | 15         |

| 2         | 35         |

| 3         | 40         |

+-----------+------------+

### [](#solution-74)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

WITH t1 AS(

SELECT first\_player, SUM(first\_score) AS total

FROM

(SELECT first\_player, first\_score

FROM matches

UNION ALL

SELECT second\_player, second\_score

FROM matches) a

GROUP BY 1),

t2 AS(

SELECT \*, COALESCE(total,0) AS score

FROM players p LEFT JOIN t1

ON p.player\_id \= t1.first\_player)

SELECT group\_id, player\_id

FROM

(SELECT \*, ROW\_NUMBER() OVER(PARTITION BY group\_id ORDER BY group\_id, score DESC) AS rn

FROM t2) b

WHERE b.rn \= 1

[](#1204-last-person-to-fit-in-the-elevator--medium---leetcode)1204\. Last Person to Fit in the Elevator | Medium | 🔒 [LeetCode](https://leetcode.com/problems/last-person-to-fit-in-the-elevator)
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Queue`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| person\_id   | int     |

| person\_name | varchar |

| weight      | int     |

| turn        | int     |

+-------------+---------+

person\_id is the primary key column for this table.

This table has the information about all people waiting for an elevator.

The person\_id and turn columns will contain all numbers from 1 to n, where n is the number of rows in the table.

The maximum weight the elevator can hold is 1000.

Write an SQL query to find the person\_name of the last person who will fit in the elevator without exceeding the weight limit. It is guaranteed that the person who is first in the queue can fit in the elevator.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Queue table

+-----------+-------------------+--------+------+

| person\_id | person\_name       | weight | turn |

+-----------+-------------------+--------+------+

| 5         | George Washington | 250    | 1    |

| 3         | John Adams        | 350    | 2    |

| 6         | Thomas Jefferson  | 400    | 3    |

| 2         | Will Johnliams    | 200    | 4    |

| 4         | Thomas Jefferson  | 175    | 5    |

| 1         | James Elephant    | 500    | 6    |

+-----------+-------------------+--------+------+

Result table

+-------------------+

| person\_name       |

+-------------------+

| Thomas Jefferson  |

+-------------------+

Queue table is ordered by turn in the example for simplicity.

In the example George Washington(id 5), John Adams(id 3) and Thomas Jefferson(id 6) will enter the elevator as their weight sum is 250 + 350 + 400 = 1000.

Thomas Jefferson(id 6) is the last person to fit in the elevator because he has the last turn in these three people.

### [](#solution-75)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

WITH t1 AS

(

SELECT \*,

SUM(weight) OVER(ORDER BY turn) AS cum\_weight

FROM queue

ORDER BY turn)

SELECT t1.person\_name

FROM t1

WHERE turn \= (SELECT MAX(turn) FROM t1 WHERE t1.cum\_weight<=1000)

[](#1205-monthly-transactions-ii--medium---leetcode)1205\. Monthly Transactions II | Medium | 🔒 [LeetCode](https://leetcode.com/problems/monthly-transactions-ii)
------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Transactions`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----------------+---------+

| Column Name    | Type    |

+----------------+---------+

| id             | int     |

| country        | varchar |

| state          | enum    |

| amount         | int     |

| trans\_date     | date    |

+----------------+---------+

id is the primary key of this table.

The table has information about incoming transactions.

The state column is an enum of type \["approved", "declined"\].

Table: `Chargebacks`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----------------+---------+

| Column Name    | Type    |

+----------------+---------+

| trans\_id       | int     |

| charge\_date    | date    |

+----------------+---------+

Chargebacks contains basic information regarding incoming chargebacks from some transactions placed in Transactions table.

trans\_id is a foreign key to the id column of Transactions table.

Each chargeback corresponds to a transaction made previously even if they were not approved.

Write an SQL query to find for each month and country, the number of approved transactions and their total amount, the number of chargebacks and their total amount.

Note: In your query, given the month and country, ignore rows with all zeros.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Transactions table:

+------+---------+----------+--------+------------+

| id   | country | state    | amount | trans\_date |

+------+---------+----------+--------+------------+

| 101  | US      | approved | 1000   | 2019-05-18 |

| 102  | US      | declined | 2000   | 2019-05-19 |

| 103  | US      | approved | 3000   | 2019-06-10 |

| 104  | US      | approved | 4000   | 2019-06-13 |

| 105  | US      | approved | 5000   | 2019-06-15 |

+------+---------+----------+--------+------------+

Chargebacks table:

+------------+------------+

| trans\_id   | trans\_date |

+------------+------------+

| 102        | 2019-05-29 |

| 101        | 2019-06-30 |

| 105        | 2019-09-18 |

+------------+------------+

Result table:

+----------+---------+----------------+-----------------+-------------------+--------------------+

| month    | country | approved\_count | approved\_amount | chargeback\_count  | chargeback\_amount  |

+----------+\`---------+----------------+-----------------+-------------------+--------------------+

| 2019-05  | US      | 1              | 1000            | 1                 | 2000               |

| 2019-06  | US      | 3              | 12000           | 1                 | 1000               |

| 2019-09  | US      | 0              | 0               | 1                 | 5000               |

+----------+---------+----------------+-----------------+-------------------+--------------------+

### [](#solution-76)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

WITH t1 AS

(SELECT country, extract('month' FROM trans\_date), state, COUNT(\*) AS approved\_count, SUM(amount) AS approved\_amount

FROM transactions

WHERE state \= 'approved'

GROUP BY 1, 2, 3),

t2 AS(

SELECT t.country, extract('month' FROM c.trans\_date), SUM(amount) AS chargeback\_amount, COUNT(\*) AS chargeback\_count

FROM chargebacks c LEFT JOIN transactions t

ON trans\_id \= id

GROUP BY t.country, extract('month' FROM c.trans\_date)),

t3 AS(

SELECT t2.date\_part, t2.country, COALESCE(approved\_count,0) AS approved\_count, COALESCE(approved\_amount,0) AS approved\_amount, COALESCE(chargeback\_count,0) AS chargeback\_count, COALESCE(chargeback\_amount,0) AS chargeback\_amount

FROM t2 LEFT JOIN t1

ON t2.date\_part \= t1.date\_part AND t2.country \= t1.country),

t4 AS(

SELECT t1.date\_part, t1.country, COALESCE(approved\_count,0) AS approved\_count, COALESCE(approved\_amount,0) AS approved\_amount, COALESCE(chargeback\_count,0) AS chargeback\_count, COALESCE(chargeback\_amount,0) AS chargeback\_amount

FROM t2 RIGHT JOIN t1

ON t2.date\_part \= t1.date\_part AND t2.country \= t1.country)

SELECT \*

FROM t3

UNION

SELECT \*

FROM t4

#Solution 2:

SELECT month, country,

    SUM(CASE WHEN type\='approved' THEN 1 ELSE 0 END) AS approved\_count,

    SUM(CASE WHEN type\='approved' THEN amount ELSE 0 END) AS approved\_amount,

    SUM(CASE WHEN type\='chargeback' THEN 1 ELSE 0 END) AS chargeback\_count,

    SUM(CASE WHEN type\='chargeback' THEN amount ELSE 0 END) AS chargeback\_amount

FROM (

    (

    SELECT left(t.trans\_date, 7) AS month, t.country, amount,'approved' AS type

    FROM Transactions AS t

    WHERE state\='approved'

    )

    UNION ALL (

    SELECT left(c.trans\_date, 7) AS month, t.country, amount,'chargeback' AS type

    FROM Transactions AS t JOIN Chargebacks AS c

    ON t.id \= c.trans\_id

    )

) AS tt

GROUP BY tt.month, tt.country

#Solution 3:

SELECT month, country,

    SUM(CASE WHEN type\='approved' THEN count ELSE 0 END) AS approved\_count,

    SUM(CASE WHEN type\='approved' THEN amount ELSE 0 END) AS approved\_amount,

    SUM(CASE WHEN type\='chargeback' THEN count ELSE 0 END) AS chargeback\_count,

    SUM(CASE WHEN type\='chargeback' THEN amount ELSE 0 END) AS chargeback\_amount

FROM (

    (

    SELECT LEFT(t.trans\_date, 7) AS month, t.country,

    COUNT(1) AS count, SUM(amount) AS amount,'approved' AS type

    FROM Transactions AS t LEFT JOIN Chargebacks AS c

    ON t.id \= c.trans\_id

    WHERE state\='approved'

    GROUP BY LEFT(t.trans\_date, 7), t.country

    )

    union (

    SELECT LEFT(c.trans\_date, 7) AS month, t.country,

        COUNT(1) AS count, SUM(amount) AS amount,'chargeback' AS type

    FROM Transactions AS t JOIN Chargebacks AS c

    ON t.id \= c.trans\_id

    GROUP BY LEFT(c.trans\_date, 7), t.country

    )

) AS tt

GROUP BY tt.month, tt.country

[](#1211-queries-quality-and-percentage--easy---leetcode)1211\. Queries Quality and Percentage | Easy | 🔒 [LeetCode](https://leetcode.com/problems/queries-quality-and-percentage)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Queries`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| query\_name  | varchar |

| result      | varchar |

| position    | int     |

| rating      | int     |

+-------------+---------+

There is no primary key for this table, it may have duplicate rows.

This table contains information collected from some queries on a database.

The position column has a value from 1 to 500.

The rating column has a value from 1 to 5. Query with rating less than 3 is a poor query.

We define query `quality` as:

*   The average of the ratio between query rating and its position.

We also define `poor query percentage` as:

*   The percentage of all queries with rating less than 3.

Write an SQL query to find each `query_name`, the `quality` and `poor_query_percentage`.

Both `quality` and `poor_query_percentage` should be rounded to **2 decimal places**.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Queries table:

+------------+-------------------+----------+--------+

| query\_name | result            | position | rating |

+------------+-------------------+----------+--------+

| Dog        | Golden Retriever  | 1        | 5      |

| Dog        | German Shepherd   | 2        | 5      |

| Dog        | Mule              | 200      | 1      |

| Cat        | Shirazi           | 5        | 2      |

| Cat        | Siamese           | 3        | 3      |

| Cat        | Sphynx            | 7        | 4      |

+------------+-------------------+----------+--------+

Result table:

+------------+---------+-----------------------+

| query\_name | quality | poor\_query\_percentage |

+------------+---------+-----------------------+

| Dog        | 2.50    | 33.33                 |

| Cat        | 0.66    | 33.33                 |

+------------+---------+-----------------------+

Dog queries quality is ((5 / 1) + (5 / 2) + (1 / 200)) / 3 = 2.50

Dog queries poor\_ query\_percentage is (1 / 3) \* 100 = 33.33

Cat queries quality equals ((2 / 5) + (3 / 3) + (4 / 7)) / 3 = 0.66

Cat queries poor\_ query\_percentage is (1 / 3) \* 100 = 33.33

### [](#solution-77)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

SELECT query\_name, ROUND(SUM(rating/position)/COUNT(\*),2) AS quality,

ROUND(AVG(CASE WHEN rating<3 THEN 1 ELSE 0 END)\*100,2) AS poor\_query\_percentage

FROM queries

GROUP BY query\_name

#Solution 2:

SELECT query\_name, ROUND(AVG(rating/position), 2) AS quality,

       ROUND(100\*SUM(CASE WHEN rating<3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS poor\_query\_percentage

FROM Queries

GROUP BY query\_name

[](#1212-team-scores-in-football-tournament--medium---leetcode)1212\. Team Scores in Football Tournament | Medium | 🔒 [LeetCode](https://leetcode.com/problems/team-scores-in-football-tournament)
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Teams`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+----------+

| Column Name   | Type     |

+---------------+----------+

| team\_id       | int      |

| team\_name     | varchar  |

+---------------+----------+

team\_id is the primary key of this table.

Each row of this table represents a single football team.

Table: `Matches`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| match\_id      | int     |

| host\_team     | int     |

| guest\_team    | int     |

| host\_goals    | int     |

| guest\_goals   | int     |

+---------------+---------+

match\_id is the primary key of this table.

Each row is a record of a finished match between two different teams.

Teams host\_team and guest\_team are represented by their IDs in the teams table (team\_id) and they scored host\_goals and guest\_goals goals respectively.

You would like to compute the scores of all teams after all matches. Points are awarded as follows:

*   A team receives three points if they win a match (Score strictly more goals than the opponent team).
    
*   A team receives one point if they draw a match (Same number of goals as the opponent team).
    
*   A team receives no points if they lose a match (Score less goals than the opponent team).
    
    Write an SQL query that selects the team\_id, team\_name and num\_points of each team in the tournament after all described matches. Result table should be ordered by num\_points (decreasing order). In case of a tie, order the records by team\_id (increasing order).
    

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Teams table:

+-----------+--------------+

| team\_id   | team\_name    |

+-----------+--------------+

| 10        | Leetcode FC  |

| 20        | NewYork FC   |

| 30        | Atlanta FC   |

| 40        | Chicago FC   |

| 50        | Toronto FC   |

+-----------+--------------+

Matches table:

+------------+--------------+---------------+-------------+--------------+

| match\_id   | host\_team    | guest\_team    | host\_goals  | guest\_goals  |

+------------+--------------+---------------+-------------+--------------+

| 1          | 10           | 20            | 3           | 0            |

| 2          | 30           | 10            | 2           | 2            |

| 3          | 10           | 50            | 5           | 1            |

| 4          | 20           | 30            | 1           | 0            |

| 5          | 50           | 30            | 1           | 0            |

+------------+--------------+---------------+-------------+--------------+

Result table:

+------------+--------------+---------------+

| team\_id    | team\_name    | num\_points    |

+------------+--------------+---------------+

| 10         | Leetcode FC  | 7             |

| 20         | NewYork FC   | 3             |

| 50         | Toronto FC   | 3             |

| 30         | Atlanta FC   | 1             |

| 40         | Chicago FC   | 0             |

+------------+--------------+---------------+

### [](#solution-78)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

SELECT Teams.team\_id, Teams.team\_name,

    SUM(CASE WHEN team\_id\=host\_team AND host\_goals\>guest\_goals THEN 3 ELSE 0 END) +

    SUM(CASE WHEN team\_id\=host\_team AND host\_goals\=guest\_goals THEN 1 ELSE 0 END) +

    SUM(CASE WHEN team\_id\=guest\_team AND host\_goals<guest\_goals THEN 3 ELSE 0 END) +

    SUM(CASE WHEN team\_id\=guest\_team AND host\_goals\=guest\_goals THEN 1 ELSE 0 END) AS num\_points

FROM Teams LEFT JOIN Matches

ON Teams.team\_id \= Matches.host\_team OR Teams.team\_id \= Matches.guest\_team

GROUP BY Teams.team\_id

ORDER BY num\_points DESC, Teams.team\_id ASC

#Solution 2:

SELECT Teams.team\_id, Teams.team\_name, SUM(if(isnull(num\_points), 0, num\_points)) AS num\_points

FROM Teams LEFT JOIN

    (

        SELECT host\_team AS team\_id,

            SUM(CASE WHEN host\_goals\>guest\_goals THEN 3

                     WHEN host\_goals\=guest\_goals THEN 1

                     ELSE 0 END) AS num\_points

        FROM Matches

        GROUP BY host\_team

        UNION ALL

        SELECT guest\_team AS team\_id,

            SUM(CASE WHEN host\_goals<guest\_goals THEN 3

                     WHEN host\_goals\=guest\_goals THEN 1

                     ELSE 0 END) AS num\_points

        FROM Matches

        GROUP BY guest\_team

    ) AS tt

ON Teams.team\_id \= tt.team\_id

GROUP BY Teams.team\_id

ORDER BY num\_points DESC, Teams.team\_id ASC

#Solution 3:

SELECT Teams.team\_id, Teams.team\_name, IFNULL(SUM(num\_points), 0) AS num\_points

FROM Teams LEFT JOIN

    (

        SELECT host\_team AS team\_id,

            SUM(CASE WHEN host\_goals\>guest\_goals THEN 3

                     WHEN host\_goals\=guest\_goals THEN 1

                     ELSE 0 END) AS num\_points

        FROM Matches

        GROUP BY host\_team

        UNION ALL

        SELECT guest\_team AS team\_id,

            SUM(CASE WHEN host\_goals<guest\_goals THEN 3

                     WHEN host\_goals\=guest\_goals THEN 1

                     ELSE 0 END) AS num\_points

        FROM Matches

        GROUP BY guest\_team

    ) AS tt

ON Teams.team\_id \= tt.team\_id

GROUP BY Teams.team\_id

ORDER BY num\_points DESC, Teams.team\_id ASC

#Solution 4:

WITH t1 AS(

SELECT c.host\_id, c.host\_name, c.host\_points

FROM(

SELECT a.match\_id, a.team\_id AS host\_id, a.team\_name AS host\_name, b.team\_id AS guest\_id, b.team\_name AS guest\_name, a.host\_goals, a.guest\_goals,

CASE WHEN a.host\_goals \> a.guest\_goals THEN 3

     WHEN a.host\_goals \= a.guest\_goals THEN 1

     ELSE 0 END AS host\_points,

CASE WHEN a.host\_goals < a.guest\_goals THEN 3

     WHEN a.host\_goals \= a.guest\_goals THEN 1

     ELSE 0 END AS guest\_points

FROM(

SELECT \*

FROM matches m

JOIN teams t

ON t.team\_id \= m.host\_team) a

JOIN

(SELECT \*

FROM matches m

JOIN teams t

ON t.team\_id \= m.guest\_team) b

ON a.match\_id \= b.match\_id) c

UNION ALL

SELECT d.guest\_id, d.guest\_name, d.guest\_points

FROM(

SELECT a.match\_id, a.team\_id AS host\_id, a.team\_name AS host\_name, b.team\_id AS guest\_id, b.team\_name AS guest\_name, a.host\_goals, a.guest\_goals,

CASE WHEN a.host\_goals \> a.guest\_goals THEN 3

     WHEN a.host\_goals \= a.guest\_goals THEN 1

     ELSE 0 END AS host\_points,

CASE WHEN a.host\_goals < a.guest\_goals THEN 3

     WHEN a.host\_goals \= a.guest\_goals THEN 1

     ELSE 0 END AS guest\_points

FROM(

SELECT \*

FROM matches m

JOIN teams t

ON t.team\_id \= m.host\_team) a

JOIN

(SELECT \*

FROM matches m

JOIN teams t

ON t.team\_id \= m.guest\_team) b

ON a.match\_id \= b.match\_id) d)

SELECT team\_id, team\_name, coalesce(total,0) AS num\_points

FROM teams t2

LEFT JOIN(

SELECT host\_id, host\_name, SUM(host\_points) AS total

FROM t1

GROUP BY host\_id, host\_name) e

ON t2.team\_id \= e.host\_id

ORDER BY num\_points DESC, team\_id

[](#1225-report-contiguous-dates--hard---leetcode)1225\. Report Contiguous Dates | Hard | 🔒 [LeetCode](https://leetcode.com/problems/report-contiguous-dates)
--------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Failed`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+---------+

| Column Name  | Type    |

+--------------+---------+

| fail\_date    | date    |

+--------------+---------+

Primary key for this table is fail\_date.

Failed table contains the days of failed tasks.

Table: `Succeeded`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+---------+

| Column Name  | Type    |

+--------------+---------+

| success\_date | date    |

+--------------+---------+

Primary key for this table is success\_date.

Succeeded table contains the days of succeeded tasks.

A system is running one task every day. Every task is independent of the previous tasks. The tasks can fail or succeed.

Write an SQL query to generate a report of period\_state for each continuous interval of days in the period from 2019-01-01 to 2019-12-31.

period\_state is 'failed' if tasks in this interval failed or 'succeeded' if tasks in this interval succeeded. Interval of days are retrieved as start\_date and end\_date.

Order result by start\_date.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Failed table:

+-------------------+

| fail\_date         |

+-------------------+

| 2018-12-28        |

| 2018-12-29        |

| 2019-01-04        |

| 2019-01-05        |

+-------------------+

Succeeded table:

+-------------------+

| success\_date      |

+-------------------+

| 2018-12-30        |

| 2018-12-31        |

| 2019-01-01        |

| 2019-01-02        |

| 2019-01-03        |

| 2019-01-06        |

+-------------------+

Result table:

+--------------+--------------+--------------+

| period\_state | start\_date   | end\_date     |

+--------------+--------------+--------------+

| succeeded    | 2019-01-01   | 2019-01-03   |

| failed       | 2019-01-04   | 2019-01-05   |

| succeeded    | 2019-01-06   | 2019-01-06   |

+--------------+--------------+--------------+

The report ignored the system state in 2018 as we care about the system in the period 2019-01-01 to 2019-12-31.

From 2019-01-01 to 2019-01-03 all tasks succeeded and the system state was "succeeded".

From 2019-01-04 to 2019-01-05 all tasks failed and system state was "failed".

From 2019-01-06 to 2019-01-06 all tasks succeeded and system state was "succeeded".

### [](#solution-79)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

WITH t1 AS(

SELECT MIN(success\_date) AS start\_date, MAX(success\_date) AS end\_date, state

FROM(

SELECT \*, date\_sub(success\_date, interval ROW\_NUMBER() OVER(ORDER BY success\_date) day) AS diff, 1 AS state

FROM succeeded

WHERE success\_date BETWEEN "2019-01-01" AND "2019-12-31") a

GROUP BY diff),

t2 AS(

SELECT MIN(fail\_date) AS start\_date, MAX(fail\_date) AS end\_date, state

FROM(

SELECT \*, date\_sub(fail\_date, interval ROW\_NUMBER() OVER(ORDER BY fail\_date) day) AS diff, 0 AS state

FROM failed

WHERE fail\_date BETWEEN "2019-01-01" AND "2019-12-31") b

GROUP BY diff)

SELECT

CASE WHEN c.state \= 1 THEN "succeeded"

ELSE "failed"

END AS period\_state,start\_date, end\_date

FROM(

SELECT \*

FROM t1

UNION ALL

SELECT \*

FROM t2) c

ORDER BY start\_date

#Solution 2:

\## First generate a list of dates

\##   succeeded 2019-01-01

\##   succeeded 2019-01-02

\##   ...

\##   failed 2019-01-04

\##   ...

\## Add group id for contiguous ranges

\## Notice: dates themselves are contiguous

##

SELECT period\_state, MIN(date) AS start\_date, MAX(date) AS end\_date

FROM (

    SELECT period\_state, date,

         @rank :\= CASE WHEN @prev \= period\_state THEN @rank ELSE @rank+1 END AS rank,

         @prev :\= period\_state AS prev

    FROM (

        SELECT 'failed' AS period\_state, fail\_date AS date

        FROM Failed

        WHERE fail\_date BETWEEN '2019-01-01' AND '2019-12-31'

        UNION

        SELECT 'succeeded' AS period\_state, success\_date AS date

        FROM Succeeded

        WHERE success\_date BETWEEN '2019-01-01' AND '2019-12-31') AS t,

        (SELECT @rank:\=0, @prev:\='') AS rows

    ORDER BY date ASC) AS tt

GROUP BY rank

ORDER BY rank

[](#1241-number-of-comments-per-post--easy---leetcode)1241\. Number of Comments per Post | Easy | 🔒 [LeetCode](https://leetcode.com/problems/number-of-comments-per-post)
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Submissions`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+----------+

| Column Name   | Type     |

+---------------+----------+

| sub\_id        | int      |

| parent\_id     | int      |

+---------------+----------+

There is no primary key for this table, it may have duplicate rows.

Each row can be a post or comment on the post.

parent\_id is null for posts.

parent\_id for comments is sub\_id for another post in the table.

Write an SQL query to find number of comments per each post.

Result table should contain `post_id` and its corresponding `number_of_comments`, and must be sorted by `post_id` in ascending order.

`Submissions` may contain duplicate comments. You should count the number of unique comments per post.

`Submissions` may contain duplicate posts. You should treat them as one post.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Submissions table:

+---------+------------+

| sub\_id  | parent\_id  |

+---------+------------+

| 1       | Null       |

| 2       | Null       |

| 1       | Null       |

| 12      | Null       |

| 3       | 1          |

| 5       | 2          |

| 3       | 1          |

| 4       | 1          |

| 9       | 1          |

| 10      | 2          |

| 6       | 7          |

+---------+------------+

Result table:

+---------+--------------------+

| post\_id | number\_of\_comments |

+---------+--------------------+

| 1       | 3                  |

| 2       | 2                  |

| 12      | 0                  |

+---------+--------------------+

The post with id 1 has three comments in the table with id 3, 4 and 9. The comment with id 3 is repeated in the table, we counted it only once.

The post with id 2 has two comments in the table with id 5 and 10.

The post with id 12 has no comments in the table.

The comment with id 6 is a comment on a deleted post with id 7 so we ignored it.

### [](#solution-80)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT a.sub\_id AS post\_id, coalesce(b.number\_of\_comments,0) AS number\_of\_comments

FROM(

SELECT DISTINCT sub\_id FROM submissions WHERE parent\_id IS NULL) a

LEFT JOIN(

SELECT parent\_id, count(DISTINCT(sub\_id)) AS number\_of\_comments

FROM submissions

GROUP BY parent\_id

HAVING parent\_id \= any(SELECT sub\_id from submissions WHERE parent\_id IS NULL)) b

ON a.sub\_id \= b.parent\_id

ORDER BY post\_id

[](#1251-average-selling-price--easy---leetcode)1251\. Average Selling Price | Easy | 🔒 [LeetCode](https://leetcode.com/problems/average-selling-price)
--------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Prices`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| product\_id    | int     |

| start\_date    | date    |

| end\_date      | date    |

| price         | int     |

+---------------+---------+

(product\_id, start\_date, end\_date) is the primary key for this table.

Each row of this table indicates the price of the product\_id in the period from start\_date to end\_date.

For each product\_id there will be no two overlapping periods. That means there will be no two intersecting periods for the same product\_id.

Table: `UnitsSold`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| product\_id    | int     |

| purchase\_date | date    |

| units         | int     |

+---------------+---------+

There is no primary key for this table, it may contain duplicates.

Each row of this table indicates the date, units and product\_id of each product sold.

Write an SQL query to find the average selling price for each product.

average\_price should be rounded to 2 decimal places.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Prices table:

+------------+------------+------------+--------+

| product\_id | start\_date | end\_date   | price  |

+------------+------------+------------+--------+

| 1          | 2019-02-17 | 2019-02-28 | 5      |

| 1          | 2019-03-01 | 2019-03-22 | 20     |

| 2          | 2019-02-01 | 2019-02-20 | 15     |

| 2          | 2019-02-21 | 2019-03-31 | 30     |

+------------+------------+------------+--------+

UnitsSold table:

+------------+---------------+-------+

| product\_id | purchase\_date | units |

+------------+---------------+-------+

| 1          | 2019-02-25    | 100   |

| 1          | 2019-03-01    | 15    |

| 2          | 2019-02-10    | 200   |

| 2          | 2019-03-22    | 30    |

+------------+---------------+-------+

Result table:

+------------+---------------+

| product\_id | average\_price |

+------------+---------------+

| 1          | 6.96          |

| 2          | 16.96         |

+------------+---------------+

Average selling price = Total Price of Product / Number of products sold.

Average selling price for product 1 = ((100 \* 5) + (15 \* 20)) / 115 = 6.96

Average selling price for product 2 = ((200 \* 15) + (30 \* 30)) / 230 = 16.96

### [](#solution-81)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT UnitsSold.product\_id, ROUND(SUM(units\*price)/SUM(units), 2) AS average\_price

FROM UnitsSold INNER JOIN Prices

ON UnitsSold.product\_id \= Prices.product\_id

AND UnitsSold.purchase\_date BETWEEN Prices.start\_date AND Prices.end\_date

GROUP BY UnitsSold.product\_id

[](#1264-page-recommendations--medium---leetcode)1264\. Page Recommendations | Medium | 🔒 [LeetCode](https://leetcode.com/problems/page-recommendations)
---------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Friendship`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| user1\_id      | int     |

| user2\_id      | int     |

+---------------+---------+

(user1\_id, user2\_id) is the primary key for this table.

Each row of this table indicates that there is a friendship relation between user1\_id and user2\_id.

Table: `Likes`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| user\_id     | int     |

| page\_id     | int     |

+-------------+---------+

(user\_id, page\_id) is the primary key for this table.

Each row of this table indicates that user\_id likes page\_id.

Write an SQL query to recommend pages to the user with `user_id` = 1 using the pages that your friends liked. It should not recommend pages you already liked.

Return result table in any order without duplicates.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Friendship table:

+----------+----------+

| user1\_id | user2\_id |

+----------+----------+

| 1        | 2        |

| 1        | 3        |

| 1        | 4        |

| 2        | 3        |

| 2        | 4        |

| 2        | 5        |

| 6        | 1        |

+----------+----------+

Likes table:

+---------+---------+

| user\_id | page\_id |

+---------+---------+

| 1       | 88      |

| 2       | 23      |

| 3       | 24      |

| 4       | 56      |

| 5       | 11      |

| 6       | 33      |

| 2       | 77      |

| 3       | 77      |

| 6       | 88      |

+---------+---------+

Result table:

+------------------+

| recommended\_page |

+------------------+

| 23               |

| 24               |

| 56               |

| 33               |

| 77               |

+------------------+

User one is friend with users 2, 3, 4 and 6.

Suggested pages are 23 from user 2, 24 from user 3, 56 from user 3 and 33 from user 6.

Page 77 is suggested from both user 2 and user 3.

Page 88 is not suggested because user 1 already likes it.

### [](#solution-82)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT DISTINCT page\_id AS recommended\_page

FROM Likes

WHERE user\_id IN (SELECT user2\_id

    FROM Friendship

    WHERE user1\_id\=1

    UNION

    SELECT user1\_id

    FROM Friendship

    WHERE user2\_id\=1)

    AND page\_id NOT IN

        (SELECT page\_id

        FROM Likes

        WHERE user\_id\=1)

[](#1270-all-people-report-to-the-given-manager--medium---leetcode)1270\. All People Report to the Given Manager | Medium | 🔒 [LeetCode](https://leetcode.com/problems/all-people-report-to-the-given-manager)
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Employees`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| employee\_id   | int     |

| employee\_name | varchar |

| manager\_id    | int     |

+---------------+---------+

employee\_id is the primary key for this table.

Each row of this table indicates that the employee with ID employee\_id and name employee\_name reports his work to his/her direct manager with manager\_id

The head of the company is the employee with employee\_id = 1.

Write an SQL query to find `employee_id` of all employees that directly or indirectly report their work to the head of the company.

The indirect relation between managers will not exceed 3 managers as the company is small.

Return result table in any order without duplicates.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Employees table:

+-------------+---------------+------------+

| employee\_id | employee\_name | manager\_id |

+-------------+---------------+------------+

| 1           | Boss          | 1          |

| 3           | Alice         | 3          |

| 2           | Bob           | 1          |

| 4           | Daniel        | 2          |

| 7           | Luis          | 4          |

| 8           | Jhon          | 3          |

| 9           | Angela        | 8          |

| 77          | Robert        | 1          |

+-------------+---------------+------------+

Result table:

+-------------+

| employee\_id |

+-------------+

| 2           |

| 77          |

| 4           |

| 7           |

+-------------+

The head of the company is the employee with employee\_id 1.

The employees with employee\_id 2 and 77 report their work directly to the head of the company.

The employee with employee\_id 4 report his work indirectly to the head of the company 4 --> 2 --> 1.

The employee with employee\_id 7 report his work indirectly to the head of the company 7 --> 4 --> 2 --> 1.

The employees with employee\_id 3, 8 and 9 don't report their work to head of company directly or indirectly.

### [](#solution-83)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

\## t3: directly report to employee\_id 1

\## t2: directly report to t3

\## t1: directly report to t2

SELECT t1.employee\_id

FROM Employees AS t1 INNER JOIN Employees AS t2

ON t1.manager\_id \= t2.employee\_id

JOIN Employees AS t3

ON t2.manager\_id \= t3.employee\_id

WHERE t3.manager\_id \= 1 AND t1.employee\_id != 1

#Solution 2:

SELECT distinct employee\_id

FROM (

SELECT employee\_id

FROM Employees

WHERE manager\_id IN

(SELECT employee\_id

FROM Employees

WHERE manager\_id IN

    (SELECT employee\_id

    FROM Employees

    WHERE manager\_id \= 1))

UNION

SELECT employee\_id

FROM Employees

WHERE manager\_id IN

    (SELECT employee\_id

    FROM Employees

    WHERE manager\_id \= 1)

UNION

SELECT employee\_id

    FROM Employees

    WHERE manager\_id \= 1) AS t

WHERE employee\_id != 1

#Solution 3:

SELECT employee\_id

FROM employees

WHERE manager\_id \= 1 AND employee\_id != 1

UNION

SELECT employee\_id

FROM employees

WHERE manager\_id \= any (SELECT employee\_id

FROM employees

WHERE manager\_id \= 1 AND employee\_id != 1)

UNION

SELECT employee\_id

FROM employees

WHERE manager\_id \= any (SELECT employee\_id

FROM employees

WHERE manager\_id \= any (SELECT employee\_id

FROM employees

WHERE manager\_id \= 1 AND employee\_id != 1))

[](#1280-students-and-examinations-easy---leetcode)1280\. Students and Examinations| Easy | 🔒 [LeetCode](https://leetcode.com/problems/students-and-examinations)
------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Students`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| student\_id    | int     |

| student\_name  | varchar |

+---------------+---------+

student\_id is the primary key for this table.

Each row of this table contains the ID and the name of one student in the school.

Table: `Subjects`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+---------+

| Column Name  | Type    |

+--------------+---------+

| subject\_name | varchar |

+--------------+---------+

subject\_name is the primary key for this table.

Each row of this table contains a name of one subject in the school.

Table: `Examinations`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+---------+

| Column Name  | Type    |

+--------------+---------+

| student\_id   | int     |

| subject\_name | varchar |

+--------------+---------+

There is no primary key for this table. It may contain duplicates.

Each student from Students table takes every course from Subjects table.

Each row of this table indicates that a student with ID student\_id attended the exam of subject\_name.

Write an SQL query to find the number of times each student attended each exam.

Order the result table by student\_id and subject\_name.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Students table:

+------------+--------------+

| student\_id | student\_name |

+------------+--------------+

| 1          | Alice        |

| 2          | Bob          |

| 13         | John         |

| 6          | Alex         |

+------------+--------------+

Subjects table:

+--------------+

| subject\_name |

+--------------+

| Math         |

| Physics      |

| Programming  |

+--------------+

Examinations table:

+------------+--------------+

| student\_id | subject\_name |

+------------+--------------+

| 1          | Math         |

| 1          | Physics      |

| 1          | Programming  |

| 2          | Programming  |

| 1          | Physics      |

| 1          | Math         |

| 13         | Math         |

| 13         | Programming  |

| 13         | Physics      |

| 2          | Math         |

| 1          | Math         |

+------------+--------------+

Result table:

+------------+--------------+--------------+----------------+

| student\_id | student\_name | subject\_name | attended\_exams |

+------------+--------------+--------------+----------------+

| 1          | Alice        | Math         | 3              |

| 1          | Alice        | Physics      | 2              |

| 1          | Alice        | Programming  | 1              |

| 2          | Bob          | Math         | 1              |

| 2          | Bob          | Physics      | 0              |

| 2          | Bob          | Programming  | 1              |

| 6          | Alex         | Math         | 0              |

| 6          | Alex         | Physics      | 0              |

| 6          | Alex         | Programming  | 0              |

| 13         | John         | Math         | 1              |

| 13         | John         | Physics      | 1              |

| 13         | John         | Programming  | 1              |

+------------+--------------+--------------+----------------+

The result table should contain all students and all subjects.

Alice attended Math exam 3 times, Physics exam 2 times and Programming exam 1 time.

Bob attended Math exam 1 time, Programming exam 1 time and didn't attend the Physics exam.

Alex didn't attend any exam.

John attended Math exam 1 time, Physics exam 1 time and Programming exam 1 time.

### [](#solution-84)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1: count with null

SELECT Students.student\_id, student\_name, Subjects.subject\_name, COUNT(Examinations.student\_id) AS attended\_exams

FROM Students JOIN Subjects

LEFT JOIN Examinations

ON Students.student\_id \= Examinations.student\_id AND Subjects.subject\_name \= Examinations.subject\_name

GROUP BY Students.student\_id, subject\_name

#Solution 2: using ISNULL

SELECT Students.student\_id, student\_name, Subjects.subject\_name, SUM(IF(ISNULL(Examinations.student\_id), 0, 1)) AS attended\_exams

FROM Students JOIN Subjects

LEFT JOIN Examinations

ON Students.student\_id \= Examinations.student\_id AND Subjects.subject\_name \= Examinations.subject\_name

GROUP BY Students.student\_id, subject\_name

#Solution 3: coalesce

SELECT a.student\_id AS student\_id, a.student\_name AS student\_name, a.subject\_name AS subject\_name, coalesce(attended\_exams,0) AS attended\_exams

FROM(

SELECT \*

FROM students

CROSS JOIN subjects

GROUP BY student\_id, student\_name, subject\_name) a

LEFT JOIN

(SELECT e.student\_id, student\_name, subject\_name, COUNT(\*) AS attended\_exams

FROM examinations e JOIN students s

ON e.student\_id \= s.student\_id

GROUP BY e.student\_id, student\_name, subject\_name) b

ON a.student\_id \= b.student\_id AND a.subject\_name \=b.subject\_name

ORDER BY a.student\_id ASC, a.subject\_name ASC

[](#1285-find-the-start-and-end-number-of-continuous-ranges--medium---leetcode)1285\. Find the Start and End Number of Continuous Ranges | Medium | 🔒 [LeetCode](https://leetcode.com/problems/find-the-start-and-end-number-of-continuous-ranges)
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Logs`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| log\_id        | int     |

+---------------+---------+

id is the primary key for this table.

Each row of this table contains the ID in a log Table.

Since some IDs have been removed from Logs. Write an SQL query to find the start and end number of continuous ranges in table Logs.

Order the result table by start\_id.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Logs table:

+------------+

| log\_id     |

+------------+

| 1          |

| 2          |

| 3          |

| 7          |

| 8          |

| 10         |

+------------+

Result table:

+------------+--------------+

| start\_id   | end\_id       |

+------------+--------------+

| 1          | 3            |

| 7          | 8            |

| 10         | 10           |

+------------+--------------+

The result table should contain all ranges in table Logs.

From 1 to 3 is contained in the table.

From 4 to 6 is missing in the table

From 7 to 8 is contained in the table.

Number 9 is missing in the table.

Number 10 is contained in the table.

### [](#solution-85)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

SELECT MIN(log\_id) AS start\_id, MAX(log\_id) AS end\_id

FROM(

SELECT log\_id, log\_id\-ROW\_NUMBER() OVER (ORDER BY log\_id) AS rk

FROM logs) a

GROUP BY rk

#Solution 2: Add temporary columns of rank and prev

SELECT MIN(log\_id) AS START\_ID, MAX(log\_id) AS END\_ID

FROM (SELECT log\_id,

        @rank :\= CASE WHEN @prev \= log\_id\-1 THEN @rank ELSE @rank+1 END AS rank,

        @prev :\= log\_id AS prev

    FROM Logs,

       (SELECT @rank:\=0, @prev:\=\-1) AS rows) AS tt

GROUP BY rank

ORDER BY START\_ID

\# Solution 3: Find the starting and ending sequences, then merge two AS one table

\## find the starting sequence: 1, 7, 10

\## find the ending sequence: 3, 8, 10

\## merge them AS one table

SELECT start\_id, MIN(end\_id) AS end\_id

FROM (SELECT t1.log\_id AS start\_id

    FROM logs AS t1 LEFT JOIN logs AS t2

    ON t1.log\_id\-1 \= t2.log\_id

    WHERE t2.log\_id IS NULL) tt\_start join

    (SELECT t1.log\_id AS end\_id

    FROM logs AS t1 LEFT JOIN logs AS t2

    ON t1.log\_id+1 \= t2.log\_id

    WHERE t2.log\_id IS NULL) tt\_end

WHERE start\_id<=end\_id

GROUP BY start\_id

[](#1294-weather-type-in-each-country--easy---leetcode)1294\. Weather Type in Each Country | Easy | 🔒 [LeetCode](https://leetcode.com/problems/weather-type-in-each-country)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Countries`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| country\_id    | int     |

| country\_name  | varchar |

+---------------+---------+

country\_id is the primary key for this table.

Each row of this table contains the ID and the name of one country.

Table: `Weather`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| country\_id    | int     |

| weather\_state | varchar |

| day           | date    |

+---------------+---------+

(country\_id, day) is the primary key for this table.

Each row of this table indicates the weather state in a country for one day.

Write an SQL query to find the type of weather in each country for November 2019.

The type of weather is Cold if the average weather\_state is less than or equal 15, Hot if the average weather\_state is greater than or equal 25 and Warm otherwise.

Return result table in any order.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Countries table:

+------------+--------------+

| country\_id | country\_name |

+------------+--------------+

| 2          | USA          |

| 3          | Australia    |

| 7          | Peru         |

| 5          | China        |

| 8          | Morocco      |

| 9          | Spain        |

+------------+--------------+

Weather table:

+------------+---------------+------------+

| country\_id | weather\_state | day        |

+------------+---------------+------------+

| 2          | 15            | 2019-11-01 |

| 2          | 12            | 2019-10-28 |

| 2          | 12            | 2019-10-27 |

| 3          | -2            | 2019-11-10 |

| 3          | 0             | 2019-11-11 |

| 3          | 3             | 2019-11-12 |

| 5          | 16            | 2019-11-07 |

| 5          | 18            | 2019-11-09 |

| 5          | 21            | 2019-11-23 |

| 7          | 25            | 2019-11-28 |

| 7          | 22            | 2019-12-01 |

| 7          | 20            | 2019-12-02 |

| 8          | 25            | 2019-11-05 |

| 8          | 27            | 2019-11-15 |

| 8          | 31            | 2019-11-25 |

| 9          | 7             | 2019-10-23 |

| 9          | 3             | 2019-12-23 |

+------------+---------------+------------+

Result table:

+--------------+--------------+

| country\_name | weather\_type |

+--------------+--------------+

| USA          | Cold         |

| Austraila    | Cold         |

| Peru         | Hot          |

| China        | Warm         |

| Morocco      | Hot          |

+--------------+--------------+

Average weather\_state in USA in November is (15) / 1 = 15 so weather type is Cold.

Average weather\_state in Austraila in November is (-2 + 0 + 3) / 3 = 0.333 so weather type is Cold.

Average weather\_state in Peru in November is (25) / 1 = 25 so weather type is Hot.

Average weather\_state in China in November is (16 + 18 + 21) / 3 = 18.333 so weather type is Warm.

Average weather\_state in Morocco in November is (25 + 27 + 31) / 3 = 27.667 so weather type is Hot.

We know nothing about average weather\_state in Spain in November so we don't include it in the result table.

### [](#solution-86)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT country\_name, CASE WHEN AVG(weather\_state) <= 15 THEN "Cold"

                          WHEN AVG(weather\_state) \>= 25 THEN "Hot"

                          ELSE "Warm" END AS weather\_type

FROM Countries INNER JOIN Weather

ON Countries.country\_id \= Weather.country\_id

WHERE MONTH(day) \= 11

GORUP BY country\_name

[](#1303-find-the-team-size--easy---leetcode)1303\. Find the Team Size | Easy | 🔒 [LeetCode](https://leetcode.com/problems/find-the-team-size)
-----------------------------------------------------------------------------------------------------------------------------------------------

Table: `Employee`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| employee\_id   | int     |

| team\_id       | int     |

+---------------+---------+

employee\_id is the primary key for this table.

Each row of this table contains the ID of each employee and their respective team.

Write an SQL query to find the team size of each of the employees.

Return result table in any order.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Employee Table:

+-------------+------------+

| employee\_id | team\_id    |

+-------------+------------+

|     1       |     8      |

|     2       |     8      |

|     3       |     8      |

|     4       |     7      |

|     5       |     9      |

|     6       |     9      |

+-------------+------------+

Result table:

+-------------+------------+

| employee\_id | team\_size  |

+-------------+------------+

|     1       |     3      |

|     2       |     3      |

|     3       |     3      |

|     4       |     1      |

|     5       |     2      |

|     6       |     2      |

+-------------+------------+

Employees with Id 1,2,3 are part of a team with team\_id = 8.

Employees with Id 4 is part of a team with team\_id = 7.

Employees with Id 5,6 are part of a team with team\_id = 9.

### [](#solution-87)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT employee\_id, b.team\_size

FROM employee e

JOIN

(

SELECT team\_id, count(team\_id) AS team\_size

FROM employee

GROUP BY team\_id) b

ON e.team\_id \= b.team\_id

[](#1308-running-total-for-different-genders--medium---leetcode)1308\. Running Total for Different Genders | Medium | 🔒 [LeetCode](https://leetcode.com/problems/running-total-for-different-genders)
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Scores`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| player\_name   | varchar |

| gender        | varchar |

| day           | date    |

| score\_points  | int     |

+---------------+---------+

(gender, day) is the primary key for this table.

A competition is held between females team and males team.

Each row of this table indicates that a player\_name and with gender has scored score\_point in someday.

Gender is 'F' if the player is in females team and 'M' if the player is in males team.

Write an SQL query to find the total score for each gender at each day.

Order the result table by gender and day

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Scores table:

+-------------+--------+------------+--------------+

| player\_name | gender | day        | score\_points |

+-------------+--------+------------+--------------+

| Aron        | F      | 2020-01-01 | 17           |

| Alice       | F      | 2020-01-07 | 23           |

| Bajrang     | M      | 2020-01-07 | 7            |

| Khali       | M      | 2019-12-25 | 11           |

| Slaman      | M      | 2019-12-30 | 13           |

| Joe         | M      | 2019-12-31 | 3            |

| Jose        | M      | 2019-12-18 | 2            |

| Priya       | F      | 2019-12-31 | 23           |

| Priyanka    | F      | 2019-12-30 | 17           |

+-------------+--------+------------+--------------+

Result table:

+--------+------------+-------+

| gender | day        | total |

+--------+------------+-------+

| F      | 2019-12-30 | 17    |

| F      | 2019-12-31 | 40    |

| F      | 2020-01-01 | 57    |

| F      | 2020-01-07 | 80    |

| M      | 2019-12-18 | 2     |

| M      | 2019-12-25 | 13    |

| M      | 2019-12-30 | 26    |

| M      | 2019-12-31 | 29    |

| M      | 2020-01-07 | 36    |

+--------+------------+-------+

For females team:

First day is 2019-12-30, Priyanka scored 17 points and the total score for the team is 17.

Second day is 2019-12-31, Priya scored 23 points and the total score for the team is 40.

Third day is 2020-01-01, Aron scored 17 points and the total score for the team is 57.

Fourth day is 2020-01-07, Alice scored 23 points and the total score for the team is 80.

For males team:

First day is 2019-12-18, Jose scored 2 points and the total score for the team is 2.

Second day is 2019-12-25, Khali scored 11 points and the total score for the team is 13.

Third day is 2019-12-30, Slaman scored 13 points and the total score for the team is 26.

Fourth day is 2019-12-31, Joe scored 3 points and the total score for the team is 29.

Fifth day is 2020-01-07, Bajrang scored 7 points and the total score for the team is 36.

### [](#solution-88)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

SELECT gender, day,

SUM(score\_points) OVER(PARTITION BY gender ORDER BY day) AS total

FROM scores

GROUP BY 1,2

ORDER BY 1,2

#Solution 2:

SELECT t1.gender, t1.day, SUM(t2.score\_points) AS total

FROM Scores AS t1 JOIN Scores AS t2

ON t1.gender \= t2.gender

AND t1.day\>=t2.day

GROUP BY t1.gender, t1.day

[](#1321-restaurant-growth--medium---leetcode)1321\. Restaurant Growth | Medium | 🔒 [LeetCode](https://leetcode.com/problems/restaurant-growth)
------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Customer`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| customer\_id   | int     |

| name          | varchar |

| visited\_on    | date    |

| amount        | int     |

+---------------+---------+

(customer\_id, visited\_on) is the primary key for this table.

This table contains data about customer transactions in a restaurant.

visited\_on is the date on which the customer with ID (customer\_id) have visited the restaurant.

amount is the total paid by a customer.

You are the restaurant owner and you want to analyze a possible expansion (there will be at least one customer every day).

Write an SQL query to compute moving average of how much customer paid in a 7 days window (current day + 6 days before) .

The query result format is in the following example:

Return result table ordered by visited\_on.

`average_amount` should be rounded to 2 decimal places, all dates are in the format ('YYYY-MM-DD').

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Customer table:

+-------------+--------------+--------------+-------------+

| customer\_id | name         | visited\_on   | amount      |

+-------------+--------------+--------------+-------------+

| 1           | Jhon         | 2019-01-01   | 100         |

| 2           | Daniel       | 2019-01-02   | 110         |

| 3           | Jade         | 2019-01-03   | 120         |

| 4           | Khaled       | 2019-01-04   | 130         |

| 5           | Winston      | 2019-01-05   | 110         |

| 6           | Elvis        | 2019-01-06   | 140         |

| 7           | Anna         | 2019-01-07   | 150         |

| 8           | Maria        | 2019-01-08   | 80          |

| 9           | Jaze         | 2019-01-09   | 110         |

| 1           | Jhon         | 2019-01-10   | 130         |

| 3           | Jade         | 2019-01-10   | 150         |

+-------------+--------------+--------------+-------------+

Result table:

+--------------+--------------+----------------+

| visited\_on   | amount       | average\_amount |

+--------------+--------------+----------------+

| 2019-01-07   | 860          | 122.86         |

| 2019-01-08   | 840          | 120            |

| 2019-01-09   | 840          | 120            |

| 2019-01-10   | 1000         | 142.86         |

+--------------+--------------+----------------+

1st moving average from 2019-01-01 to 2019-01-07 has an average\_amount of (100 + 110 + 120 + 130 + 110 + 140 + 150)/7 = 122.86

2nd moving average from 2019-01-02 to 2019-01-08 has an average\_amount of (110 + 120 + 130 + 110 + 140 + 150 + 80)/7 = 120

3rd moving average from 2019-01-03 to 2019-01-09 has an average\_amount of (120 + 130 + 110 + 140 + 150 + 80 + 110)/7 = 120

4th moving average from 2019-01-04 to 2019-01-10 has an average\_amount of (130 + 110 + 140 + 150 + 80 + 110 + 130 + 150)/7 = 142.86

### [](#solution-89)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

SELECT visited\_on, SUM(amount) OVER(ORDER BY visited\_on ROWS 6 PRECEDING),

round(avg(amount) OVER(ORDER BY visited\_on ROWS 6 PRECEDING),2)

FROM

(

	SELECT visited\_on, SUM(amount) AS amount

	FROM customer

	GROUP BY visited\_on

	ORDER BY visited\_on

) a

ORDER BY visited\_on offset 6 ROWS

#Solution 2:

SELECT t1.visited\_on,

    SUM(t2.amount) AS amount,

    round(avg(t2.amount), 2) AS average\_amount

FROM (

    SELECT visited\_on, SUM(amount) AS amount

    FROM Customer

    GROUP BY visited\_on) AS t1

    inner join

     (

    SELECT visited\_on, SUM(amount) AS amount

    FROM Customer

    GROUP BY visited\_on) AS t2

ON t2.visited\_on BETWEEN DATE\_SUB(t1.visited\_on, INTERVAL 6 DAY) and t1.visited\_on

GROUP BY t1.visited\_on

HAVING COUNT(1)\=7

[](#1322-ads-performance--easy---leetcode)1322\. Ads Performance | Easy | 🔒 [LeetCode](https://leetcode.com/problems/ads-performance)
--------------------------------------------------------------------------------------------------------------------------------------

Table: `Ads`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| ad\_id         | int     |

| user\_id       | int     |

| action        | enum    |

+---------------+---------+

(ad\_id, user\_id) is the primary key for this table.

Each row of this table contains the ID of an Ad, the ID of a user and the action taken by this user regarding this Ad.

The action column is an ENUM type of ('Clicked', 'Viewed', 'Ignored').

A company is running Ads and wants to calculate the performance of each Ad.

![](/_next/image?url=%2Fstatic%2Fimages%2Farticles%2Fsql-questions%2Fleetcode-sql-1322.png&w=1920&q=75)

**Round** `ctr` to 2 decimal points. **Order** the result table by `ctr` in descending order and by `ad_id` in ascending order in case of a tie.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Ads table:

+-------+---------+---------+

| ad\_id | user\_id | action  |

+-------+---------+---------+

| 1     | 1       | Clicked |

| 2     | 2       | Clicked |

| 3     | 3       | Viewed  |

| 5     | 5       | Ignored |

| 1     | 7       | Ignored |

| 2     | 7       | Viewed  |

| 3     | 5       | Clicked |

| 1     | 4       | Viewed  |

| 2     | 11      | Viewed  |

| 1     | 2       | Clicked |

+-------+---------+---------+

Result table:

+-------+-------+

| ad\_id | ctr   |

+-------+-------+

| 1     | 66.67 |

| 3     | 50.00 |

| 2     | 33.33 |

| 5     | 0.00  |

+-------+-------+

for ad\_id = 1, ctr = (2/(2+1)) \* 100 = 66.67

for ad\_id = 2, ctr = (1/(1+2)) \* 100 = 33.33

for ad\_id = 3, ctr = (1/(1+1)) \* 100 = 50.00

for ad\_id = 5, ctr = 0.00, Note that ad\_id = 5 has no clicks or views.

Note that we don't care about Ignored Ads.

Result table is ordered by the ctr. in case of a tie we order them by ad\_id

### [](#solution-90)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

SELECT ad\_id,

    (CASE WHEN clicks+views \= 0 THEN 0 ELSE ROUND(clicks/(clicks+views)\*100, 2) END) AS ctr

FROM

    (SELECT ad\_id,

        SUM(CASE WHEN action\='Clicked' THEN 1 ELSE 0 END) AS clicks,

        SUM(CASE WHEN action\='Viewed' THEN 1 ELSE 0 END) AS views

    FROM Ads

    GROUP BY ad\_id) AS t

ORDER BY ctr DESC, ad\_id ASC

#Solution 2:

WITH t1 AS(

SELECT ad\_id, SUM(CASE WHEN action in ('Clicked') THEN 1 ELSE 0 END) AS clicked

FROM ads

GROUP BY ad\_id

)

, t2 AS

(

SELECT ad\_id AS ad, SUM(CASE WHEN action in ('Clicked','Viewed') THEN 1 ELSE 0 END) AS total

FROM ads

GROUP BY ad\_id

)

SELECT a.ad\_id, coalesce(round((clicked +0.0)/nullif((total +0.0),0)\*100,2),0) AS ctr

FROM

(

select \*

FROM t1 JOIN t2

ON t1.ad\_id \= t2.ad) a

ORDER BY ctr DESC, ad\_id

[](#1327-list-the-products-ordered-in-a-period--easy---leetcode)1327\. List the Products Ordered in a Period | Easy | 🔒 [LeetCode](https://leetcode.com/problems/list-the-products-ordered-in-a-period)
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Products`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+------------------+---------+

| Column Name      | Type    |

+------------------+---------+

| product\_id       | int     |

| product\_name     | varchar |

| product\_category | varchar |

+------------------+---------+

product\_id is the primary key for this table.

This table contains data about the company's products.

Table: `Orders`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| product\_id    | int     |

| order\_date    | date    |

| unit          | int     |

+---------------+---------+

There is no primary key for this table. It may have duplicate rows.

product\_id is a foreign key to Products table.

unit is the number of products ordered in order\_date.

Write an SQL query to get the names of products with greater than or equal to 100 units ordered in February 2020 and their amount.

Return result table in any order.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Products table:

+-------------+-----------------------+------------------+

| product\_id  | product\_name          | product\_category |

+-------------+-----------------------+------------------+

| 1           | Leetcode Solutions    | Book             |

| 2           | Jewels of Stringology | Book             |

| 3           | HP                    | Laptop           |

| 4           | Lenovo                | Laptop           |

| 5           | Leetcode Kit          | T-shirt          |

+-------------+-----------------------+------------------+

Orders table:

+--------------+--------------+----------+

| product\_id   | order\_date   | unit     |

+--------------+--------------+----------+

| 1            | 2020-02-05   | 60       |

| 1            | 2020-02-10   | 70       |

| 2            | 2020-01-18   | 30       |

| 2            | 2020-02-11   | 80       |

| 3            | 2020-02-17   | 2        |

| 3            | 2020-02-24   | 3        |

| 4            | 2020-03-01   | 20       |

| 4            | 2020-03-04   | 30       |

| 4            | 2020-03-04   | 60       |

| 5            | 2020-02-25   | 50       |

| 5            | 2020-02-27   | 50       |

| 5            | 2020-03-01   | 50       |

+--------------+--------------+----------+

Result table:

+--------------------+---------+

| product\_name       | unit    |

+--------------------+---------+

| Leetcode Solutions | 130     |

| Leetcode Kit       | 100     |

+--------------------+---------+

Products with product\_id = 1 is ordered in February a total of (60 + 70) = 130.

Products with product\_id = 2 is ordered in February a total of 80.

Products with product\_id = 3 is ordered in February a total of (2 + 3) = 5.

Products with product\_id = 4 was not ordered in February 2020.

Products with product\_id = 5 is ordered in February a total of (50 + 50) = 100.

### [](#solution-91)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

SELECT a.product\_name, a.unit

FROM

(SELECT p.product\_name, SUM(unit) AS unit

FROM orders o

JOIN products p

ON o.product\_id \= p.product\_id

WHERE MONTH(order\_date)\=2 and YEAR(order\_date) \= 2020

GROUP BY o.product\_id) a

WHERE a.unit\>=100

#Solution 2:

SELECT product\_name, SUM(unit) AS unit

FROM Products JOIN Orders

ON Products.product\_id \= Orders.product\_id

WHERE left(order\_date, 7) \= "2020-02"

GROUP BY Products.product\_id

HAVING SUM(unit)\>=100

[](#1336-number-of-transactions-per-visit--hard---leetcode)1336\. Number of Transactions per Visit | Hard | 🔒 [LeetCode](https://leetcode.com/problems/number-of-transactions-per-visit)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Visits`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| user\_id       | int     |

| visit\_date    | date    |

+---------------+---------+

(user\_id, visit\_date) is the primary key for this table.

Each row of this table indicates that user\_id has visited the bank in visit\_date.

Table: `Transactions`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+------------------+---------+

| Column Name      | Type    |

+------------------+---------+

| user\_id          | int     |

| transaction\_date | date    |

| amount           | int     |

+------------------+---------+

There is no primary key for this table, it may contain duplicates.

Each row of this table indicates that user\_id has done a transaction of amount in transaction\_date.

It is guaranteed that the user has visited the bank in the transaction\_date.(i.e The Visits table contains (user\_id, transaction\_date) in one row)

A bank wants to draw a chart of the number of transactions bank visitors did in one visit to the bank and the corresponding number of visitors who have done this number of transaction in one visit.

Write an SQL query to find how many users visited the bank and didn't do any transactions, how many visited the bank and did one transaction and so on.

The result table will contain two columns:

*   `transactions_count` which is the number of transactions done in one visit.
*   `visits_count` which is the corresponding number of users who did transactions\_count in one visit to the bank.  
    `transactions_count` should take all values from `0` to `max(transactions_count)` done by one or more users.

Order the result table by `transactions_count`.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Visits table:

+---------+------------+

| user\_id | visit\_date |

+---------+------------+

| 1       | 2020-01-01 |

| 2       | 2020-01-02 |

| 12      | 2020-01-01 |

| 19      | 2020-01-03 |

| 1       | 2020-01-02 |

| 2       | 2020-01-03 |

| 1       | 2020-01-04 |

| 7       | 2020-01-11 |

| 9       | 2020-01-25 |

| 8       | 2020-01-28 |

+---------+------------+

Transactions table:

+---------+------------------+--------+

| user\_id | transaction\_date | amount |

+---------+------------------+--------+

| 1       | 2020-01-02       | 120    |

| 2       | 2020-01-03       | 22     |

| 7       | 2020-01-11       | 232    |

| 1       | 2020-01-04       | 7      |

| 9       | 2020-01-25       | 33     |

| 9       | 2020-01-25       | 66     |

| 8       | 2020-01-28       | 1      |

| 9       | 2020-01-25       | 99     |

+---------+------------------+--------+

Result table:

+--------------------+--------------+

| transactions\_count | visits\_count |

+--------------------+--------------+

| 0                  | 4            |

| 1                  | 5            |

| 2                  | 0            |

| 3                  | 1            |

+--------------------+--------------+

\* For transactions\_count = 0, The visits (1, "2020-01-01"), (2, "2020-01-02"), (12, "2020-01-01") and (19, "2020-01-03") did no transactions so visits\_count = 4.

\* For transactions\_count = 1, The visits (2, "2020-01-03"), (7, "2020-01-11"), (8, "2020-01-28"), (1, "2020-01-02") and (1, "2020-01-04") did one transaction so visits\_count = 5.

\* For transactions\_count = 2, No customers visited the bank and did two transactions so visits\_count = 0.

\* For transactions\_count = 3, The visit (9, "2020-01-25") did three transactions so visits\_count = 1.

\* For transactions\_count >= 4, No customers visited the bank and did more than three transactions so we will stop at transactions\_count = 3

The chart drawn for this example is as follows:

![](/_next/image?url=%2Fstatic%2Fimages%2Farticles%2Fsql-questions%2Fleetcode-sql-1336.png&w=3840&q=75)

### [](#solution-92)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

WITH RECURSIVE t1 AS(

                    SELECT visit\_date,

                           COALESCE(num\_visits,0) as num\_visits,

                           COALESCE(num\_trans,0) as num\_trans

                    FROM ((

                          SELECT visit\_date, user\_id, COUNT(\*) as num\_visits

                          FROM visits

                          GROUP BY 1, 2) AS a

                         LEFT JOIN

                          (

                           SELECT transaction\_date,

                                 user\_id,

                                 count(\*) as num\_trans

                            FROM transactions

                          GROUP BY 1, 2) AS b

                         ON a.visit\_date \= b.transaction\_date and a.user\_id \= b.user\_id)

                      ),

              t2 AS (

                      SELECT MAX(num\_trans) as trans

                        FROM t1

                      UNION ALL

                      SELECT trans\-1

                        FROM t2

                      WHERE trans \>= 1)

SELECT trans as transactions\_count,

       COALESCE(visits\_count,0) as visits\_count

  FROM t2 LEFT JOIN (

                    SELECT num\_trans as transactions\_count, COALESCE(COUNT(\*),0) as visits\_count

                    FROM t1

                    GROUP BY 1

                    ORDER BY 1) AS a

ON a.transactions\_count \= t2.trans

ORDER BY 1

[](#1341-movie-rating--medium---leetcode)1341\. Movie Rating | Medium | 🔒 [LeetCode](https://leetcode.com/problems/movie-rating)
---------------------------------------------------------------------------------------------------------------------------------

Table: `Movies`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| movie\_id      | int     |

| title         | varchar |

+---------------+---------+

movie\_id is the primary key for this table.

title is the name of the movie.

Table: `Users`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| user\_id       | int     |

| name          | varchar |

+---------------+---------+

user\_id is the primary key for this table.

Table: `Movie_Rating`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| movie\_id      | int     |

| user\_id       | int     |

| rating        | int     |

| created\_at    | date    |

+---------------+---------+

(movie\_id, user\_id) is the primary key for this table.

This table contains the rating of a movie by a user in their review.

created\_at is the user's review date.

Write the following SQL query:

*   Find the name of the user who has rated the greatest number of the movies.  
    In case of a tie, return lexicographically smaller user name.
    
*   Find the movie name with the highest average rating in February 2020.  
    In case of a tie, return lexicographically smaller movie name..
    

Query is returned in 2 rows, the query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Movies table:

+-------------+--------------+

| movie\_id    |  title       |

+-------------+--------------+

| 1           | Avengers     |

| 2           | Frozen 2     |

| 3           | Joker        |

+-------------+--------------+

Users table:

+-------------+--------------+

| user\_id     |  name        |

+-------------+--------------+

| 1           | Daniel       |

| 2           | Monica       |

| 3           | Maria        |

| 4           | James        |

+-------------+--------------+

Movie\_Rating table:

+-------------+--------------+--------------+-------------+

| movie\_id    | user\_id      | rating       | created\_at  |

+-------------+--------------+--------------+-------------+

| 1           | 1            | 3            | 2020-01-12  |

| 1           | 2            | 4            | 2020-02-11  |

| 1           | 3            | 2            | 2020-02-12  |

| 1           | 4            | 1            | 2020-01-01  |

| 2           | 1            | 5            | 2020-02-17  |

| 2           | 2            | 2            | 2020-02-01  |

| 2           | 3            | 2            | 2020-03-01  |

| 3           | 1            | 3            | 2020-02-22  |

| 3           | 2            | 4            | 2020-02-25  |

+-------------+--------------+--------------+-------------+

Result table:

+--------------+

| results      |

+--------------+

| Daniel       |

| Frozen 2     |

+--------------+

Daniel and Maria have rated 3 movies ("Avengers", "Frozen 2" and "Joker") but Daniel is smaller lexicographically.

Frozen 2 and Joker have a rating average of 3.5 in February but Frozen 2 is smaller lexicographically.

### [](#solution-93)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

(SELECT name AS results

FROM Movie\_Rating JOIN Users

ON Movie\_Rating.user\_id \= Users.user\_id

GROUP BY Movie\_Rating.user\_id

ORDER BY count(1) DESC, name

LIMIT 1)

UNION ALL

(SELECT title AS results

FROM Movie\_Rating JOIN Movies

ON Movie\_Rating.movie\_id \= Movies.movie\_id

WHERE left(created\_at, 7) \= "2020-02"

GROUP BY Movie\_Rating.movie\_id

ORDER BY avg(rating) DESC, title

LIMIT 1

)

#Solution 2:

SELECT name AS results

FROM(

(SELECT a.name

FROM(

SELECT name, count(\*),

rank() OVER(ORDER BY count(\*) DESC) AS rk

FROM movie\_rating m

JOIN users u

ON m.user\_id \= u.user\_id

GROUP BY name, m.user\_id

ORDER BY rk, name) a

LIMIT 1)

UNION

(SELECT title

FROM(

SELECT title, round(avg(rating),1) AS rnd

FROM movie\_rating m

JOIN movies u

on m.movie\_id \= u.movie\_id

WHERE month(created\_at) \= 2

GROUP BY title

ORDER BY rnd DESC, title) b

LIMIT 1)) AS d

[](#1350-students-with-invalid-departments--easy---leetcode)1350\. Students With Invalid Departments | Easy | 🔒 [LeetCode](https://leetcode.com/problems/students-with-invalid-departments)
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Departments`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| id            | int     |

| name          | varchar |

+---------------+---------+

id is the primary key of this table.

The table has information about the id of each department of a university.

Table: `Students`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| id            | int     |

| name          | varchar |

| department\_id | int     |

+---------------+---------+

id is the primary key of this table.

The table has information about the id of each student at a university and the id of the department he/she studies at.

Write an SQL query to find the id and the name of all students who are enrolled in departments that no longer exists.

Return the result table in any order.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Departments table:

+------+--------------------------+

| id   | name                     |

+------+--------------------------+

| 1    | Electrical Engineering   |

| 7    | Computer Engineering     |

| 13   | Bussiness Administration |

+------+--------------------------+

Students table:

+------+----------+---------------+

| id   | name     | department\_id |

+------+----------+---------------+

| 23   | Alice    | 1             |

| 1    | Bob      | 7             |

| 5    | Jennifer | 13            |

| 2    | John     | 14            |

| 4    | Jasmine  | 77            |

| 3    | Steve    | 74            |

| 6    | Luis     | 1             |

| 8    | Jonathan | 7             |

| 7    | Daiana   | 33            |

| 11   | Madelynn | 1             |

+------+----------+---------------+

Result table:

+------+----------+

| id   | name     |

+------+----------+

| 2    | John     |

| 7    | Daiana   |

| 4    | Jasmine  |

| 3    | Steve    |

+------+----------+

John, Daiana, Steve and Jasmine are enrolled in departments 14, 33, 74 and 77 respectively. department 14, 33, 74 and 77 doesn't exist in the Departments table.

### [](#solution-94)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

SELECT s.id, s.name

FROM students s LEFT JOIN

departments d

ON s.department\_id \= d.id

WHERE d.name IS NULL;

#Solution 2:

SELECT id, name

FROM Students

WHERE department\_id NOT IN

    (SELECT id FROM Departments)

[](#1355-activity-participants--medium---leetcode)1355\. Activity Participants | Medium | 🔒 [LeetCode](https://leetcode.com/problems/activity-participants)
------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Friends`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| id            | int     |

| name          | varchar |

| activity      | varchar |

+---------------+---------+

id is the id of the friend and primary key for this table.

name is the name of the friend.

activity is the name of the activity which the friend takes part in.

Table: `Activities`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| id            | int     |

| name          | varchar |

+---------------+---------+

id is the primary key for this table.

name is the name of the activity.

Write an SQL query to find the names of all the activities with neither maximum, nor minimum number of participants.

Return the result table in any order. Each activity in table Activities is performed by any person in the table Friends.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Friends table:

+------+--------------+---------------+

| id   | name         | activity      |

+------+--------------+---------------+

| 1    | Jonathan D.  | Eating        |

| 2    | Jade W.      | Singing       |

| 3    | Victor J.    | Singing       |

| 4    | Elvis Q.     | Eating        |

| 5    | Daniel A.    | Eating        |

| 6    | Bob B.       | Horse Riding  |

+------+--------------+---------------+

Activities table:

+------+--------------+

| id   | name         |

+------+--------------+

| 1    | Eating       |

| 2    | Singing      |

| 3    | Horse Riding |

+------+--------------+

Result table:

+--------------+

| results      |

+--------------+

| Singing      |

+--------------+

Eating activity is performed by 3 friends, maximum number of participants, (Jonathan D. , Elvis Q. and Daniel A.)

Horse Riding activity is performed by 1 friend, minimum number of participants, (Bob B.)

Singing is performed by 2 friends (Victor J. and Jade W.)

### [](#solution-95)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

WITH CTE AS

(SELECT COUNT(\*) AS cnt, activity FROM Friends GROUP BY activity)

SELECT activity FROM CTE

WHERE cnt NOT IN

    (SELECT MAX(cnt) FROM CTE

    UNION ALL

    SELECT MIN(cnt) FROM CTE)

#Solution 2:

WITH t1 AS(

SELECT MAX(a.total) AS total

FROM(

    SELECT activity, COUNT(\*) AS total

    FROM friends

    GROUP BY activity) a

	UNION ALL

	SELECT MIN(b.total) AS low

    FROM(

    SELECT activity, COUNT(\*) AS total

    FROM friends

    GROUP BY activity) b),

t2 AS

(

    SELECT activity, COUNT(\*) AS total

    FROM friends

    GROUP BY activity

)

SELECT activity

FROM t1 RIGHT JOIN t2

ON t1.total \= t2.total

WHERE t1.total is null

[](#1364-number-of-trusted-contacts-of-a-customer--medium---leetcode)1364\. Number of Trusted Contacts of a Customer | Medium | 🔒 [LeetCode](https://leetcode.com/problems/number-of-trusted-contacts-of-a-customer)
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Customers`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| customer\_id   | int     |

| customer\_name | varchar |

| email         | varchar |

+---------------+---------+

customer\_id is the primary key for this table.

Each row of this table contains the name and the email of a customer of an online shop.

Table: `Contacts`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| user\_id       | id      |

| contact\_name  | varchar |

| contact\_email | varchar |

+---------------+---------+

(user\_id, contact\_email) is the primary key for this table.

Each row of this table contains the name and email of one contact of customer with user\_id.

This table contains information about people each customer trust. The contact may or may not exist in the Customers table.

Table: `Invoices`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+---------+

| Column Name  | Type    |

+--------------+---------+

| invoice\_id   | int     |

| price        | int     |

| user\_id      | int     |

+--------------+---------+

invoice\_id is the primary key for this table.

Each row of this table indicates that user\_id has an invoice with invoice\_id and a price.

Write an SQL query to find the following for each invoice\_id:

*   customer\_name: The name of the customer the invoice is related to.
*   price: The price of the invoice.
*   contacts\_cnt: The number of contacts related to the customer.
*   trusted\_contacts\_cnt: The number of contacts related to the customer and at the same time they are customers to the shop. (i.e His/Her email exists in the Customers table.) Order the result table by invoice\_id.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Customers table:

+-------------+---------------+--------------------+

| customer\_id | customer\_name | email              |

+-------------+---------------+--------------------+

| 1           | Alice         | [\[email protected\]](/cdn-cgi/l/email-protection) |

| 2           | Bob           | [\[email protected\]](/cdn-cgi/l/email-protection)   |

| 13          | John          | [\[email protected\]](/cdn-cgi/l/email-protection)  |

| 6           | Alex          | [\[email protected\]](/cdn-cgi/l/email-protection)  |

+-------------+---------------+--------------------+

Contacts table:

+-------------+--------------+--------------------+

| user\_id     | contact\_name | contact\_email      |

+-------------+--------------+--------------------+

| 1           | Bob          | [\[email protected\]](/cdn-cgi/l/email-protection)   |

| 1           | John         | [\[email protected\]](/cdn-cgi/l/email-protection)  |

| 1           | Jal          | [\[email protected\]](/cdn-cgi/l/email-protection)   |

| 2           | Omar         | [\[email protected\]](/cdn-cgi/l/email-protection)  |

| 2           | Meir         | [\[email protected\]](/cdn-cgi/l/email-protection)  |

| 6           | Alice        | [\[email protected\]](/cdn-cgi/l/email-protection) |

+-------------+--------------+--------------------+

Invoices table:

+------------+-------+---------+

| invoice\_id | price | user\_id |

+------------+-------+---------+

| 77         | 100   | 1       |

| 88         | 200   | 1       |

| 99         | 300   | 2       |

| 66         | 400   | 2       |

| 55         | 500   | 13      |

| 44         | 60    | 6       |

+------------+-------+---------+

Result table:

+------------+---------------+-------+--------------+----------------------+

| invoice\_id | customer\_name | price | contacts\_cnt | trusted\_contacts\_cnt |

+------------+---------------+-------+--------------+----------------------+

| 44         | Alex          | 60    | 1            | 1                    |

| 55         | John          | 500   | 0            | 0                    |

| 66         | Bob           | 400   | 2            | 0                    |

| 77         | Alice         | 100   | 3            | 2                    |

| 88         | Alice         | 200   | 3            | 2                    |

| 99         | Bob           | 300   | 2            | 0                    |

+------------+---------------+-------+--------------+----------------------+

Alice has three contacts, two of them are trusted contacts (Bob and John).

Bob has two contacts, none of them is a trusted contact.

Alex has one contact and it is a trusted contact (Alice).

John doesn't have any contacts.

### [](#solution-96)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT invoice\_id, customer\_name, price,

 COUNT(Contacts.user\_id) AS contacts\_cnt,

 SUM(CASE WHEN Contacts.contact\_name IN

    (SELECT customer\_name FROM Customers)

    THEN 1 ELSE 0 END) AS trusted\_contacts\_cnt

FROM Invoices INNER JOIN Customers ON Invoices.user\_id \= Customers.customer\_id

LEFT JOIN Contacts ON Customers.customer\_id \= Contacts.user\_id

GROUP BY Invoices.invoice\_id, customer\_name

ORDER BY Invoices.invoice\_id

[](#1369-get-the-second-most-recent-activity--hard---leetcode)1369\. Get the Second Most Recent Activity | Hard | 🔒 [LeetCode](https://leetcode.com/problems/get-the-second-most-recent-activity)
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `UserActivity`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| username      | varchar |

| activity      | varchar |

| startDate     | Date    |

| endDate       | Date    |

+---------------+---------+

This table does not contain primary key.

This table contain information about the activity performed of each user in a period of time.

A person with username performed a activity from startDate to endDate.

Write an SQL query to show the second most recent activity of each user.

If the user only has one activity, return that one.

A user can't perform more than one activity at the same time. Return the result table in any order.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

UserActivity table:

+------------+--------------+-------------+-------------+

| username   | activity     | startDate   | endDate     |

+------------+--------------+-------------+-------------+

| Alice      | Travel       | 2020-02-12  | 2020-02-20  |

| Alice      | Dancing      | 2020-02-21  | 2020-02-23  |

| Alice      | Travel       | 2020-02-24  | 2020-02-28  |

| Bob        | Travel       | 2020-02-11  | 2020-02-18  |

+------------+--------------+-------------+-------------+

Result table:

+------------+--------------+-------------+-------------+

| username   | activity     | startDate   | endDate     |

+------------+--------------+-------------+-------------+

| Alice      | Dancing      | 2020-02-21  | 2020-02-23  |

| Bob        | Travel       | 2020-02-11  | 2020-02-18  |

+------------+--------------+-------------+-------------+

The most recent activity of Alice is Travel from 2020-02-24 to 2020-02-28, before that she was dancing from 2020-02-21 to 2020-02-23.

Bob only has one record, we just take that one.

### [](#solution-97)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

(SELECT \*

FROM UserActivity

GROUP BY username

HAVING count(1) \= 1)

UNION

(SELECT a.\*

FROM UserActivity AS a LEFT JOIN UserActivity AS b

on a.username \= b.username AND a.endDate<b.endDate

GROUP BY a.username, a.endDate

HAVING count(b.endDate) \= 1)

[](#1378-replace-employee-id-with-the-unique-identifier--easy---leetcode)1378\. Replace Employee ID With The Unique Identifier | Easy | 🔒 [LeetCode](https://leetcode.com/problems/replace-employee-id-with-the-unique-identifier)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Employees`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| id            | int     |

| name          | varchar |

+---------------+---------+

id is the primary key for this table.

Each row of this table contains the id and the name of an employee in a company.

Table: `EmployeeUNI`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| id            | int     |

| unique\_id     | int     |

+---------------+---------+

(id, unique\_id) is the primary key for this table.

Each row of this table contains the id and the corresponding unique id of an employee in the company.

Write an SQL query to show the unique ID of each user, If a user doesn't have a unique ID replace just show null.

Return the result table in any order.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Employees table:

+----+----------+

| id | name     |

+----+----------+

| 1  | Alice    |

| 7  | Bob      |

| 11 | Meir     |

| 90 | Winston  |

| 3  | Jonathan |

+----+----------+

EmployeeUNI table:

+----+-----------+

| id | unique\_id |

+----+-----------+

| 3  | 1         |

| 11 | 2         |

| 90 | 3         |

+----+-----------+

EmployeeUNI table:

+-----------+----------+

| unique\_id | name     |

+-----------+----------+

| null      | Alice    |

| null      | Bob      |

| 2         | Meir     |

| 3         | Winston  |

| 1         | Jonathan |

+-----------+----------+

Alice and Bob don't have a unique ID, We will show null instead.

The unique ID of Meir is 2.

The unique ID of Winston is 3.

The unique ID of Jonathan is 1.

### [](#solution-98)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT unique\_id, name

FROM Employees

LEFT JOIN EmployeeUNI

ON Employees.id \= EmployeeUNI.id

[](#1384-total-sales-amount-by-year--hard---leetcode)1384\. Total Sales Amount by Year | Hard | 🔒 [LeetCode](https://leetcode.com/problems/total-sales-amount-by-year)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Product`

+---------------+---------+ | Column Name | Type | +---------------+---------+ | product\_id | int | | product\_name | varchar | +---------------+---------+ product\_id is the primary key for this table. product\_name is the name of the product.

Table: `Sales`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------------+---------+

| Column Name         | Type    |

+---------------------+---------+

| product\_id          | int     |

| period\_start        | varchar |

| period\_end          | date    |

| average\_daily\_sales | int     |

+---------------------+---------+

product\_id is the primary key for this table.

period\_start and period\_end indicates the start and end date for sales period, both dates are inclusive.

The average\_daily\_sales column holds the average daily sales amount of the items for the period.

Write an SQL query to report the Total sales amount of each item for each year, with corresponding product name, product\_id, product\_name and report\_year.

Dates of the sales years are between 2018 to 2020. Return the result table **ordered** by product\_id and report\_year.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Product table:

+------------+--------------+

| product\_id | product\_name |

+------------+--------------+

| 1          | LC Phone     |

| 2          | LC T-Shirt   |

| 3          | LC Keychain  |

+------------+--------------+

Sales table:

+------------+--------------+-------------+---------------------+

| product\_id | period\_start | period\_end  | average\_daily\_sales |

+------------+--------------+-------------+---------------------+

| 1          | 2019-01-25   | 2019-02-28  | 100                 |

| 2          | 2018-12-01   | 2020-01-01  | 10                  |

| 3          | 2019-12-01   | 2020-01-31  | 1                   |

+------------+--------------+-------------+---------------------+

Result table:

+------------+--------------+-------------+--------------+

| product\_id | product\_name | report\_year | total\_amount |

+------------+--------------+-------------+--------------+

| 1          | LC Phone     |    2019     | 3500         |

| 2          | LC T-Shirt   |    2018     | 310          |

| 2          | LC T-Shirt   |    2019     | 3650         |

| 2          | LC T-Shirt   |    2020     | 10           |

| 3          | LC Keychain  |    2019     | 31           |

| 3          | LC Keychain  |    2020     | 31           |

+------------+--------------+-------------+--------------+

LC Phone was sold for the period of 2019-01-25 to 2019-02-28, and there are 35 days for this period. Total amount 35\*100 = 3500.

LC T-shirt was sold for the period of 2018-12-01 to 2020-01-01, and there are 31, 365, 1 days for years 2018, 2019 and 2020 respectively.

LC Keychain was sold for the period of 2019-12-01 to 2020-01-31, and there are 31, 31 days for years 2019 and 2020 respectively.

### [](#solution-99)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT

    b.product\_id,

    a.product\_name,

    a.yr AS report\_year,

    CASE

        WHEN YEAR(b.period\_start)\=YEAR(b.period\_end) AND a.yr\=YEAR(b.period\_start) THEN DATEDIFF(b.period\_end,b.period\_start)+1

        WHEN a.yr\=YEAR(b.period\_start) THEN DATEDIFF(DATE\_FORMAT(b.period\_start,'%Y-12-31'),b.period\_start)+1

        WHEN a.yr\=YEAR(b.period\_end) THEN DAYOFYEAR(b.period\_end)

        WHEN a.yr\>YEAR(b.period\_start) AND a.yr<YEAR(b.period\_end) THEN 365

        ELSE 0

    END \* average\_daily\_sales AS total\_amount

FROM

    (SELECT product\_id,product\_name,'2018' AS yr FROM Product

    UNION

    SELECT product\_id,product\_name,'2019' AS yr FROM Product

    UNION

    SELECT product\_id,product\_name,'2020' AS yr FROM Product) a

    JOIN

    Sales b

    ON a.product\_id\=b.product\_id

HAVING total\_amount \> 0

ORDER BY b.product\_id,a.yr

[](#1393-capital-gainloss--medium---leetcode)1393\. Capital Gain/Loss | Medium | 🔒 [LeetCode](https://leetcode.com/problems/capital-gainloss)
----------------------------------------------------------------------------------------------------------------------------------------------

Table: `Stocks`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| stock\_name    | varchar |

| operation     | enum    |

| operation\_day | int     |

| price         | int     |

+---------------+---------+

(stock\_name, day) is the primary key for this table.

The operation column is an ENUM of type ('Sell', 'Buy')

Each row of this table indicates that the stock which has stock\_name had an operation on the day operation\_day with the price.

It is guaranteed that each 'Sell' operation for a stock has a corresponding 'Buy' operation in a previous day.

Write an SQL query to report the Capital gain/loss for each stock.

The capital gain/loss of a stock is total gain or loss after buying and selling the stock one or many times.

Return the result table in any order.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Stocks table:

+---------------+-----------+---------------+--------+

| stock\_name    | operation | operation\_day | price  |

+---------------+-----------+---------------+--------+

| Leetcode      | Buy       | 1             | 1000   |

| Corona Masks  | Buy       | 2             | 10     |

| Leetcode      | Sell      | 5             | 9000   |

| Handbags      | Buy       | 17            | 30000  |

| Corona Masks  | Sell      | 3             | 1010   |

| Corona Masks  | Buy       | 4             | 1000   |

| Corona Masks  | Sell      | 5             | 500    |

| Corona Masks  | Buy       | 6             | 1000   |

| Handbags      | Sell      | 29            | 7000   |

| Corona Masks  | Sell      | 10            | 10000  |

+---------------+-----------+---------------+--------+

Result table:

+---------------+-------------------+

| stock\_name    | capital\_gain\_loss |

+---------------+-------------------+

| Corona Masks  | 9500              |

| Leetcode      | 8000              |

| Handbags      | -23000            |

+---------------+-------------------+

Leetcode stock was bought at day 1 for 1000$ and was sold at day 5 for 9000$. Capital gain = 9000 - 1000 = 8000$.

Handbags stock was bought at day 17 for 30000$ and was sold at day 29 for 7000$. Capital loss = 7000 - 30000 = -23000$.

Corona Masks stock was bought at day 1 for 10$ and was sold at day 3 for 1010$. It was bought again at day 4 for 1000$ and was sold at day 5 for 500$. At last, it was bought at day 6 for 1000$ and was sold at day 10 for 10000$. Capital gain/loss is the sum of capital gains/losses for each ('Buy' --> 'Sell') operation = (1010 - 10) + (500 - 1000) + (10000 - 1000) = 1000 - 500 + 9000 = 9500$.

### [](#solution-100)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

SELECT stock\_name,

       SUM(CASE WHEN operation \= 'Buy' THEN \-price ELSE price END) AS capital\_gain\_loss

FROM Stocks

GROUP BY stock\_name;

#Solution 2:

SELECT stock\_name, (one\-two) AS capital\_gain\_loss

FROM(

(SELECT stock\_name, sum(price) AS one

FROM stocks

WHERE operation \= 'Sell'

GROUP BY stock\_name) b

LEFT JOIN

(SELECT stock\_name AS name, sum(price) AS two

FROM stocks

WHERE operation \= 'Buy'

GROUP BY stock\_name) c

ON b.stock\_name \= c.name)

ORDER BY capital\_gain\_loss DESC;

[](#1398-customers-who-bought-products-a-and-b-but-not-c--medium---leetcode)1398\. Customers Who Bought Products A and B but Not C | Medium | 🔒 [LeetCode](https://leetcode.com/problems/customers-who-bought-products-a-and-b-but-not-c)
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Customers`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------------+---------+

| Column Name         | Type    |

+---------------------+---------+

| customer\_id         | int     |

| customer\_name       | varchar |

+---------------------+---------+

customer\_id is the primary key for this table.

customer\_name is the name of the customer.

Table: `Orders`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| order\_id      | int     |

| customer\_id   | int     |

| product\_name  | varchar |

+---------------+---------+

order\_id is the primary key for this table.

customer\_id is the id of the customer who bought the product "product\_name".

Write an SQL query to report the customer\_id and customer\_name of customers who bought products "A", "B" but did not buy the product "C" since we want to recommend them buy this product.

Return the result table ordered by customer\_id.

The query result format is in the following example.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Customers table:

+-------------+---------------+

| customer\_id | customer\_name |

+-------------+---------------+

| 1           | Daniel        |

| 2           | Diana         |

| 3           | Elizabeth     |

| 4           | Jhon          |

+-------------+---------------+

Orders table:

+------------+--------------+---------------+

| order\_id   | customer\_id  | product\_name  |

+------------+--------------+---------------+

| 10         |     1        |     A         |

| 20         |     1        |     B         |

| 30         |     1        |     D         |

| 40         |     1        |     C         |

| 50         |     2        |     A         |

| 60         |     3        |     A         |

| 70         |     3        |     B         |

| 80         |     3        |     D         |

| 90         |     4        |     C         |

+------------+--------------+---------------+

Result table:

+-------------+---------------+

| customer\_id | customer\_name |

+-------------+---------------+

| 3           | Elizabeth     |

+-------------+---------------+

Only the customer\_id with id 3 bought the product A and B but not the product C.

### [](#solution-101)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

WITH t1 AS

(

SELECT customer\_id

FROM orders

WHERE product\_name \= 'B' AND

customer\_id IN (SELECT customer\_id

FROM orders

WHERE product\_name \= 'A'))

SELECT t1.customer\_id, c.customer\_name

FROM t1 JOIN customers c

ON t1.customer\_id \= c.customer\_id

WHERE t1.customer\_id != all(SELECT customer\_id

FROM orders

WHERE product\_name \= 'C')

#Solution 2:

SELECT \*

FROM Customers

WHERE customer\_id IN

    (SELECT DISTINCT customer\_id

     FROM Orders

     WHERE product\_name \= 'A'

    ) AND

    customer\_id IN

    (SELECT DISTINCT customer\_id

     FROM Orders

     WHERE product\_name \= 'B'

    ) AND

    customer\_id NOT IN

    (SELECT DISTINCT customer\_id

     FROM Orders

     WHERE product\_name \= 'C'

    )

ORDER BY customer\_id

#Solution 3:

SELECT Customers.\*

FROM (

    SELECT customer\_id,

     sum(CASE WHEN product\_name \= 'A' THEN 1 ELSE 0 END) AS product\_a,

     sum(CASE WHEN product\_name \= 'B' THEN 1 ELSE 0 END) AS product\_b

    FROM Orders

    GROUP BY customer\_id) AS t JOIN Customers

ON t.customer\_id \= Customers.customer\_id

WHERE t.product\_a\>0 AND product\_b \>0 AND Customers.customer\_id NOT IN (

    SELECT DISTINCT customer\_id

    FROM Orders

    WHERE product\_name \= 'C')

ORDER BY Customers.customer\_id

[](#1407-top-travellers--easy---leetcode)1407\. Top Travellers | Easy | 🔒 [LeetCode](https://leetcode.com/problems/top-travellers)
-----------------------------------------------------------------------------------------------------------------------------------

Table: `Users`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| id            | int     |

| name          | varchar |

+---------------+---------+

id is the primary key for this table.

name is the name of the user.

Table: `Rides`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| id            | int     |

| user\_id       | int     |

| distance      | int     |

+---------------+---------+

id is the primary key for this table.

city\_id is the id of the city who bought the product "product\_name".

Write an SQL query to report the distance travelled by each user.

Return the result table ordered by `travelled_distance` in descending order, if two or more users travelled the same distance, order them by their `name` in ascending order.

The query result format is in the following example.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Users table:

+------+-----------+

| id   | name      |

+------+-----------+

| 1    | Alice     |

| 2    | Bob       |

| 3    | Alex      |

| 4    | Donald    |

| 7    | Lee       |

| 13   | Jonathan  |

| 19   | Elvis     |

+------+-----------+

Rides table:

+------+----------+----------+

| id   | user\_id  | distance |

+------+----------+----------+

| 1    | 1        | 120      |

| 2    | 2        | 317      |

| 3    | 3        | 222      |

| 4    | 7        | 100      |

| 5    | 13       | 312      |

| 6    | 19       | 50       |

| 7    | 7        | 120      |

| 8    | 19       | 400      |

| 9    | 7        | 230      |

+------+----------+----------+

Result table:

+----------+--------------------+

| name     | travelled\_distance |

+----------+--------------------+

| Elvis    | 450                |

| Lee      | 450                |

| Bob      | 317                |

| Jonathan | 312                |

| Alex     | 222                |

| Alice    | 120                |

| Donald   | 0                  |

+----------+--------------------+

Elvis and Lee travelled 450 miles, Elvis is the top traveller as his name is alphabetically smaller than Lee.

Bob, Jonathan, Alex and Alice have only one ride and we just order them by the total distances of the ride.

Donald didn't have any rides, the distance travelled by him is 0.

### [](#solution-102)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

SELECT U.name AS name, COALESCE(SUM(R.distance),0) AS travelled\_distance

FROM Users U LEFT JOIN Rides R

ON R.user\_id \= U.id

GROUP BY name

ORDER BY travelled\_distance DESC, name

#Solution 2:

SELECT name, IFNULL(SUM(distance), 0) AS travelled\_distance

FROM Users LEFT JOIN Rides

ON Users.id \= Rides.user\_id

GROUP BY Users.id

ORDER BY travelled\_distance DESC, name

#Solution 3:

SELECT name, SUM(IF(ISNULL(distance), 0, distance)) AS travelled\_distance

FROM Users LEFT JOIN Rides

ON Users.id \= Rides.user\_id

GROUP BY Users.id

ORDER BY travelled\_distance DESC, name

[](#1412-find-the-quiet-students-in-all-exams--hard---leetcode)1412\. Find the Quiet Students in All Exams | Hard | 🔒 [LeetCode](https://leetcode.com/problems/find-the-quiet-students-in-all-exams)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Student`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------------+---------+

| Column Name         | Type    |

+---------------------+---------+

| student\_id          | int     |

| student\_name        | varchar |

+---------------------+---------+

student\_id is the primary key for this table.

student\_name is the name of the student.

Table: `Exam`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| exam\_id       | int     |

| student\_id    | int     |

| score         | int     |

+---------------+---------+

(exam\_id, student\_id) is the primary key for this table.

Student with student\_id got score points in exam with id exam\_id.

A "quite" student is the one who took at least one exam and didn't score neither the high score nor the low score.

Write an SQL query to report the students (student\_id, student\_name) being "quiet" in **ALL** exams.

Don't return the student who has never taken any exam. Return the result table ordered by student\_id.

The query result format is in the following example.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Student table:

+-------------+---------------+

| student\_id  | student\_name  |

+-------------+---------------+

| 1           | Daniel        |

| 2           | Jade          |

| 3           | Stella        |

| 4           | Jonathan      |

| 5           | Will          |

+-------------+---------------+

Exam table:

+------------+--------------+-----------+

| exam\_id    | student\_id   | score     |

+------------+--------------+-----------+

| 10         |     1        |    70     |

| 10         |     2        |    80     |

| 10         |     3        |    90     |

| 20         |     1        |    80     |

| 30         |     1        |    70     |

| 30         |     3        |    80     |

| 30         |     4        |    90     |

| 40         |     1        |    60     |

| 40         |     2        |    70     |

| 40         |     4        |    80     |

+------------+--------------+-----------+

Result table:

+-------------+---------------+

| student\_id  | student\_name  |

+-------------+---------------+

| 2           | Jade          |

+-------------+---------------+

For exam 1: Student 1 and 3 hold the lowest and high score respectively.

For exam 2: Student 1 hold both highest and lowest score.

For exam 3 and 4: Studnet 1 and 4 hold the lowest and high score respectively.

Student 2 and 5 have never got the highest or lowest in any of the exam.

Since student 5 is not taking any exam, he is excluded from the result.

So, we only return the information of Student 2.

### [](#solution-103)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

WITH t1 AS(

SELECT student\_id

FROM

(SELECT \*,

MIN(score) OVER(PARTITION BY exam\_id) AS least,

MAX(score) OVER(PARTITION BY exam\_id) AS most

FROM exam) a

WHERE least \= score OR most \= score)

SELECT DISTINCT student\_id, student\_name

FROM exam JOIN student

USING (student\_id)

WHERE student\_id != all(SELECT student\_id FROM t1)

order by 1

#Solution 2:

SELECT DISTINCT Student.\*

FROM Student INNER JOIN Exam

ON Student.student\_id \= Exam.student\_id

WHERE student.student\_id NOT IN

    (SELECT e1.student\_id

    FROM Exam AS e1 INNER JOIN

        (SELECT exam\_id, MIN(score) AS min\_score, MAX(score) AS max\_score

        FROM Exam

        GROUP BY exam\_id) AS e2

    ON e1.exam\_id \= e2.exam\_id

    WHERE e1.score \= e2.min\_score OR e1.score \= e2.max\_score)

ORDER BY student\_id

[](#1421-npv-queries--medium---leetcode)1421\. NPV Queries | Medium | 🔒 [LeetCode](https://leetcode.com/problems/npv-queries)
------------------------------------------------------------------------------------------------------------------------------

Table: `NPV`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| id            | int     |

| year          | int     |

| npv           | int     |

+---------------+---------+

(id, year) is the primary key of this table.

The table has information about the id and the year of each inventory and the corresponding net present value.

Table: `Queries`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| id            | int     |

| year          | int     |

+---------------+---------+

(id, year) is the primary key of this table.

The table has information about the id and the year of each inventory query.

Write an SQL query to find the npv of all each query of queries table.

Return the result table in any order.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

NPV table:

+------+--------+--------+

| id   | year   | npv    |

+------+--------+--------+

| 1    | 2018   | 100    |

| 7    | 2020   | 30     |

| 13   | 2019   | 40     |

| 1    | 2019   | 113    |

| 2    | 2008   | 121    |

| 3    | 2009   | 12     |

| 11   | 2020   | 99     |

| 7    | 2019   | 0      |

+------+--------+--------+

Queries table:

+------+--------+

| id   | year   |

+------+--------+

| 1    | 2019   |

| 2    | 2008   |

| 3    | 2009   |

| 7    | 2018   |

| 7    | 2019   |

| 7    | 2020   |

| 13   | 2019   |

+------+--------+

Result table:

+------+--------+--------+

| id   | year   | npv    |

+------+--------+--------+

| 1    | 2019   | 113    |

| 2    | 2008   | 121    |

| 3    | 2009   | 12     |

| 7    | 2018   | 0      |

| 7    | 2019   | 0      |

| 7    | 2020   | 30     |

| 13   | 2019   | 40     |

+------+--------+--------+

The npv value of (7, 2018) is not present in the NPV table, we consider it 0.

The npv values of all other queries can be found in the NPV table.

### [](#solution-104)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

SELECT q.id, q.year, COALESCE(n.npv,0) AS npv

FROM queries q

LEFT JOIN npv n

ON q.id \= n.id AND q.year\=n.year

#Solution 2:

SELECT Queries.\*, IF(ISNULL(npv), 0, npv) AS npv

FROM Queries LEFT JOIN NPV

ON Queries.id \= NPV.id AND Queries.year \= NPV.year

[](#1435-create-a-session-bar-chart--easy---leetcode)1435\. Create a Session Bar Chart | Easy | 🔒 [LeetCode](https://leetcode.com/problems/create-a-session-bar-chart)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Sessions`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------------+---------+

| Column Name         | Type    |

+---------------------+---------+

| session\_id          | int     |

| duration            | int     |

+---------------------+---------+

session\_id is the primary key for this table.

duration is the time in seconds that a user has visited the application.

You want to know how long a user visits your application. You decided to create bins of "\[0-5>", "\[5-10>", "\[10-15>" and "15 minutes or more" and count the number of sessions on it.

Write an SQL query to report the (bin, total) in **any** order.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

The query result format is in the following example.

Sessions table:

+-------------+---------------+

| session\_id  | duration      |

+-------------+---------------+

| 1           | 30            |

| 2           | 299           |

| 3           | 340           |

| 4           | 580           |

| 5           | 1000          |

+-------------+---------------+

Result table:

+--------------+--------------+

| bin          | total        |

+--------------+--------------+

| \[0-5>        | 3            |

| \[5-10>       | 1            |

| \[10-15>      | 0            |

| 15 or more   | 1            |

+--------------+--------------+

For session\_id 1, 2 and 3 have a duration greater or equal than 0 minutes and less than 5 minutes.

For session\_id 4 has a duration greater or equal than 5 minutes and less than 10 minutes.

There are no session with a duration greater or equial than 10 minutes and less than 15 minutes.

For session\_id 5 has a duration greater or equal than 15 minutes.

### [](#solution-105)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

(SELECT '\[0-5>' AS bin,

 SUM(CASE WHEN duration/60 < 5 THEN 1 ELSE 0 END) AS total FROM Sessions)

 UNION

(SELECT '\[5-10>' AS bin,

 SUM(CASE WHEN ((duration/60 \>= 5) AND (duration/60 < 10)) THEN 1 ELSE 0 END) AS total FROM Sessions)

 UNION

(SELECT '\[10-15>' AS bin,

 SUM(CASE WHEN ((duration/60 \>= 10) AND (duration/60 < 15)) THEN 1 ELSE 0 END) AS total FROM Sessions)

 UNION

(SELECT '15 or more' AS bin,

 SUM(CASE WHEN duration/60 \>= 15 THEN 1 ELSE 0 END) AS total FROM Sessions)

#Solution 2:

SELECT '\[0-5>' AS bin, count(1) AS total

FROM Sessions

WHERE duration\>=0 AND duration < 300

UNION

SELECT '\[5-10>' AS bin, count(1) AS total

FROM Sessions

WHERE duration\>=300 AND duration < 600

UNION

SELECT '\[10-15>' AS bin, count(1) AS total

FROM Sessions

WHERE duration\>=600 AND duration < 900

UNION

SELECT '15 or more' AS bin, count(1) AS total

FROM Sessions

WHERE duration \>= 900

[](#1440-evaluate-boolean-expression--medium---leetcode)1440\. Evaluate Boolean Expression | Medium | 🔒 [LeetCode](https://leetcode.com/problems/evaluate-boolean-expression)
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table `Variables`:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| name          | varchar |

| value         | int     |

+---------------+---------+

name is the primary key for this table.

This table contains the stored variables and their values.

Table `Expressions`:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| left\_operand  | varchar |

| operator      | enum    |

| right\_operand | varchar |

+---------------+---------+

(left\_operand, operator, right\_operand) is the primary key for this table.

This table contains a boolean expression that should be evaluated.

operator is an enum that takes one of the values ('<', '>', '=')

The values of left\_operand and right\_operand are guaranteed to be in the Variables table.

Write an SQL query to evaluate the boolean expressions in `Expressions` table.

Return the result table in any order.

The query result format is in the following example.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Variables table:

+------+-------+

| name | value |

+------+-------+

| x    | 66    |

| y    | 77    |

+------+-------+

Expressions table:

+--------------+----------+---------------+

| left\_operand | operator | right\_operand |

+--------------+----------+---------------+

| x            | >        | y             |

| x            | <        | y             |

| x            | =        | y             |

| y            | >        | x             |

| y            | <        | x             |

| x            | =        | x             |

+--------------+----------+---------------+

Result table:

+--------------+----------+---------------+-------+

| left\_operand | operator | right\_operand | value |

+--------------+----------+---------------+-------+

| x            | >        | y             | false |

| x            | <        | y             | true  |

| x            | =        | y             | false |

| y            | >        | x             | true  |

| y            | <        | x             | false |

| x            | =        | x             | true  |

+--------------+----------+---------------+-------+

As shown, you need find the value of each boolean exprssion in the table using the variables table.

### [](#solution-106)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

WITH t1 AS(

SELECT e.left\_operand, e.operator, e.right\_operand, v.value AS left\_val, v\_1.value AS right\_val

FROM expressions e

JOIN variables v

ON v.name \= e.left\_operand

JOIN variables v\_1

ON v\_1.name \= e.right\_operand)

SELECT t1.left\_operand, t1.operator, t1.right\_operand,

CASE WHEN t1.operator \= '<' THEN (SELECT t1.left\_val< t1.right\_val)

WHEN t1.operator \= '>' THEN (SELECT t1.left\_val \> t1.right\_val)

WHEN t1.operator \= '=' THEN (SELECT t1.left\_val \= t1.right\_val)

ELSE FALSE

END AS VALUE

FROM t1

#Solution 2:

\# nested INNER JOIN can trim the volume of the intermediate table, which gives us better performance

SELECT t.left\_operand, t.operator, t.right\_operand,

    (CASE WHEN v1\_value\>v2.value AND operator \= '>' THEN "true"

          WHEN v1\_value<v2.value AND operator \= '<' THEN "true"

          WHEN v1\_value\=v2.value AND operator \= '=' THEN "true"

          ELSE "false"

          END) AS value

FROM

   (SELECT e.\*, v1.value AS v1\_value

    FROM Expressions AS e INNER JOIN Variables AS v1

    ON e.left\_operand \= v1.name) AS t INNER JOIN Variables AS v2

    ON t.right\_operand \= v2.name

#Solution 3:

SELECT t.left\_operand, t.operator, t.right\_operand,

    (CASE WHEN operator \= '>' THEN IF(v1\_value\>v2.value, "true", "false")

          WHEN operator \= '<' THEN IF(v1\_value<v2.value, "true", "false")

          WHEN operator \= '=' THEN IF(v1\_value\=v2.value, "true", "false")

          END) AS value

FROM

   (SELECT e.\*, v1.value AS v1\_value

    FROM Expressions AS e INNER JOIN Variables AS v1

    ON e.left\_operand \= v1.name) AS t INNER JOIN Variables AS v2

    ON t.right\_operand \= v2.name

[](#1445-apples--oranges--medium---leetcode)1445\. Apples & Oranges | Medium | 🔒 [LeetCode](https://leetcode.com/problems/apples-oranges)
------------------------------------------------------------------------------------------------------------------------------------------

Table: `Sales`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| sale\_date     | date    |

| fruit         | enum    |

| sold\_num      | int     |

+---------------+---------+

(sale\_date,fruit) is the primary key for this table.

This table contains the sales of "apples" and "oranges" sold each day.

Write an SQL query to report the difference between number of **apples** and **oranges** sold each day.

Return the result table ordered by sale\_date in format ('YYYY-MM-DD').

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Sales table:

+------------+------------+-------------+

| sale\_date  | fruit      | sold\_num    |

+------------+------------+-------------+

| 2020-05-01 | apples     | 10          |

| 2020-05-01 | oranges    | 8           |

| 2020-05-02 | apples     | 15          |

| 2020-05-02 | oranges    | 15          |

| 2020-05-03 | apples     | 20          |

| 2020-05-03 | oranges    | 0           |

| 2020-05-04 | apples     | 15          |

| 2020-05-04 | oranges    | 16          |

+------------+------------+-------------+

Result table:

+------------+--------------+

| sale\_date  | diff         |

+------------+--------------+

| 2020-05-01 | 2            |

| 2020-05-02 | 0            |

| 2020-05-03 | 20           |

| 2020-05-04 | -1           |

+------------+--------------+

Day 2020-05-01, 10 apples and 8 oranges were sold (Difference  10 - 8 = 2).

Day 2020-05-02, 15 apples and 15 oranges were sold (Difference 15 - 15 = 0).

Day 2020-05-03, 20 apples and 0 oranges were sold (Difference 20 - 0 = 20).

Day 2020-05-04, 15 apples and 16 oranges were sold (Difference 15 - 16 = -1).

### [](#solution-107)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

SELECT sale\_date, sum(CASE WHEN fruit\='apples' THEN sold\_num ELSE \-sold\_num END) AS diff

FROM Sales

GROUP BY sale\_date

#Solution 2:

SELECT sale\_date, sold\_num\-sold AS diff

FROM

((SELECT \*

FROM sales

WHERE fruit \= 'apples') a

JOIN

(SELECT sale\_date AS sale, fruit, sold\_num AS sold

FROM sales

WHERE fruit \= 'oranges') b

ON a.sale\_date \= b.sale)

[](#1454-active-users--medium---leetcode)1454\. Active Users | Medium | 🔒 [LeetCode](https://leetcode.com/problems/active-users)
---------------------------------------------------------------------------------------------------------------------------------

Table `Accounts`:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| id            | int     |

| name          | varchar |

+---------------+---------+

the id is the primary key for this table.

This table contains the account id and the user name of each account.

Table `Logins`:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| id            | int     |

| login\_date    | date    |

+---------------+---------+

There is no primary key for this table, it may contain duplicates.

This table contains the account id of the user who logged in and the login date. A user may log in multiple times in the day.

Write an SQL query to find the id and the name of active users.

Active users are those who logged in to their accounts for 5 or more consecutive days.

Return the result table **ordered** by the id.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Accounts table:

+----+----------+

| id | name     |

+----+----------+

| 1  | Winston  |

| 7  | Jonathan |

+----+----------+

Logins table:

+----+------------+

| id | login\_date |

+----+------------+

| 7  | 2020-05-30 |

| 1  | 2020-05-30 |

| 7  | 2020-05-31 |

| 7  | 2020-06-01 |

| 7  | 2020-06-02 |

| 7  | 2020-06-02 |

| 7  | 2020-06-03 |

| 1  | 2020-06-07 |

| 7  | 2020-06-10 |

+----+------------+

Result table:

+----+----------+

| id | name     |

+----+----------+

| 7  | Jonathan |

+----+----------+

User Winston with id = 1 logged in 2 times only in 2 different days, so, Winston is not an active user.

User Jonathan with id = 7 logged in 7 times in 6 different days, five of them were consecutive days, so, Jonathan is an active user.

Follow up question: Can you write a general solution if the active users are those who logged in to their accounts for n or more consecutive days?

### [](#solution-108)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

WITH t1 AS (

SELECT id,login\_date,

lead(login\_date,4) OVER(PARTITION BY id ORDER BY login\_date) date\_5

FROM (SELECT DISTINCT \* FROM Logins) b

)

SELECT DISTINCT a.id, a.name FROM t1

INNER JOIN accounts a

ON t1.id \= a.id

WHERE DATEDIFF(t1.date\_5,login\_date) \= 4

ORDER BY id

#Soltion 2:

SELECT \*

FROM Accounts

WHERE id IN

    (SELECT DISTINCT t1.id

    FROM Logins AS t1 INNER JOIN Logins AS t2

    ON t1.id \= t2.id AND datediff(t1.login\_date, t2.login\_date) BETWEEN 1 AND 4

    GROUP BY t1.id, t1.login\_date

    HAVING count(DISTINCT(t2.login\_date)) \= 4)

ORDER BY id

[](#1459-rectangles-area--medium---leetcode)1459\. Rectangles Area | Medium | 🔒 [LeetCode](https://leetcode.com/problems/rectangles-area)
------------------------------------------------------------------------------------------------------------------------------------------

Table: `Points`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| id            | int     |

| x\_value       | int     |

| y\_value       | int     |

+---------------+---------+

id is the primary key for this table.

Each point is represented as a 2D Dimensional (x\_value, y\_value).

Write an SQL query to report of all possible rectangles which can be formed by any two points of the table.

Each row in the result contains three columns (p1, p2, area) where:

*   **p1** and **p2** are the id of two opposite corners of a rectangle and p1 < p2.
*   Area of this rectangle is represented by the column **area**. Report the query in descending order by area in case of tie in ascending order by p1 and p2.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Points table:

+----------+-------------+-------------+

| id       | x\_value     | y\_value     |

+----------+-------------+-------------+

| 1        | 2           | 8           |

| 2        | 4           | 7           |

| 3        | 2           | 10          |

+----------+-------------+-------------+

Result table:

+----------+-------------+-------------+

| p1       | p2          | area        |

+----------+-------------+-------------+

| 2        | 3           | 6           |

| 1        | 2           | 2           |

+----------+-------------+-------------+

p1 should be less than p2 and area greater than 0.

p1 = 1 and p2 = 2, has an area equal to |2-4| \* |8-7| = 2.

p1 = 2 and p2 = 3, has an area equal to |4-2| \* |7-10| = 2.

p1 = 1 and p2 = 3 It's not possible because has an area equal to 0.

### [](#solution-109)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT t1.id AS p1, t2.id AS p2, ABS(t1.x\_value\-t2.x\_value)\*ABS(t1.y\_value\-t2.y\_value) AS area

FROM Points AS t1 INNER JOIN Points AS t2

ON t1.id < t2.id

AND t1.x\_value != t2.x\_value AND t1.y\_value != t2.y\_value

ORDER BY area DESC, p1, p2

[](#1468-calculate-salaries--medium---leetcode)1468\. Calculate Salaries | Medium | 🔒 [LeetCode](https://leetcode.com/problems/calculate-salaries)
---------------------------------------------------------------------------------------------------------------------------------------------------

Table `Salaries`:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| company\_id    | int     |

| employee\_id   | int     |

| employee\_name | varchar |

| salary        | int     |

+---------------+---------+

(company\_id, employee\_id) is the primary key for this table.

This table contains the company id, the id, the name and the salary for an employee.

Write an SQL query to find the salaries of the employees after applying taxes.

The tax rate is calculated for each company based on the following criteria:

*   0% If the max salary of any employee in the company is less than 1000$.
*   24% If the max salary of any employee in the company is in the range \[1000, 10000\] inclusive.
*   49% If the max salary of any employee in the company is greater than 10000$.  
    Return the result table **in any order**. Round the salary to the nearest integer.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Salaries table:

+------------+-------------+---------------+--------+

| company\_id | employee\_id | employee\_name | salary |

+------------+-------------+---------------+--------+

| 1          | 1           | Tony          | 2000   |

| 1          | 2           | Pronub        | 21300  |

| 1          | 3           | Tyrrox        | 10800  |

| 2          | 1           | Pam           | 300    |

| 2          | 7           | Bassem        | 450    |

| 2          | 9           | Hermione      | 700    |

| 3          | 7           | Bocaben       | 100    |

| 3          | 2           | Ognjen        | 2200   |

| 3          | 13          | Nyancat       | 3300   |

| 3          | 15          | Morninngcat   | 1866   |

+------------+-------------+---------------+--------+

Result table:

+------------+-------------+---------------+--------+

| company\_id | employee\_id | employee\_name | salary |

+------------+-------------+---------------+--------+

| 1          | 1           | Tony          | 1020   |

| 1          | 2           | Pronub        | 10863  |

| 1          | 3           | Tyrrox        | 5508   |

| 2          | 1           | Pam           | 300    |

| 2          | 7           | Bassem        | 450    |

| 2          | 9           | Hermione      | 700    |

| 3          | 7           | Bocaben       | 76     |

| 3          | 2           | Ognjen        | 1672   |

| 3          | 13          | Nyancat       | 2508   |

| 3          | 15          | Morninngcat   | 5911   |

+------------+-------------+---------------+--------+

For company 1, Max salary is 21300. Employees in company 1 have taxes = 49%

For company 2, Max salary is 700. Employees in company 2 have taxes = 0%

For company 3, Max salary is 7777. Employees in company 3 have taxes = 24%

The salary after taxes = salary - (taxes percentage / 100) \* salary

For example, Salary for Morninngcat (3, 15) after taxes = 7777 - 7777 \* (24 / 100) = 7777 - 1866.48 = 5910.52, which is rounded to 5911.

### [](#solution-110)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

WITH t1 AS (

SELECT company\_id, employee\_id, employee\_name, salary AS sa, MAX(salary) OVER(PARTITION BY company\_id) AS maximum

FROM salaries)

SELECT company\_id, employee\_id, employee\_name,

CASE WHEN t1.maximum<1000 THEN t1.sa

WHEN t1.maximum BETWEEN 1000 AND 10000 THEN ROUND(t1.sa\*.76,0)

ELSE ROUND(t1.sa\*.51,0)

END AS salary

FROM t1

#Soltion 2:

SELECT Salaries.company\_id, Salaries.employee\_id, Salaries.employee\_name,

    ROUND(CASE WHEN salary\_max<1000 THEN Salaries.salary

               WHEN salary\_max\>=1000 AND salary\_max<=10000 THEN Salaries.salary \* 0.76

               ELSE Salaries.salary \* 0.51 END, 0) AS salary

FROM Salaries INNER JOIN (

    SELECT company\_id, MAX(salary) AS salary\_max

    FROM Salaries

    GROUP BY company\_id) AS t

ON Salaries.company\_id \= t.company\_id

[](#1479-sales-by-day-of-the-week--hard---leetcode)1479\. Sales by Day of the Week | Hard | 🔒 [LeetCode](https://leetcode.com/problems/sales-by-day-of-the-week)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Orders`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| order\_id      | int     |

| customer\_id   | int     |

| order\_date    | date    |

| item\_id       | varchar |

| quantity      | int     |

+---------------+---------+

(ordered\_id, item\_id) is the primary key for this table.

This table contains information of the orders placed.

order\_date is the date when item\_id was ordered by the customer with id customer\_id.

Table: `Items`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------------+---------+

| Column Name         | Type    |

+---------------------+---------+

| item\_id             | varchar |

| item\_name           | varchar |

| item\_category       | varchar |

+---------------------+---------+

item\_id is the primary key for this table.

item\_name is the name of the item.

item\_category is the category of the item.

You are the business owner and would like to obtain a sales report for category items and day of the week.

Write an SQL query to report how many units in each category have been ordered on each **day of the week**.

Return the result table **ordered** by category.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Orders table:

+------------+--------------+-------------+--------------+-------------+

| order\_id   | customer\_id  | order\_date  | item\_id      | quantity    |

+------------+--------------+-------------+--------------+-------------+

| 1          | 1            | 2020-06-01  | 1            | 10          |

| 2          | 1            | 2020-06-08  | 2            | 10          |

| 3          | 2            | 2020-06-02  | 1            | 5           |

| 4          | 3            | 2020-06-03  | 3            | 5           |

| 5          | 4            | 2020-06-04  | 4            | 1           |

| 6          | 4            | 2020-06-05  | 5            | 5           |

| 7          | 5            | 2020-06-05  | 1            | 10          |

| 8          | 5            | 2020-06-14  | 4            | 5           |

| 9          | 5            | 2020-06-21  | 3            | 5           |

+------------+--------------+-------------+--------------+-------------+

Items table:

+------------+----------------+---------------+

| item\_id    | item\_name      | item\_category |

+------------+----------------+---------------+

| 1          | LC Alg. Book   | Book          |

| 2          | LC DB. Book    | Book          |

| 3          | LC SmarthPhone | Phone         |

| 4          | LC Phone 2020  | Phone         |

| 5          | LC SmartGlass  | Glasses       |

| 6          | LC T-Shirt XL  | T-Shirt       |

+------------+----------------+---------------+

Result table:

+------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+

| Category   | Monday    | Tuesday   | Wednesday | Thursday  | Friday    | Saturday  | Sunday    |

+------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+

| Book       | 20        | 5         | 0         | 0         | 10        | 0         | 0         |

| Glasses    | 0         | 0         | 0         | 0         | 5         | 0         | 0         |

| Phone      | 0         | 0         | 5         | 1         | 0         | 0         | 10        |

| T-Shirt    | 0         | 0         | 0         | 0         | 0         | 0         | 0         |

+------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+

On Monday (2020-06-01, 2020-06-08) were sold a total of 20 units (10 + 10) in the category Book (ids: 1, 2).

On Tuesday (2020-06-02) were sold a total of 5 units  in the category Book (ids: 1, 2).

On Wednesday (2020-06-03) were sold a total of 5 units in the category Phone (ids: 3, 4).

On Thursday (2020-06-04) were sold a total of 1 unit in the category Phone (ids: 3, 4).

On Friday (2020-06-05) were sold 10 units in the category Book (ids: 1, 2) and 5 units in Glasses (ids: 5).

On Saturday there are no items sold.

On Sunday (2020-06-14, 2020-06-21) were sold a total of 10 units (5 +5) in the category Phone (ids: 3, 4).

There are no sales of T-Shirt.

### [](#solution-111)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

WITH t1 AS(

SELECT DISTINCT item\_category,

CASE WHEN dayname(order\_date)\='Monday' THEN SUM(quantity) OVER(PARTITION BY item\_category,dayname(order\_date)) ELSE 0 END AS Monday,

CASE WHEN dayname(order\_date)\='Tuesday' THEN SUM(quantity) OVER(PARTITION BY item\_category,dayname(order\_date)) ELSE 0 END AS Tuesday,

CASE WHEN dayname(order\_date)\='Wednesday' THEN SUM(quantity) OVER(PARTITION BY item\_category,dayname(order\_date)) ELSE 0 END AS Wednesday,

CASE WHEN dayname(order\_date)\='Thursday' THEN SUM(quantity) OVER(PARTITION BY item\_category,dayname(order\_date)) ELSE 0 END AS Thursday,

CASE WHEN dayname(order\_date)\='Friday' THEN SUM(quantity) OVER(PARTITION BY item\_category,dayname(order\_date)) ELSE 0 END AS Friday,

CASE WHEN dayname(order\_date)\='Saturday' THEN SUM(quantity) OVER(PARTITION BY item\_category,dayname(order\_date)) ELSE 0 END AS Saturday,

CASE WHEN dayname(order\_date)\='Sunday' THEN SUM(quantity) OVER(PARTITION BY item\_category,dayname(order\_date)) ELSE 0 END AS Sunday

FROM orders o

RIGHT JOIN items i

USING (item\_id))

SELECT item\_category AS category, SUM(Monday) AS Monday, SUM(Tuesday) AS Tuesday, SUM(Wednesday) Wednesday, SUM(Thursday) Thursday,

SUM(Friday) Friday, SUM(Saturday) Saturday, SUM(Sunday) Sunday

FROM t1

GROUP BY item\_category

[](#1484-group-sold-products-by-the-date--easy---leetcode)1484\. Group Sold Products By The Date | Easy | 🔒 [LeetCode](https://leetcode.com/problems/group-sold-products-by-the-date)
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table `Activities`:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| sell\_date   | date    |

| product     | varchar |

+-------------+---------+

There is no primary key for this table, it may contains duplicates.

Each row of this table contains the product name and the date it was sold in a market.

Write an SQL query to find for each date, the number of distinct products sold and their names.

The sold-products names for each date should be sorted lexicographically.

Return the result table ordered by `sell_date`.

The query result format is in the following example.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Activities table:

+------------+-------------+

| sell\_date  | product     |

+------------+-------------+

| 2020-05-30 | Headphone   |

| 2020-06-01 | Pencil      |

| 2020-06-02 | Mask        |

| 2020-05-30 | Basketball  |

| 2020-06-01 | Bible       |

| 2020-06-02 | Mask        |

| 2020-05-30 | T-Shirt     |

+------------+-------------+

Result table:

+------------+----------+------------------------------+

| sell\_date  | num\_sold | products                     |

+------------+----------+------------------------------+

| 2020-05-30 | 3        | Basketball,Headphone,T-shirt |

| 2020-06-01 | 2        | Bible,Pencil                 |

| 2020-06-02 | 1        | Mask                         |

+------------+----------+------------------------------+

For 2020-05-30, Sold items were (Headphone, Basketball, T-shirt), we sort them lexicographically and separate them by comma.

For 2020-06-01, Sold items were (Pencil, Bible), we sort them lexicographically and separate them by comma.

For 2020-06-02, Sold item is (Masks), we just return it.

### [](#solution-112)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT sell\_date, COUNT(DISTINCT product) AS num\_sold, group\_concat(DISTINCT product) AS products

FROM activities

GROUP BY 1

ORDER BY 1

[](#1495-friendly-movies-streamed-last-month--easy---leetcode)1495\. Friendly Movies Streamed Last Month | Easy | 🔒 [LeetCode](https://leetcode.com/problems/friendly-movies-streamed-last-month)
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `TVProgram`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| program\_date  | date    |

| content\_id    | int     |

| channel       | varchar |

+---------------+---------+

(program\_date, content\_id) is the primary key for this table.

This table contains information of the programs on the TV.

content\_id is the id of the program in some channel on the TV.

Table: `Content`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+------------------+---------+

| Column Name      | Type    |

+------------------+---------+

| content\_id       | varchar |

| title            | varchar |

| Kids\_content     | enum    |

| content\_type     | varchar |

+------------------+---------+

content\_id is the primary key for this table.

Kids\_content is an enum that takes one of the values ('Y', 'N') where:

'Y' means is content for kids otherwise 'N' is not content for kids.

content\_type is the category of the content as movies, series, etc.

Write an SQL query to report the distinct titles of the kid-friendly movies streamed in June 2020.

Return the result table in any order.

The query result format is in the following example.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

TVProgram table:

+--------------------+--------------+-------------+

| program\_date       | content\_id   | channel     |

+--------------------+--------------+-------------+

| 2020-06-10 08:00   | 1            | LC-Channel  |

| 2020-05-11 12:00   | 2            | LC-Channel  |

| 2020-05-12 12:00   | 3            | LC-Channel  |

| 2020-05-13 14:00   | 4            | Disney Ch   |

| 2020-06-18 14:00   | 4            | Disney Ch   |

| 2020-07-15 16:00   | 5            | Disney Ch   |

+--------------------+--------------+-------------+

Content table:

+------------+----------------+---------------+---------------+

| content\_id | title          | Kids\_content  | content\_type  |

+------------+----------------+---------------+---------------+

| 1          | Leetcode Movie | N             | Movies        |

| 2          | Alg. for Kids  | Y             | Series        |

| 3          | Database Sols  | N             | Series        |

| 4          | Aladdin        | Y             | Movies        |

| 5          | Cinderella     | Y             | Movies        |

+------------+----------------+---------------+---------------+

Result table:

+--------------+

| title        |

+--------------+

| Aladdin      |

+--------------+

"Leetcode Movie" is not a content for kids.

"Alg. for Kids" is not a movie.

"Database Sols" is not a movie

"Alladin" is a movie, content for kids and was streamed in June 2020.

"Cinderella" was not streamed in June 2020.

### [](#solution-113)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELCT DISTINCT title

FROM

(SELCT content\_id, title

FROM content

WHERE kids\_content \= 'Y' AND content\_type \= 'Movies') a

JOIN

tvprogram USING (content\_id)

WHERE month(program\_date) \= 6

[](#1501-countries-you-can-safely-invest-in--medium---leetcode)1501\. Countries You Can Safely Invest In | Medium | 🔒 [LeetCode](https://leetcode.com/problems/countries-you-can-safely-invest-in)
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table `Person`:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----------------+---------+

| Column Name    | Type    |

+----------------+---------+

| id             | int     |

| name           | varchar |

| phone\_number   | varchar |

+----------------+---------+

id is the primary key for this table.

Each row of this table contains the name of a person and their phone number.

Phone number will be in the form 'xxx-yyyyyyy' where xxx is the country code (3 characters) and yyyyyyy is the phone number (7 characters) where x and y are digits. Both can contain leading zeros.

Table `Country`:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----------------+---------+

| Column Name    | Type    |

+----------------+---------+

| name           | varchar |

| country\_code   | varchar |

+----------------+---------+

country\_code is the primary key for this table.

Each row of this table contains the country name and its code. country\_code will be in the form 'xxx' where x is digits.

Table `Calls`:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+------+

| Column Name | Type |

+-------------+------+

| caller\_id   | int  |

| callee\_id   | int  |

| duration    | int  |

+-------------+------+

There is no primary key for this table, it may contain duplicates.

Each row of this table contains the caller id, callee id and the duration of the call in minutes. caller\_id != callee\_id

A telecommunications company wants to invest in new countries. The country intends to invest in the countries where the average call duration of the calls in this country is strictly greater than the global average call duration.

Write an SQL query to find the countries where this company can invest.

Return the result table in any order.

The query result format is in the following example.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Person table:

+----+----------+--------------+

| id | name     | phone\_number |

+----+----------+--------------+

| 3  | Jonathan | 051-1234567  |

| 12 | Elvis    | 051-7654321  |

| 1  | Moncef   | 212-1234567  |

| 2  | Maroua   | 212-6523651  |

| 7  | Meir     | 972-1234567  |

| 9  | Rachel   | 972-0011100  |

+----+----------+--------------+

Country table:

+----------+--------------+

| name     | country\_code |

+----------+--------------+

| Peru     | 051          |

| Israel   | 972          |

| Morocco  | 212          |

| Germany  | 049          |

| Ethiopia | 251          |

+----------+--------------+

Calls table:

+-----------+-----------+----------+

| caller\_id | callee\_id | duration |

+-----------+-----------+----------+

| 1         | 9         | 33       |

| 2         | 9         | 4        |

| 1         | 2         | 59       |

| 3         | 12        | 102      |

| 3         | 12        | 330      |

| 12        | 3         | 5        |

| 7         | 9         | 13       |

| 7         | 1         | 3        |

| 9         | 7         | 1        |

| 1         | 7         | 7        |

+-----------+-----------+----------+

Result table:

+----------+

| country  |

+----------+

| Peru     |

+----------+

The average call duration for Peru is (102 + 102 + 330 + 330 + 5 + 5) / 6 = 145.666667

The average call duration for Israel is (33 + 4 + 13 + 13 + 3 + 1 + 1 + 7) / 8 = 9.37500

The average call duration for Morocco is (33 + 4 + 59 + 59 + 3 + 7) / 6 = 27.5000

Global call duration average = (2 \* (33 + 3 + 59 + 102 + 330 + 5 + 13 + 3 + 1 + 7)) / 20 = 55.70000

Since Peru is the only country where average call duration is greater than the global average, it's the only recommended country.

### [](#solution-114)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

WITH t1 AS(

SELECT caller\_id AS id, duration AS total

FROM

(SELECT caller\_id, duration

FROM calls

UNION ALL

SELECT callee\_id, duration

FROM calls) a

)

SELECT name AS country

FROM

(SELECT distinct avg(total) OVER(PARTITION BY code) AS avg\_call, avg(total) OVER() AS global\_avg, c.name

FROM

((SELECT \*, coalesce(total,0) AS duration, SUBSTRING(phone\_number FROM 1 for 3) AS code

FROM person RIGHT JOIN t1

USING (id)) b

join country c

ON c.country\_code \= b.code)) d

WHERE avg\_call \> global\_avg

[](#1511-customer-order-frequency--easy---leetcode)1511\. Customer Order Frequency | Easy | 🔒 [LeetCode](https://leetcode.com/problems/customer-order-frequency)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Customers`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| customer\_id   | int     |

| name          | varchar |

| country       | varchar |

+---------------+---------+

customer\_id is the primary key for this table.

This table contains information of the customers in the company.

Table: `Product`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| product\_id    | int     |

| description   | varchar |

| price         | int     |

+---------------+---------+

product\_id is the primary key for this table.

This table contains information of the products in the company.

price is the product cost.

Table: `Orders`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| order\_id      | int     |

| customer\_id   | int     |

| product\_id    | int     |

| order\_date    | date    |

| quantity      | int     |

+---------------+---------+

order\_id is the primary key for this table.

This table contains information on customer orders.

customer\_id is the id of the customer who bought "quantity" products with id "product\_id".

Order\_date is the date in format ('YYYY-MM-DD') when the order was shipped.

Write an SQL query to report the customer\_id and customer\_name of customers who have spent at least $100 in each month of June and July 2020.

Return the result table in any order.

The query result format is in the following example.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Customers

+--------------+-----------+-------------+

| customer\_id  | name      | country     |

+--------------+-----------+-------------+

| 1            | Winston   | USA         |

| 2            | Jonathan  | Peru        |

| 3            | Moustafa  | Egypt       |

+--------------+-----------+-------------+

Product

+--------------+-------------+-------------+

| product\_id   | description | price       |

+--------------+-------------+-------------+

| 10           | LC Phone    | 300         |

| 20           | LC T-Shirt  | 10          |

| 30           | LC Book     | 45          |

| 40           | LC Keychain | 2           |

+--------------+-------------+-------------+

Orders

+--------------+-------------+-------------+-------------+-----------+

| order\_id     | customer\_id | product\_id  | order\_date  | quantity  |

+--------------+-------------+-------------+-------------+-----------+

| 1            | 1           | 10          | 2020-06-10  | 1         |

| 2            | 1           | 20          | 2020-07-01  | 1         |

| 3            | 1           | 30          | 2020-07-08  | 2         |

| 4            | 2           | 10          | 2020-06-15  | 2         |

| 5            | 2           | 40          | 2020-07-01  | 10        |

| 6            | 3           | 20          | 2020-06-24  | 2         |

| 7            | 3           | 30          | 2020-06-25  | 2         |

| 9            | 3           | 30          | 2020-05-08  | 3         |

+--------------+-------------+-------------+-------------+-----------+

Result table:

+--------------+------------+

| customer\_id  | name       |

+--------------+------------+

| 1            | Winston    |

+--------------+------------+

Winston spent $300 (300 \* 1) in June and $100 ( 10 \* 1 + 45 \* 2) in July 2020.

Jonathan spent $600 (300 \* 2) in June and $20 ( 2 \* 10) in July 2020.

Moustafa spent $110 (10 \* 2 + 45 \* 2) in June and $0 in July 2020.

### [](#solution-115)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

SELECT o.customer\_id, name

JOIN Product p

ON o.product\_id \= p.product\_id

JOIN Customers c

ON o.customer\_id \= c.customer\_id

GROUP BY 1, 2

HAVING SUM(CASE WHEN date\_format(order\_date, '%Y-%m')\='2020-06'

THEN price\*quantity END) \>= 100

AND

SUM(CASE WHEN date\_format(order\_date, '%Y-%m')\='2020-07'

THEN price\*quantity END) \>= 100;

#Solution 2:

SELECT customer\_id, name

FROM

(

    SELECT o.customer\_id, c.name,

        sum(CASE WHEN left(o.order\_date,7) \= '2020-06' THEN p.price \* o.quantity END) AS JuneSpend,

        sum(CASE WHEN left(o.order\_date,7) \= '2020-07' THEN p.price \* o.quantity END) AS JulySpend

    FROM Orders o

    LEFT JOIN Customers c ON o.customer\_id \= c.customer\_id

    lEFT JOIN Product p ON o.product\_id \= p.product\_id

    GROUP BY o.customer\_id

    HAVING JuneSpend \>= 100 AND JulySpend \>= 100

) AS temp

#Solution 3:

SELECT o.customer\_id, c.name

FROM Customers c, Product p, Orders o

WHERE c.customer\_id \= o.customer\_id AND p.product\_id \= o.product\_id

GROUP BY o.customer\_id

HAVING

(

    SUM(CASE WHEN o.order\_date LIKE '2020-06%' THEN o.quantity\*p.price ELSE 0 END) \>= 100

    and

    SUM(CASE WHEN o.order\_date LIKE '2020-07%' THEN o.quantity\*p.price ELSE 0 END) \>= 100

);

[](#1517-find-users-with-valid-e-mails--easy---leetcode)1517\. Find Users With Valid E-Mails | Easy | 🔒 [LeetCode](https://leetcode.com/problems/find-users-with-valid-e-mails)
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Users`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| user\_id       | int     |

| name          | varchar |

| mail          | varchar |

+---------------+---------+

user\_id is the primary key for this table.

This table contains information of the users signed up in a website. Some e-mails are invalid.

Write an SQL query to find the users who have **valid emails**.

A valid e-mail has a prefix name and a domain where:

*   **The prefix name** is a string that may contain letters (upper or lower case), digits, underscore `'_'`, period `'.'` and/or dash `'-'`. The prefix name **must** start with a letter.
*   The domain is `'@leetcode.com'`.  
    Return the result table in any order.

The query result format is in the following example.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Users

+---------+-----------+-------------------------+

| user\_id | name      | mail                    |

+---------+-----------+-------------------------+

| 1       | Winston   | [\[email protected\]](/cdn-cgi/l/email-protection)    |

| 2       | Jonathan  | jonathanisgreat         |

| 3       | Annabelle | [\[email protected\]](/cdn-cgi/l/email-protection)     |

| 4       | Sally     | [\[email protected\]](/cdn-cgi/l/email-protection) |

| 5       | Marwan    | quarz#[\[email protected\]](/cdn-cgi/l/email-protection) |

| 6       | David     | [\[email protected\]](/cdn-cgi/l/email-protection)       |

| 7       | Shapiro   | [\[email protected\]](/cdn-cgi/l/email-protection)     |

+---------+-----------+-------------------------+

Result table:

+---------+-----------+-------------------------+

| user\_id | name      | mail                    |

+---------+-----------+-------------------------+

| 1       | Winston   | [\[email protected\]](/cdn-cgi/l/email-protection)    |

| 3       | Annabelle | [\[email protected\]](/cdn-cgi/l/email-protection)     |

| 4       | Sally     | [\[email protected\]](/cdn-cgi/l/email-protection) |

+---------+-----------+-------------------------+

The mail of user 2 doesn't have a domain.

The mail of user 5 has # sign which is not allowed.

The mail of user 6 doesn't have leetcode domain.

The mail of user 7 starts with a period.

### [](#solution-116)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

SELECT user\_id, name, mail

FROM Users

WHERE mail regexp "^\[a-zA-Z\]+\[a-zA-Z0-9\_\\\\./\\\\-\]{0,}@leetcode\\\\.com$"

ORDER BY user\_id

#Solution 2:

SELECT \* FROM Users

WHERE regexp\_like(mail, '^\[A-Za-z\]+\[A-Za-z0-9\\\_\\.\\-\]\*@leetcode.com')

[](#1527-patients-with-a-condition--easy---leetcode)1527\. Patients With a Condition | Easy | 🔒 [LeetCode](https://leetcode.com/problems/patients-with-a-condition)
--------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Patients`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+---------+

| Column Name  | Type    |

+--------------+---------+

| patient\_id   | int     |

| patient\_name | varchar |

| conditions   | varchar |

+--------------+---------+

patient\_id is the primary key for this table.

'conditions' contains 0 or more code separated by spaces.

This table contains information of the patients in the hospital.

Write an SQL query to report the patient\_id, patient\_name all conditions of patients who have Type I Diabetes. Type I Diabetes always starts with `DIAB1` prefix

Return the result table in any order.

The query result format is in the following example.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Patients

+------------+--------------+--------------+

| patient\_id | patient\_name | conditions   |

+------------+--------------+--------------+

| 1          | Daniel       | YFEV COUGH   |

| 2          | Alice        |              |

| 3          | Bob          | DIAB100 MYOP |

| 4          | George       | ACNE DIAB100 |

| 5          | Alain        | DIAB201      |

+------------+--------------+--------------+

Result table:

+------------+--------------+--------------+

| patient\_id | patient\_name | conditions   |

+------------+--------------+--------------+

| 3          | Bob          | DIAB100 MYOP |

| 4          | George       | ACNE DIAB100 |

+------------+--------------+--------------+

Bob and George both have a condition that starts with DIAB1.

### [](#solution-117)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT patient\_id, patient\_name, conditions

FROM Patients

WHERE conditions LIKE '%DIAB1%'

[](#1532-the-most-recent-three-orders--medium---leetcode)1532\. The Most Recent Three Orders | Medium | 🔒 [LeetCode](https://leetcode.com/problems/the-most-recent-three-orders)
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Customers`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| customer\_id   | int     |

| name          | varchar |

+---------------+---------+

customer\_id is the primary key for this table.

This table contains information about customers.

Table: `Orders`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| order\_id      | int     |

| order\_date    | date    |

| customer\_id   | int     |

| cost          | int     |

+---------------+---------+

order\_id is the primary key for this table.

This table contains information about the orders made customer\_id.

Each customer has one order per day.

Write an SQL query to find the most recent 3 orders of each user. If a user ordered less than 3 orders return all of their orders.

Return the result table sorted by `customer_name` in ascending order and in case of a tie by the `customer_id` in ascending order. If there still a tie, order them by the `order_date` in descending order.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Customers

+-------------+-----------+

| customer\_id | name      |

+-------------+-----------+

| 1           | Winston   |

| 2           | Jonathan  |

| 3           | Annabelle |

| 4           | Marwan    |

| 5           | Khaled    |

+-------------+-----------+

Orders

+----------+------------+-------------+------+

| order\_id | order\_date | customer\_id | cost |

+----------+------------+-------------+------+

| 1        | 2020-07-31 | 1           | 30   |

| 2        | 2020-07-30 | 2           | 40   |

| 3        | 2020-07-31 | 3           | 70   |

| 4        | 2020-07-29 | 4           | 100  |

| 5        | 2020-06-10 | 1           | 1010 |

| 6        | 2020-08-01 | 2           | 102  |

| 7        | 2020-08-01 | 3           | 111  |

| 8        | 2020-08-03 | 1           | 99   |

| 9        | 2020-08-07 | 2           | 32   |

| 10       | 2020-07-15 | 1           | 2    |

+----------+------------+-------------+------+

Result table:

+---------------+-------------+----------+------------+

| customer\_name | customer\_id | order\_id | order\_date |

+---------------+-------------+----------+------------+

| Annabelle     | 3           | 7        | 2020-08-01 |

| Annabelle     | 3           | 3        | 2020-07-31 |

| Jonathan      | 2           | 9        | 2020-08-07 |

| Jonathan      | 2           | 6        | 2020-08-01 |

| Jonathan      | 2           | 2        | 2020-07-30 |

| Marwan        | 4           | 4        | 2020-07-29 |

| Winston       | 1           | 8        | 2020-08-03 |

| Winston       | 1           | 1        | 2020-07-31 |

| Winston       | 1           | 10       | 2020-07-15 |

+---------------+-------------+----------+------------+

Winston has 4 orders, we discard the order of "2020-06-10" because it is the oldest order.

Annabelle has only 2 orders, we return them.

Jonathan has exactly 3 orders.

Marwan ordered only one time.

We sort the result table by customer\_name in ascending order, by customer\_id in ascending order and by order\_date in descending order in case of a tie.

Follow-up:

Can you write a general solution for the most recent \`n\` orders?

### [](#solution-118)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

WITH tmp AS (

SELECT a.name, a.customer\_id, b.order\_id, b.order\_date,

ROW\_NUMBER() OVER(PARTITION BY a.name, a.customer\_id ORDER BY b.order\_date DESC) AS rnk

FROM Customers AS a

JOIN Orders AS b

ON a.customer\_id \= b.customer\_id

)

SELECT name AS customer\_name, customer\_id, order\_id, order\_date

FROM tmp

WHERE rnk <= 3

ORDER BY customer\_name, customer\_id, order\_date DESC;

[](#1543-fix-product-name-format--easy---leetcode)1543\. Fix Product Name Format | Easy | 🔒 [LeetCode](https://leetcode.com/problems/fix-product-name-format)
--------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Sales`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+---------+

| Column Name  | Type    |

+--------------+---------+

| sale\_id      | int     |

| product\_name | varchar |

| sale\_date    | date    |

+--------------+---------+

sale\_id is the primary key for this table.

Each row of this table contains the product name and the date it was sold.

Since table Sales was filled manually in the year 2000, `product_name` may contain leading and/or trailing white spaces, also they are case-insensitive.

Write an SQL query to report

*   `product_name` in lowercase without leading or trailing white spaces.
*   `sale_date` in the format `('YYYY-MM')`
*   `total` the number of times the product was sold in this month.  
    Return the result table ordered by `product_name` in **ascending order**, in case of a tie order it by `sale_date` in ascending order.

The query result format is in the following example.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Sales

+------------+------------------+--------------+

| sale\_id    | product\_name     | sale\_date    |

+------------+------------------+--------------+

| 1          |      LCPHONE     | 2000-01-16   |

| 2          |    LCPhone       | 2000-01-17   |

| 3          |     LcPhOnE      | 2000-02-18   |

| 4          |      LCKeyCHAiN  | 2000-02-19   |

| 5          |   LCKeyChain     | 2000-02-28   |

| 6          | Matryoshka       | 2000-03-31   |

+------------+------------------+--------------+

Result table:

+--------------+--------------+----------+

| product\_name | sale\_date    | total    |

+--------------+--------------+----------+

| lcphone      | 2000-01      | 2        |

| lckeychain   | 2000-02      | 2        |

| lcphone      | 2000-02      | 1        |

| matryoshka   | 2000-03      | 1        |

+--------------+--------------+----------+

In January, 2 LcPhones were sold, please note that the product names are not case sensitive and may contain spaces.

In Februery, 2 LCKeychains and 1 LCPhone were sold.

In March, 1 matryoshka was sold.

### [](#solution-119)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT TRIM(LOWER(product\_name)) AS product\_name,

       DATE\_FORMAT(sale\_date, '%Y-%m') AS sale\_date,

       COUNT(\*) AS total

FROM Sales

GROUP BY 1, DATE\_FORMAT(sale\_date, '%Y-%m')

ORDER BY 1, 2;

[](#1549-the-most-recent-orders-for-each-product--medium---leetcode)1549\. The Most Recent Orders for Each Product | Medium | 🔒 [LeetCode](https://leetcode.com/problems/the-most-recent-orders-for-each-product)
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Customers`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| customer\_id   | int     |

| name          | varchar |

+---------------+---------+

customer\_id is the primary key for this table.

This table contains information about the customers.

Table: `Orders`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| order\_id      | int     |

| order\_date    | date    |

| customer\_id   | int     |

| product\_id    | int     |

+---------------+---------+

order\_id is the primary key for this table.

This table contains information about the orders made by customer\_id.

There will be no product ordered by the same user more than once in one day.

Table: `Products`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| product\_id    | int     |

| product\_name  | varchar |

| price         | int     |

+---------------+---------+

product\_id is the primary key for this table.

This table contains information about the Products.

Write an SQL query to find the most recent order(s) of each product.

Return the result table sorted by `product_name` in **ascending** order and in case of a tie by the `product_id` in **ascending** order. If there still a tie, order them by the `order_id` in **ascending** order.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Customers

+-------------+-----------+

| customer\_id | name      |

+-------------+-----------+

| 1           | Winston   |

| 2           | Jonathan  |

| 3           | Annabelle |

| 4           | Marwan    |

| 5           | Khaled    |

+-------------+-----------+

Orders

+----------+------------+-------------+------------+

| order\_id | order\_date | customer\_id | product\_id |

+----------+------------+-------------+------------+

| 1        | 2020-07-31 | 1           | 1          |

| 2        | 2020-07-30 | 2           | 2          |

| 3        | 2020-08-29 | 3           | 3          |

| 4        | 2020-07-29 | 4           | 1          |

| 5        | 2020-06-10 | 1           | 2          |

| 6        | 2020-08-01 | 2           | 1          |

| 7        | 2020-08-01 | 3           | 1          |

| 8        | 2020-08-03 | 1           | 2          |

| 9        | 2020-08-07 | 2           | 3          |

| 10       | 2020-07-15 | 1           | 2          |

+----------+------------+-------------+------------+

Products

+------------+--------------+-------+

| product\_id | product\_name | price |

+------------+--------------+-------+

| 1          | keyboard     | 120   |

| 2          | mouse        | 80    |

| 3          | screen       | 600   |

| 4          | hard disk    | 450   |

+------------+--------------+-------+

Result table:

+--------------+------------+----------+------------+

| product\_name | product\_id | order\_id | order\_date |

+--------------+------------+----------+------------+

| keyboard     | 1          | 6        | 2020-08-01 |

| keyboard     | 1          | 7        | 2020-08-01 |

| mouse        | 2          | 8        | 2020-08-03 |

| screen       | 3          | 3        | 2020-08-29 |

+--------------+------------+----------+------------+

keyboard's most recent order is in 2020-08-01, it was ordered two times this day.

mouse's most recent order is in 2020-08-03, it was ordered only once this day.

screen's most recent order is in 2020-08-29, it was ordered only once this day.

The hard disk was never ordered and we don't include it in the result table.

### [](#solution-120)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT p.product\_name, o.product\_id, o.order\_id, o.order\_date

FROM(

    SELECT product\_id, order\_id, order\_date,

    RANK() OVER(PARTITION BY product\_id ORDER BY order\_date DESC) AS seq

    FROM orders

) o

LEFT JOIN products p

    ON o.product\_id \= p.product\_id

WHERE o.seq \= 1

ORDER BY 1,2,3

[](#1555-bank-account-summary--medium---leetcode)1555\. Bank Account Summary | Medium | 🔒 [LeetCode](https://leetcode.com/problems/bank-account-summary)
---------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Users`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+---------+

| Column Name  | Type    |

+--------------+---------+

| user\_id      | int     |

| user\_name    | varchar |

| credit       | int     |

+--------------+---------+

user\_id is the primary key for this table.

Each row of this table contains the current credit information for each user.

Table: `Transaction`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| trans\_id      | int     |

| paid\_by       | int     |

| paid\_to       | int     |

| amount        | int     |

| transacted\_on | date    |

+---------------+---------+

trans\_id is the primary key for this table.

Each row of this table contains the information about the transaction in the bank.

User with id (paid\_by) transfer money to user with id (paid\_to).

Leetcode Bank (LCB) helps its coders in making virtual payments. Our bank records all transactions in the table Transaction, we want to find out the current balance of all users and check wheter they have breached their credit limit (If their current credit is less than 0).

Write an SQL query to report.

*   `user_id`
*   `user_name`
*   `credit`, current balance after performing transactions.
*   `credit_limit_breached`, check credit\_limit ("Yes" or "No") Return the result table in **any** order.

The query result format is in the following example.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Users table:

+------------+--------------+-------------+

| user\_id    | user\_name    | credit      |

+------------+--------------+-------------+

| 1          | Moustafa     | 100         |

| 2          | Jonathan     | 200         |

| 3          | Winston      | 10000       |

| 4          | Luis         | 800         |

+------------+--------------+-------------+

Transaction table:

+------------+------------+------------+----------+---------------+

| trans\_id   | paid\_by    | paid\_to    | amount   | transacted\_on |

+------------+------------+------------+----------+---------------+

| 1          | 1          | 3          | 400      | 2020-08-01    |

| 2          | 3          | 2          | 500      | 2020-08-02    |

| 3          | 2          | 1          | 200      | 2020-08-03    |

+------------+------------+------------+----------+---------------+

Result table:

+------------+------------+------------+-----------------------+

| user\_id    | user\_name  | credit     | credit\_limit\_breached |

+------------+------------+------------+-----------------------+

| 1          | Moustafa   | -100       | Yes                   |

| 2          | Jonathan   | 500        | No                    |

| 3          | Winston    | 9990       | No                    |

| 4          | Luis       | 800        | No                    |

+------------+------------+------------+-----------------------+

Moustafa paid $400 on "2020-08-01" and received $200 on "2020-08-03", credit (100 -400 +200) = -$100

Jonathan received $500 on "2020-08-02" and paid $200 on "2020-08-08", credit (200 +500 -200) = $500

Winston received $400 on "2020-08-01" and paid $500 on "2020-08-03", credit (10000 +400 -500) = $9990

Luis didn't received any transfer, credit = $800

### [](#solution-121)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT Users.user\_id AS user\_id

    , Users.user\_name AS user\_name

    , credit+IFNULL(SUM(trans),0) AS credit

    , CASE WHEN credit+IFNULL(SUM(trans),0)\>0 THEN 'No' ELSE 'Yes' END AS credit\_limit\_breached

FROM(

    SELECT paid\_by AS user\_id, \-amount AS trans

    FROM Transaction

    UNION ALL

    SELECT paid\_to AS user\_id, amount AS trans

    FROM Transaction

) t RIGHT JOIN users ON t.user\_id\=users.user\_id

GROUP BY user\_id

[](#1565-unique-orders-and-customers-per-month--easy---leetcode)1565\. Unique Orders and Customers Per Month | Easy | 🔒 [LeetCode](https://leetcode.com/problems/unique-orders-and-customers-per-month)
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Orders`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| order\_id      | int     |

| order\_date    | date    |

| customer\_id   | int     |

| invoice       | int     |

+---------------+---------+

order\_id is the primary key for this table.

This table contains information about the orders made by customer\_id.

Write an SQL query to find the number of **unique orders** and the number of **unique users** with invoices > **$20** for each **different month**.

Return the result table sorted in **any order**.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Orders

+----------+------------+-------------+------------+

| order\_id | order\_date | customer\_id | invoice    |

+----------+------------+-------------+------------+

| 1        | 2020-09-15 | 1           | 30         |

| 2        | 2020-09-17 | 2           | 90         |

| 3        | 2020-10-06 | 3           | 20         |

| 4        | 2020-10-20 | 3           | 21         |

| 5        | 2020-11-10 | 1           | 10         |

| 6        | 2020-11-21 | 2           | 15         |

| 7        | 2020-12-01 | 4           | 55         |

| 8        | 2020-12-03 | 4           | 77         |

| 9        | 2021-01-07 | 3           | 31         |

| 10       | 2021-01-15 | 2           | 20         |

+----------+------------+-------------+------------+

Result table:

+---------+-------------+----------------+

| month   | order\_count | customer\_count |

+---------+-------------+----------------+

| 2020-09 | 2           | 2              |

| 2020-10 | 1           | 1              |

| 2020-12 | 2           | 1              |

| 2021-01 | 1           | 1              |

+---------+-------------+----------------+

In September 2020 we have two orders from 2 different customers with invoices > $20.

In October 2020 we have two orders from 1 customer, and only one of the two orders has invoice > $20.

In November 2020 we have two orders from 2 different customers but invoices < $20, so we don't include that month.

In December 2020 we have two orders from 1 customer both with invoices > $20.

In January 2021 we have two orders from 2 different customers, but only one of them with invoice > $20.

### [](#solution-122)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

SELECT DATE\_FORMAT(order\_date, '%Y-%m') AS month, COUNT(DISTINCT order\_id) AS order\_count, COUNT(DISTINCT customer\_id) AS customer\_count

    FROM Orders

    WHERE invoice \> 20

    GROUP BY YEAR(order\_date), MONTH(order\_date);

#Solution 2:

SELECT LEFT(order\_date, 7) AS month, COUNT(DISTINCT order\_id) AS order\_count,

	COUNT(DISTINCT customer\_id) AS customer\_count

FROM orders

WHERE invoice \> 20

GROUP BY month

[](#1571-warehouse-manager--easy---leetcode)1571\. Warehouse Manager | Easy | 🔒 [LeetCode](https://leetcode.com/problems/warehouse-manager)
--------------------------------------------------------------------------------------------------------------------------------------------

Table: `Warehouse`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+---------+

| Column Name  | Type    |

+--------------+---------+

| name         | varchar |

| product\_id   | int     |

| units        | int     |

+--------------+---------+

(name, product\_id) is the primary key for this table.

Each row of this table contains the information of the products in each warehouse.

Table: `Products`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| product\_id    | int     |

| product\_name  | varchar |

| Width         | int     |

| Length        | int     |

| Height        | int     |

+---------------+---------+

product\_id is the primary key for this table.

Each row of this table contains the information about the product dimensions (Width, Lenght and Height) in feets of each product.

Write an SQL query to report, How much cubic feet of **volume** does the inventory occupy in each warehouse.

*   warehouse\_name
*   volume  
    Return the result table in **any** order.

The query result format is in the following example.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Warehouse table:

+------------+--------------+-------------+

| name       | product\_id   | units       |

+------------+--------------+-------------+

| LCHouse1   | 1            | 1           |

| LCHouse1   | 2            | 10          |

| LCHouse1   | 3            | 5           |

| LCHouse2   | 1            | 2           |

| LCHouse2   | 2            | 2           |

| LCHouse3   | 4            | 1           |

+------------+--------------+-------------+

Products table:

+------------+--------------+------------+----------+-----------+

| product\_id | product\_name | Width      | Length   | Height    |

+------------+--------------+------------+----------+-----------+

| 1          | LC-TV        | 5          | 50       | 40        |

| 2          | LC-KeyChain  | 5          | 5        | 5         |

| 3          | LC-Phone     | 2          | 10       | 10        |

| 4          | LC-T-Shirt   | 4          | 10       | 20        |

+------------+--------------+------------+----------+-----------+

Result table:

+----------------+------------+

| warehouse\_name | volume     |

+----------------+------------+

| LCHouse1       | 12250      |

| LCHouse2       | 20250      |

| LCHouse3       | 800        |

+----------------+------------+

Volume of product\_id = 1 (LC-TV), 5x50x40 = 10000

Volume of product\_id = 2 (LC-KeyChain), 5x5x5 = 125

Volume of product\_id = 3 (LC-Phone), 2x10x10 = 200

Volume of product\_id = 4 (LC-T-Shirt), 4x10x20 = 800

LCHouse1: 1 unit of LC-TV + 10 units of LC-KeyChain + 5 units of LC-Phone.

          Total volume: 1\*10000 + 10\*125  + 5\*200 = 12250 cubic feet

LCHouse2: 2 units of LC-TV + 2 units of LC-KeyChain.

          Total volume: 2\*10000 + 2\*125 = 20250 cubic feet

LCHouse3: 1 unit of LC-T-Shirt.

          Total volume: 1\*800 = 800 cubic feet.

### [](#solution-123)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT a.name AS warehouse\_name,

SUM(a.units \* b.Width \* b.Length \* b.Height) AS volume

FROM Warehouse AS a

LEFT JOIN Products AS b

ON a.product\_id \= b.product\_id

GROUP BY a.name;

[](#1581-customer-who-visited-but-did-not-make-any-transactions--easy---leetcode)1581\. Customer Who Visited but Did Not Make Any Transactions | Easy | 🔒 [LeetCode](https://leetcode.com/problems/customer-who-visited-but-did-not-make-any-transactions)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Visits`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| visit\_id    | int     |

| customer\_id | int     |

+-------------+---------+

visit\_id is the primary key for this table.

This table contains information about the customers who visited the mall.

Table: `Transactions`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----------------+---------+

| Column Name    | Type    |

+----------------+---------+

| transaction\_id | int     |

| visit\_id       | int     |

| amount         | int     |

+----------------+---------+

transaction\_id is the primary key for this table.

This table contains information about the customers who visited the mall.

Write an SQL query to find the IDs of the users who visited without making any transactions and the number of times they made these types of visits.

Return the result table sorted in **any orders**.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Visits

+----------+-------------+

| visit\_id | customer\_id |

+----------+-------------+

| 1        | 23          |

| 2        | 9           |

| 4        | 30          |

| 5        | 54          |

| 6        | 96          |

| 7        | 54          |

| 8        | 54          |

+----------+-------------+

Transactions

+----------------+----------+--------+

| transaction\_id | visit\_id | amount |

+----------------+----------+--------+

| 2              | 5        | 310    |

| 3              | 5        | 300    |

| 9              | 5        | 200    |

| 12             | 1        | 910    |

| 13             | 2        | 970    |

+----------------+----------+--------+

Result table:

+-------------+----------------+

| customer\_id | count\_no\_trans |

+-------------+----------------+

| 54          | 2              |

| 30          | 1              |

| 96          | 1              |

+-------------+----------------+

Customer with id = 23 visited the mall once and made one transaction during the visit with id = 12.

Customer with id = 9 visited the mall once and made one transaction during the visit with id = 13.

Customer with id = 30 visited the mall once and did not make any transactions.

Customer with id = 54 visited the mall three times. During 2 visits they did not make any transactions, and during one visit they made 3 transactions.

Customer with id = 96 visited the mall once and did not make any transactions.

As we can see, users with IDs 30 and 96 visited the mall one time without making any transactions. Also user 54 visited the mall twice and did not make any transactions.

### [](#solution-124)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

SELECT a.customer\_id, COUNT(a.visit\_id) AS count\_no\_trans FROM Visits AS a

LEFT JOIN Transactions AS b

ON a.visit\_id \= b.visit\_id

WHERE b.transaction\_id IS NULL

GROUP BY a.customer\_id;

#Solution 2:

SELECT customer\_id, count(visit\_id) AS count\_no\_trans

FROM Visits

WHERE visit\_id NOT IN

    (SELECT visit\_id

    FROM Transactions

    GROUP BY visit\_id)

GROUP BY customer\_id

[](#1587-bank-account-summary-ii--easy---leetcode)1587\. Bank Account Summary II | Easy | 🔒 [LeetCode](https://leetcode.com/problems/bank-account-summary-ii)
--------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Users`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+---------+

| Column Name  | Type    |

+--------------+---------+

| account      | int     |

| name         | varchar |

+--------------+---------+

account is the primary key for this table.

Each row of this table contains the account number of each user in the bank.

Table: `Transactions`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| trans\_id      | int     |

| account       | int     |

| amount        | int     |

| transacted\_on | date    |

+---------------+---------+

trans\_id is the primary key for this table.

Each row of this table contains all changes made to all accounts.

amount is positive if the user received money and negative if they transferred money.

All accounts start with a balance 0.

Write an SQL query to report the name and balance of users with a balance higher than 10000. The balance of an account is equal to the sum of the amounts of all transactions involving that account.

Return the result table in **any** order.

The query result format is in the following example.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Users table:

+------------+--------------+

| account    | name         |

+------------+--------------+

| 900001     | Alice        |

| 900002     | Bob          |

| 900003     | Charlie      |

+------------+--------------+

Transactions table:

+------------+------------+------------+---------------+

| trans\_id   | account    | amount     | transacted\_on |

+------------+------------+------------+---------------+

| 1          | 900001     | 7000       |  2020-08-01   |

| 2          | 900001     | 7000       |  2020-09-01   |

| 3          | 900001     | -3000      |  2020-09-02   |

| 4          | 900002     | 1000       |  2020-09-12   |

| 5          | 900003     | 6000       |  2020-08-07   |

| 6          | 900003     | 6000       |  2020-09-07   |

| 7          | 900003     | -4000      |  2020-09-11   |

+------------+------------+------------+---------------+

Result table:

+------------+------------+

| name       | balance    |

+------------+------------+

| Alice      | 11000      |

+------------+------------+

Alice's balance is (7000 + 7000 - 3000) = 11000.

Bob's balance is 1000.

Charlie's balance is (6000 + 6000 - 4000) = 8000.

### [](#solution-125)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

SELECT u.name AS NAME,SUM(t.amount) AS BALANCE

FROM Transactions t LEFT JOIN Users u

ON u.account \= t.account

GROUP BY u.account

HAVING SUM(t.amount)\>10000;

#Solution 2:

WITH tmp AS(

SELECT t.account, u.name, SUM(amount) AS balance

FROM Transactions t

LEFT JOIN Users u ON t.account \= u.account

GROUP BY account )

SELECT name, balance

FROM tmp

WHERE balance \> 10000

[](#1596-the-most-frequently-ordered-products-for-each-customer--medium---leetcode)1596\. The Most Frequently Ordered Products for Each Customer | Medium | 🔒 [LeetCode](https://leetcode.com/problems/the-most-frequently-ordered-products-for-each-customer)
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Customers`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| customer\_id   | int     |

| name          | varchar |

+---------------+---------+

customer\_id is the primary key for this table.

This table contains information about the customers.

Table: `Orders`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| order\_id      | int     |

| order\_date    | date    |

| customer\_id   | int     |

| product\_id    | int     |

+---------------+---------+

order\_id is the primary key for this table.

This table contains information about the orders made by customer\_id.

No customer will order the same product more than once in a single day.

Table: `Products`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| product\_id    | int     |

| product\_name  | varchar |

| price         | int     |

+---------------+---------+

product\_id is the primary key for this table.

This table contains information about the products.

Write an SQL query to find the most frequently ordered product(s) for each customer.

The result table should have the `product_id` and `product_name` for each `customer_id` who ordered at least one order. Return the result table in **any order**.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Customers

+-------------+-------+

| customer\_id | name  |

+-------------+-------+

| 1           | Alice |

| 2           | Bob   |

| 3           | Tom   |

| 4           | Jerry |

| 5           | John  |

+-------------+-------+

Orders

+----------+------------+-------------+------------+

| order\_id | order\_date | customer\_id | product\_id |

+----------+------------+-------------+------------+

| 1        | 2020-07-31 | 1           | 1          |

| 2        | 2020-07-30 | 2           | 2          |

| 3        | 2020-08-29 | 3           | 3          |

| 4        | 2020-07-29 | 4           | 1          |

| 5        | 2020-06-10 | 1           | 2          |

| 6        | 2020-08-01 | 2           | 1          |

| 7        | 2020-08-01 | 3           | 3          |

| 8        | 2020-08-03 | 1           | 2          |

| 9        | 2020-08-07 | 2           | 3          |

| 10       | 2020-07-15 | 1           | 2          |

+----------+------------+-------------+------------+

Products

+------------+--------------+-------+

| product\_id | product\_name | price |

+------------+--------------+-------+

| 1          | keyboard     | 120   |

| 2          | mouse        | 80    |

| 3          | screen       | 600   |

| 4          | hard disk    | 450   |

+------------+--------------+-------+

Result table:

+-------------+------------+--------------+

| customer\_id | product\_id | product\_name |

+-------------+------------+--------------+

| 1           | 2          | mouse        |

| 2           | 1          | keyboard     |

| 2           | 2          | mouse        |

| 2           | 3          | screen       |

| 3           | 3          | screen       |

| 4           | 1          | keyboard     |

+-------------+------------+--------------+

Alice (customer 1) ordered the mouse three times and the keyboard one time, so the mouse is the most frquently ordered product for them.

Bob (customer 2) ordered the keyboard, the mouse, and the screen one time, so those are the most frquently ordered products for them.

Tom (customer 3) only ordered the screen (two times), so that is the most frquently ordered product for them.

Jerry (customer 4) only ordered the keyboard (one time), so that is the most frquently ordered product for them.

John (customer 5) did not order anything, so we do not include them in the result table.

### [](#solution-126)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

SELECT customer\_id, Products.product\_id, Products.product\_name FROM

(SELECT customer\_id, product\_id, order\_count, RANK() OVER(PARTITION BY customer\_id ORDER BY order\_count DESC) r From

(SELECT customer\_id, product\_id, COUNT(DISTINCT order\_id) AS order\_count FROM Orders

GROUP BY customer\_id, product\_id) order\_counts) order\_counts\_ranked

JOIN Products ON order\_counts\_ranked.product\_id \= Products.product\_id

WHERE r \= 1;

#solution- 2:

SELECT customer\_id, T.product\_id, product\_name

FROM(

    SELECT customer\_id, product\_id,

    RANK() OVER( PARTITION BY customer\_id ORDER BY COUNT(\*) DESC ) AS RK

    FROM Orders o

    GROUP BY customer\_id, product\_id

) T

LEFT JOIN Products p on p.product\_id \= t.product\_id

WHERE RK\=1

#Solution-3:

WITH

tmp AS (

  SELECT a.customer\_id, b.product\_id, c.product\_name,

  COUNT(b.order\_id) OVER(PARTITION BY a.customer\_id, b.product\_id) AS freq

  FROM Customers AS a

  JOIN Orders AS b

  ON a.customer\_id \= b.customer\_id

  JOIN Products AS c

  ON b.product\_id \= c.product\_id

),

tmp1 AS (

  SELECT customer\_id, product\_id, product\_name, freq,

  DENSE\_RANK() OVER(PARTITION BY customer\_id ORDER BY freq DESC) AS rnk

  FROM tmp

)

SELECT DISTINCT customer\_id, product\_id, product\_name FROM tmp1

WHERE rnk \= 1;

[](#1607-sellers-with-no-sales--easy---leetcode)1607\. Sellers With No Sales | Easy | 🔒 [LeetCode](https://leetcode.com/problems/sellers-with-no-sales)
--------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Customer`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| customer\_id   | int     |

| customer\_name | varchar |

+---------------+---------+

customer\_id is the primary key for this table.

Each row of this table contains the information of each customer in the WebStore.

Table: `Orders`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| order\_id      | int     |

| sale\_date     | date    |

| order\_cost    | int     |

| customer\_id   | int     |

| seller\_id     | int     |

+---------------+---------+

order\_id is the primary key for this table.

Each row of this table contains all orders made in the webstore.

sale\_date is the date when the transaction was made between the customer (customer\_id) and the seller (seller\_id).

Table: `Seller`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| seller\_id     | int     |

| seller\_name   | varchar |

+---------------+---------+

seller\_id is the primary key for this table.

Each row of this table contains the information of each seller.

Write an SQL query to report the names of all sellers who did not make any sales in 2020.

Return the result table ordered by `seller_name` in ascending order.

The query result format is in the following example.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Customer table:

+--------------+---------------+

| customer\_id  | customer\_name |

+--------------+---------------+

| 101          | Alice         |

| 102          | Bob           |

| 103          | Charlie       |

+--------------+---------------+

Orders table:

+-------------+------------+--------------+-------------+-------------+

| order\_id    | sale\_date  | order\_cost   | customer\_id | seller\_id   |

+-------------+------------+--------------+-------------+-------------+

| 1           | 2020-03-01 | 1500         | 101         | 1           |

| 2           | 2020-05-25 | 2400         | 102         | 2           |

| 3           | 2019-05-25 | 800          | 101         | 3           |

| 4           | 2020-09-13 | 1000         | 103         | 2           |

| 5           | 2019-02-11 | 700          | 101         | 2           |

+-------------+------------+--------------+-------------+-------------+

Seller table:

+-------------+-------------+

| seller\_id   | seller\_name |

+-------------+-------------+

| 1           | Daniel      |

| 2           | Elizabeth   |

| 3           | Frank       |

+-------------+-------------+

Result table:

+-------------+

| seller\_name |

+-------------+

| Frank       |

+-------------+

Daniel made 1 sale in March 2020.

Elizabeth made 2 sales in 2020 and 1 sale in 2019.

Frank made 1 sale in 2019 but no sales in 2020.

### [](#solution-127)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT seller\_name FROM Seller

WHERE seller\_id NOT IN (

SELECT DISTINCT seller\_id FROM Orders

WHERE YEAR(sale\_date)\='2020'

)

ORDER BY seller\_name;

[](#1613-find-the-missing-ids--medium---leetcode)1613\. Find the Missing IDs | Medium | 🔒 [LeetCode](https://leetcode.com/problems/find-the-missing-ids)
---------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Customers`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| customer\_id   | int     |

| customer\_name | varchar |

+---------------+---------+

customer\_id is the primary key for this table.

Each row of this table contains the name and the id customer.

Write an SQL query to find the missing customer IDs. The missing IDs are ones that are not in the `Customers` table but are in the range between `1` and the **maximum** `customer_id` present in the table.

**Notice** that the maximum `customer_id` will not exceed 100.

Return the result table ordered by **ids** in **_ascending order_**.

The query result format is in the following example.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Customer table:

+-------------+---------------+

| customer\_id | customer\_name |

+-------------+---------------+

| 1           | Alice         |

| 4           | Bob           |

| 5           | Charlie       |

+-------------+---------------+

Result table:

+-----+

| ids |

+-----+

| 2   |

| 3   |

+-----+

The maximum customer\_id present in the table is 5, so in the range \[1,5\], IDs 2 and 3 are missing from the table.

### [](#solution-128)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

WITH RECURSIVE CTE AS(

    SELECT 1 AS 'id', MAX(c.customer\_id) AS 'Max\_Id'

    FROM Customers c

    UNION ALL

    SELECT id+1, Max\_Id

    FROM CTE

    WHERE id < Max\_id

)

SELECT id AS 'ids'

FROM CTE c

WHERE c.id NOT IN (SELECT customer\_id FROM Customers)

ORDER BY 1 ASC

[](#1623-all-valid-triplets-that-can-represent-a-country--easy---leetcode)1623\. All Valid Triplets That Can Represent a Country | Easy | 🔒 [LeetCode](https://leetcode.com/problems/all-valid-triplets-that-can-represent-a-country)
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `SchoolA`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| student\_id    | int     |

| student\_name  | varchar |

+---------------+---------+

student\_id is the primary key for this table.

Each row of this table contains the name and the id of a student in school A.

All student\_name are distinct.

Table: `SchoolB`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| student\_id    | int     |

| student\_name  | varchar |

+---------------+---------+

student\_id is the primary key for this table.

Each row of this table contains the name and the id of a student in school B.

All student\_name are distinct.

Table: `SchoolC`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| student\_id    | int     |

| student\_name  | varchar |

+---------------+---------+

student\_id is the primary key for this table.

Each row of this table contains the name and the id of a student in school C.

All student\_name are distinct.

There is a country with three schools, where each student is enrolled in **exactly one** school. The country is joining a competition and wants to select one student from each school to represent the country such that:

*   `member_A` is selected from `SchoolA`,
*   `member_B` is selected from `SchoolB`,
*   `member_C` is selected from `SchoolC`, and The selected students' names and IDs are pairwise distinct (i.e. no two students share the same name, and no two students share the same ID). Write an SQL query to find all the possible triplets representing the country under the given constraints.

Return the result table in **any order**.

The query result format is in the following example.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SchoolA table:

+------------+--------------+

| student\_id | student\_name |

+------------+--------------+

| 1          | Alice        |

| 2          | Bob          |

+------------+--------------+

SchoolB table:

+------------+--------------+

| student\_id | student\_name |

+------------+--------------+

| 3          | Tom          |

+------------+--------------+

SchoolC table:

+------------+--------------+

| student\_id | student\_name |

+------------+--------------+

| 3          | Tom          |

| 2          | Jerry        |

| 10         | Alice        |

+------------+--------------+

Result table:

+----------+----------+----------+

| member\_A | member\_B | member\_C |

+----------+----------+----------+

| Alice    | Tom      | Jerry    |

| Bob      | Tom      | Alice    |

+----------+----------+----------+

Let us see all the possible triplets.

\- (Alice, Tom, Tom) --> Rejected because member\_B and member\_C have the same name and the same ID.

\- (Alice, Tom, Jerry) --> Valid triplet.

\- (Alice, Tom, Alice) --> Rejected because member\_A and member\_C have the same name.

\- (Bob, Tom, Tom) --> Rejected because member\_B and member\_C have the same name and the same ID.

\- (Bob, Tom, Jerry) --> Rejected because member\_A and member\_C have the same ID.

\- (Bob, Tom, Alice) --> Valid triplet.

### [](#solution-129)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT a.student\_name AS 'member\_A',

b.student\_name AS 'member\_B',

c.student\_name AS 'member\_C'

FROM SchoolA AS a

JOIN SchoolB AS b

ON a.student\_id <> b.student\_id

AND a.student\_name <> b.student\_name

JOIN SchoolC AS c

ON a.student\_id <> c.student\_id

AND b.student\_id <> c.student\_id

AND a.student\_name <> c.student\_name

AND b.student\_name <> c.student\_name;

[](#1633-percentage-of-users-attended-a-contest--easy---leetcode)1633\. Percentage of Users Attended a Contest | Easy | 🔒 [LeetCode](https://leetcode.com/problems/percentage-of-users-attended-a-contest)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Users`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| user\_id     | int     |

| user\_name   | varchar |

+-------------+---------+

user\_id is the primary key for this table.

Each row of this table contains the name and the id of a user.

Table: `Register`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| contest\_id  | int     |

| user\_id     | int     |

+-------------+---------+

(contest\_id, user\_id) is the primary key for this table.

Each row of this table contains the id of a user and the contest they registered into.

Write an SQL query to find the percentage of the users registered in each contest rounded to two decimals.

Return the result table ordered by percentage in descending order. In case of a tie, order it by contest\_id in ascending order.

The query result format is in the following example.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Users table:

+---------+-----------+

| user\_id | user\_name |

+---------+-----------+

| 6       | Alice     |

| 2       | Bob       |

| 7       | Alex      |

+---------+-----------+

Register table:

+------------+---------+

| contest\_id | user\_id |

+------------+---------+

| 215        | 6       |

| 209        | 2       |

| 208        | 2       |

| 210        | 6       |

| 208        | 6       |

| 209        | 7       |

| 209        | 6       |

| 215        | 7       |

| 208        | 7       |

| 210        | 2       |

| 207        | 2       |

| 210        | 7       |

+------------+---------+

Result table:

+------------+------------+

| contest\_id | percentage |

+------------+------------+

| 208        | 100.0      |

| 209        | 100.0      |

| 210        | 100.0      |

| 215        | 66.67      |

| 207        | 33.33      |

+------------+------------+

All the users registered in contests 208, 209, and 210. The percentage is 100% and we sort them in the answer table in ascending order.

Alice and Alex registered in contest 215 and the percentage is ((2/3) \* 100) = 66.67%

Bob registered in contest 207 and the percentage is ((1/3) \* 100) = 33.33%

### [](#solution-130)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT contest\_id, ROUND(COUNT(user\_id)\*100.00/(SELECT COUNT(\*) FROM users),2) as percentage

FROM register

GROUP BY contest\_id

ORDER BY percentage desc, contest\_id

[](#1635-hopper-company-queries-i--hard---leetcode)1635\. Hopper Company Queries I | Hard | 🔒 [LeetCode](https://leetcode.com/problems/hopper-company-queries-i)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Drivers`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| driver\_id   | int     |

| join\_date   | date    |

+-------------+---------+

driver\_id is the primary key for this table.

Each row of this table contains the driver's ID and the date they joined the Hopper company.

Table: `Rides`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+---------+

| Column Name  | Type    |

+--------------+---------+

| ride\_id      | int     |

| user\_id      | int     |

| requested\_at | date    |

+--------------+---------+

ride\_id is the primary key for this table.

Each row of this table contains the ID of a ride, the user's ID that requested it, and the day they requested it.

There may be some ride requests in this table that were not accepted.

Table: `AcceptedRides`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| ride\_id       | int     |

| driver\_id     | int     |

| ride\_distance | int     |

| ride\_duration | int     |

+---------------+---------+

ride\_id is the primary key for this table.

Each row of this table contains some information about an accepted ride.

It is guaranteed that each accepted ride exists in the Rides table.

Write an SQL query to report the following statistics for each month of **2020**:

The number of drivers currently with the Hopper company by the end of the month (**active\_drivers**). The number of accepted rides in that month (**accepted\_rides**). Return the result table ordered by **month** in ascending order, where **month** is the month's number (January is **1**, February is **2**, etc.).

The query result format is in the following example.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Drivers table:

+-----------+------------+

| driver\_id | join\_date  |

+-----------+------------+

| 10        | 2019-12-10 |

| 8         | 2020-1-13  |

| 5         | 2020-2-16  |

| 7         | 2020-3-8   |

| 4         | 2020-5-17  |

| 1         | 2020-10-24 |

| 6         | 2021-1-5   |

+-----------+------------+

Rides table:

+---------+---------+--------------+

| ride\_id | user\_id | requested\_at |

+---------+---------+--------------+

| 6       | 75      | 2019-12-9    |

| 1       | 54      | 2020-2-9     |

| 10      | 63      | 2020-3-4     |

| 19      | 39      | 2020-4-6     |

| 3       | 41      | 2020-6-3     |

| 13      | 52      | 2020-6-22    |

| 7       | 69      | 2020-7-16    |

| 17      | 70      | 2020-8-25    |

| 20      | 81      | 2020-11-2    |

| 5       | 57      | 2020-11-9    |

| 2       | 42      | 2020-12-9    |

| 11      | 68      | 2021-1-11    |

| 15      | 32      | 2021-1-17    |

| 12      | 11      | 2021-1-19    |

| 14      | 18      | 2021-1-27    |

+---------+---------+--------------+

AcceptedRides table:

+---------+-----------+---------------+---------------+

| ride\_id | driver\_id | ride\_distance | ride\_duration |

+---------+-----------+---------------+---------------+

| 10      | 10        | 63            | 38            |

| 13      | 10        | 73            | 96            |

| 7       | 8         | 100           | 28            |

| 17      | 7         | 119           | 68            |

| 20      | 1         | 121           | 92            |

| 5       | 7         | 42            | 101           |

| 2       | 4         | 6             | 38            |

| 11      | 8         | 37            | 43            |

| 15      | 8         | 108           | 82            |

| 12      | 8         | 38            | 34            |

| 14      | 1         | 90            | 74            |

+---------+-----------+---------------+---------------+

Result table:

+-------+----------------+----------------+

| month | active\_drivers | accepted\_rides |

+-------+----------------+----------------+

| 1     | 2              | 0              |

| 2     | 3              | 0              |

| 3     | 4              | 1              |

| 4     | 4              | 0              |

| 5     | 5              | 0              |

| 6     | 5              | 1              |

| 7     | 5              | 1              |

| 8     | 5              | 1              |

| 9     | 5              | 0              |

| 10    | 6              | 0              |

| 11    | 6              | 2              |

| 12    | 6              | 1              |

+-------+----------------+----------------+

By the end of January --> two active drivers (10, 8) and no accepted rides.

By the end of February --> three active drivers (10, 8, 5) and no accepted rides.

By the end of March --> four active drivers (10, 8, 5, 7) and one accepted ride (10).

By the end of April --> four active drivers (10, 8, 5, 7) and no accepted rides.

By the end of May --> five active drivers (10, 8, 5, 7, 4) and no accepted rides.

By the end of June --> five active drivers (10, 8, 5, 7, 4) and one accepted ride (13).

By the end of July --> five active drivers (10, 8, 5, 7, 4) and one accepted ride (7).

By the end of August --> five active drivers (10, 8, 5, 7, 4) and one accepted ride (17).

By the end of Septemeber --> five active drivers (10, 8, 5, 7, 4) and no accepted rides.

By the end of October --> six active drivers (10, 8, 5, 7, 4, 1) and no accepted rides.

By the end of November --> six active drivers (10, 8, 5, 7, 4, 1) and two accepted rides (20, 5).

By the end of December --> six active drivers (10, 8, 5, 7, 4, 1) and one accepted ride (2).

### [](#solution-131)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT t.month,

    COUNT(DISTINCT driver\_id) active\_drivers,

    COUNT(DISTINCT rides.ride\_id) accepted\_rides

FROM

    ((SELECT 1 AS month)

    UNION (SELECT 2 AS month)

    UNION (SELECT 3 AS month)

    UNION (SELECT 4 AS month)

    UNION (SELECT 5 AS month)

    UNION (SELECT 6 AS month)

    UNION (SELECT 7 AS month)

    UNION (SELECT 8 AS month)

    UNION (SELECT 9 AS month)

    UNION (SELECT 10 AS month)

    UNION (SELECT 11 AS month)

    UNION (SELECT 12 AS month)) t

LEFT JOIN

    (SELECT driver\_id,

    (CASE WHEN year(join\_date) \= 2019 THEN '1' ELSE month(join\_date) END) \`month\`

    FROM Drivers

    WHERE year(join\_date) <= 2020) d

ON d.month <= t.month

LEFT JOIN

    (SELECT month(requested\_at) AS \`month\`, a.ride\_id

    FROM AcceptedRides a

    JOIN Rides r

    ON r.ride\_id \= a.ride\_id

    WHERE year(requested\_at) \= 2020) rides

ON t.month \= rides.month

GROUP BY t.month

ORDER BY t.month

[](#1645-hopper-company-queries-ii--hard---leetcode)1645\. Hopper Company Queries II | Hard | 🔒 [LeetCode](https://leetcode.com/problems/hopper-company-queries-ii)
--------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Drivers`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| driver\_id   | int     |

| join\_date   | date    |

+-------------+---------+

driver\_id is the primary key for this table.

Each row of this table contains the driver's ID and the date they joined the Hopper company.

Table: `Rides`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+---------+

| Column Name  | Type    |

+--------------+---------+

| ride\_id      | int     |

| user\_id      | int     |

| requested\_at | date    |

+--------------+---------+

ride\_id is the primary key for this table.

Each row of this table contains the ID of a ride, the user's ID that requested it, and the day they requested it.

There may be some ride requests in this table that were not accepted.

Table: `AcceptedRides`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| ride\_id       | int     |

| driver\_id     | int     |

| ride\_distance | int     |

| ride\_duration | int     |

+---------------+---------+

ride\_id is the primary key for this table.

Each row of this table contains some information about an accepted ride.

It is guaranteed that each accepted ride exists in the Rides table.

Write an SQL query to report the percentage of working drivers (`working_percentage`) for each month of **2020** where:

![](/_next/image?url=%2Fstatic%2Fimages%2Farticles%2Fsql-questions%2Fleetcode-sql-1645.png&w=2048&q=75)

**Note** that if the number of available drivers during a month is zero, we consider the `working_percentage` to be `0`.

Return the result table ordered by `month` in **ascending** order, where **month** is the month's number (January is **1**, February is **2**, etc.). Round **working\_percentage** to the nearest **2 decimal places**.

The query result format is in the following example.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Drivers table:

+-----------+------------+

| driver\_id | join\_date  |

+-----------+------------+

| 10        | 2019-12-10 |

| 8         | 2020-1-13  |

| 5         | 2020-2-16  |

| 7         | 2020-3-8   |

| 4         | 2020-5-17  |

| 1         | 2020-10-24 |

| 6         | 2021-1-5   |

+-----------+------------+

Rides table:

+---------+---------+--------------+

| ride\_id | user\_id | requested\_at |

+---------+---------+--------------+

| 6       | 75      | 2019-12-9    |

| 1       | 54      | 2020-2-9     |

| 10      | 63      | 2020-3-4     |

| 19      | 39      | 2020-4-6     |

| 3       | 41      | 2020-6-3     |

| 13      | 52      | 2020-6-22    |

| 7       | 69      | 2020-7-16    |

| 17      | 70      | 2020-8-25    |

| 20      | 81      | 2020-11-2    |

| 5       | 57      | 2020-11-9    |

| 2       | 42      | 2020-12-9    |

| 11      | 68      | 2021-1-11    |

| 15      | 32      | 2021-1-17    |

| 12      | 11      | 2021-1-19    |

| 14      | 18      | 2021-1-27    |

+---------+---------+--------------+

AcceptedRides table:

+---------+-----------+---------------+---------------+

| ride\_id | driver\_id | ride\_distance | ride\_duration |

+---------+-----------+---------------+---------------+

| 10      | 10        | 63            | 38            |

| 13      | 10        | 73            | 96            |

| 7       | 8         | 100           | 28            |

| 17      | 7         | 119           | 68            |

| 20      | 1         | 121           | 92            |

| 5       | 7         | 42            | 101           |

| 2       | 4         | 6             | 38            |

| 11      | 8         | 37            | 43            |

| 15      | 8         | 108           | 82            |

| 12      | 8         | 38            | 34            |

| 14      | 1         | 90            | 74            |

+---------+-----------+---------------+---------------+

Result table:

+-------+--------------------+

| month | working\_percentage |

+-------+--------------------+

| 1     | 0.00               |

| 2     | 0.00               |

| 3     | 25.00              |

| 4     | 0.00               |

| 5     | 0.00               |

| 6     | 20.00              |

| 7     | 20.00              |

| 8     | 20.00              |

| 9     | 0.00               |

| 10    | 0.00               |

| 11    | 33.33              |

| 12    | 16.67              |

+-------+--------------------+

By the end of January --> two active drivers (10, 8) and no accepted rides. The percentage is 0%.

By the end of February --> three active drivers (10, 8, 5) and no accepted rides. The percentage is 0%.

By the end of March --> four active drivers (10, 8, 5, 7) and one accepted ride by driver (10). The percentage is (1 / 4) \* 100 = 25%.

By the end of April --> four active drivers (10, 8, 5, 7) and no accepted rides. The percentage is 0%.

By the end of May --> five active drivers (10, 8, 5, 7, 4) and no accepted rides. The percentage is 0%.

By the end of June --> five active drivers (10, 8, 5, 7, 4) and one accepted ride by driver (10). The percentage is (1 / 5) \* 100 = 20%.

By the end of July --> five active drivers (10, 8, 5, 7, 4) and one accepted ride by driver (8). The percentage is (1 / 5) \* 100 = 20%.

By the end of August --> five active drivers (10, 8, 5, 7, 4) and one accepted ride by driver (7). The percentage is (1 / 5) \* 100 = 20%.

By the end of Septemeber --> five active drivers (10, 8, 5, 7, 4) and no accepted rides. The percentage is 0%.

By the end of October --> six active drivers (10, 8, 5, 7, 4, 1) and no accepted rides. The percentage is 0%.

By the end of November --> six active drivers (10, 8, 5, 7, 4, 1) and two accepted rides by two different drivers (1, 7). The percentage is (2 / 6) \* 100 = 33.33%.

By the end of December --> six active drivers (10, 8, 5, 7, 4, 1) and one accepted ride by driver (4). The percentage is (1 / 6) \* 100 = 16.67%.

### [](#solution-132)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT months\_drivers.month, ROUND(COALESCE(100 \* COALESCE(total\_active\_drivers, 0) / total\_drivers, 0), 2) AS working\_percentage

FROM

(

    SELECT month, COUNT(driver\_id) AS total\_drivers

    FROM Drivers AS a

    RIGHT JOIN

    (

        SELECT "2020-1-31" AS day, 1 AS month

        UNION SELECT "2020-2-29", 2

        UNION SELECT "2020-3-31", 3

        UNION SELECT "2020-4-30", 4

        UNION SELECT "2020-5-31", 5

        UNION SELECT "2020-6-30", 6

        UNION SELECT "2020-7-31", 7

        UNION SELECT "2020-8-31", 8

        UNION SELECT "2020-9-30", 9

        UNION SELECT "2020-10-31", 10

        UNION SELECT "2020-11-30", 11

        UNION SELECT "2020-12-31", 12

    ) AS months

    ON join\_date <= day

    GROUP BY month

) months\_drivers

LEFT JOIN

(

    SELECT month, COUNT(DISTINCT b.driver\_id) AS total\_active\_drivers

    FROM

    (

        SELECT ride\_id, CAST(substr(requested\_at, 6, 2) AS unsigned) AS month

        FROM Rides

        WHERE substr(requested\_at, 1, 4) \= "2020"

    ) month\_rides

    JOIN AcceptedRides AS b

    ON month\_rides.ride\_id \= b.ride\_id

    GROUP BY month

) months\_active\_drivers

ON months\_drivers.month \= months\_active\_drivers.month;

[](#1651-hopper-company-queries-iii--hard---leetcode)1651\. Hopper Company Queries III | Hard | 🔒 [LeetCode](https://leetcode.com/problems/hopper-company-queries-iii)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Drivers`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| driver\_id   | int     |

| join\_date   | date    |

+-------------+---------+

driver\_id is the primary key for this table.

Each row of this table contains the driver's ID and the date they joined the Hopper company.

Table: `Rides`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+---------+

| Column Name  | Type    |

+--------------+---------+

| ride\_id      | int     |

| user\_id      | int     |

| requested\_at | date    |

+--------------+---------+

ride\_id is the primary key for this table.

Each row of this table contains the ID of a ride, the user's ID that requested it, and the day they requested it.

There may be some ride requests in this table that were not accepted.

Table: `AcceptedRides`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| ride\_id       | int     |

| driver\_id     | int     |

| ride\_distance | int     |

| ride\_duration | int     |

+---------------+---------+

ride\_id is the primary key for this table.

Each row of this table contains some information about an accepted ride.

It is guaranteed that each accepted ride exists in the Rides table.

Write an SQL query to compute the `average_ride_distance` and `average_ride_duration` of every 3-month window starting from **January - March 2020 to October - December 2020**. Round `average_ride_distance` and `average_ride_duration` to the nearest two decimal places.

The `average_ride_distance` is calculated by summing up the total `ride_distance` values from the three months and dividing it by `3`. The `average_ride_duration` is calculated in a similar way.

Return the result table ordered by `month` in ascending order, where `month` is the starting month's number (January is `1`, February is `2`, etc.).

The query result format is in the following example.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Drivers table:

+-----------+------------+

| driver\_id | join\_date  |

+-----------+------------+

| 10        | 2019-12-10 |

| 8         | 2020-1-13  |

| 5         | 2020-2-16  |

| 7         | 2020-3-8   |

| 4         | 2020-5-17  |

| 1         | 2020-10-24 |

| 6         | 2021-1-5   |

+-----------+------------+

Rides table:

+---------+---------+--------------+

| ride\_id | user\_id | requested\_at |

+---------+---------+--------------+

| 6       | 75      | 2019-12-9    |

| 1       | 54      | 2020-2-9     |

| 10      | 63      | 2020-3-4     |

| 19      | 39      | 2020-4-6     |

| 3       | 41      | 2020-6-3     |

| 13      | 52      | 2020-6-22    |

| 7       | 69      | 2020-7-16    |

| 17      | 70      | 2020-8-25    |

| 20      | 81      | 2020-11-2    |

| 5       | 57      | 2020-11-9    |

| 2       | 42      | 2020-12-9    |

| 11      | 68      | 2021-1-11    |

| 15      | 32      | 2021-1-17    |

| 12      | 11      | 2021-1-19    |

| 14      | 18      | 2021-1-27    |

+---------+---------+--------------+

AcceptedRides table:

+---------+-----------+---------------+---------------+

| ride\_id | driver\_id | ride\_distance | ride\_duration |

+---------+-----------+---------------+---------------+

| 10      | 10        | 63            | 38            |

| 13      | 10        | 73            | 96            |

| 7       | 8         | 100           | 28            |

| 17      | 7         | 119           | 68            |

| 20      | 1         | 121           | 92            |

| 5       | 7         | 42            | 101           |

| 2       | 4         | 6             | 38            |

| 11      | 8         | 37            | 43            |

| 15      | 8         | 108           | 82            |

| 12      | 8         | 38            | 34            |

| 14      | 1         | 90            | 74            |

+---------+-----------+---------------+---------------+

Result table:

+-------+-----------------------+-----------------------+

| month | average\_ride\_distance | average\_ride\_duration |

+-------+-----------------------+-----------------------+

| 1     | 21.00                 | 12.67                 |

| 2     | 21.00                 | 12.67                 |

| 3     | 21.00                 | 12.67                 |

| 4     | 24.33                 | 32.00                 |

| 5     | 57.67                 | 41.33                 |

| 6     | 97.33                 | 64.00                 |

| 7     | 73.00                 | 32.00                 |

| 8     | 39.67                 | 22.67                 |

| 9     | 54.33                 | 64.33                 |

| 10    | 56.33                 | 77.00                 |

+-------+-----------------------+-----------------------+

By the end of January --> average\_ride\_distance = (0+0+63)/3=21, average\_ride\_duration = (0+0+38)/3=12.67

By the end of February --> average\_ride\_distance = (0+63+0)/3=21, average\_ride\_duration = (0+38+0)/3=12.67

By the end of March --> average\_ride\_distance = (63+0+0)/3=21, average\_ride\_duration = (38+0+0)/3=12.67

By the end of April --> average\_ride\_distance = (0+0+73)/3=24.33, average\_ride\_duration = (0+0+96)/3=32.00

By the end of May --> average\_ride\_distance = (0+73+100)/3=57.67, average\_ride\_duration = (0+96+28)/3=41.33

By the end of June --> average\_ride\_distance = (73+100+119)/3=97.33, average\_ride\_duration = (96+28+68)/3=64.00

By the end of July --> average\_ride\_distance = (100+119+0)/3=73.00, average\_ride\_duration = (28+68+0)/3=32.00

By the end of August --> average\_ride\_distance = (119+0+0)/3=39.67, average\_ride\_duration = (68+0+0)/3=22.67

By the end of Septemeber --> average\_ride\_distance = (0+0+163)/3=54.33, average\_ride\_duration = (0+0+193)/3=64.33

By the end of October --> average\_ride\_distance = (0+163+6)/3=56.33, average\_ride\_duration = (0+193+38)/3=77.00

### [](#solution-133)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT month,

    COALESCE(ROUND(SUM(ride\_distance)/3,2),0) AS average\_ride\_distance,

    COALESCE(ROUND(SUM(ride\_duration)/3,2),0) AS average\_ride\_duration

FROM

(

    SELECT months.month, ride\_id

    FROM Rides

    RIGHT JOIN

    (

        SELECT "2020-1-1" AS start, "2020-3-31" AS last, 1 AS month

        UNION SELECT "2020-2-1", "2020-4-30", 2

        UNION SELECT "2020-3-1", "2020-5-31", 3

        UNION SELECT "2020-4-1", "2020-6-30", 4

        UNION SELECT "2020-5-1", "2020-7-31", 5

        UNION SELECT "2020-6-1", "2020-8-31", 6

        UNION SELECT "2020-7-1", "2020-9-30", 7

        UNION SELECT "2020-8-1", "2020-10-31", 8

        UNION SELECT "2020-9-1", "2020-11-30", 9

        UNION SELECT "2020-10-1", "2020-12-31", 10

    ) AS months

    ON months.start <= requested\_at AND months.last \>= requested\_at

) total

LEFT JOIN AcceptedRides AS a

ON total.ride\_id\=a.ride\_id

GROUP BY month

ORDER BY month;

[](#1661-average-time-of-process-per-machine--easy---leetcode)1661\. Average Time of Process per Machine | Easy | 🔒 [LeetCode](https://leetcode.com/problems/average-time-of-process-per-machine)
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Activity`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----------------+---------+

| Column Name    | Type    |

+----------------+---------+

| machine\_id     | int     |

| process\_id     | int     |

| activity\_type  | enum    |

| timestamp      | float   |

+----------------+---------+

The table shows the user activities for a factory website.

(machine\_id, process\_id, activity\_type) is the primary key of this table.

machine\_id is the ID of a machine.

process\_id is the ID of a process running on the machine with ID machine\_id.

activity\_type is an ENUM of type ('start', 'end').

timestamp is a float representing the current time in seconds.

'start' means the machine starts the process at the given timestamp and 'end' means the machine ends the process at the given timestamp.

The 'start' timestamp will always be before the 'end' timestamp for every (machine\_id, process\_id) pair.

There is a factory website that has several machines each running the **same number of processes**. Write an SQL query to find the **average time** each machine takes to complete a process.

The time to complete a process is the `'end' timestamp` minus the `'start' timestamp`. The average time is calculated by the total time to complete every process on the machine divided by the number of processes that were run.

The resulting table should have the `machine_id` along with the **average time** as `processing_time`, which should be **rounded to 3 decimal places**.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Activity table:

+------------+------------+---------------+-----------+

| machine\_id | process\_id | activity\_type | timestamp |

+------------+------------+---------------+-----------+

| 0          | 0          | start         | 0.712     |

| 0          | 0          | end           | 1.520     |

| 0          | 1          | start         | 3.140     |

| 0          | 1          | end           | 4.120     |

| 1          | 0          | start         | 0.550     |

| 1          | 0          | end           | 1.550     |

| 1          | 1          | start         | 0.430     |

| 1          | 1          | end           | 1.420     |

| 2          | 0          | start         | 4.100     |

| 2          | 0          | end           | 4.512     |

| 2          | 1          | start         | 2.500     |

| 2          | 1          | end           | 5.000     |

+------------+------------+---------------+-----------+

Result table:

+------------+-----------------+

| machine\_id | processing\_time |

+------------+-----------------+

| 0          | 0.894           |

| 1          | 0.995           |

| 2          | 1.456           |

+------------+-----------------+

There are 3 machines running 2 processes each.

Machine 0's average time is ((1.520 - 0.712) + (4.120 - 3.140)) / 2 = 0.894

Machine 1's average time is ((1.550 - 0.550) + (1.420 - 0.430)) / 2 = 0.995

Machine 2's average time is ((4.512 - 4.100) + (5.000 - 2.500)) / 2 = 1.456

### [](#solution-134)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT machine\_id,

	ROUND(SUM(IF(activity\_type\='start', \-timestamp, timestamp)) / COUNT(DISTINCT process\_id), 3) AS processing\_time

FROM Activity

GROUP BY machine\_id

ORDER BY machine\_id

[](#1667-fix-names-in-a-table--easy---leetcode)1667\. Fix Names in a Table | Easy | 🔒 [LeetCode](https://leetcode.com/problems/fix-names-in-a-table)
-----------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Users`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----------------+---------+

| Column Name    | Type    |

+----------------+---------+

| user\_id        | int     |

| name           | varchar |

+----------------+---------+

user\_id is the primary key for this table.

This table contains the ID and the name of the user. The name consists of only lowercase and uppercase characters.

Write an SQL query to fix the names so that only the first character is uppercase and the rest are lowercase.

Return the result table ordered by `user_id`.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Users table:

+---------+-------+

| user\_id | name  |

+---------+-------+

| 1       | aLice |

| 2       | bOB   |

+---------+-------+

Result table:

+---------+-------+

| user\_id | name  |

+---------+-------+

| 1       | Alice |

| 2       | Bob   |

+---------+-------+

### [](#solution-135)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

select user\_id,

    CONCAT(UPPER(LEFT(name,1)),LOWER(SUBSTRING(name,2))) AS name

FROM Users

ORDER BY user\_id

[](#1677-products-worth-over-invoices--easy---leetcode)1677\. Product's Worth Over Invoices | Easy | 🔒 [LeetCode](https://leetcode.com/problems/products-worth-over-invoices)
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Product`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| product\_id  | int     |

| name        | varchar |

+-------------+---------+

product\_id is the primary key for this table.

This table contains the ID and the name of the product. The name consists of only lowercase English letters. No two products have the same name.

Table: `Invoice`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+------+

| Column Name | Type |

+-------------+------+

| invoice\_id  | int  |

| product\_id  | int  |

| rest        | int  |

| paid        | int  |

| canceled    | int  |

| refunded    | int  |

+-------------+------+

invoice\_id is the primary key for this table and the id of this invoice.

product\_id is the id of the product for this invoice.

rest is the amount left to pay for this invoice.

paid is the amount paid for this invoice.

canceled is the amount canceled for this invoice.

refunded is the amount refunded for this invoice.

Write an SQL query that will, for all products, return each product name with total amount due, paid, canceled, and refunded across all invoices.

Return the result table ordered by `product_name`.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Product table:

+------------+-------+

| product\_id | name  |

+------------+-------+

| 0          | ham   |

| 1          | bacon |

+------------+-------+

Invoice table:

+------------+------------+------+------+----------+----------+

| invoice\_id | product\_id | rest | paid | canceled | refunded |

+------------+------------+------+------+----------+----------+

| 23         | 0          | 2    | 0    | 5        | 0        |

| 12         | 0          | 0    | 4    | 0        | 3        |

| 1          | 1          | 1    | 1    | 0        | 1        |

| 2          | 1          | 1    | 0    | 1        | 1        |

| 3          | 1          | 0    | 1    | 1        | 1        |

| 4          | 1          | 1    | 1    | 1        | 0        |

+------------+------------+------+------+----------+----------+

Result table:

+-------+------+------+----------+----------+

| name  | rest | paid | canceled | refunded |

+-------+------+------+----------+----------+

| bacon | 3    | 3    | 3        | 3        |

| ham   | 2    | 4    | 5        | 3        |

+-------+------+------+----------+----------+

\- The amount of money left to pay for bacon is 1 + 1 + 0 + 1 = 3

\- The amount of money paid for bacon is 1 + 0 + 1 + 1 = 3

\- The amount of money canceled for bacon is 0 + 1 + 1 + 1 = 3

\- The amount of money refunded for bacon is 1 + 1 + 1 + 0 = 3

\- The amount of money left to pay for ham is 2 + 0 = 2

\- The amount of money paid for ham is 0 + 4 = 4

\- The amount of money canceled for ham is 5 + 0 = 5

\- The amount of money refunded for ham is 0 + 3 = 3

### [](#solution-136)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT p.name AS name,

    SUM(i.rest) AS rest,

    SUM(i.paid) AS paid,

    SUM(i.canceled) AS canceled,

    SUM(i.refunded) AS refunded

FROM Invoice i

LEFT JOIN Product p ON p.product\_id \= i.product\_id

GROUP BY name

ORDER BY name;

[](#1683-invalid-tweets--easy---leetcode)1683\. Invalid Tweets | Easy | 🔒 [LeetCode](https://leetcode.com/problems/invalid-tweets)
-----------------------------------------------------------------------------------------------------------------------------------

Table: `Tweets`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----------------+---------+

| Column Name    | Type    |

+----------------+---------+

| tweet\_id       | int     |

| content        | varchar |

+----------------+---------+

tweet\_id is the primary key for this table.

This table contains all the tweets in a social media app.

Write an SQL query to find the IDs of the invalid tweets. The tweet is invalid if the number of characters used in the content of the tweet is `strictly greater` than `15`.

Return the result table `in any order`.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Tweets table:

+----------+----------------------------------+

| tweet\_id | content                          |

+----------+----------------------------------+

| 1        | Vote for Biden                   |

| 2        | Let us make America great again! |

+----------+----------------------------------+

Result table:

+----------+

| tweet\_id |

+----------+

| 2        |

+----------+

Tweet 1 has length = 14. It is a valid tweet.

Tweet 2 has length = 32. It is an invalid tweet.

### [](#solution-137)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT tweet\_id

FROM Tweets

WHERE LENGTH(content) \> 15;

[](#1693-daily-leads-and-partners--easy---leetcode)1693\. Daily Leads and Partners | Easy | 🔒 [LeetCode](https://leetcode.com/problems/daily-leads-and-partners)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `DailySales`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| date\_id     | date    |

| make\_name   | varchar |

| lead\_id     | int     |

| partner\_id  | int     |

+-------------+---------+

This table does not have a primary key.

This table contains the date and the name of the product sold and the IDs of the lead and partner it was sold to.

The name consists of only lowercase English letters.

Write an SQL query that will, for each `date_id` and `make_name`, return the number of distinct `lead_id`'s and distinct `partner_id`'s.

Return the result table in any order.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

DailySales table:

+-----------+-----------+---------+------------+

| date\_id   | make\_name | lead\_id | partner\_id |

+-----------+-----------+---------+------------+

| 2020-12-8 | toyota    | 0       | 1          |

| 2020-12-8 | toyota    | 1       | 0          |

| 2020-12-8 | toyota    | 1       | 2          |

| 2020-12-7 | toyota    | 0       | 2          |

| 2020-12-7 | toyota    | 0       | 1          |

| 2020-12-8 | honda     | 1       | 2          |

| 2020-12-8 | honda     | 2       | 1          |

| 2020-12-7 | honda     | 0       | 1          |

| 2020-12-7 | honda     | 1       | 2          |

| 2020-12-7 | honda     | 2       | 1          |

+-----------+-----------+---------+------------+

Result table:

+-----------+-----------+--------------+-----------------+

| date\_id   | make\_name | unique\_leads | unique\_partners |

+-----------+-----------+--------------+-----------------+

| 2020-12-8 | toyota    | 2            | 3               |

| 2020-12-7 | toyota    | 1            | 2               |

| 2020-12-8 | honda     | 2            | 2               |

| 2020-12-7 | honda     | 3            | 2               |

+-----------+-----------+--------------+-----------------+

For 2020-12-8, toyota gets leads = \[0, 1\] and partners = \[0, 1, 2\] while honda gets leads = \[1, 2\] and partners = \[1, 2\].

For 2020-12-7, toyota gets leads = \[0\] and partners = \[1, 2\] while honda gets leads = \[0, 1, 2\] and partners = \[1, 2\].

### [](#solution-138)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT date\_id, make\_name,

    COUNT(DISTINCT lead\_id) AS unique\_leads,

    COUNT(DISTINCT partner\_id) AS unique\_partners

FROM DailySales

GROUP BY date\_id, make\_name

[](#1699-number-of-calls-between-two-persons--medium---leetcode)1699\. Number of Calls Between Two Persons | Medium | 🔒 [LeetCode](https://leetcode.com/problems/number-of-calls-between-two-persons)
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Calls`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| from\_id     | int     |

| to\_id       | int     |

| duration    | int     |

+-------------+---------+

This table does not have a primary key, it may contain duplicates.

This table contains the duration of a phone call between from\_id and to\_id.

from\_id != to\_id

Write an SQL query to report the number of calls and the total call duration between each pair of distinct persons `(person1, person2)` where `person1 < person2`.

Return the result table in any order.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Calls table:

+---------+-------+----------+

| from\_id | to\_id | duration |

+---------+-------+----------+

| 1       | 2     | 59       |

| 2       | 1     | 11       |

| 1       | 3     | 20       |

| 3       | 4     | 100      |

| 3       | 4     | 200      |

| 3       | 4     | 200      |

| 4       | 3     | 499      |

+---------+-------+----------+

Result table:

+---------+---------+------------+----------------+

| person1 | person2 | call\_count | total\_duration |

+---------+---------+------------+----------------+

| 1       | 2       | 2          | 70             |

| 1       | 3       | 1          | 20             |

| 3       | 4       | 4          | 999            |

+---------+---------+------------+----------------+

Users 1 and 2 had 2 calls and the total duration is 70 (59 + 11).

Users 1 and 3 had 1 call and the total duration is 20.

Users 3 and 4 had 4 calls and the total duration is 999 (100 + 200 + 200 + 499).

### [](#solution-139)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

SELECT from\_id AS person1,to\_id AS person2,

    COUNT(duration) AS call\_count, SUM(duration) AS total\_duration

FROM (SELECT \*

      FROM Calls

      UNION ALL

      SELECT to\_id, from\_id, duration

      FROM Calls) t1

WHERE from\_id < to\_id

GROUP BY person1, person2

#Solution 2:

SELECT

    IF(from\_id<to\_id,from\_id,to\_id) person1,

    IF(from\_id\>to\_id,from\_id,to\_id) person2,

    COUNT(\*) call\_count,

    SUM(duration) total\_duration

FROM

    Calls

GROUP BY

    IF(from\_id<to\_id,from\_id,to\_id),

    IF(from\_id\>to\_id,from\_id,to\_id);

[](#1709-biggest-window-between-visits--medium---leetcode)1709\. Biggest Window Between Visits | Medium | 🔒 [LeetCode](https://leetcode.com/problems/biggest-window-between-visits)
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `UserVisits`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+------+

| Column Name | Type |

+-------------+------+

| user\_id     | int  |

| visit\_date  | date |

+-------------+------+

This table does not have a primary key.

This table contains logs of the dates that users vistied a certain retailer.

Assume today's date is `'2021-1-1'`.

Write an SQL query that will, for each `user_id`, find out the largest `window` of days between each visit and the one right after it (or today if you are considering the last visit).

Return the result table ordered by `user_id`.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

UserVisits table:

+---------+------------+

| user\_id | visit\_date |

+---------+------------+

| 1       | 2020-11-28 |

| 1       | 2020-10-20 |

| 1       | 2020-12-3  |

| 2       | 2020-10-5  |

| 2       | 2020-12-9  |

| 3       | 2020-11-11 |

+---------+------------+

Result table:

+---------+---------------+

| user\_id | biggest\_window|

+---------+---------------+

| 1       | 39            |

| 2       | 65            |

| 3       | 51            |

+---------+---------------+

For the first user, the windows in question are between dates:

    - 2020-10-20 and 2020-11-28 with a total of 39 days.

    - 2020-11-28 and 2020-12-3 with a total of 5 days.

    - 2020-12-3 and 2021-1-1 with a total of 29 days.

Making the biggest window the one with 39 days.

For the second user, the windows in question are between dates:

    - 2020-10-5 and 2020-12-9 with a total of 65 days.

    - 2020-12-9 and 2021-1-1 with a total of 23 days.

Making the biggest window the one with 65 days.

For the third user, the only window in question is between dates 2020-11-11 and 2021-1-1 with a total of 51 days.

### [](#solution-140)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT user\_id, max(diff) AS biggest\_window

FROM

(

    SELECT user\_id,

       datediff(coalesce(lead(visit\_date) OVER (PARTITION BY user\_id ORDER BY visit\_date), '2021-01-01'), visit\_date) AS diff

    FROM userVisits

) t

GROUP BY user\_id

ORDER BY user\_id

[](#1715-count-apples-and-oranges--medium---leetcode)1715\. Count Apples and Oranges | Medium | 🔒 [LeetCode](https://leetcode.com/problems/count-apples-and-oranges)
---------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Boxes`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+------+

| Column Name  | Type |

+--------------+------+

| box\_id       | int  |

| chest\_id     | int  |

| apple\_count  | int  |

| orange\_count | int  |

+--------------+------+

box\_id is the primary key for this table.

chest\_id is a foreign key of the chests table.

This table contains information about the boxes and the number of oranges and apples they contain. Each box may contain a chest, which also can contain oranges and apples.

Table: `Chests`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+------+

| Column Name  | Type |

+--------------+------+

| chest\_id     | int  |

| apple\_count  | int  |

| orange\_count | int  |

+--------------+------+

chest\_id is the primary key for this table.

This table contains information about the chests we have, and the corresponding number if oranges and apples they contain.

Write an SQL query to count the number of apples and oranges in all the boxes. If a box contains a chest, you should also include the number of apples and oranges it has.

Return the result table in **any order**.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Boxes table:

+--------+----------+-------------+--------------+

| box\_id | chest\_id | apple\_count | orange\_count |

+--------+----------+-------------+--------------+

| 2      | null     | 6           | 15           |

| 18     | 14       | 4           | 15           |

| 19     | 3        | 8           | 4            |

| 12     | 2        | 19          | 20           |

| 20     | 6        | 12          | 9            |

| 8      | 6        | 9           | 9            |

| 3      | 14       | 16          | 7            |

+--------+----------+-------------+--------------+

Chests table:

+----------+-------------+--------------+

| chest\_id | apple\_count | orange\_count |

+----------+-------------+--------------+

| 6        | 5           | 6            |

| 14       | 20          | 10           |

| 2        | 8           | 8            |

| 3        | 19          | 4            |

| 16       | 19          | 19           |

+----------+-------------+--------------+

Result table:

+-------------+--------------+

| apple\_count | orange\_count |

+-------------+--------------+

| 151         | 123          |

+-------------+--------------+

box 2 has 6 apples and 15 oranges.

box 18 has 4 + 20 (from the chest) = 24 apples and 15 + 10 (from the chest) = 25 oranges.

box 19 has 8 + 19 (from the chest) = 27 apples and 4 + 4 (from the chest) = 8 oranges.

box 12 has 19 + 8 (from the chest) = 27 apples and 20 + 8 (from the chest) = 28 oranges.

box 20 has 12 + 5 (from the chest) = 17 apples and 9 + 6 (from the chest) = 15 oranges.

box 8 has 9 + 5 (from the chest) = 14 apples and 9 + 6 (from the chest) = 15 oranges.

box 3 has 16 + 20 (from the chest) = 36 apples and 7 + 10 (from the chest) = 17 oranges.

Total number of apples = 6 + 24 + 27 + 27 + 17 + 14 + 36 = 151

Total number of oranges = 15 + 25 + 8 + 28 + 15 + 15 + 17 = 123

### [](#solution-141)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT sum(IFNULL(box.apple\_count, 0) + IFNULL(chest.apple\_count, 0)) AS apple\_count,

    sum(IFNULL(box.orange\_count, 0) + IFNULL(chest.orange\_count, 0)) AS orange\_count

    FROM Boxes AS box

    LEFT JOIN Chests AS chest

    ON box.chest\_id \= chest.chest\_id;

[](#1729-find-followers-count--easy---leetcode)1729\. Find Followers Count | Easy | 🔒 [LeetCode](https://leetcode.com/problems/find-followers-count)
-----------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Followers`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+------+

| Column Name | Type |

+-------------+------+

| user\_id     | int  |

| follower\_id | int  |

+-------------+------+

(user\_id, follower\_id) is the primary key for this table.

This table contains the IDs of a user and a follower in a social media app where the follower follows the user.

Write an SQL query that will, for each user, return the number of followers.

Return the result table ordered by user\_id.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Followers table:

+---------+-------------+

| user\_id | follower\_id |

+---------+-------------+

| 0       | 1           |

| 1       | 0           |

| 2       | 0           |

| 2       | 1           |

+---------+-------------+

Result table:

+---------+----------------+

| user\_id | followers\_count|

+---------+----------------+

| 0       | 1              |

| 1       | 1              |

| 2       | 2              |

+---------+----------------+

The followers of 0 are {1}

The followers of 1 are {0}

The followers of 2 are {0,1}

### [](#solution-142)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT user\_id, COUNT(DISTINCT follower\_id) followers\_count

FROM followers

GROUP BY user\_id

ORDER BY user\_id

[](#1731-the-number-of-employees-which-report-to-each-employee--easy---leetcode)1731\. The Number of Employees Which Report to Each Employee | Easy | 🔒 [LeetCode](https://leetcode.com/problems/the-number-of-employees-which-report-to-each-employee)
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Employees`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+----------+

| Column Name | Type     |

+-------------+----------+

| employee\_id | int      |

| name        | varchar  |

| reports\_to  | int      |

| age         | int      |

+-------------+----------+

employee\_id is the primary key for this table.

This table contains information about the employees and the id of the manager they report to. Some employees do not report to anyone (reports\_to is null).

For this problem, we will consider a **manager** an employee who has at least 1 other employee reporting to them.

Write an SQL query to report the ids and the names of all **managers**, the number of employees who report **directly** to them, and the average age of the reports rounded to the nearest integer.

Return the result table ordered by `employee_id`.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Employees table:

+-------------+---------+------------+-----+

| employee\_id | name    | reports\_to | age |

+-------------+---------+------------+-----+

| 9           | Hercy   | null       | 43  |

| 6           | Alice   | 9          | 41  |

| 4           | Bob     | 9          | 36  |

| 2           | Winston | null       | 37  |

+-------------+---------+------------+-----+

Result table:

+-------------+-------+---------------+-------------+

| employee\_id | name  | reports\_count | average\_age |

+-------------+-------+---------------+-------------+

| 9           | Hercy | 2             | 39          |

+-------------+-------+---------------+-------------+

Hercy has 2 people report directly to him, Alice and Bob. Their average age is (41+36)/2 = 38.5, which is 39 after rounding it to the nearest integer.

### [](#solution-143)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT e1.reports\_to AS employee\_id,

       e2.name,

       COUNT(e1.reports\_to) AS reports\_count,

       ROUND(AVG(e1.age),0) AS average\_age

FROM employees e1

JOIN employees e2

ON e1.reports\_to\=e2.employee\_id

GROUP BY e1.reports\_to

ORDER BY e1.reports\_to

[](#1741-find-total-time-spent-by-each-employee--easy---leetcode)1741\. Find Total Time Spent by Each Employee | Easy | 🔒 [LeetCode](https://leetcode.com/problems/find-total-time-spent-by-each-employee)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Employees`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+------+

| Column Name | Type |

+-------------+------+

| emp\_id      | int  |

| event\_day   | date |

| in\_time     | int  |

| out\_time    | int  |

+-------------+------+

(emp\_id, event\_day, in\_time) is the primary key of this table.

The table shows the employees' entries and exits in an office.

event\_day is the day at which this event happened and in\_time is the minute at which the employee entered the office and out\_time is the time at which he got outnumbered from 1 to 1440.

It's guaranteed that no two events on the same day intersect in time.

Write an SQL query to calculate the total time **in minutes** spent by each employee on each day at the office. Note that within one day, an employee can enter and leave more than once.

Return the result table in **any order**.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Employees table:

+--------+------------+---------+----------+

| emp\_id | event\_day  | in\_time | out\_time |

+--------+------------+---------+----------+

| 1      | 2020-11-28 | 4       | 32       |

| 1      | 2020-11-28 | 55      | 200      |

| 1      | 2020-12-03 | 1       | 42       |

| 2      | 2020-11-28 | 3       | 33       |

| 2      | 2020-12-09 | 47      | 74       |

+--------+------------+---------+----------+

Result table:

+------------+--------+------------+

| day        | emp\_id | total\_time |

+------------+--------+------------+

| 2020-11-28 | 1      | 173        |

| 2020-11-28 | 2      | 30         |

| 2020-12-03 | 1      | 41         |

| 2020-12-09 | 2      | 27         |

+------------+--------+------------+

Employee 1 has three events two on day 2020-11-28 with a total of (32 - 4) + (200-55) = 173 and one on day 2020-12-03 with a total of (42 - 1) = 41.

Employee 2 has two events one on day 2020-11-28 with a total of (33-3) = 30 and one on day 2020-12-09 with a total of (74 - 47) = 27.

### [](#solution-144)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT event\_day AS day, emp\_id, SUM(out\_time \- in\_time) AS total\_time

FROM Employees

GROUP BY day, emp\_id

[](#1747-leetflex-banned-accounts--medium---leetcode)1747\. Leetflex Banned Accounts | Medium | 🔒 [LeetCode](https://leetcode.com/problems/leetflex-banned-accounts)
---------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `LogInfo`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+----------+

| Column Name | Type     |

+-------------+----------+

| account\_id  | int      |

| ip\_address  | int      |

| login       | datetime |

| logout      | datetime |

+-------------+----------+

There is no primary key for this table, and it may contain duplicates.

The table contains information about the login and logout dates of Leetflex accounts. It also contains the IP address from which the account logged in and out.

It is guaranteed that the logout time is after the login time.

Write an SQL query to find the `account_id` of the accounts that should be banned from Leetflex. An account should be banned if it was logged in at some moment from two different IP addresses.

Return the result table in any order.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

LogInfo table:

+------------+------------+---------------------+---------------------+

| account\_id | ip\_address | login               | logout              |

+------------+------------+---------------------+---------------------+

| 1          | 1          | 2021-02-01 09:00:00 | 2021-02-01 09:30:00 |

| 1          | 2          | 2021-02-01 08:00:00 | 2021-02-01 11:30:00 |

| 2          | 6          | 2021-02-01 20:30:00 | 2021-02-01 22:00:00 |

| 2          | 7          | 2021-02-02 20:30:00 | 2021-02-02 22:00:00 |

| 3          | 9          | 2021-02-01 16:00:00 | 2021-02-01 16:59:59 |

| 3          | 13         | 2021-02-01 17:00:00 | 2021-02-01 17:59:59 |

| 4          | 10         | 2021-02-01 16:00:00 | 2021-02-01 17:00:00 |

| 4          | 11         | 2021-02-01 17:00:00 | 2021-02-01 17:59:59 |

+------------+------------+---------------------+---------------------+

Result table:

+------------+

| account\_id |

+------------+

| 1          |

| 4          |

+------------+

Account ID 1 --> The account was active from "2021-02-01 09:00:00" to "2021-02-01 09:30:00" with two different IP addresses (1 and 2). It should be banned.

Account ID 2 --> The account was active from two different addresses (6, 7) but in two different times.

Account ID 3 --> The account was active from two different addresses (9, 13) on the same day but they do not intersect at any moment.

Account ID 4 --> The account was active from "2021-02-01 17:00:00" to "2021-02-01 17:00:00" with two different IP addresses (10 and 11). It should be banned.

### [](#solution-145)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT DISTINCT l1.account\_id

FROM LogInfo l1

JOIN LogInfo l2

ON l1.account\_id \= l2.account\_id AND l1.ip\_address != l2.ip\_address

WHERE NOT (l1.login \> l2.logout OR l1.logout < l2.login)

[](#1757-recyclable-and-low-fat-products--easy---leetcode)1757\. Recyclable and Low Fat Products | Easy | 🔒 [LeetCode](https://leetcode.com/problems/recyclable-and-low-fat-products)
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Products`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| product\_id  | int     |

| low\_fats    | enum    |

| recyclable  | enum    |

+-------------+---------+

product\_id is the primary key for this table.

low\_fats is an ENUM of type ('Y', 'N') where 'Y' means this product is low fat and 'N' means it is not.

recyclable is an ENUM of types ('Y', 'N') where 'Y' means this product is recyclable and 'N' means it is not.

Write an SQL query to find the ids of products that are both low fat and recyclable.

Return the result table in **any order**.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Products table:

+-------------+----------+------------+

| product\_id  | low\_fats | recyclable |

+-------------+----------+------------+

| 0           | Y        | N          |

| 1           | Y        | Y          |

| 2           | N        | Y          |

| 3           | Y        | Y          |

| 4           | N        | N          |

+-------------+----------+------------+

Result table:

+-------------+

| product\_id  |

+-------------+

| 1           |

| 3           |

+-------------+

Only products 1 and 3 are both low fat and recyclable.

### [](#solution-146)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT product\_id

FROM Products

WHERE low\_fats \= "Y" AND recyclable \= "Y"

[](#1767-find-the-subtasks-that-did-not-execute--hard---leetcode)1767\. Find the Subtasks That Did Not Execute | Hard | 🔒 [LeetCode](https://leetcode.com/problems/find-the-subtasks-that-did-not-execute)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Tasks`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----------------+---------+

| Column Name    | Type    |

+----------------+---------+

| task\_id        | int     |

| subtasks\_count | int     |

+----------------+---------+

task\_id is the primary key for this table.

Each row in this table indicates that task\_id was divided into subtasks\_count subtasks labelled from 1 to subtasks\_count.

It is guaranteed that 2 <= subtasks\_count <= 20.

Table: `Executed`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| task\_id       | int     |

| subtask\_id    | int     |

+---------------+---------+

(task\_id, subtask\_id) is the primary key for this table.

Each row in this table indicates that for the task task\_id, the subtask with ID subtask\_id was executed successfully.

It is guaranteed that subtask\_id <= subtasks\_count for each task\_id.

Write an SQL query to report the IDs of the missing subtasks for each `task_id`.

Return the result table in **any order**.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Tasks table:

+---------+----------------+

| task\_id | subtasks\_count |

+---------+----------------+

| 1       | 3              |

| 2       | 2              |

| 3       | 4              |

+---------+----------------+

Executed table:

+---------+------------+

| task\_id | subtask\_id |

+---------+------------+

| 1       | 2          |

| 3       | 1          |

| 3       | 2          |

| 3       | 3          |

| 3       | 4          |

+---------+------------+

Result table:

+---------+------------+

| task\_id | subtask\_id |

+---------+------------+

| 1       | 1          |

| 1       | 3          |

| 2       | 1          |

| 2       | 2          |

+---------+------------+

Task 1 was divided into 3 subtasks (1, 2, 3). Only subtask 2 was executed successfully, so we include (1, 1) and (1, 3) in the answer.

Task 2 was divided into 2 subtasks (1, 2). No subtask was executed successfully, so we include (2, 1) and (2, 2) in the answer.

Task 3 was divided into 4 subtasks (1, 2, 3, 4). All of the subtasks were executed successfully.

### [](#solution-147)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

WITH RECURSIVE CTE AS

  (SELECT 1 AS subtask\_id

   UNION ALL SELECT subtask\_id + 1

   FROM CTE

   WHERE subtask\_id <

       (SELECT MAX(subtasks\_count)

        FROM Tasks) )

SELECT Tasks.task\_id,

       CTE.subtask\_id

FROM CTE

INNER JOIN Tasks ON CTE.subtask\_id <= Tasks.subtasks\_count

LEFT JOIN Executed ON Tasks.task\_id \= Executed.task\_id

                      AND CTE.subtask\_id \= Executed.subtask\_id

WHERE Executed.subtask\_id IS NULL

ORDER BY NULL

[](#1777-products-price-for-each-store--easy---leetcode)1777\. Product's Price for Each Store | Easy | 🔒 [LeetCode](https://leetcode.com/problems/products-price-for-each-store)
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Products`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+-------------+---------+

| Column Name | Type    |

+-------------+---------+

| product\_id  | int     |

| store       | enum    |

| price       | int     |

+-------------+---------+

(product\_id,store) is the primary key for this table.

store is an ENUM of type ('store1', 'store2', 'store3') where each represents the store this product is available at.

price is the price of the product at this store.

Write an SQL query to find the price of each product in each store.

Return the result table in **any order**.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Products table:

+-------------+--------+-------+

| product\_id  | store  | price |

+-------------+--------+-------+

| 0           | store1 | 95    |

| 0           | store3 | 105   |

| 0           | store2 | 100   |

| 1           | store1 | 70    |

| 1           | store3 | 80    |

+-------------+--------+-------+

Result table:

+-------------+--------+--------+--------+

| product\_id  | store1 | store2 | store3 |

+-------------+--------+--------+--------+

| 0           | 95     | 100    | 105    |

| 1           | 70     | null   | 80     |

+-------------+--------+--------+--------+

Product 0 price's are 95 for store1, 100 for store2 and, 105 for store3.

Product 1 price's are 70 for store1, 80 for store3 and, it's not sold in store2.

### [](#solution-148)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

SELECT product\_id,

       SUM(CASE WHEN store\='store1' THEN price END) AS store1,

       SUM(CASE WHEN store\='store2' THEN price END) AS store2,

       SUM(CASE WHEN store\='store3' THEN price END) AS store3

FROM Products

GROUP BY product\_id

[](#1783-grand-slam-titles--medium---leetcode)1783\. Grand Slam Titles | Medium | 🔒 [LeetCode](https://leetcode.com/problems/grand-slam-titles)
------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Players`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+----------------+---------+

| Column Name    | Type    |

+----------------+---------+

| player\_id      | int     |

| player\_name    | varchar |

+----------------+---------+

player\_id is the primary key for this table.

Each row in this table contains the name and the ID of a tennis player.

Table: `Championships`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+---------------+---------+

| Column Name   | Type    |

+---------------+---------+

| year          | int     |

| Wimbledon     | int     |

| Fr\_open       | int     |

| US\_open       | int     |

| Au\_open       | int     |

+---------------+---------+

year is the primary key for this table.

Each row of this table containts the IDs of the players who won one each tennis tournament of the grand slam.

Write an SQL query to report the number of grand slam tournaments won by each player. Do not include the players who did not win any tournament.

Return the result table in **any order**.

The query result format is in the following example:

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Players table:

+-----------+-------------+

| player\_id | player\_name |

+-----------+-------------+

| 1         | Nadal       |

| 2         | Federer     |

| 3         | Novak       |

+-----------+-------------+

Championships table:

+------+-----------+---------+---------+---------+

| year | Wimbledon | Fr\_open | US\_open | Au\_open |

+------+-----------+---------+---------+---------+

| 2018 | 1         | 1       | 1       | 1       |

| 2019 | 1         | 1       | 2       | 2       |

| 2020 | 2         | 1       | 2       | 2       |

+------+-----------+---------+---------+---------+

Result table:

+-----------+-------------+-------------------+

| player\_id | player\_name | grand\_slams\_count |

+-----------+-------------+-------------------+

| 2         | Federer     | 5                 |

| 1         | Nadal       | 7                 |

+-----------+-------------+-------------------+

Player 1 (Nadal) won 7 titles: Wimbledon (2018, 2019), Fr\_open (2018, 2019, 2020), US\_open (2018), and Au\_open (2018).

Player 2 (Federer) won 5 titles: Wimbledon (2020), US\_open (2019, 2020), and Au\_open (2019, 2020).

Player 3 (Novak) did not win anything, we did not include them in the result table.

### [](#solution-149)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

SELECT player\_id, player\_name,

	SUM((IF(Wimbledon \= player\_id,1,0) +

		IF(Fr\_open \= player\_id,1,0) +

		IF(US\_open \= player\_id,1,0) +

		IF(Au\_open \= player\_id,1,0))) as grand\_slams\_count

FROM Players INNER JOIN Championships

ON Wimbledon \= player\_id OR Fr\_open \= player\_id OR US\_open \= player\_id OR Au\_open \= player\_id

GROUP BY player\_id;

#Solution 2:

WITH cte

     AS (SELECT wimbledon AS id

         FROM   championships

         UNION ALL

         SELECT fr\_open AS id

         FROM   championships

         UNION ALL

         SELECT us\_open AS id

         FROM   championships

         UNION ALL

         SELECT au\_open AS id

         FROM   championships)

SELECT player\_id,

       player\_name,

       Count(\*) AS grand\_slams\_count

FROM   players

       INNER JOIN cte

               ON players.player\_id \= cte.id

GROUP  BY 1, 2

ORDER  BY NULL;

[](#1789-primary-department-for-each-employee--easy---leetcode)1789\. Primary Department for Each Employee | Easy | 🔒 [LeetCode](https://leetcode.com/problems/primary-department-for-each-employee)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Table: `Employee`

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

+--------------+---------+

| Column Name  |  Type   |

+--------------+---------+

| employee\_id  | int     |

| deprtment\_id | int     |

| primary\_flag | varchar |

+--------------+---------+

(employee\_id, department\_id) is the primary key for this table.

employee\_id is the id of the employee.

department\_id is the id of the department to which the employee belongs.

primary\_flag is an ENUM of type ('Y', 'N'). If the flag is 'Y', the department is the primary department for the employee. If the flag is 'N', the department is not the primary.

Employees can belong to multiple departments. When the employee joins other departments, they need to decide which department is their primary department. Note that when an employee belongs to only one department, their primary column is `'N'`.

Write an SQL query to report all the employees with their primary department. For employees who belong to one department, report their only department.

Return the result table in any order.

The query result format is in the following example.

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

Employee table:

+-------------+---------------+--------------+

| employee\_id | department\_id | primary\_flag |

+-------------+---------------+--------------+

| 1           | 1             | N            |

| 2           | 1             | Y            |

| 2           | 2             | N            |

| 3           | 3             | N            |

| 4           | 2             | N            |

| 4           | 3             | Y            |

| 4           | 4             | N            |

+-------------+---------------+--------------+

Result table:

+-------------+---------------+

| employee\_id | department\_id |

+-------------+---------------+

| 1           | 1             |

| 2           | 1             |

| 3           | 3             |

| 4           | 3             |

+-------------+---------------+

\- The Primary department for employee 1 is 1.

\- The Primary department for employee 2 is 1.

\- The Primary department for employee 3 is 3.

\- The Primary department for employee 4 is 3.

### [](#solution-150)Solution

sql

\[data-radix-scroll-area-viewport\]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}\[data-radix-scroll-area-viewport\]::-webkit-scrollbar{display:none}

#Solution 1:

SELECT employee\_id,department\_id

FROM employee

WHERE primary\_flag \= 'Y' OR employee\_id IN

    (SELECT employee\_id

     FROM employee

     GROUP BY employee\_id

     HAVING COUNT(department\_id) \= 1)

#Solution 2:

(SELECT employee\_id,

      department\_id

FROM Employee

WHERE primary\_flag \= 'Y')

UNION

(SELECT employee\_id,

      department\_id

FROM Employee

GROUP BY employee\_id

HAVING COUNT(employee\_id) \= 1

ORDER BY NULL);

[← HackerRank SQL Problem Solving Questions With Solutions](/articles/sql/hackerrank-sql-problem-solving)

*   [Contact](/contact)
*   [Become a supporter](/miscellaneous/support)
*   [FAQs](/miscellaneous/uses)
*   [Terms & Policies](/miscellaneous/terms)
*   [Sitemap](/miscellaneous/sitemap)

*   [Tableau](https://public.tableau.com/profile/faisalakbar#!/)
*   [Linkedin](https://www.linkedin.com/in/md-faisal-akbar/)
*   [GitHub](https://github.com/faisal-akbar)
*   [Twitter](https://twitter.com/_faisal_akbar)
*   [RSS feed](/feed.xml)

© 2006—2024[Faisal Akbar](#).  
Built in Queens, New York.

{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\\u003e{var u=Object.create;var r=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var y=Object.getPrototypeOf,\_=Object.prototype.hasOwnProperty;var b=(t,e)=\\u003e()=\\u003e(e||t((e={exports:{}}).exports,e),e.exports),E=(t,e)=\\u003e{for(var i in e)r(t,i,{get:e\[i\],enumerable:!0})},d=(t,e,i,o)=\\u003e{if(e\\u0026\\u0026typeof e==\\"object\\"||typeof e==\\"function\\")for(let a of p(e))!\_.call(t,a)\\u0026\\u0026a!==i\\u0026\\u0026r(t,a,{get:()=\\u003ee\[a\],enumerable:!(o=m(e,a))||o.enumerable});return t};var f=(t,e,i)=\\u003e(i=t!=null?u(y(t)):{},d(e||!t||!t.\_\_esModule?r(i,\\"default\\",{value:t,enumerable:!0}):i,t)),S=t=\\u003ed(r({},\\"\_\_esModule\\",{value:!0}),t);var l=b((C,s)=\\u003e{s.exports=\_jsx\_runtime});var g={};E(g,{default:()=\\u003eh,frontmatter:()=\\u003eN});var n=f(l()),N={title:\\"LeetCode SQL Problem Solving Questions With Solutions\\",date:\\"2020-11-06\\",lastmod:\\"2020-11-06\\",path:\\"/articles\\",draft:!1,tags:\[\\"SQL\\",\\"SQL Problem Solving\\",\\"LeetCode\\"\],summary:\\"Post displaying LeetCode sql problem solving questions and solution.\\",images:\[\\"/static/images/articles/leetcode-sql.png\\"\],featured:!0,comment:!0,showTOC:!0};function c(t){let e={a:\\"a\\",br:\\"br\\",code:\\"code\\",div:\\"div\\",em:\\"em\\",h2:\\"h2\\",h3:\\"h3\\",li:\\"li\\",ol:\\"ol\\",p:\\"p\\",pre:\\"pre\\",span:\\"span\\",strong:\\"strong\\",ul:\\"ul\\",...t.components},{Image:i}=e;return i||T(\\"Image\\",!0),(0,n.jsxs)(n.Fragment,{children:\[(0,n.jsxs)(e.h2,{id:\\"175-combine-two-tables--easy--leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#175-combine-two-tables--easy--leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"175. Combine Two Tables | Easy | \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/combine-two-tables/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Person\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| PersonId | int |\\n| FirstName | varchar |\\n| LastName | varchar |\\n+-------------+---------+\\nPersonId is the primary key column for this table.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Address\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| AddressId | int |\\n| PersonId | int |\\n| City | varchar |\\n| State | varchar |\\n+-------------+---------+\\nAddressId is the primary key column for this table.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write a SQL query for a report that provides the following information for each person in the Person table, regardless if there is an address for each of those people:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`FirstName, LastName, City, State\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT p.FirstName, p.LastName, a.City, a.State\\nFROM Person p\\nLEFT JOIN Address a\\nON p.PersonId = a.PersonId;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"176-second-highest-salary--easy--leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#176-second-highest-salary--easy--leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"176. Second Highest Salary | Easy | \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/second-highest-salary/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Write a SQL query to get the second highest salary from the \\",(0,n.jsx)(e.code,{children:\\"Employee\\"}),\\" table.\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----+--------+\\n| Id | Salary |\\n+----+--------+\\n| 1 | 100 |\\n| 2 | 200 |\\n| 3 | 300 |\\n+----+--------+\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"For example, given the above Employee table, the query should return \\",(0,n.jsx)(e.code,{children:\\"200\\"}),\\" as the second highest salary. If there is no second highest salary, then the query should return \\",(0,n.jsx)(e.code,{children:\\"null\\"}),\\".\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------------+\\n| SecondHighestSalary |\\n+---------------------+\\n| 200 |\\n+---------------------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-1\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-1\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nSELECT Max(Salary) SecondHighestSalary\\nFROM Employee WHERE Salary \\u003c (SELECT MAX(Salary) FROM Employee)\\n\\n#Solution 2:\\nWITH CTE AS (SELECT DISTINCT Salary\\nFROM Employee\\nORDER BY Salary DESC\\nLIMIT 2)\\n\\nSELECT Salary as SecondHighestSalary\\nFROM CTE\\nORDER BY Salary Asc\\nLIMIT 1;\\n\\n#Solution 3:\\nWITH CTE AS\\n(\\n SELECT Salary,\\n DENSE\_RANK() OVER (ORDER BY Salary DESC) AS DENSERANK\\n FROM Employee\\n)\\nSELECT Salary SecondHighestSalary\\nFROM CTE\\nWHERE DENSERANK = 2;\\n\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"177-nth-highest-salary--medium--leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#177-nth-highest-salary--medium--leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"177. Nth Highest Salary | Medium | \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/nth-highest-salary/\\",children:\\"LeetCode\\"})\]}),(0,n.jsx)(e.p,{children:\\"Write a SQL query to get the nth highest salary from the Employee table.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----+--------+\\n| Id | Salary |\\n+----+--------+\\n| 1 | 100 |\\n| 2 | 200 |\\n| 3 | 300 |\\n+----+--------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"For example, given the above Employee table, the nth highest salary where n = 2 is 200. If there is no nth highest salary, then the query should return null.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+------------------------+\\n| getNthHighestSalary(2) |\\n+------------------------+\\n| 200 |\\n+------------------------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-2\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-2\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`CREATE FUNCTION getNthHighestSalary(N INT) RETURNS INT\\nBEGIN\\nSET N = N-1;\\n RETURN(\\n SELECT DISTINCT Salary FROM Employee ORDER BY Salary DESC\\n LIMIT 1 OFFSET N\\n );\\nEND\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"178-rank-scores--medium--leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#178-rank-scores--medium--leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"178. Rank Scores | Medium | \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/rank-scores/\\",children:\\"LeetCode\\"})\]}),(0,n.jsx)(e.p,{children:'Write a SQL query to rank scores. If there is a tie between two scores, both should have the same ranking. Note that after a tie, the next ranking number should be the next consecutive integer value. In other words, there should be no \\"holes\\" between ranks.'}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----+-------+\\n| Id | Score |\\n+----+-------+\\n| 1 | 3.50 |\\n| 2 | 3.65 |\\n| 3 | 4.00 |\\n| 4 | 3.85 |\\n| 5 | 4.00 |\\n| 6 | 3.65 |\\n+----+-------+\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"For example, given the above \\",(0,n.jsx)(e.code,{children:\\"Scores\\"}),\\" table, your query should generate the following report (order by highest score):\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------+---------+\\n| score | Rank |\\n+-------+---------+\\n| 4.00 | 1 |\\n| 4.00 | 1 |\\n| 3.85 | 2 |\\n| 3.65 | 3 |\\n| 3.65 | 3 |\\n| 3.50 | 4 |\\n+-------+---------+\\n\`})}),(0,n.jsxs)(e.p,{children:\[(0,n.jsx)(e.strong,{children:\\"Important Note:\\"}),\\" For MySQL solutions, to escape reserved words used as column names, you can use an apostrophe before and after the keyword. For example \\",(0,n.jsx)(e.code,{children:\\"Rank\\"}),\\".\\"\]}),(0,n.jsxs)(e.h3,{id:\\"solution-3\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-3\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT score, DENSE\_RANK() OVER (ORDER By Score DESC) AS \\"Rank\\"\\nFROM Scores;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"180-consecutive-numbers--medium--leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#180-consecutive-numbers--medium--leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"180. Consecutive Numbers | Medium | \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/consecutive-numbers/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Logs\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| id | int |\\n| num | varchar |\\n+-------------+---------+\\nid is the primary key for this table.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find all numbers that appear at least three times consecutively.\\"}),(0,n.jsx)(e.p,{children:\\"Return the result table in any order.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Logs table:\\n+----+-----+\\n| Id | Num |\\n+----+-----+\\n| 1 | 1 |\\n| 2 | 1 |\\n| 3 | 1 |\\n| 4 | 2 |\\n| 5 | 1 |\\n| 6 | 2 |\\n| 7 | 2 |\\n+----+-----+\\n\\nResult table:\\n+-----------------+\\n| ConsecutiveNums |\\n+-----------------+\\n| 1 |\\n+-----------------+\\n1 is the only number that appears consecutively for at least three times.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-4\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-4\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT a.Num as ConsecutiveNums\\nFROM Logs a\\nJOIN Logs b\\nON a.id = b.id+1 AND a.num = b.num\\nJOIN Logs c\\nON a.id = c.id+2 AND a.num = c.num;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"181-employees-earning-more-than-their-managers--easy--leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#181-employees-earning-more-than-their-managers--easy--leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"181. Employees Earning More Than Their Managers | Easy | \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/employees-earning-more-than-their-managers/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"The \\",(0,n.jsx)(e.code,{children:\\"Employee\\"}),\\" table holds all employees including their managers. Every employee has an Id, and there is also a column for the manager Id.\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----+-------+--------+-----------+\\n| Id | Name | Salary | ManagerId |\\n+----+-------+--------+-----------+\\n| 1 | Joe | 70000 | 3 |\\n| 2 | Henry | 80000 | 4 |\\n| 3 | Sam | 60000 | NULL |\\n| 4 | Max | 90000 | NULL |\\n+----+-------+--------+-----------+\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Given the \\",(0,n.jsx)(e.code,{children:\\"Employee\\"}),\\" table, write a SQL query that finds out employees who earn more than their managers. For the above table, Joe is the only employee who earns more than his manager.\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----------+\\n| Employee |\\n+----------+\\n| Joe |\\n+----------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-5\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-5\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT E.Name as \\"Employee\\"\\nFROM Employee E\\nJOIN Employee M\\nON E.ManagerId = M.Id\\nAND E.Salary \\u003e M.Salary;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"182-duplicate-emails--easy--leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#182-duplicate-emails--easy--leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"182. Duplicate Emails | Easy | \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/duplicate-emails/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Write a SQL query to find all duplicate emails in a table named \\",(0,n.jsx)(e.code,{children:\\"Person\\"}),\\".\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----+---------+\\n| Id | Email |\\n+----+---------+\\n| 1 | a@b.com |\\n| 2 | c@d.com |\\n| 3 | a@b.com |\\n+----+---------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"For example, your query should return the following for the above table:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------+\\n| Email |\\n+---------+\\n| a@b.com |\\n+---------+\\n\`})}),(0,n.jsxs)(e.p,{children:\[(0,n.jsx)(e.strong,{children:\\"Note:\\"}),\\" All emails are in lowercase.\\"\]}),(0,n.jsxs)(e.h3,{id:\\"solution-6\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-6\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution- 1:\\nSELECT Email\\nFROM Person\\nGROUP BY Email\\nHAVING count(\*) \\u003e 1\\n\\n#Solution- 2:\\nWITH CTE AS(\\nSELECT Email, ROW\_NUMBER() OVER(PARTITION BY Email ORDER BY Email) AS RN\\n FROM Person\\n)\\n\\nSELECT Email\\nFROM CTE\\nWHERE RN \\u003e 1;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"183-customers-who-never-order--easy--leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#183-customers-who-never-order--easy--leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"183. Customers Who Never Order | Easy | \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/customers-who-never-order/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Suppose that a website contains two tables, the \\",(0,n.jsx)(e.code,{children:\\"Customers\\"}),\\" table and the \\",(0,n.jsx)(e.code,{children:\\"Orders\\"}),\\" table. Write a SQL query to find all customers who never order anything.\\"\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Customers\\"}),\\".\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----+-------+\\n| Id | Name |\\n+----+-------+\\n| 1 | Joe |\\n| 2 | Henry |\\n| 3 | Sam |\\n| 4 | Max |\\n+----+-------+\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Orders\\"}),\\".\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----+------------+\\n| Id | CustomerId |\\n+----+------------+\\n| 1 | 3 |\\n| 2 | 1 |\\n+----+------------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"Using the above tables as example, return the following:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-----------+\\n| Customers |\\n+-----------+\\n| Henry |\\n| Max |\\n+-----------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-7\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-7\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution- 1:\\nSELECT Name AS Customers\\nFROM Customers\\nLEFT JOIN Orders\\nON Customers.Id = Orders.CustomerId\\nWHERE CustomerId IS NULL;\\n\\n#Solution- 2:\\nSELECT Name as Customers\\nFROM Customers\\nWHERE Id NOT IN(\\n SELECT CustomerId\\n FROM Orders\\n)\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"184-department-highest-salary--medium--leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#184-department-highest-salary--medium--leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"184. Department Highest Salary | Medium | \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/department-highest-salary/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"The \\",(0,n.jsx)(e.code,{children:\\"Employee\\"}),\\" table holds all employees. Every employee has an Id, a salary, and there is also a column for the department Id.\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----+-------+--------+--------------+\\n| Id | Name | Salary | DepartmentId |\\n+----+-------+--------+--------------+\\n| 1 | Joe | 70000 | 1 |\\n| 2 | Jim | 90000 | 1 |\\n| 3 | Henry | 80000 | 2 |\\n| 4 | Sam | 60000 | 2 |\\n| 5 | Max | 90000 | 1 |\\n+----+-------+--------+--------------+\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"The \\",(0,n.jsx)(e.code,{children:\\"Department\\"}),\\" table holds all departments of the company.\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----+----------+\\n| Id | Name |\\n+----+----------+\\n| 1 | IT |\\n| 2 | Sales |\\n+----+----------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write a SQL query to find employees who have the highest salary in each of the departments. For the above tables, your SQL query should return the following rows (order of rows does not matter).\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+------------+----------+--------+\\n| Department | Employee | Salary |\\n+------------+----------+--------+\\n| IT | Max | 90000 |\\n| IT | Jim | 90000 |\\n| Sales | Henry | 80000 |\\n+------------+----------+--------+\\n\`})}),(0,n.jsxs)(e.p,{children:\[(0,n.jsx)(e.strong,{children:(0,n.jsx)(e.em,{children:\\"Explanation:\\"})}),(0,n.jsx)(e.br,{}),\\"Max and Jim both have the highest salary in the IT department and Henry has the highest salary in the Sales department.\\"\]}),(0,n.jsxs)(e.h3,{id:\\"solution-8\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-8\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT Department.Name AS Department, Employee.Name AS Employee, Salary\\nFROM Employee\\nJOIN Department\\nON Employee.DepartmentId = Department.Id\\nWHERE (DepartmentId, Salary) IN(\\n SELECT DepartmentId, MAX(Salary) AS Salary\\n FROM Employee\\n GROUP BY DepartmentId\\n );\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"185-department-top-three-salaries--hard--leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#185-department-top-three-salaries--hard--leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"185. Department Top Three Salaries | Hard | \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/department-top-three-salaries/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"The \\",(0,n.jsx)(e.code,{children:\\"Employee\\"}),\\" table holds all employees. Every employee has an Id, and there is also a column for the department Id.\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----+-------+--------+--------------+\\n| Id | Name\\\\\` | Salary | DepartmentId |\\n+----+-------+--------+--------------+\\n| 1 | Joe | 85000 | 1 |\\n| 2 | Henry | 80000 | 2 |\\n| 3 | Sam | 60000 | 2 |\\n| 4 | Max | 90000 | 1 |\\n| 5 | Janet | 69000 | 1 |\\n| 6 | Randy | 85000 | 1 |\\n| 7 | Will | 70000 | 1 |\\n+----+-------+--------+--------------+\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"The \\",(0,n.jsx)(e.code,{children:\\"Department\\"}),\\" table holds all departments of the company.\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----+----------+\\n| Id | Name |\\n+----+----------+\\n| 1 | IT |\\n| 2 | Sales |\\n+----+----------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write a SQL query to find employees who earn the top three salaries in each of the department. For the above tables, your SQL query should return the following rows (order of rows does not matter).\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+------------+----------+--------+\\n| Department | Employee | Salary |\\n+------------+----------+--------+\\n| IT | Max | 90000 |\\n| IT | Randy | 85000 |\\n| IT | Joe | 85000 |\\n| IT | Will | 70000 |\\n| Sales | Henry | 80000 |\\n| Sales | Sam | 60000 |\\n+------------+----------+--------+\\n\`})}),(0,n.jsxs)(e.p,{children:\[(0,n.jsx)(e.strong,{children:(0,n.jsx)(e.em,{children:\\"Explanation:\\"})}),(0,n.jsx)(e.br,{}),\\"In IT department, Max earns the highest salary, both Randy and Joe earn the second highest salary, and Will earns the third highest salary. There are only two employees in the Sales department, Henry earns the highest salary while Sam earns the second highest salary.\\"\]}),(0,n.jsxs)(e.h3,{id:\\"solution-9\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-9\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`WITH department\_ranking AS (\\nSELECT Name AS Employee, Salary ,DepartmentId\\n ,DENSE\_RANK() OVER (PARTITION BY DepartmentId ORDER BY Salary DESC) AS rnk\\nFROM Employee\\n)\\n\\nSELECT d.Name AS Department, r.Employee, r.Salary\\nFROM department\_ranking AS r\\nJOIN Department AS d\\nON r.DepartmentId = d.Id\\nWHERE r.rnk \\u003c= 3\\nORDER BY d.Name ASC, r.Salary DESC;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"196-delete-duplicate-emails--easy--leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#196-delete-duplicate-emails--easy--leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"196. Delete Duplicate Emails | Easy | \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/delete-duplicate-emails/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Write a SQL query to delete all duplicate email entries in a table named \\",(0,n.jsx)(e.code,{children:\\"Person\\"}),\\", keeping only unique emails based on its smallest Id.\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----+------------------+\\n| Id | Email |\\n+----+------------------+\\n| 1 | john@example.com |\\n| 2 | bob@example.com |\\n| 3 | john@example.com |\\n+----+------------------+\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Id is the primary key column for this table. For example, after running your query, the above \\",(0,n.jsx)(e.code,{children:\\"Person\\"}),\\" table should have the following rows:\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----+------------------+\\n| Id | Email |\\n+----+------------------+\\n| 1 | john@example.com |\\n| 2 | bob@example.com |\\n+----+------------------+\\n\`})}),(0,n.jsxs)(e.p,{children:\[(0,n.jsx)(e.strong,{children:\\"Note:\\"}),(0,n.jsx)(e.br,{}),\\"Your output is the whole \\",(0,n.jsx)(e.code,{children:\\"Person\\"}),\\" table after executing your sql. Use \\",(0,n.jsx)(e.code,{children:\\"delete\\"}),\\" statement.\\"\]}),(0,n.jsxs)(e.h3,{id:\\"solution-10\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-10\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`DELETE p2\\nFROM Person p1\\nJOIN Person p2\\nON p1.Email = p2.Email\\nAND p1.id \\u003c p2.id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"197-rising-temperature--easy--leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#197-rising-temperature--easy--leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"197. Rising Temperature | Easy | \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/rising-temperature/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Weather\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| id | int |\\n| recordDate | date |\\n| temperature | int |\\n+---------------+---------+\\n\\nid is the primary key for this table.\\nThis table contains information about the temperature in a certain day.\\n\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to find all dates' \\",(0,n.jsx)(e.code,{children:\\"id\\"}),\\" with higher temperature compared to its previous dates (yesterday).\\"\]}),(0,n.jsx)(e.p,{children:\\"Return the result table in any order.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`\\nWeather\\n+----+------------+-------------+\\n| id | recordDate | Temperature |\\n+----+------------+-------------+\\n| 1 | 2015-01-01 | 10 |\\n| 2 | 2015-01-02 | 25 |\\n| 3 | 2015-01-03 | 20 |\\n| 4 | 2015-01-04 | 30 |\\n+----+------------+-------------+\\n\\nResult table:\\n+----+\\n| id |\\n+----+\\n| 2 |\\n| 4 |\\n+----+\\n\\nIn 2015-01-02, temperature was higher than the previous day (10 -\\u003e 25).\\nIn 2015-01-04, temperature was higher than the previous day (20 -\\u003e 30).\\n\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-11\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-11\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution- 1:\\nSELECT t.Id\\nFROM Weather AS t, Weather AS y\\nWHERE DATEDIFF(t.RecordDate, y.RecordDate) = 1\\nAND t.Temperature \\u003e y.Temperature;\\n\\n#Solution- 2:\\nSELECT t.Id\\nFROM Weather t\\nJOIN Weather y\\nON DATEDIFF(t.recordDate, y.recordDate) = 1 AND\\nt.temperature \\u003e y.temperature;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"262-trips-and-users--hard--leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#262-trips-and-users--hard--leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"262. Trips and Users | Hard | \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/trips-and-users/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Trips\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+----------+\\n| Column Name | Type |\\n+-------------+----------+\\n| Id | int |\\n| Client\_Id | int |\\n| Driver\_Id | int |\\n| City\_Id | int |\\n| Status | enum |\\n| Request\_at | date |\\n+-------------+----------+\\nId is the primary key for this table.\\nThe table holds all taxi trips. Each trip has a unique Id, while Client\_Id and Driver\_Id are foreign keys to the Users\_Id at the Users table.\\nStatus is an ENUM type of (\\\\u2018completed\\\\u2019, \\\\u2018cancelled\_by\_driver\\\\u2019, \\\\u2018cancelled\_by\_client\\\\u2019).\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Users\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+----------+\\n| Column Name | Type |\\n+-------------+----------+\\n| Users\_Id | int |\\n| Banned | enum |\\n| Role | enum |\\n+-------------+----------+\\nUsers\_Id is the primary key for this table.\\nThe table holds all users. Each user has a unique Users\_Id, and Role is an ENUM type of (\\\\u2018client\\\\u2019, \\\\u2018driver\\\\u2019, \\\\u2018partner\\\\u2019).\\nStatus is an ENUM type of (\\\\u2018Yes\\\\u2019, \\\\u2018No\\\\u2019).\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Write a SQL query to find the cancellation rate of requests with unbanned users (both client and driver must not be banned) each day between \\",(0,n.jsx)(e.code,{children:'\\"2013-10-01\\"'}),\\" and \\",(0,n.jsx)(e.code,{children:'\\"2013-10-03\\"'}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"The cancellation rate is computed by dividing the number of canceled (by client or driver) requests with unbanned users by the total number of requests with unbanned users on that day.\\"}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table in any order. Round \\",(0,n.jsx)(e.code,{children:\\"Cancellation Rate\\"}),\\" to two decimal points.\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Trips table:\\n+----+-----------+-----------+---------+---------------------+------------+\\n| Id | Client\_Id | Driver\_Id | City\_Id | Status | Request\_at |\\n+----+-----------+-----------+---------+---------------------+------------+\\n| 1 | 1 | 10 | 1 | completed | 2013-10-01 |\\n| 2 | 2 | 11 | 1 | cancelled\_by\_driver | 2013-10-01 |\\n| 3 | 3 | 12 | 6 | completed | 2013-10-01 |\\n| 4 | 4 | 13 | 6 | cancelled\_by\_client | 2013-10-01 |\\n| 5 | 1 | 10 | 1 | completed | 2013-10-02 |\\n| 6 | 2 | 11 | 6 | completed | 2013-10-02 |\\n| 7 | 3 | 12 | 6 | completed | 2013-10-02 |\\n| 8 | 2 | 12 | 12 | completed | 2013-10-03 |\\n| 9 | 3 | 10 | 12 | completed | 2013-10-03 |\\n| 10 | 4 | 13 | 12 | cancelled\_by\_driver | 2013-10-03 |\\n+----+-----------+-----------+---------+---------------------+------------+\\n\\nUsers table:\\n+----------+--------+--------+\\n| Users\_Id | Banned | Role |\\n+----------+--------+--------+\\n| 1 | No | client |\\n| 2 | Yes | client |\\n| 3 | No | client |\\n| 4 | No | client |\\n| 10 | No | driver |\\n| 11 | No | driver |\\n| 12 | No | driver |\\n| 13 | No | driver |\\n+----------+--------+--------+\\n\\nResult table:\\n+------------+-------------------+\\n| Day | Cancellation Rate |\\n+------------+-------------------+\\n| 2013-10-01 | 0.33 |\\n| 2013-10-02 | 0.00 |\\n| 2013-10-03 | 0.50 |\\n+------------+-------------------+\\n\\nOn 2013-10-01:\\n\\n- There were 4 requests in total, 2 of which were canceled.\\n- However, the request with Id=2 was made by a banned client (User\_Id=2), so it is ignored in the calculation.\\n- Hence there are 3 unbanned requests in total, 1 of which was canceled.\\n- The Cancellation Rate is (1 / 3) = 0.33\\n On 2013-10-02:\\n- There were 3 requests in total, 0 of which were canceled.\\n- The request with Id=6 was made by a banned client, so it is ignored.\\n- Hence there are 2 unbanned requests in total, 0 of which were canceled.\\n- The Cancellation Rate is (0 / 2) = 0.00\\n On 2013-10-03:\\n- There were 3 requests in total, 1 of which was canceled.\\n- The request with Id=8 was made by a banned client, so it is ignored.\\n- Hence there are 2 unbanned request in total, 1 of which were canceled.\\n- The Cancellation Rate is (1 / 2) = 0.50\\n\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-12\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-12\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT Request\_at AS Day,\\nROUND(SUM(IF(Status\\u003c\\u003e\\"completed\\", 1, 0))/COUNT(Status),2) AS \\"Cancellation Rate\\"\\nFROM Trips\\nWHERE Request\_at BETWEEN \\"2013-10-01\\" AND \\"2013-10-03\\"\\nAND Client\_Id NOT IN (SELECT Users\_Id FROM Users WHERE Banned = 'Yes')\\nAND Driver\_Id NOT IN (SELECT Users\_Id FROM Users WHERE Banned = 'Yes')\\nGROUP BY Request\_at;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"511-game-play-analysis-i--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#511-game-play-analysis-i--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"511. Game Play Analysis I | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/game-play-analysis-i/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Activity\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+---------+\\n| Column Name | Type |\\n+--------------+---------+\\n| player\_id | int |\\n| device\_id | int |\\n| event\_date | date |\\n| games\_played | int |\\n+--------------+---------+\\n(player\_id, event\_date) is the primary key of this table.\\nThis table shows the activity of players of some game.\\nEach row is a record of a player who logged in and played a number of games (possibly 0) before logging out on some day using some device.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query that reports the \\",(0,n.jsx)(e.strong,{children:\\"first login date\\"}),\\" for each player.\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Activity table:\\n+-----------+-----------+------------+--------------+\\n| player\_id | device\_id | event\_date | games\_played |\\n+-----------+-----------+------------+--------------+\\n| 1 | 2 | 2016-03-01 | 5 |\\n| 1 | 2 | 2016-05-02 | 6 |\\n| 2 | 3 | 2017-06-25 | 1 |\\n| 3 | 1 | 2016-03-02 | 0 |\\n| 3 | 4 | 2018-07-03 | 5 |\\n+-----------+-----------+------------+--------------+\\n\\nResult table:\\n+-----------+-------------+\\n| player\_id | first\_login |\\n+-----------+-------------+\\n| 1 | 2016-03-01 |\\n| 2 | 2017-06-25 |\\n| 3 | 2016-03-02 |\\n+-----------+-------------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-13\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-13\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT player\_id, MIN(event\_date) as first\_login\\nFROM Activity\\nGROUP BY player\_id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"512-game-play-analysis-ii--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#512-game-play-analysis-ii--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"512. Game Play Analysis II | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/game-play-analysis-ii/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Activity\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+---------+\\n| Column Name | Type |\\n+--------------+---------+\\n| player\_id | int |\\n| device\_id | int |\\n| event\_date | date |\\n| games\_played | int |\\n+--------------+---------+\\n(player\_id, event\_date) is the primary key of this table.\\nThis table shows the activity of players of some game.\\nEach row is a record of a player who logged in and played a number of games (possibly 0) before logging out on some day using some device.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write a SQL query that reports the device that is first logged in for each player.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Activity table:\\n+-----------+-----------+------------+--------------+\\n| player\_id | device\_id | event\_date | games\_played |\\n+-----------+-----------+------------+--------------+\\n| 1 | 2 | 2016-03-01 | 5 |\\n| 1 | 2 | 2016-05-02 | 6 |\\n| 2 | 3 | 2017-06-25 | 1 |\\n| 3 | 1 | 2016-03-02 | 0 |\\n| 3 | 4 | 2018-07-03 | 5 |\\n+-----------+-----------+------------+--------------+\\n\\nResult table:\\n+-----------+-----------+\\n| player\_id | device\_id |\\n+-----------+-----------+\\n| 1 | 2 |\\n| 2 | 3 |\\n| 3 | 1 |\\n+-----------+-----------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-14\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-14\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution- 1:\\nSELECT DISTINCT player\_id, device\_id\\nFROM Activity\\nWHERE (player\_id, event\_date) in (\\n SELECT player\_id, min(event\_date)\\n FROM Activity\\n GROUP BY player\_id)\\n\\n#Solution- 2:\\nSELECT a.player\_id, b.device\_id\\nFROM\\n(SELECT player\_id, MIN(event\_date) AS event\_date FROM Activity\\nGROUP BY player\_id) a\\nJOIN Activity b\\nON a.player\_id = b.player\_id AND a.event\_date = b.event\_date;\\n\\n#Solution- 3:\\nSELECT player\_id, device\_id\\nFROM\\n(SELECT player\_id, device\_id, event\_date,\\nROW\_NUMBER() OVER (PARTITION BY player\_id ORDER BY event\_date) AS r\\nFROM Activity) lookup\\nWHERE r = 1;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"534-game-play-analysis-iii--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#534-game-play-analysis-iii--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"534. Game Play Analysis III | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/game-play-analysis-iii/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Activity\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+---------+\\n| Column Name | Type |\\n+--------------+---------+\\n| player\_id | int |\\n| device\_id | int |\\n| event\_date | date |\\n| games\_played | int |\\n+--------------+---------+\\n(player\_id, event\_date) is the primary key of this table.\\nThis table shows the activity of players of some game.\\nEach row is a record of a player who logged in and played a number of games (possibly 0) before logging out on some day using some device.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query that reports for each player and date, how many games played so far by the player. That is, the total number of games played by the player until that date. Check the example for clarity.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Activity table:\\n+-----------+-----------+------------+--------------+\\n| player\_id | device\_id | event\_date | games\_played |\\n+-----------+-----------+------------+--------------+\\n| 1 | 2 | 2016-03-01 | 5 |\\n| 1 | 2 | 2016-05-02 | 6 |\\n| 1 | 3 | 2017-06-25 | 1 |\\n| 3 | 1 | 2016-03-02 | 0 |\\n| 3 | 4 | 2018-07-03 | 5 |\\n+-----------+-----------+------------+--------------+\\n\\nResult table:\\n+-----------+------------+---------------------+\\n| player\_id | event\_date | games\_played\_so\_far |\\n+-----------+------------+---------------------+\\n| 1 | 2016-03-01 | 5 |\\n| 1 | 2016-05-02 | 11 |\\n| 1 | 2017-06-25 | 12 |\\n| 3 | 2016-03-02 | 0 |\\n| 3 | 2018-07-03 | 5 |\\n+-----------+------------+---------------------+\\nFor the player with id 1, 5 + 6 = 11 games played by 2016-05-02, and 5 + 6 + 1 = 12 games played by 2017-06-25.\\nFor the player with id 3, 0 + 5 = 5 games played by 2018-07-03.\\nNote that for each player we only care about the days when the player logged in.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-15\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-15\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution- 1:\\nSELECT t1.player\_id, t1.event\_date, SUM(t2.games\_played) as games\_played\_so\_far\\nFROM Activity t1\\nJOIN Activity t2\\nON t1.player\_id = t2.player\_id\\nWHERE t1.event\_date \\u003e= t2.event\_date\\nGROUP BY t1.player\_id, t1.event\_date;\\n\\n#Solution- 2:\\nSELECT player\_id, event\_date,\\nSUM(games\_played) OVER (PARTITION BY player\_id ORDER BY event\_date) AS games\_played\_so\_far\\nFROM Activity;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"550-game-play-analysis-iv--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#550-game-play-analysis-iv--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"550. Game Play Analysis IV | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/game-play-analysis-iv/\\",children:\\"LeetCode\\"})\]}),(0,n.jsx)(e.p,{children:\\"Table: Activity\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+---------+\\n| Column Name | Type |\\n+--------------+---------+\\n| player\_id | int |\\n| device\_id | int |\\n| event\_date | date |\\n| games\_played | int |\\n+--------------+---------+\\n(player\_id, event\_date) is the primary key of this table.\\nThis table shows the activity of players of some game.\\nEach row is a record of a player who logged in and played a number of games (possibly 0) before logging out on some day using some device.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query that reports the fraction of players that logged in again on the day after the day they first logged in, rounded to 2 decimal places. In other words, you need to count the number of players that logged in for at least two consecutive days starting from their first login date, then divide that number by the total number of players.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Activity table:\\n+-----------+-----------+------------+--------------+\\n| player\_id | device\_id | event\_date | games\_played |\\n+-----------+-----------+------------+--------------+\\n| 1 | 2 | 2016-03-01 | 5 |\\n| 1 | 2 | 2016-03-02 | 6 |\\n| 2 | 3 | 2017-06-25 | 1 |\\n| 3 | 1 | 2016-03-02 | 0 |\\n| 3 | 4 | 2018-07-03 | 5 |\\n+-----------+-----------+------------+--------------+\\n\\nResult table:\\n+-----------+\\n| fraction |\\n+-----------+\\n| 0.33 |\\n+-----------+\\nOnly the player with id 1 logged back in after the first day he had logged in so the answer is 1/3 = 0.33\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-16\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-16\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution- 1:\\nSELECT ROUND(sum(CASE WHEN t1.event\_date = t2.first\_event+1 THEN 1 ELSE 0 END)/COUNT(DISTINCT t1.player\_id), 2) AS fraction\\nFROM Activity t1\\nJOIN\\n (SELECT player\_id, MIN(event\_date) AS first\_event\\n FROM Activity\\n GROUP BY player\_id) t2\\n ON t1.player\_id = t2.player\_id;\\n\\n#Solution- 2:\\nSELECT ROUND(COUNT(DISTINCT b.player\_id)/COUNT(DISTINCT a.player\_id),2) AS fraction\\nFROM\\n (SELECT player\_id, MIN(event\_date) AS event\_date FROM Activity\\n GROUP BY player\_id) a\\n LEFT JOIN Activity b\\n ON a.player\_id = b.player\_id AND a.event\_date+1 = b.event\_date;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"569-median-employee-salary--hard---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#569-median-employee-salary--hard---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"569. Median Employee Salary | Hard | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/median-employee-salary/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"The \\",(0,n.jsx)(e.code,{children:\\"Employee\\"}),\\" table holds all employees. The employee table has three columns: Employee Id, Company Name, and Salary.\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-----+------------+--------+\\n|Id | Company | Salary |\\n+-----+------------+--------+\\n|1 | A | 2341 |\\n|2 | A | 341 |\\n|3 | A | 15 |\\n|4 | A | 15314 |\\n|5 | A | 451 |\\n|6 | A | 513 |\\n|7 | B | 15 |\\n|8 | B | 13 |\\n|9 | B | 1154 |\\n|10 | B | 1345 |\\n|11 | B | 1221 |\\n|12 | B | 234 |\\n|13 | C | 2345 |\\n|14 | C | 2645 |\\n|15 | C | 2645 |\\n|16 | C | 2652 |\\n|17 | C | 65 |\\n+-----+------------+--------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write a SQL query to find the median salary of each company. Bonus points if you can solve it without using any built-in SQL functions.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-----+------------+--------+\\n|Id | Company | Salary |\\n+-----+------------+--------+\\n|5 | A | 451 |\\n|6 | A | 513 |\\n|12 | B | 234 |\\n|9 | B | 1154 |\\n|14 | C | 2645 |\\n+-----+------------+--------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-17\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-17\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT t1.Id AS Id, t1.Company, t1.Salary\\nFROM Employee AS t1 JOIN Employee AS t2\\nON t1.Company = t2.Company\\nGROUP BY t1.Id\\nHAVING abs(sum(CASE WHEN t2.Salary\\u003ct1.Salary THEN 1\\n WHEN t2.Salary\\u003et1.Salary THEN -1\\n WHEN t2.Salary=t1.Salary AND t2.Id\\u003ct1.Id THEN 1\\n WHEN t2.Salary=t1.Salary AND t2.Id\\u003et1.Id THEN -1\\n ELSE 0 END)) \\u003c= 1\\nORDER BY t1.Company, t1.Salary, t1.Id\\n\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"570-managers-with-at-least-5-direct-reports--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#570-managers-with-at-least-5-direct-reports--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"570. Managers with at Least 5 Direct Reports | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/managers-with-at-least-5-direct-reports/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"The \\",(0,n.jsx)(e.code,{children:\\"Employee\\"}),\\" table holds all employees including their managers. Every employee has an Id, and there is also a column for the manager Id.\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+------+----------+-----------+----------+\\n|Id |Name \\t |Department |ManagerId |\\n+------+----------+-----------+----------+\\n|101 |John \\t |A \\t |null |\\n|102 |Dan \\t |A \\t |101 |\\n|103 |James \\t |A \\t |101 |\\n|104 |Amy \\t |A \\t |101 |\\n|105 |Anne \\t |A \\t |101 |\\n|106 |Ron \\t |B \\t |101 |\\n+------+----------+-----------+----------+\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Given the \\",(0,n.jsx)(e.code,{children:\\"Employee\\"}),\\" table, write a SQL query that finds out managers with at least 5 direct report. For the above table, your SQL query should return:\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------+\\n| Name |\\n+-------+\\n| John |\\n+-------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"Note: No one would report to himself.\\"}),(0,n.jsxs)(e.h3,{id:\\"solution-18\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-18\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT Name\\nFROM Employee\\nWHERE id IN\\n (SELECT ManagerId\\n FROM Employee\\n GROUP BY ManagerId\\n HAVING COUNT(DISTINCT Id) \\u003e= 5)\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"571-find-median-given-frequency-of-numbers---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#571-find-median-given-frequency-of-numbers---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"571. Find Median Given Frequency of Numbers | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/find-median-given-frequency-of-numbers/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"The \\",(0,n.jsx)(e.code,{children:\\"Numbers\\"}),\\" table keeps the value of number and its frequency.\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----------+-------------+\\n| Number | Frequency |\\n+----------+-------------|\\n| 0 | 7 |\\n| 1 | 1 |\\n| 2 | 3 |\\n| 3 | 1 |\\n+----------+-------------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"In this table, the numbers are 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 3, so the median is (0 + 0) / 2 = 0.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------+\\n| median |\\n+--------|\\n| 0.0000 |\\n+--------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write a query to find the median of all numbers and name the result as median.\\"}),(0,n.jsxs)(e.h3,{id:\\"solution-19\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-19\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT avg(t3.Number) as median\\nFROM Numbers as t3\\nJOIN\\n (SELECT t1.Number,\\n abs(SUM(CASE WHEN t1.Number\\u003et2.Number THEN t2.Frequency ELSE 0 END) -\\n SUM(CASE WHEN t1.Number\\u003ct2.Number THEN t2.Frequency ELSE 0 END)) AS count\_diff\\n FROM numbers AS t1, numbers AS t2\\n GROUP BY t1.Number) AS t4\\nON t3.Number = t4.Number\\nWHERE t3.Frequency\\u003e=t4.count\_diff\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"574-winning-candidate--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#574-winning-candidate--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"574. Winning Candidate | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/winning-candidate/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Candidate\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-----+---------+\\n| id | Name |\\n+-----+---------+\\n| 1 | A |\\n| 2 | B |\\n| 3 | C |\\n| 4 | D |\\n| 5 | E |\\n+-----+---------+\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Vote\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-----+--------------+\\n| id | CandidateId |\\n+-----+--------------+\\n| 1 | 2 |\\n| 2 | 4 |\\n| 3 | 3 |\\n| 4 | 2 |\\n| 5 | 5 |\\n+-----+--------------+\\n\`})}),(0,n.jsxs)(e.p,{children:\[(0,n.jsx)(e.code,{children:\\"id\\"}),\\" is the auto-increment primary key, \\",(0,n.jsx)(e.code,{children:\\"CandidateId\\"}),\\" is the id appeared in Candidate table. Write a sql to find the name of the winning candidate, the above example will return the winner B.\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+------+\\n| Name |\\n+------+\\n| B |\\n+------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"Notes: You may assume there is no tie, in other words there will be at most one winning candidate.\\"}),(0,n.jsxs)(e.h3,{id:\\"solution-20\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-20\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT Name\\nFROM Candidate\\nWHERE id = (SELECT CandidateId\\n FROM Vote\\n GROUP BY CandidateId\\n ORDER BY COUNT(1) desc\\n LIMIT 1)\\n\\n## Assumption: if we have two candidates with the same votes, we choose the one who get the first vote\\n# SELECT Name\\n# FROM Candidate JOIN\\n# (SELECT CandidateId\\n# FROM Vote\\n# GROUP BY CandidateId\\n# ORDER BY count(1) DESC\\n# LIMIT 1) AS t\\n# ON Candidate.id = t.CandidateId\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"577-employee-bonus--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#577-employee-bonus--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"577. Employee Bonus | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/employee-bonus/https://leetcode.com/problems/employee-bonus/\\",children:\\"LeetCode\\"})\]}),(0,n.jsx)(e.p,{children:\\"Select all employee\\\\u2019s name and bonus whose bonus is \\u003c 1000.\\"}),(0,n.jsx)(e.p,{children:\\"Table:Employee\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------+--------+-----------+--------+\\n| empId | name | supervisor| salary |\\n+-------+--------+-----------+--------+\\n| 1 | John | 3 | 1000 |\\n| 2 | Dan | 3 | 2000 |\\n| 3 | Brad | null | 4000 |\\n| 4 | Thomas | 3 | 4000 |\\n+-------+--------+-----------+--------+\\nempId is the primary key column for this table.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Table: Bonus\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------+-------+\\n| empId | bonus |\\n+-------+-------+\\n| 2 | 500 |\\n| 4 | 2000 |\\n+-------+-------+\\nempId is the primary key column for this table.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Example ouput:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------+-------+\\n| name | bonus |\\n+-------+-------+\\n| John | null |\\n| Dan | 500 |\\n| Brad | null |\\n+-------+-------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-21\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-21\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT name, bonus\\nFROM Employee LEFT JOIN Bonus\\nON Employee.empId = Bonus.empId\\nWHERE bonus\\u003c1000 OR bonus IS NULL;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"578-get-highest-answer-rate-question--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#578-get-highest-answer-rate-question--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"578. Get Highest Answer Rate Question | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/get-highest-answer-rate-question/\\",children:\\"LeetCode\\"})\]}),(0,n.jsx)(e.p,{children:\\"Get the highest answer rate question from a table survey\_log with these columns: uid, action, question\_id, answer\_id, q\_num, timestamp.\\"}),(0,n.jsx)(e.p,{children:\\"uid means user id; action has these kind of values: \\\\u201Cshow\\\\u201D, \\\\u201Canswer\\\\u201D, \\\\u201Cskip\\\\u201D; answer\_id is not null when action column is \\\\u201Canswer\\\\u201D, while is null for \\\\u201Cshow\\\\u201D and \\\\u201Cskip\\\\u201D; q\_num is the numeral order of the question in current session.\\"}),(0,n.jsx)(e.p,{children:\\"Write a sql query to identify the question which has the highest answer rate.\\"}),(0,n.jsx)(e.p,{children:\\"Example: Input:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+------+-----------+--------------+------------+-----------+------------+\\n| uid | action | question\_id | answer\_id | q\_num | timestamp |\\n+------+-----------+--------------+------------+-----------+------------+\\n| 5 | show | 285 | null | 1 | 123 |\\n| 5 | answer | 285 | 124124 | 1 | 124 |\\n| 5 | show | 369 | null | 2 | 125 |\\n| 5 | skip | 369 | null | 2 | 126 |\\n+------+-----------+--------------+------------+-----------+------------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"Output:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+\\n| survey\_log |\\n+-------------+\\n| 285 |\\n+-------------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"Explanation: question 285 has answer rate 1/1, while question 369 has 0/1 answer rate, so output 285.\\"}),(0,n.jsx)(e.p,{children:\\"Note: The highest answer rate meaning is: answer number\\\\u2019s ratio in show number in the same question.\\"}),(0,n.jsxs)(e.h3,{id:\\"solution-22\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-22\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution- 1::\\nSELECT question\_id AS survey\_log FROM\\n(SELECT question\_id,\\n SUM(IF(action='show', 1, 0)) AS num\_show,\\n SUM(IF(action='answer', 1, 0)) AS num\_answer\\n FROM survey\_log GROUP BY question\_id) AS t\\nORDER BY (num\_answer/num\_show) DESC LIMIT 1;\\n\\n#Solution- 2:\\nSELECT question\_id AS survey\_log\\nFROM (SELECT question\_id,\\n sum(CASE WHEN action='show' THEN 1 ELSE 0 END) AS show\_count,\\n sum(CASE WHEN action='answer' THEN 1 ELSE 0 END) AS answer\_count\\n FROM survey\_log\\n GROUP BY question\_id) AS t\\nORDER BY answer\_count/show\_count DESC LIMIT 1;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"579-find-cumulative-salary-of-an-employee--hard---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#579-find-cumulative-salary-of-an-employee--hard---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"579. Find Cumulative Salary of an Employee | Hard | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/find-cumulative-salary-of-an-employee/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"The \\",(0,n.jsx)(e.code,{children:\\"Employee\\"}),\\" table holds the salary information in a year.\\"\]}),(0,n.jsx)(e.p,{children:\\"Write a SQL to get the cumulative sum of an employee\\\\u2019s salary over a period of 3 months but exclude the most recent month.\\"}),(0,n.jsx)(e.p,{children:\\"The result should be displayed by \\\\u2018Id\\\\u2019 ascending, and then by \\\\u2018Month\\\\u2019 descending.\\"}),(0,n.jsx)(e.p,{children:\\"Example Input\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| Id | Month | Salary |\\n|----|-------|--------|\\n| 1 | 1 | 20 |\\n| 2 | 1 | 20 |\\n| 1 | 2 | 30 |\\n| 2 | 2 | 30 |\\n| 3 | 2 | 40 |\\n| 1 | 3 | 40 |\\n| 3 | 3 | 60 |\\n| 1 | 4 | 60 |\\n| 3 | 4 | 70 |\\n\`})}),(0,n.jsx)(e.p,{children:\\"Output\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| Id | Month | Salary |\\n|----|-------|--------|\\n| 1 | 3 | 90 |\\n| 1 | 2 | 50 |\\n| 1 | 1 | 20 |\\n| 2 | 1 | 20 |\\n| 3 | 3 | 100 |\\n| 3 | 2 | 40 |\\n\`})}),(0,n.jsx)(e.p,{children:\\"Explanation Employee \\\\u20181\\\\u2019 has 3 salary records for the following 3 months except the most recent month \\\\u20184\\\\u2019: salary 40 for month \\\\u20183\\\\u2019, 30 for month \\\\u20182\\\\u2019 and 20 for month \\\\u20181\\\\u2019 So the cumulative sum of salary of this employee over 3 months is 90(40+30+20), 50(30+20) and 20 respectively.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| Id | Month | Salary |\\n|----|-------|--------|\\n| 1 | 3 | 90 |\\n| 1 | 2 | 50 |\\n| 1 | 1 | 20 |\\n\`})}),(0,n.jsx)(e.p,{children:\\"Employee \\\\u20182\\\\u2019 only has one salary record (month \\\\u20181\\\\u2019) except its most recent month \\\\u20182\\\\u2019.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| Id | Month | Salary |\\n|----|-------|--------|\\n| 2 | 1 | 20 |\\n\`})}),(0,n.jsx)(e.p,{children:\\"Employ \\\\u20183\\\\u2019 has two salary records except its most recent pay month \\\\u20184\\\\u2019: month \\\\u20183\\\\u2019 with 60 and month \\\\u20182\\\\u2019 with 40. So the cumulative salary is as following.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| Id | Month | Salary |\\n|----|-------|--------|\\n| 3 | 3 | 100 |\\n| 3 | 2 | 40 |\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-23\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-23\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT\\n a.id,\\n a.month,\\n SUM(b.salary) Salary\\nFROM\\n Employee a JOIN Employee b ON\\n a.id = b.id AND\\n a.month - b.month \\u003e= 0 AND\\n a.month - b.month \\u003c 3\\nGROUP BY\\n a.id, a.month\\nHAVING\\n (a.id, a.month) NOT IN (SELECT id, MAX(month) FROM Employee GROUP BY id)\\nORDER BY\\n a.id, a.month DESC\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"580-count-student-number-in-departments--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#580-count-student-number-in-departments--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"580. Count Student Number in Departments | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/count-student-number-in-departments/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"A university uses 2 data tables, \\",(0,n.jsx)(e.code,{children:\\"student\\"}),\\" and \\",(0,n.jsx)(e.code,{children:\\"department\\"}),\\", to store data about its students and the departments associated with each major.\\"\]}),(0,n.jsx)(e.p,{children:\\"Write a query to print the respective department name and number of students majoring in each department for all departments in the department table (even ones with no current students).\\"}),(0,n.jsx)(e.p,{children:\\"Sort your results by descending number of students; if two or more departments have the same number of students, then sort those departments alphabetically by department name.\\"}),(0,n.jsxs)(e.p,{children:\[\\"The \\",(0,n.jsx)(e.code,{children:\\"student\\"}),\\" is described as follow:\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| Column Name | Type |\\n|--------------|-----------|\\n| student\_id | Integer |\\n| student\_name | String |\\n| gender | Character |\\n| dept\_id | Integer |\\n\`})}),(0,n.jsx)(e.p,{children:\\"where student\_id is the student\\\\u2019s ID number, student\_name is the student\\\\u2019s name, gender is their gender, and dept\_id is the department ID associated with their declared major.\\"}),(0,n.jsx)(e.p,{children:\\"And the department table is described as below:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| Column Name | Type |\\n|-------------|---------|\\n| dept\_id | Integer |\\n| dept\_name | String |\\n\`})}),(0,n.jsx)(e.p,{children:\\"where dept\_id is the department\\\\u2019s ID number and dept\_name is the department name.\\"}),(0,n.jsxs)(e.p,{children:\[\\"Here is an example input: \\",(0,n.jsx)(e.code,{children:\\"student\\"}),\\" table:\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| student\_id | student\_name | gender | dept\_id |\\n|------------|--------------|--------|---------|\\n| 1 | Jack | M | 1 |\\n| 2 | Jane | F | 1 |\\n| 3 | Mark | M | 2 |\\n\`})}),(0,n.jsxs)(e.p,{children:\[(0,n.jsx)(e.code,{children:\\"department\\"}),\\" table:\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| dept\_id | dept\_name |\\n|---------|-------------|\\n| 1 | Engineering |\\n| 2 | Science |\\n| 3 | Law |\\n\`})}),(0,n.jsx)(e.p,{children:\\"The Output should be:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| dept\_name | student\_number |\\n|-------------|----------------|\\n| Engineering | 2 |\\n| Science | 1 |\\n| Law | 0 |\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-24\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-24\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT dept\_name,\\n SUM(CASE WHEN student\_id IS NULL THEN 0 ELSE 1 END) AS student\_number\\nFROM department\\nLEFT JOIN student\\nON department.dept\_id = student.dept\_id\\nGROUP BY department.dept\_id\\nORDER BY student\_number DESC, dept\_name\\n\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"584-find-customer-referee--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#584-find-customer-referee--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"584. Find Customer Referee | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/find-customer-referee/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Given a table \\",(0,n.jsx)(e.code,{children:\\"customer\\"}),\\" holding customers information and the referee.\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+------+------+-----------+\\n| id | name | referee\_id|\\n+------+------+-----------+\\n| 1 | Will | NULL |\\n| 2 | Jane | NULL |\\n| 3 | Alex | 2 |\\n| 4 | Bill | NULL |\\n| 5 | Zack | 1 |\\n| 6 | Mark | 2 |\\n+------+------+-----------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write a query to return the list of customers NOT referred by the person with id \\\\u20182\\\\u2019.\\"}),(0,n.jsx)(e.p,{children:\\"For the sample data above, the result is:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+------+\\n| name |\\n+------+\\n| Will |\\n| Jane |\\n| Bill |\\n| Zack |\\n+------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-25\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-25\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT name\\nFROM customer\\nWHERE referee\_id != '2' OR referee\_id IS NULL;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"585-investments-in-2016--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#585-investments-in-2016--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"585. Investments in 2016 | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/investments-in-2016/\\",children:\\"LeetCode\\"})\]}),(0,n.jsx)(e.p,{children:\\"Write a query to print the sum of all total investment values in 2016 (TIV\_2016), to a scale of 2 decimal places, for all policy holders who meet the following criteria:\\"}),(0,n.jsxs)(e.ol,{children:\[(0,n.jsx)(e.li,{children:\\"Have the same TIV\_2015 value as one or more other policyholders.\\"}),(0,n.jsx)(e.li,{children:\\"Are not located in the same city as any other policyholder (i.e.: the (latitude, longitude) attribute pairs must be unique). Input Format: The insurance table is described as follows:\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| Column Name | Type |\\n|-------------|---------------|\\n| PID | INTEGER(11) |\\n| TIV\_2015 | NUMERIC(15,2) |\\n| TIV\_2016 | NUMERIC(15,2) |\\n| LAT | NUMERIC(5,2) |\\n| LON | NUMERIC(5,2) |\\n\`})}),(0,n.jsx)(e.p,{children:\\"where PID is the policyholder\\\\u2019s policy ID, TIV\_2015 is the total investment value in 2015, TIV\_2016 is the total investment value in 2016, LAT is the latitude of the policy holder\\\\u2019s city, and LON is the longitude of the policy holder\\\\u2019s city.\\"}),(0,n.jsx)(e.p,{children:\\"Sample Input\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| PID | TIV\_2015 | TIV\_2016 | LAT | LON |\\n|-----|----------|----------|-----|-----|\\n| 1 | 10 | 5 | 10 | 10 |\\n| 2 | 20 | 20 | 20 | 20 |\\n| 3 | 10 | 30 | 20 | 20 |\\n| 4 | 10 | 40 | 40 | 40 |\\n\`})}),(0,n.jsx)(e.p,{children:\\"Sample Output\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| TIV\_2016 |\\n|----------|\\n| 45.00 |\\n\`})}),(0,n.jsx)(e.p,{children:\\"Explanation\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`The first record in the table, like the last record, meets both of the two criteria.\\nThe TIV\_2015 value '10' is as the same as the third and forth record, and its location unique.\\n\\nThe second record does not meet any of the two criteria. Its TIV\_2015 is not like any other policyholders.\\n\\nAnd its location is the same with the third record, which makes the third record fail, too.\\n\\nSo, the result is the sum of TIV\_2016 of the first and last record, which is 45.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-26\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-26\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT SUM(TIV\_2016) AS TIV\_2016\\nFROM insurance\\nWHERE CONCAT(LAT, ',', LON)\\n IN (SELECT CONCAT(LAT, ',', LON)\\n FROM insurance\\n GROUP BY LAT, LON\\n HAVING COUNT(1) = 1)\\nAND TIV\_2015 in\\n (SELECT TIV\_2015\\n FROM insurance\\n GROUP BY TIV\_2015\\n HAVING COUNT(1)\\u003e1)\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"586-customer-placing-the-largest-number-of-orders--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#586-customer-placing-the-largest-number-of-orders--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"586. Customer Placing the Largest Number of Orders | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/customer-placing-the-largest-number-of-orders/\\",children:\\"LeetCode\\"})\]}),(0,n.jsx)(e.p,{children:\\"Query the customer\_number from the orders table for the customer who has placed the largest number of orders.\\"}),(0,n.jsx)(e.p,{children:\\"It is guaranteed that exactly one customer will have placed more orders than any other customer.\\"}),(0,n.jsx)(e.p,{children:\\"The orders table is defined as follows:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`\\n| Column | Type |\\n|-------------------|-----------|\\n| order\_number (PK) | int |\\n| customer\_number | int |\\n| order\_date | date |\\n| required\_date | date |\\n| shipped\_date | date |\\n| status | char(15) |\\n| comment | char(200) |\\n\`})}),(0,n.jsx)(e.p,{children:\\"Sample Input\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| order\_number | customer\_number | order\_date | required\_date | shipped\_date | status | comment |\\n|--------------|-----------------|------------|---------------|--------------|--------|---------|\\n| 1 | 1 | 2017-04-09 | 2017-04-13 | 2017-04-12 | Closed | |\\n| 2 | 2 | 2017-04-15 | 2017-04-20 | 2017-04-18 | Closed | |\\n| 3 | 3 | 2017-04-16 | 2017-04-25 | 2017-04-20 | Closed | |\\n| 4 | 3 | 2017-04-18 | 2017-04-28 | 2017-04-25 | Closed | |\\n\`})}),(0,n.jsx)(e.p,{children:\\"Sample Output\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| customer\_number |\\n|-----------------|\\n| 3 |\\n\`})}),(0,n.jsx)(e.p,{children:\\"Explanation\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`The customer with number '3' has two orders, which is greater than either customer '1' or '2' because each of them only has one order.\\nSo the result is customer\_number '3'.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-27\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-27\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`# assume: only one match\\nSELECT customer\_number FROM orders\\nGROUP BY customer\_number\\nORDER BY COUNT(1) DESC\\nLIMIT 1\\n\\n## assume: multiple matches\\n## 1 1\\n## 2 1\\n## 3 1\\n##\\n## 1 1 1 1\\n## 1 1 2 1\\n## 1 1 3 1\\n##\\n## SELECT t1.customer\_number\\n## FROM (SELECT customer\_number, COUNT(1) AS count\\n## FROM orders GROUP BY customer\_number) AS t1,\\n## (SELECT customer\_number, COUNT(1) AS count\\n## FROM orders GROUP BY customer\_number) AS t2\\n## GROUP BY t1.customer\_number\\n## HAVING max(t1.count) = max(t2.count)\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"595-big-countries--easy--leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#595-big-countries--easy--leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"595. Big Countries | Easy | \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/big-countries/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"There is a table \\",(0,n.jsx)(e.code,{children:\\"World\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-----------------+------------+------------+--------------+---------------+\\n| name | continent | area | population | gdp |\\n+-----------------+------------+------------+--------------+---------------+\\n| Afghanistan | Asia | 652230 | 25500100 | 20343000 |\\n| Albania | Europe | 28748 | 2831741 | 12960000 |\\n| Algeria | Africa | 2381741 | 37100000 | 188681000 |\\n| Andorra | Europe | 468 | 78115 | 3712000 |\\n| Angola | Africa | 1246700 | 20609294 | 100990000 |\\n+-----------------+------------+------------+--------------+---------------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"A country is big if it has an area of bigger than 3 million square km or a population of more than 25 million.\\"}),(0,n.jsx)(e.p,{children:\\"Write a SQL solution to output big countries' name, population and area.\\"}),(0,n.jsx)(e.p,{children:\\"For example, according to the above table, we should output:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+-------------+--------------+\\n| name | population | area |\\n+--------------+-------------+--------------+\\n| Afghanistan | 25500100 | 652230 |\\n| Algeria | 37100000 | 2381741 |\\n+--------------+-------------+--------------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-28\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-28\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT name, population, area\\nFROM World\\nWHERE area \\u003e= 3000000 OR population \\u003e 25000000;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"596-classes-more-than-5-students--easy--leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#596-classes-more-than-5-students--easy--leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"596. Classes More Than 5 Students | Easy | \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/classes-more-than-5-students/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"There is a table \\",(0,n.jsx)(e.code,{children:\\"courses\\"}),\\" with columns: \\",(0,n.jsx)(e.strong,{children:\\"student\\"}),\\" and \\",(0,n.jsx)(e.strong,{children:\\"class\\"})\]}),(0,n.jsx)(e.p,{children:\\"Please list out all classes which have more than or equal to 5 students.\\"}),(0,n.jsx)(e.p,{children:\\"For example, the table:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------+------------+\\n| student | class |\\n+---------+------------+\\n| A | Math |\\n| B | English |\\n| C | Math |\\n| D | Biology |\\n| E | Math |\\n| F | Computer |\\n| G | Math |\\n| H | Math |\\n| I | Math |\\n+---------+------------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"Should output:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------+\\n| class |\\n+---------+\\n| Math |\\n+---------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-29\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-29\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT class\\nFROM courses\\nGROUP BY class\\nHAVING count(DISTINCT Student)\\u003e=5;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"597-friend-requests-i-overall-acceptance-rate--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#597-friend-requests-i-overall-acceptance-rate--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"597. Friend Requests I: Overall Acceptance Rate | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/friend-requests-i-overall-acceptance-rate/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"In social network like Facebook or Twitter, people send friend requests and accept others\\\\u2019 requests as well. Now given two tables as below: Table: \\",(0,n.jsx)(e.code,{children:\\"friend\_request\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| sender\_id | send\_to\_id |request\_date|\\n|-----------|------------|------------|\\n| 1 | 2 | 2016\_06-01 |\\n| 1 | 3 | 2016\_06-01 |\\n| 1 | 4 | 2016\_06-01 |\\n| 2 | 3 | 2016\_06-02 |\\n| 3 | 4 | 2016-06-09 |\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"request\_accepted\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| requester\_id | accepter\_id |accept\_date |\\n|--------------|-------------|------------|\\n| 1 | 2 | 2016\_06-03 |\\n| 1 | 3 | 2016-06-08 |\\n| 2 | 3 | 2016-06-08 |\\n| 3 | 4 | 2016-06-09 |\\n| 3 | 4 | 2016-06-10 |\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write a query to find the overall acceptance rate of requests rounded to 2 decimals, which is the number of acceptance divide the number of requests. For the sample data above, your query should return the following result.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`|accept\_rate|\\n|-----------|\\n| 0.80|\\n\`})}),(0,n.jsx)(e.p,{children:\\"Note:\\"}),(0,n.jsx)(e.p,{children:\\"The accepted requests are not necessarily from the table friend\_request. In this case, you just need to simply count the total accepted requests (no matter whether they are in the original requests), and divide it by the number of requests to get the acceptance rate. It is possible that a sender sends multiple requests to the same receiver, and a request could be accepted more than once. In this case, the \\\\u2018duplicated\\\\u2019 requests or acceptances are only counted once. If there is no requests at all, you should return 0.00 as the accept\_rate. Explanation: There are 4 unique accepted requests, and there are 5 requests in total. So the rate is 0.80.\\"}),(0,n.jsx)(e.p,{children:\\"Follow-up:\\"}),(0,n.jsx)(e.p,{children:\\"Can you write a query to return the accept rate but for every month? How about the cumulative accept rate for every day?\\"}),(0,n.jsxs)(e.h3,{id:\\"solution-30\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-30\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT IFNULL((round(accepts/requests, 2)), 0.0) AS accept\_rate\\nFROM\\n (SELECT count(DISTINCT sender\_id, send\_to\_id) AS requests FROM friend\_request) AS t1,\\n (SELECT count(DISTINCT requester\_id, accepter\_id) AS accepts FROM request\_accepted) AS t2\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"601-human-traffic-of-stadium--hard--leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#601-human-traffic-of-stadium--hard--leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"601. Human Traffic of Stadium | Hard | \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/human-traffic-of-stadium/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Stadium\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| id | int |\\n| visit\_date | date |\\n| people | int |\\n+---------------+---------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"visit\_date is the primary key for this table. Each row of this table contains the visit date and visit id to the stadium with the number of people during the visit. No two rows will have the same visit\_date, and as the id increases, the dates increase as well.\\"}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to display the records with three or more rows with \\",(0,n.jsx)(e.strong,{children:\\"consecutive\\"}),\\" \\",(0,n.jsx)(e.code,{children:\\"id\\"}),\\"'s, and the number of people is greater than or equal to 100 for each.\\"\]}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table ordered by \\",(0,n.jsx)(e.code,{children:\\"visit\_date\\"}),\\" in \\",(0,n.jsx)(e.strong,{children:\\"ascending order\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Stadium table:\\n+------+------------+-----------+\\n| id | visit\_date | people |\\n+------+------------+-----------+\\n| 1 | 2017-01-01 | 10 |\\n| 2 | 2017-01-02 | 109 |\\n| 3 | 2017-01-03 | 150 |\\n| 4 | 2017-01-04 | 99 |\\n| 5 | 2017-01-05 | 145 |\\n| 6 | 2017-01-06 | 1455 |\\n| 7 | 2017-01-07 | 199 |\\n| 8 | 2017-01-09 | 188 |\\n+------+------------+-----------+\\n\\nResult table:\\n+------+------------+-----------+\\n| id | visit\_date | people |\\n+------+------------+-----------+\\n| 5 | 2017-01-05 | 145 |\\n| 6 | 2017-01-06 | 1455 |\\n| 7 | 2017-01-07 | 199 |\\n| 8 | 2017-01-09 | 188 |\\n+------+------------+-----------+\\nThe four rows with ids 5, 6, 7, and 8 have consecutive ids and each of them has \\u003e= 100 people attended. Note that row 8 was included even though the visit\_date was not the next day after row 7.\\nThe rows with ids 2 and 3 are not included because we need at least three consecutive ids.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-31\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-31\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT DISTINCT s1.\*\\nFROM Stadium s1 JOIN Stadium s2 JOIN Stadium s3\\nON (s1.id = s2.id-1 AND s1.id = s3.id-2) OR\\n (s1.id = s2.id+1 AND s1.id = s3.id-1) OR\\n (s1.id = s2.id+1 AND s1.id = s3.id+2)\\n WHERE s1.people \\u003e= 100 AND s2.people \\u003e= 100 AND s3.people\\u003e=100\\n ORDER BY visit\_date\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"602-friend-requests-ii-who-has-the-most-friends--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#602-friend-requests-ii-who-has-the-most-friends--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"602. Friend Requests II: Who Has the Most Friends | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/friend-requests-ii-who-has-the-most-friends/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"In social network like Facebook or Twitter, people send friend requests and accept others\\\\u2019 requests as well. Table \\",(0,n.jsx)(e.code,{children:\\"request\_accepted\\"}),\\" holds the data of friend acceptance, while requester\_id and accepter\_id both are the id of a person.\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| requester\_id | accepter\_id | accept\_date|\\n|--------------|-------------|------------|\\n| 1 | 2 | 2016\_06-03 |\\n| 1 | 3 | 2016-06-08 |\\n| 2 | 3 | 2016-06-08 |\\n| 3 | 4 | 2016-06-09 |\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write a query to find the the people who has most friends and the most friends number. For the sample data above, the result is:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| id | num |\\n|----|-----|\\n| 3 | 3 |\\n\`})}),(0,n.jsx)(e.p,{children:\\"Note:\\"}),(0,n.jsx)(e.p,{children:\\"It is guaranteed there is only 1 people having the most friends. The friend request could only been accepted once, which mean there is no multiple records with the same requester\_id and accepter\_id value. Explanation: The person with id \\\\u20183\\\\u2019 is a friend of people \\\\u20181\\\\u2019, \\\\u20182\\\\u2019 and \\\\u20184\\\\u2019, so he has 3 friends in total, which is the most number than any others.\\"}),(0,n.jsx)(e.p,{children:\\"Follow-up: In the real world, multiple people could have the same most number of friends, can you find all these people in this case?\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT t.id, sum(t.num) AS num\\nFROM (\\n (SELECT requester\_id AS id, COUNT(1) AS num\\n FROM request\_accepted\\n GROUP BY requester\_id)\\n union all\\n (SELECT accepter\_id AS id, COUNT(1) AS num\\n FROM request\_accepted\\n GROUP BY accepter\_id)) AS t\\nGROUP BY t.id\\nORDER BY num DESC\\nLIMIT 1;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"603-consecutive-available-seats--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#603-consecutive-available-seats--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"603. Consecutive Available Seats | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/consecutive-available-seats/\\",children:\\"LeetCode\\"})\]}),(0,n.jsx)(e.p,{children:\\"Several friends at a cinema ticket office would like to reserve consecutive available seats. Can you help to query all the consecutive available seats order by the seat\_id using the following cinema table?\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| seat\_id | free |\\n|---------|------|\\n| 1 | 1 |\\n| 2 | 0 |\\n| 3 | 1 |\\n| 4 | 1 |\\n| 5 | 1 |\\n\`})}),(0,n.jsx)(e.p,{children:\\"Your query should return the following result for the sample case above.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| seat\_id |\\n|---------|\\n| 3 |\\n| 4 |\\n| 5 |\\n\`})}),(0,n.jsx)(e.p,{children:\\"Note:\\"}),(0,n.jsx)(e.p,{children:\\"The seat\_id is an auto increment int, and free is bool (\\\\u20181\\\\u2019 means free, and \\\\u20180\\\\u2019 means occupied.). Consecutive available seats are more than 2(inclusive) seats consecutively available.\\"}),(0,n.jsxs)(e.h3,{id:\\"solution-32\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-32\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT DISTINCT t1.seat\_id\\nFROM cinema AS t1 JOIN cinema AS t2\\nON abs(t1.seat\_id-t2.seat\_id)=1\\nWHERE t1.free='1' AND t2.free='1'\\nORDER BY t1.seat\_id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"607sales-person--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#607sales-person--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"607.Sales Person | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/sales-person/\\",children:\\"LeetCode\\"})\]}),(0,n.jsx)(e.p,{children:\\"Description\\"}),(0,n.jsxs)(e.p,{children:\[\\"Given three tables: \\",(0,n.jsx)(e.code,{children:\\"salesperson\\"}),\\", \\",(0,n.jsx)(e.code,{children:\\"company\\"}),\\", \\",(0,n.jsx)(e.code,{children:\\"orders\\"}),\\". Output all the names in the table salesperson, who didn\\\\u2019t have sales to company \\\\u2018RED\\\\u2019.\\"\]}),(0,n.jsx)(e.p,{children:\\"Example Input\\"}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"salesperson\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----------+------+--------+-----------------+-----------+\\n| sales\_id | name | salary | commission\_rate | hire\_date |\\n+----------+------+--------+-----------------+-----------+\\n| 1 | John | 100000 | 6 | 4/1/2006 |\\n| 2 | Amy | 120000 | 5 | 5/1/2010 |\\n| 3 | Mark | 65000 | 12 | 12/25/2008|\\n| 4 | Pam | 25000 | 25 | 1/1/2005 |\\n| 5 | Alex | 50000 | 10 | 2/3/2007 |\\n+----------+------+--------+-----------------+-----------+\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"The table salesperson holds the salesperson information. Every salesperson has a sales\_id and a name. Table: \\",(0,n.jsx)(e.code,{children:\\"company\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------+--------+------------+\\n| com\_id | name | city |\\n+---------+--------+------------+\\n| 1 | RED | Boston |\\n| 2 | ORANGE | New York |\\n| 3 | YELLOW | Boston |\\n| 4 | GREEN | Austin |\\n+---------+--------+------------+\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"The table company holds the company information. Every company has a com\_id and a name. Table: \\",(0,n.jsx)(e.code,{children:\\"orders\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----------+----------+---------+----------+--------+\\n| order\_id | date | com\_id | sales\_id | amount |\\n+----------+----------+---------+----------+--------+\\n| 1 | 1/1/2014 | 3 | 4 | 100000 |\\n| 2 | 2/1/2014 | 4 | 5 | 5000 |\\n| 3 | 3/1/2014 | 1 | 1 | 50000 |\\n| 4 | 4/1/2014 | 1 | 4 | 25000 |\\n+----------+----------+---------+----------+--------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"The table orders holds the sales record information, salesperson and customer company are represented by sales\_id and com\_id. output\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+------+\\n| name |\\n+------+\\n| Amy |\\n| Mark |\\n| Alex |\\n+------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"Explanation\\"}),(0,n.jsx)(e.p,{children:\\"According to order \\\\u20183\\\\u2019 and \\\\u20184\\\\u2019 in table orders, it is easy to tell only salesperson \\\\u2018John\\\\u2019 and \\\\u2018Alex\\\\u2019 have sales to company \\\\u2018RED\\\\u2019, so we need to output all the other names in table salesperson.\\"}),(0,n.jsxs)(e.h3,{id:\\"solution-33\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-33\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT name\\nFROM salesperson\\nWHERE name NOT IN\\n (SELECT DISTINCT salesperson.name\\n FROM salesperson, orders, company\\n WHERE company.name = 'RED'\\n AND salesperson.sales\_id = orders.sales\_id\\n AND orders.com\_id = company.com\_id)\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"608-tree-node--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#608-tree-node--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"608. Tree Node | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/tree-node/\\",children:\\"LeetCode\\"})\]}),(0,n.jsx)(e.p,{children:\\"Given a table tree, id is identifier of the tree node and p\_id is its parent node\\\\u2019s id.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----+------+\\n| id | p\_id |\\n+----+------+\\n| 1 | null |\\n| 2 | 1 |\\n| 3 | 1 |\\n| 4 | 2 |\\n| 5 | 2 |\\n+----+------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"Each node in the tree can be one of three types:\\"}),(0,n.jsx)(e.p,{children:\\"Leaf: if the node is a leaf node. Root: if the node is the root of the tree. Inner: If the node is neither a leaf node nor a root node. Write a query to print the node id and the type of the node. Sort your output by the node id. The result for the above sample is:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----+------+\\n| id | Type |\\n+----+------+\\n| 1 | Root |\\n| 2 | Inner|\\n| 3 | Leaf |\\n| 4 | Leaf |\\n| 5 | Leaf |\\n+----+------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"Explanation\\"}),(0,n.jsx)(e.p,{children:\\"Node \\\\u20181\\\\u2019 is root node, because its parent node is NULL and it has child node \\\\u20182\\\\u2019 and \\\\u20183\\\\u2019. Node \\\\u20182\\\\u2019 is inner node, because it has parent node \\\\u20181\\\\u2019 and child node \\\\u20184\\\\u2019 and \\\\u20185\\\\u2019. Node \\\\u20183\\\\u2019, \\\\u20184\\\\u2019 and \\\\u20185\\\\u2019 is Leaf node, because they have parent node and they don\\\\u2019t have child node. And here is the image of the sample tree as below:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`\\t1\\n / \\\\\\\\\\n 2 3\\n / \\\\\\\\\\n4 5\\n\`})}),(0,n.jsx)(e.p,{children:\\"Note\\"}),(0,n.jsx)(e.p,{children:\\"If there is only one node on the tree, you only need to output its root attributes.\\"}),(0,n.jsxs)(e.h3,{id:\\"solution-34\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-34\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`## Basic Ideas: LEFT JOIN\\n# In tree, each node can only one parent or no parent\\n## | id | p\_id | id (child) |\\n## |----+------+------------|\\n## | 1 | null | 1 |\\n## | 1 | null | 2 |\\n## | 2 | 1 | 4 |\\n## | 2 | 1 | 5 |\\n## | 3 | 1 | null |\\n## | 4 | 2 | null |\\n## | 5 | 2 | null |\\n\\nSELECT t1.id,\\n CASE\\n WHEN ISNULL(t1.p\_id) THEN 'Root'\\n WHEN ISNULL(MAX(t2.id)) THEN 'Leaf'\\n ELSE 'Inner'\\n END AS Type\\nFROM tree AS t1 LEFT JOIN tree AS t2\\nON t1.id = t2.p\_id\\nGROUP BY t1.id, t1.p\_id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"610-triangle-judgement--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#610-triangle-judgement--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"610. Triangle Judgement | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/triangle-judgement/\\",children:\\"LeetCode\\"})\]}),(0,n.jsx)(e.p,{children:\\"A pupil Tim gets homework to identify whether three line segments could possibly form a triangle. However, this assignment is very heavy because there are hundreds of records to calculate. Could you help Tim by writing a query to judge whether these three sides can form a triangle, assuming table triangle holds the length of the three sides x, y and z.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| x | y | z |\\n|----|----|----|\\n| 13 | 15 | 30 |\\n| 10 | 20 | 15 |\\n\`})}),(0,n.jsx)(e.p,{children:\\"For the sample data above, your query should return the follow result:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| x | y | z | triangle |\\n|----|----|----|----------|\\n| 13 | 15 | 30 | No |\\n| 10 | 20 | 15 | Yes |\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-35\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-35\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT x, y, z,\\n CASE\\n WHEN x+y\\u003ez AND y+z\\u003ex AND x+z\\u003ey THEN 'Yes'\\n ELSE 'No'\\n END AS triangle\\nFROM triangle\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"612-shortest-distance-in-a-plane--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#612-shortest-distance-in-a-plane--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"612. Shortest Distance in a Plane | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/shortest-distance-in-a-plane/\\",children:\\"LeetCode\\"})\]}),(0,n.jsx)(e.p,{children:\\"Table point\_2d holds the coordinates (x,y) of some unique points (more than two) in a plane. Write a query to find the shortest distance between these points rounded to 2 decimals.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| x | y |\\n|----|----|\\n| -1 | -1 |\\n| 0 | 0 |\\n| -1 | -2 |\\n\`})}),(0,n.jsx)(e.p,{children:\\"The shortest distance is 1.00 from point (-1,-1) to (-1,2). So the output should be:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| shortest |\\n|----------|\\n| 1.00 |\\n\`})}),(0,n.jsx)(e.p,{children:\\"Note: The longest distance among all the points are less than 10000.\\"}),(0,n.jsxs)(e.h3,{id:\\"solution-36\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-36\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT ROUND(MIN(SQRT((t1.x-t2.x)\*(t1.x-t2.x) + (t1.y-t2.y)\*(t1.y-t2.y))), 2) as shortest\\nFROM point\_2d AS t1, point\_2d AS t2\\nWHERE t1.x!=t2.x OR t1.y!=t2.y\\n\\n# SELECT ROUND(SQRT((t1.x-t2.x)\*(t1.x-t2.x) + (t1.y-t2.y)\*(t1.y-t2.y)), 2) AS shortest\\n# FROM point\_2d AS t1, point\_2d AS t2\\n# WHERE t1.x!=t2.x OR t1.y!=t2.y\\n# ORDER BY shortest ASC\\n# LIMIT 1\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"613-shortest-distance-in-a-line--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#613-shortest-distance-in-a-line--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"613. Shortest Distance in a Line | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/shortest-distance-in-a-line/\\",children:\\"LeetCode\\"})\]}),(0,n.jsx)(e.p,{children:\\"Table point holds the x coordinate of some points on x-axis in a plane, which are all integers. Write a query to find the shortest distance between two points in these points.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| x |\\n|-----|\\n| -1 |\\n| 0 |\\n| 2 |\\n\`})}),(0,n.jsx)(e.p,{children:\\"The shortest distance is \\\\u20181\\\\u2019 obviously, which is from point \\\\u2018-1\\\\u2019 to \\\\u20180\\\\u2019. So the output is as below:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| shortest|\\n|---------|\\n| 1 |\\n\`})}),(0,n.jsx)(e.p,{children:\\"Note: Every point is unique, which means there is no duplicates in table point.\\"}),(0,n.jsx)(e.p,{children:\\"Follow-up: What if all these points have an id and are arranged from the left most to the right most of x axis?\\"}),(0,n.jsxs)(e.h3,{id:\\"solution-37\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-37\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT t1.x-t2.x AS shortest\\nFROM point AS t1 JOIN point AS t2\\nWHERE t1.x\\u003et2.x\\nORDER BY (t1.x-t2.x) ASC\\nLIMIT 1\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"614-second-degree-follower--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#614-second-degree-follower--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"614. Second Degree Follower | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/second-degree-follower/\\",children:\\"LeetCode\\"})\]}),(0,n.jsx)(e.p,{children:\\"In facebook, there is a follow table with two columns: followee, follower.\\"}),(0,n.jsx)(e.p,{children:\\"Please write a sql query to get the amount of each follower\\\\u2019s follower if he/she has one.\\"}),(0,n.jsx)(e.p,{children:\\"For example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+------------+\\n| followee | follower |\\n+-------------+------------+\\n| A | B |\\n| B | C |\\n| B | D |\\n| D | E |\\n+-------------+------------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"should output:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+------------+\\n| follower | num |\\n+-------------+------------+\\n| B | 2 |\\n| D | 1 |\\n+-------------+------------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"Explanation: Both B and D exist in the follower list, when as a followee, B\\\\u2019s follower is C and D, and D\\\\u2019s follower is E. A does not exist in follower list.\\"}),(0,n.jsx)(e.p,{children:\\"Note: Followee would not follow himself/herself in all cases. Please display the result in follower\\\\u2019s alphabet order.\\"}),(0,n.jsxs)(e.h3,{id:\\"solution-38\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-38\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`## Explain the business logic\\n## A follows B. Then A is follwer, B is followee\\n## What are second degree followers?\\n## A follows B, and B follows C.\\n## Then A is the second degree followers of C\\n\\nSELECT f1.follower, COUNT(DISTINCT f2.follower) AS num\\nFROM follow AS f1 JOIN follow AS f2\\nON f1.follower = f2.followee\\nGROUP BY f1.follower;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"615-average-salary-departments-vs-company--hard---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#615-average-salary-departments-vs-company--hard---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"615. Average Salary: Departments VS Company | Hard | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/average-salary-departments-vs-company\\",children:\\"LeetCode\\"})\]}),(0,n.jsx)(e.p,{children:\\"Given two tables as below, write a query to display the comparison result (higher/lower/same) of the average salary of employees in a department to the company\\\\u2019s average salary. Table: salary\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| id | employee\_id | amount | pay\_date |\\n|----|-------------|--------|------------|\\n| 1 | 1 | 9000 | 2017-03-31 |\\n| 2 | 2 | 6000 | 2017-03-31 |\\n| 3 | 3 | 10000 | 2017-03-31 |\\n| 4 | 1 | 7000 | 2017-02-28 |\\n| 5 | 2 | 6000 | 2017-02-28 |\\n| 6 | 3 | 8000 | 2017-02-28 |\\n\`})}),(0,n.jsx)(e.p,{children:\\"The employee\_id column refers to the employee\_id in the following table employee.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| employee\_id | department\_id |\\n|-------------|---------------|\\n| 1 | 1 |\\n| 2 | 2 |\\n| 3 | 2 |\\n\`})}),(0,n.jsx)(e.p,{children:\\"So for the sample data above, the result is:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| pay\_month | department\_id | comparison |\\n|-----------|---------------|-------------|\\n| 2017-03 | 1 | higher |\\n| 2017-03 | 2 | lower |\\n| 2017-02 | 1 | same |\\n| 2017-02 | 2 | same |\\n\`})}),(0,n.jsx)(e.p,{children:\\"Explanation In March, the company\\\\u2019s average salary is (9000+6000+10000)/3 = 8333.33\\\\u2026 The average salary for department \\\\u20181\\\\u2019 is 9000, which is the salary of employee\_id \\\\u20181\\\\u2019 since there is only one employee in this department. So the comparison result is \\\\u2018higher\\\\u2019 since 9000 \\u003e 8333.33 obviously. The average salary of department \\\\u20182\\\\u2019 is (6000 + 10000)/2 = 8000, which is the average of employee\_id \\\\u20182\\\\u2019 and \\\\u20183\\\\u2019. So the comparison result is \\\\u2018lower\\\\u2019 since 8000 \\u003c 8333.33. With he same formula for the average salary comparison in February, the result is \\\\u2018same\\\\u2019 since both the department \\\\u20181\\\\u2019 and \\\\u20182\\\\u2019 have the same average salary with the company, which is 7000.\\"}),(0,n.jsxs)(e.h3,{id:\\"solution-39\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-39\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT t1.pay\_month, t1.department\_id,\\n (CASE WHEN t1.amount = t2.amount THEN 'same'\\n WHEN t1.amount \\u003e t2.amount THEN 'higher'\\n WHEN t1.amount \\u003c t2.amount THEN 'lower' END) AS comparison\\nFROM\\n (SELECT left(pay\_date, 7) AS pay\_month, department\_id, avg(amount) AS amount\\n FROM salary JOIN employee\\n ON salary.employee\_id = employee.employee\_id\\n GROUP BY pay\_month, department\_id\\n ORDER BY pay\_month DESC, department\_id) AS t1\\n JOIN\\n (SELECT left(pay\_date, 7) AS pay\_month, avg(amount) AS amount\\n FROM salary JOIN employee\\n ON salary.employee\_id = employee.employee\_id\\n GROUP BY pay\_month) AS t2\\n ON t1.pay\_month = t2.pay\_month\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"618-students-report-by-geography--hard---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#618-students-report-by-geography--hard---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"618. Students Report By Geography | Hard | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/students-report-by-geography\\",children:\\"LeetCode\\"})\]}),(0,n.jsx)(e.p,{children:\\"A U.S graduate school has students from Asia, Europe and America. The students\\\\u2019 location information are stored in table student as below.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| name | continent |\\n|--------|-----------|\\n| Jack | America |\\n| Pascal | Europe |\\n| Xi | Asia |\\n| Jane | America |\\n\`})}),(0,n.jsx)(e.p,{children:\\"Pivot the continent column in this table so that each name is sorted alphabetically and displayed underneath its corresponding continent. The output headers should be America, Asia and Europe respectively. It is guaranteed that the student number from America is no less than either Asia or Europe. For the sample input, the output is:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`| America | Asia | Europe |\\n|---------|------|--------|\\n| Jack | Xi | Pascal |\\n| Jane | | |\\n\`})}),(0,n.jsx)(e.p,{children:\\"Follow-up: If it is unknown which continent has the most students, can you write a query to generate the student report?\\"}),(0,n.jsxs)(e.h3,{id:\\"solution-40\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-40\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT t1.name AS America, t2.name AS Asia, t3.name AS Europe\\nFROM\\n (SELECT (@cnt1 := @cnt1 + 1) AS id, name\\n FROM student\\n CROSS JOIN (SELECT @cnt1 := 0) AS dummy\\n WHERE continent='America'\\n ORDER BY name) AS t1\\n LEFT JOIN\\n (SELECT (@cnt2 := @cnt2 + 1) AS id, name\\n FROM student\\n CROSS JOIN (SELECT @cnt2 := 0) AS dummy\\n WHERE continent='Asia'\\n ORDER BY name) AS t2\\n ON t1.id = t2.id\\n LEFT JOIN\\n (SELECT (@cnt3 := @cnt3 + 1) AS id, name\\n FROM student\\n CROSS JOIN (SELECT @cnt3 := 0) AS dummy\\n WHERE continent='Europe'\\n ORDER BY name) AS t3\\n ON t1.id = t3.id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"619-biggest-single-number--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#619-biggest-single-number--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"619. Biggest Single Number | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/biggest-single-number\\",children:\\"LeetCode\\"})\]}),(0,n.jsx)(e.p,{children:\\"Table number contains many numbers in column num including duplicated ones. Can you write a SQL query to find the biggest number, which only appears once.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---+\\n|num|\\n+---+\\n| 8 |\\n| 8 |\\n| 3 |\\n| 3 |\\n| 1 |\\n| 4 |\\n| 5 |\\n| 6 |\\n\`})}),(0,n.jsx)(e.p,{children:\\"For the sample data above, your query should return the following result:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---+\\n|num|\\n+---+\\n| 6 |\\n\`})}),(0,n.jsx)(e.p,{children:\\"Note: If there is no such number, just output null.\\"}),(0,n.jsxs)(e.h3,{id:\\"solution-41\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-41\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT IFNULL((\\n SELECT num\\n FROM number\\n GROUP BY num\\n HAVING count(1) = 1\\n ORDER BY num DESC\\n LIMIT 0, 1), NULL) AS num\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"620-not-boring-movies--easy--leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#620-not-boring-movies--easy--leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"620. Not Boring Movies | Easy | \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/not-boring-movies/\\",children:\\"LeetCode\\"})\]}),(0,n.jsx)(e.p,{children:\\"X city opened a new cinema, many people would like to go to this cinema. The cinema also gives out a poster indicating the movies\\\\u2019 ratings and descriptions. Please write a SQL query to output movies with an odd numbered ID and a description that is not 'boring'. Order the result by rating.\\"}),(0,n.jsxs)(e.p,{children:\[\\"For example, table \\",(0,n.jsx)(e.code,{children:\\"cinema\\"}),\\":\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------+-----------+--------------+-----------+\\n| id | movie | description | rating |\\n+---------+-----------+--------------+-----------+\\n| 1 | War | great 3D | 8.9 |\\n| 2 | Science | fiction | 8.5 |\\n| 3 | irish | boring | 6.2 |\\n| 4 | Ice song | Fantacy | 8.6 |\\n| 5 | House card| Interesting| 9.1 |\\n+---------+-----------+--------------+-----------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"For the example above, the output should be:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------+-----------+--------------+-----------+\\n| id | movie | description | rating |\\n+---------+-----------+--------------+-----------+\\n| 5 | House card| Interesting| 9.1 |\\n| 1 | War | great 3D | 8.9 |\\n+---------+-----------+--------------+-----------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-42\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-42\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT \*\\nFROM Cinema\\nWHERE description \\u003c\\u003e 'boring' AND ID % 2 = 1\\nORDER BY rating DESC;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"626-exchange-seats--medium--leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#626-exchange-seats--medium--leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"626. Exchange Seats | Medium | \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/exchange-seats/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Mary is a teacher in a middle school and she has a table \\",(0,n.jsx)(e.code,{children:\\"seat\\"}),\\" storing students' names and their corresponding seat ids.\\"\]}),(0,n.jsx)(e.p,{children:\\"The column id is continuous increment.\\"}),(0,n.jsx)(e.p,{children:\\"Mary wants to change seats for the adjacent students.\\"}),(0,n.jsx)(e.p,{children:\\"Can you write a SQL query to output the result for Mary?\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------+---------+\\n| id | student |\\n+---------+---------+\\n| 1 | Abbot |\\n| 2 | Doris |\\n| 3 | Emerson |\\n| 4 | Green |\\n| 5 | Jeames |\\n+---------+---------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"For the sample input, the output is:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------+---------+\\n| id | student |\\n+---------+---------+\\n| 1 | Doris |\\n| 2 | Abbot |\\n| 3 | Green |\\n| 4 | Emerson |\\n| 5 | Jeames |\\n+---------+---------+\\n\`})}),(0,n.jsxs)(e.p,{children:\[(0,n.jsx)(e.strong,{children:(0,n.jsx)(e.em,{children:\\"Note:\\"})}),(0,n.jsx)(e.br,{}),\\"If the number of students is odd, there is no need to change the last one's seat.\\"\]}),(0,n.jsxs)(e.h3,{id:\\"solution-43\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-43\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT\\nIF(id\\u003c(SELECT MAX(id) FROM seat),IF(id%2=0,id-1, id+1),IF(id%2=0, id-1, id)) AS id, student\\nFROM seat\\nORDER BY id;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"627-swap-salary--leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#627-swap-salary--leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"627. Swap Salary | \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/swap-salary/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Salary\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+----------+\\n| Column Name | Type |\\n+-------------+----------+\\n| id | int |\\n| name | varchar |\\n| sex | ENUM |\\n| salary | int |\\n+-------------+----------+\\n\\nid is the primary key for this table.\\nThe sex column is ENUM value of type ('m', 'f').\\nThe table contains information about an employee.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to swap all \\",(0,n.jsx)(e.code,{children:\\"'f'\\"}),\\" and \\",(0,n.jsx)(e.code,{children:\\"'m'\\"}),\\" values (i.e., change all \\",(0,n.jsx)(e.code,{children:\\"'f'\\"}),\\" values to \\",(0,n.jsx)(e.code,{children:\\"'m'\\"}),\\" and vice versa) with a single update statement and no intermediate temp table(s).\\"\]}),(0,n.jsx)(e.p,{children:\\"Note that you must write a single update statement, DO NOT write any select statement for this problem.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Salary table:\\n+----+------+-----+--------+\\n| id | name | sex | salary |\\n+----+------+-----+--------+\\n| 1 | A | m | 2500 |\\n| 2 | B | f | 1500 |\\n| 3 | C | m | 5500 |\\n| 4 | D | f | 500 |\\n+----+------+-----+--------+\\n\\nResult table:\\n+----+------+-----+--------+\\n| id | name | sex | salary |\\n+----+------+-----+--------+\\n| 1 | A | f | 2500 |\\n| 2 | B | m | 1500 |\\n| 3 | C | f | 5500 |\\n| 4 | D | m | 500 |\\n+----+------+-----+--------+\\n(1, A) and (2, C) were changed from 'm' to 'f'.\\n(2, B) and (4, D) were changed from 'f' to 'm'.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-44\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-44\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`# With IF\\nUPDATE Salary SET sex = IF(sex='m', 'f', 'm')\\n\\n# With CASE\\nUPDATE Salary SET sex = CASE WHEN sex='m' THEN 'f' ELSE 'm' END\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1045-customers-who-bought-all-products--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1045-customers-who-bought-all-products--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1045. Customers Who Bought All Products | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/customers-who-bought-all-products\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Customer\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| customer\_id | int |\\n| product\_key | int |\\n+-------------+---------+\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"product\_key is a foreign key to Product table. Table: \\",(0,n.jsx)(e.code,{children:\\"Product\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| product\_key | int |\\n+-------------+---------+\\nproduct\_key is the primary key column for this table.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query for a report that provides the customer ids from the Customer table that bought all the products in the Product table.\\"}),(0,n.jsx)(e.p,{children:\\"For example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Customer table:\\n+-------------+-------------+\\n| customer\_id | product\_key |\\n+-------------+-------------+\\n| 1 | 5 |\\n| 2 | 6 |\\n| 3 | 5 |\\n| 3 | 6 |\\n| 1 | 6 |\\n+-------------+-------------+\\n\\nProduct table:\\n+-------------+\\n| product\_key |\\n+-------------+\\n| 5 |\\n| 6 |\\n+-------------+\\n\\nResult table:\\n+-------------+\\n| customer\_id |\\n+-------------+\\n| 1 |\\n| 3 |\\n+-------------+\\nThe customers who bought all the products (5 and 6) are customers with id 1 and 3.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-45\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-45\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT customer\_id\\nFROM Customer\\nGROUP NY customer\_id\\nHAVING count(DISTINCT product\_key) = (\\n SELECT count(1)\\n FROM Product)\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1050-actors-and-directors-who-cooperated-at-least-three-times--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1050-actors-and-directors-who-cooperated-at-least-three-times--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1050. Actors and Directors Who Cooperated At Least Three Times | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/actors-and-directors-who-cooperated-at-least-three-times\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"ActorDirector\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| actor\_id | int |\\n| director\_id | int |\\n| timestamp | int |\\n+-------------+---------+\\ntimestamp is the primary key column for this table.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write a SQL query for a report that provides the pairs (actor\_id, director\_id) where the actor have cooperated with the director at least 3 times.\\"}),(0,n.jsx)(e.p,{children:\\"Example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`ActorDirector table:\\n+-------------+-------------+-------------+\\n| actor\_id | director\_id | timestamp |\\n+-------------+-------------+-------------+\\n| 1 | 1 | 0 |\\n| 1 | 1 | 1 |\\n| 1 | 1 | 2 |\\n| 1 | 2 | 3 |\\n| 1 | 2 | 4 |\\n| 2 | 1 | 5 |\\n| 2 | 1 | 6 |\\n+-------------+-------------+-------------+\\n\\nResult table:\\n+-------------+-------------+\\n| actor\_id | director\_id |\\n+-------------+-------------+\\n| 1 | 1 |\\n+-------------+-------------+\\nThe only pair is (1, 1) where they cooperated exactly 3 times.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-46\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-46\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT actor\_id, director\_id\\nFROM ActorDirector\\nGROUP BY actor\_id, director\_id\\nHAVING COUNT(1)\\u003e=3\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1068-product-sales-analysis-i--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1068-product-sales-analysis-i--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1068. Product Sales Analysis I | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/product-sales-analysis-i\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Sales\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+-------+\\n| Column Name | Type |\\n+-------------+-------+\\n| sale\_id | int |\\n| product\_id | int |\\n| year | int |\\n| quantity | int |\\n| price | int |\\n+-------------+-------+\\n(sale\_id, year) is the primary key of this table.\\nproduct\_id is a foreign key to Product table.\\nNote that the price is per unit.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Product\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+---------+\\n| Column Name | Type |\\n+--------------+---------+\\n| product\_id | int |\\n| product\_name | varchar |\\n+--------------+---------+\\nproduct\_id is the primary key of this table.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query that reports all product names of the products in the Sales table along with their selling year and price.\\"}),(0,n.jsx)(e.p,{children:\\"For example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Sales table:\\n+---------+------------+------+----------+-------+\\n| sale\_id | product\_id | year | quantity | price |\\n+---------+------------+------+----------+-------+\\n| 1 | 100 | 2008 | 10 | 5000 |\\n| 2 | 100 | 2009 | 12 | 5000 |\\n| 7 | 200 | 2011 | 15 | 9000 |\\n+---------+------------+------+----------+-------+\\n\\nProduct table:\\n+------------+--------------+\\n| product\_id | product\_name |\\n+------------+--------------+\\n| 100 | Nokia |\\n| 200 | Apple |\\n| 300 | Samsung |\\n+------------+--------------+\\n\\nResult table:\\n+--------------+-------+-------+\\n| product\_name | year | price |\\n+--------------+-------+-------+\\n| Nokia | 2008 | 5000 |\\n| Nokia | 2009 | 5000 |\\n| Apple | 2011 | 9000 |\\n+--------------+-------+-------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-47\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-47\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT product\_name, year, price\\nFROM Sales JOIN Product\\nON Product.product\_id = Sales.product\_id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1069-product-sales-analysis-ii--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1069-product-sales-analysis-ii--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1069. Product Sales Analysis II | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/product-sales-analysis-ii\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Sales\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+-------+\\n| Column Name | Type |\\n+-------------+-------+\\n| sale\_id | int |\\n| product\_id | int |\\n| year | int |\\n| quantity | int |\\n| price | int |\\n+-------------+-------+\\nsale\_id is the primary key of this table.\\nproduct\_id is a foreign key to Product table.\\nNote that the price is per unit.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Product\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+---------+\\n| Column Name | Type |\\n+--------------+---------+\\n| product\_id | int |\\n| product\_name | varchar |\\n+--------------+---------+\\nproduct\_id is the primary key of this table.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query that reports the total quantity sold for every product id.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Sales table:\\n+---------+------------+------+----------+-------+\\n| sale\_id | product\_id | year | quantity | price |\\n+---------+------------+------+----------+-------+\\n| 1 | 100 | 2008 | 10 | 5000 |\\n| 2 | 100 | 2009 | 12 | 5000 |\\n| 7 | 200 | 2011 | 15 | 9000 |\\n+---------+------------+------+----------+-------+\\n\\nProduct table:\\n+------------+--------------+\\n| product\_id | product\_name |\\n+------------+--------------+\\n| 100 | Nokia |\\n| 200 | Apple |\\n| 300 | Samsung |\\n+------------+--------------+\\n\\nResult table:\\n+--------------+----------------+\\n| product\_id | total\_quantity |\\n+--------------+----------------+\\n| 100 | 22 |\\n| 200 | 15 |\\n+--------------+----------------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-48\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-48\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT product\_id, sum(quantity) AS total\_quantity\\nFROM Sales\\nGROUP BY product\_id;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1070-product-sales-analysis-iii--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1070-product-sales-analysis-iii--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1070. Product Sales Analysis III | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/product-sales-analysis-iii\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Sales\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+-------+\\n| Column Name | Type |\\n+-------------+-------+\\n| sale\_id | int |\\n| product\_id | int |\\n| year | int |\\n| quantity | int |\\n| price | int |\\n+-------------+-------+\\nsale\_id is the primary key of this table.\\nproduct\_id is a foreign key to Product table.\\nNote that the price is per unit.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Product\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+---------+\\n| Column Name | Type |\\n+--------------+---------+\\n| product\_id | int |\\n| product\_name | varchar |\\n+--------------+---------+\\nproduct\_id is the primary key of this table.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query that selects the product id, year, quantity, and price for the first year of every product sold.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Sales table:\\n+---------+------------+------+----------+-------+\\n| sale\_id | product\_id | year | quantity | price |\\n+---------+------------+------+----------+-------+\\n| 1 | 100 | 2008 | 10 | 5000 |\\n| 2 | 100 | 2009 | 12 | 5000 |\\n| 7 | 200 | 2011 | 15 | 9000 |\\n+---------+------------+------+----------+-------+\\n\\nProduct table:\\n+------------+--------------+\\n| product\_id | product\_name |\\n+------------+--------------+\\n| 100 | Nokia |\\n| 200 | Apple |\\n| 300 | Samsung |\\n+------------+--------------+\\n\\nResult table:\\n+------------+------------+----------+-------+\\n| product\_id | first\_year | quantity | price |\\n+------------+------------+----------+-------+\\n| 100 | 2008 | 10 | 5000 |\\n| 200 | 2011 | 15 | 9000 |\\n+------------+------------+----------+-------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-49\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-49\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT\\n product\_id,\\n year first\_year,\\n quantity,\\n price\\nFROM Sales\\nWHERE (product\_id, year) IN (SELECT product\_id, MIN(year)\\n FROM Sales\\n GROUP BY product\_id)\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1075-project-employees-i--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1075-project-employees-i--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1075. Project Employees I | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/project-employees-i\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Project\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| project\_id | int |\\n| employee\_id | int |\\n+-------------+---------+\\n(project\_id, employee\_id) is the primary key of this table.\\nemployee\_id is a foreign key to Employee table.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Employee\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+------------------+---------+\\n| Column Name | Type |\\n+------------------+---------+\\n| employee\_id | int |\\n| name | varchar |\\n| experience\_years | int |\\n+------------------+---------+\\nemployee\_id is the primary key of this table.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query that reports the average experience years of all the employees for each project, rounded to 2 digits.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Project table:\\n+-------------+-------------+\\n| project\_id | employee\_id |\\n+-------------+-------------+\\n| 1 | 1 |\\n| 1 | 2 |\\n| 1 | 3 |\\n| 2 | 1 |\\n| 2 | 4 |\\n+-------------+-------------+\\n\\nEmployee table:\\n+-------------+--------+------------------+\\n| employee\_id | name | experience\_years |\\n+-------------+--------+------------------+\\n| 1 | Khaled | 3 |\\n| 2 | Ali | 2 |\\n| 3 | John | 1 |\\n| 4 | Doe | 2 |\\n+-------------+--------+------------------+\\n\\nResult table:\\n+-------------+---------------+\\n| project\_id | average\_years |\\n+-------------+---------------+\\n| 1 | 2.00 |\\n| 2 | 2.50 |\\n+-------------+---------------+\\nThe average experience years for the first project is (3 + 2 + 1) / 3 = 2.00 and for the second project is (3 + 2) / 2 = 2.50\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-50\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-50\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT\\n p.project\_id,\\n ROUND(AVG(e.experience\_years),2) average\_years\\nFROM\\n Project p JOIN Employee e ON\\n p.employee\_id = e.employee\_id\\nGROUP BY\\n p.project\_id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1076-project-employees-ii--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1076-project-employees-ii--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1076. Project Employees II | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/project-employees-ii\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Project\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| project\_id | int |\\n| employee\_id | int |\\n+-------------+---------+\\n(project\_id, employee\_id) is the primary key of this table.\\nemployee\_id is a foreign key to Employee table.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Employee\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+------------------+---------+\\n| Column Name | Type |\\n+------------------+---------+\\n| employee\_id | int |\\n| name | varchar |\\n| experience\_years | int |\\n+------------------+---------+\\nemployee\_id is the primary key of this table.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query that reports all the projects that have the most employees.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Project table:\\n+-------------+-------------+\\n| project\_id | employee\_id |\\n+-------------+-------------+\\n| 1 | 1 |\\n| 1 | 2 |\\n| 1 | 3 |\\n| 2 | 1 |\\n| 2 | 4 |\\n+-------------+-------------+\\n\\nEmployee table:\\n+-------------+--------+------------------+\\n| employee\_id | name | experience\_years |\\n+-------------+--------+------------------+\\n| 1 | Khaled | 3 |\\n| 2 | Ali | 2 |\\n| 3 | John | 1 |\\n| 4 | Doe | 2 |\\n+-------------+--------+------------------+\\n\\nResult table:\\n+-------------+\\n| project\_id |\\n+-------------+\\n| 1 |\\n+-------------+\\nThe first project has 3 employees while the second one has 2.\\n\`})}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT project\_id\\nFROM Project\\nGROUP BY project\_id\\nHAVING COUNT(employee\_id) = (SELECT COUNT(employee\_id)\\n FROM Project\\n GROUP BY project\_id\\n ORDER BY COUNT(employee\_id) DESC\\n LIMIT 1)\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1077-project-employees-iii--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1077-project-employees-iii--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1077. Project Employees III | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/project-employees-iii\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Project\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| project\_id | int |\\n| employee\_id | int |\\n+-------------+---------+\\n(project\_id, employee\_id) is the primary key of this table.\\nemployee\_id is a foreign key to Employee table.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Employee\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+------------------+---------+\\n| Column Name | Type |\\n+------------------+---------+\\n| employee\_id | int |\\n| name | varchar |\\n| experience\_years | int |\\n+------------------+---------+\\nemployee\_id is the primary key of this table.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query that reports the most experienced employees in each project. In case of a tie, report all employees with the maximum number of experience years.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Project table:\\n+-------------+-------------+\\n| project\_id | employee\_id |\\n+-------------+-------------+\\n| 1 | 1 |\\n| 1 | 2 |\\n| 1 | 3 |\\n| 2 | 1 |\\n| 2 | 4 |\\n+-------------+-------------+\\n\\nEmployee table:\\n+-------------+--------+------------------+\\n| employee\_id | name | experience\_years |\\n+-------------+--------+------------------+\\n| 1 | Khaled | 3 |\\n| 2 | Ali | 2 |\\n| 3 | John | 3 |\\n| 4 | Doe | 2 |\\n+-------------+--------+------------------+\\n\\nResult table:\\n+-------------+---------------+\\n| project\_id | employee\_id |\\n+-------------+---------------+\\n| 1 | 1 |\\n| 1 | 3 |\\n| 2 | 1 |\\n+-------------+---------------+\\nBoth employees with id 1 and 3 have the most experience among the employees of the first project. For the second project, the employee with id 1 has the most experience.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-51\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-51\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT\\n p.project\_id,\\n e.employee\_id\\nFROM\\n Project p LEFT JOIN Employee e ON\\n p.employee\_id = e.employee\_id\\nWHERE (p.project\_id,\\n e.experience\_years) IN (SELECT\\n p.project\_id,\\n MAX(e.experience\_years)\\n FROM\\n Project p JOIN Employee e ON\\n p.employee\_id = e.employee\_id\\n GROUP BY\\n p.project\_id)\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1082-sales-analysis-i--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1082-sales-analysis-i--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1082. Sales Analysis I | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/sales-analysis-i\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Product\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+---------+\\n| Column Name | Type |\\n+--------------+---------+\\n| product\_id | int |\\n| product\_name | varchar |\\n| unit\_price | int |\\n+--------------+---------+\\nproduct\_id is the primary key of this table.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Table: Sales\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| seller\_id | int |\\n| product\_id | int |\\n| buyer\_id | int |\\n| sale\_date | date |\\n| quantity | int |\\n| price | int |\\n+------ ------+---------+\\nThis table has no primary key, it can have repeated rows.\\nproduct\_id is a foreign key to Product table.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query that reports the best seller by total sales price, If there is a tie, report them all.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Product table:\\n+------------+--------------+------------+\\n| product\_id | product\_name | unit\_price |\\n+------------+--------------+------------+\\n| 1 | S8 | 1000 |\\n| 2 | G4 | 800 |\\n| 3 | iPhone | 1400 |\\n+------------+--------------+------------+\\n\\nSales table:\\n+-----------+------------+----------+------------+----------+-------+\\n| seller\_id | product\_id | buyer\_id | sale\_date | quantity | price |\\n+-----------+------------+----------+------------+----------+-------+\\n| 1 | 1 | 1 | 2019-01-21 | 2 | 2000 |\\n| 1 | 2 | 2 | 2019-02-17 | 1 | 800 |\\n| 2 | 2 | 3 | 2019-06-02 | 1 | 800 |\\n| 3 | 3 | 4 | 2019-05-13 | 2 | 2800 |\\n+-----------+------------+----------+------------+----------+-------+\\n\\nResult table:\\n+-------------+\\n| seller\_id |\\n+-------------+\\n| 1 |\\n| 3 |\\n+-------------+\\nBoth sellers with id 1 and 3 sold products with the most total price of 2800.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-52\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-52\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT seller\_id\\nFROM Sales\\nGROUP BY seller\_id\\nHAVING SUM(price) = (SELECT SUM(price)\\n FROM Sales\\n GROUP BY seller\_id\\n ORDER BY SUM(price) DESC\\n LIMIT 1)\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1083-sales-analysis-ii--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1083-sales-analysis-ii--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1083. Sales Analysis II | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/sales-analysis-ii\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Product\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+---------+\\n| Column Name | Type |\\n+--------------+---------+\\n| product\_id | int |\\n| product\_name | varchar |\\n| unit\_price | int |\\n+--------------+---------+\\nproduct\_id is the primary key of this table.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Sales\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| seller\_id | int |\\n| product\_id | int |\\n| buyer\_id | int |\\n| sale\_date | date |\\n| quantity | int |\\n| price | int |\\n+------ ------+---------+\\nThis table has no primary key, it can have repeated rows.\\nproduct\_id is a foreign key to Product table.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query that reports the buyers who have bought S8 but not iPhone. Note that S8 and iPhone are products present in the Product table.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Product table:\\n+------------+--------------+------------+\\n| product\_id | product\_name | unit\_price |\\n+------------+--------------+------------+\\n| 1 | S8 | 1000 |\\n| 2 | G4 | 800 |\\n| 3 | iPhone | 1400 |\\n+------------+--------------+------------+\\n\\nSales table:\\n+-----------+------------+----------+------------+----------+-------+\\n| seller\_id | product\_id | buyer\_id | sale\_date | quantity | price |\\n+-----------+------------+----------+------------+----------+-------+\\n| 1 | 1 | 1 | 2019-01-21 | 2 | 2000 |\\n| 1 | 2 | 2 | 2019-02-17 | 1 | 800 |\\n| 2 | 1 | 3 | 2019-06-02 | 1 | 800 |\\n| 3 | 3 | 3 | 2019-05-13 | 2 | 2800 |\\n+-----------+------------+----------+------------+----------+-------+\\n\\nResult table:\\n+-------------+\\n| buyer\_id |\\n+-------------+\\n| 1 |\\n+-------------+\\nThe buyer with id 1 bought an S8 but didn't buy an iPhone. The buyer with id 3 bought both.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-53\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-53\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT DISTINCT s.buyer\_id\\nFROM Sales s LEFT JOIN Product p ON\\n s.product\_id = p.product\_id\\nWHERE p.product\_name = 'S8' AND\\n s.buyer\_id NOT IN (SELECT s.buyer\_id\\n FROM Sales s LEFT JOIN Product p ON\\n s.product\_id = p.product\_id\\n WHERE p.product\_name = 'iPhone')\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1084-sales-analysis-iii--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1084-sales-analysis-iii--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1084. Sales Analysis III | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/sales-analysis-iii\\",children:\\"LeetCode\\"})\]}),(0,n.jsx)(e.p,{children:\\"Reports the products that were only sold in spring 2019. That is, between 2019-01-01 and 2019-03-31 inclusive. Select the product that were only sold in spring 2019.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Product table:\\n+------------+--------------+------------+\\n| product\_id | product\_name | unit\_price |\\n+------------+--------------+------------+\\n| 1 | S8 | 1000 |\\n| 2 | G4 | 800 |\\n| 3 | iPhone | 1400 |\\n+------------+--------------+------------+\\n\\nSales table:\\n+-----------+------------+----------+------------+----------+-------+\\n| seller\_id | product\_id | buyer\_id | sale\_date | quantity | price |\\n+-----------+------------+----------+------------+----------+-------+\\n| 1 | 1 | 1 | 2019-01-21 | 2 | 2000 |\\n| 1 | 2 | 2 | 2019-02-17 | 1 | 800 |\\n| 2 | 2 | 3 | 2019-06-02 | 1 | 800 |\\n| 3 | 3 | 4 | 2019-05-13 | 2 | 2800 |\\n+-----------+------------+----------+------------+----------+-------+\\n\\nResult table:\\n+-------------+--------------+\\n| product\_id | product\_name |\\n+-------------+--------------+\\n| 1 | S8 |\\n+-------------+--------------+\\nThe product with id 1 was only sold in spring 2019 while the other two were sold after.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-54\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-54\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`(SELECT DISTINCT s.product\_id, p.product\_name\\nFROM Sales s LEFT JOIN Product p ON\\n s.product\_id = p.product\_id\\nWHERE s.sale\_date \\u003e= '2019-01-01' AND\\n s.sale\_date \\u003c= '2019-03-31')\\nEXCEPT -- MINUS if Oracle\\n(SELECT DISTINCT s.product\_id, p.product\_name\\nFROM Sales s LEFT JOIN Product p ON\\n s.product\_id = p.product\_id\\nWHERE s.sale\_date \\u003c '2019-01-01' OR\\n s.sale\_date \\u003e '2019-03-31')\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1097-game-play-analysis-v--hard---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1097-game-play-analysis-v--hard---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1097. Game Play Analysis V | Hard | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/game-play-analysis-v\\",children:\\"LeetCode\\"})\]}),(0,n.jsx)(e.p,{children:\\"We define the install date of a player to be the first login day of that player. We also define day 1 retention of some date X to be the number of players whose install date is X and they logged back in on the day right after X , divided by the number of players whose install date is X, rounded to 2 decimal places. Write an SQL query that reports for each install date, the number of players that installed the game on that day and the day 1 retention. The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Activity table:\\n+-----------+-----------+------------+--------------+\\n| player\_id | device\_id | event\_date | games\_played |\\n+-----------+-----------+------------+--------------+\\n| 1 | 2 | 2016-03-01 | 5 |\\n| 1 | 2 | 2016-03-02 | 6 |\\n| 2 | 3 | 2017-06-25 | 1 |\\n| 3 | 1 | 2016-03-01 | 0 |\\n| 3 | 4 | 2016-07-03 | 5 |\\n+-----------+-----------+------------+--------------+\\n\\nResult table:\\n+------------+----------+----------------+\\n| install\_dt | installs | Day1\_retention |\\n+------------+----------+----------------+\\n| 2016-03-01 | 2 | 0.50 |\\n| 2017-06-25 | 1 | 0.00 |\\n+------------+----------+----------------+\\n\\nPlayer 1 and 3 installed the game on 2016-03-01 but only player 1 logged back in on 2016-03-02 so the day 1 retention of 2016-03-01 is 1/2 = 0.50\\nPlayer 2 installed the game on 2017 -06-25 but didn't log back in on 2017-06-26 so the day 1 retention of 2017-06-25 is 0/1 = 0.00\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-55\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-55\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT\\n install\_dt,\\n COUNT(player\_id) installs,\\n ROUND(COUNT(retention)/COUNT(player\_id),2) Day1\_retention --the number of record on the next day / the total number of id on the day = retention rate\\nFROM\\n (\\n SELECT a.player\_id, a.install\_dt, b.event\_date retention -- id, the record of the first installation day and next day\\n FROM\\n (SELECT player\_id, MIN(event\_date) install\_dt --subquery 1 take the first installation of date of each id\\n FROM Activity\\n GROUP BY player\_id) a LEFT JOIN Activity b ON --sq1 left join the original table, find the login status the next day after the first installation\\n a.player\_id = b.player\_id AND\\n a.install\_dt + 1=b.event\_date\\n ) AS tmp\\nGROUP BY\\n install\_dt\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1098-unpopular-books--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1098-unpopular-books--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1098. Unpopular Books | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/unpopular-books\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Books\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----------------+---------+\\n| Column Name | Type |\\n+----------------+---------+\\n| book\_id | int |\\n| name | varchar |\\n| available\_from | date |\\n+----------------+---------+\\nbook\_id is the primary key of this table.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Orders\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----------------+---------+\\n| Column Name | Type |\\n+----------------+---------+\\n| order\_id | int |\\n| book\_id | int |\\n| quantity | int |\\n| dispatch\_date | date |\\n+----------------+---------+\\norder\_id is the primary key of this table.\\nbook\_id is a foreign key to the Books table.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query that reports the books that have sold less than 10 copies in the last year, excluding books that have been available for less than 1 month from today. Assume today is 2019-06-23.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Books table:\\n+---------+--------------------+----------------+\\n| book\_id | name | available\_from |\\n+---------+--------------------+----------------+\\n| 1 | \\"Kalila And Demna\\" | 2010-01-01 |\\n| 2 | \\"28 Letters\\" | 2012-05-12 |\\n| 3 | \\"The Hobbit\\" | 2019-06-10 |\\n| 4 | \\"13 Reasons Why\\" | 2019-06-01 |\\n| 5 | \\"The Hunger Games\\" | 2008-09-21 |\\n+---------+--------------------+----------------+\\n\\nOrders table:\\n+----------+---------+----------+---------------+\\n| order\_id | book\_id | quantity | dispatch\_date |\\n+----------+---------+----------+---------------+\\n| 1 | 1 | 2 | 2018-07-26 |\\n| 2 | 1 | 1 | 2018-11-05 |\\n| 3 | 3 | 8 | 2019-06-11 |\\n| 4 | 4 | 6 | 2019-06-05 |\\n| 5 | 4 | 5 | 2019-06-20 |\\n| 6 | 5 | 9 | 2009-02-02 |\\n| 7 | 5 | 8 | 2010-04-13 |\\n+----------+---------+----------+---------------+\\n\\nResult table:\\n+-----------+--------------------+\\n| book\_id | name |\\n+-----------+--------------------+\\n| 1 | \\"Kalila And Demna\\" |\\n| 2 | \\"28 Letters\\" |\\n| 5 | \\"The Hunger Games\\" |\\n+-----------+--------------------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-56\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-56\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT\\n b.book\_id, b.name\\nFROM\\n Books b LEFT JOIN ( -- subquery calculates last year's sales\\n SELECT book\_id, SUM(quantity) nsold\\n FROM Orders\\n WHERE dispatch\_date BETWEEN '2018-06-23' AND '2019-06-23'\\n GROUP BY book\_id\\n ) o\\n ON b.book\_id = o.book\_id\\nWHERE\\n (o.nsold \\u003c 10 OR o.nsold IS NULL) AND -- Sales less than 10 or no sales\\n DATEDIFF('2019-06-23', b.available\_from) \\u003e 30 -- Not a new book within 1 month\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1107-new-users-daily-count--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1107-new-users-daily-count--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1107. New Users Daily Count | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/new-users-daily-count\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Traffic\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| user\_id | int |\\n| activity | enum |\\n| activity\_date | date |\\n+---------------+---------+\\nThere is no primary key for this table, it may have duplicate rows.\\nThe activity column is an ENUM type of ('login', 'logout', 'jobs', 'groups', 'homepage').\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query that reports for every date within at most 90 days from today, the number of users that logged in for the first time on that date. Assume today is 2019-06-30.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Traffic table:\\n+---------+----------+---------------+\\n| user\_id | activity | activity\_date |\\n+---------+----------+---------------+\\n| 1 | login | 2019-05-01 |\\n| 1 | homepage | 2019-05-01 |\\n| 1 | logout | 2019-05-01 |\\n| 2 | login | 2019-06-21 |\\n| 2 | logout | 2019-06-21 |\\n| 3 | login | 2019-01-01 |\\n| 3 | jobs | 2019-01-01 |\\n| 3 | logout | 2019-01-01 |\\n| 4 | login | 2019-06-21 |\\n| 4 | groups | 2019-06-21 |\\n| 4 | logout | 2019-06-21 |\\n| 5 | login | 2019-03-01 |\\n| 5 | logout | 2019-03-01 |\\n| 5 | login | 2019-06-21 |\\n| 5 | logout | 2019-06-21 |\\n+---------+----------+---------------+\\n\\nResult table:\\n+------------+-------------+\\n| login\_date | user\_count |\\n+------------+-------------+\\n| 2019-05-01 | 1 |\\n| 2019-06-21 | 2 |\\n+------------+-------------+\\nNote that we only care about dates with non zero user count.\\nThe user with id 5 first logged in on 2019-03-01 so he's not counted on 2019-06-21.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-57\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-57\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution- 1:\\nSELECT login\_date, COUNT(user\_id) AS user\_count\\nFROM (SELECT user\_id, MIN(activity\_date) AS login\_date\\n FROM Traffic\\n WHERE activity = 'login'\\n GROUP BY user\_id) AS t\\nWHERE login\_date \\u003e= DATE\_ADD('2019-06-30', INTERVAL -90 DAY) AND login\_date \\u003c= '2019-06-30'\\nGROUP BY login\_date\\n\\n#Solution- 2:\\nSELECT login\_date, COUNT(user\_id) user\_count\\nFROM\\n (SELECT user\_id, MIN(activity\_date) as login\_date\\n FROM Traffic\\n WHERE activity='login'\\n GROUP BY user\_id) as t\\nWHERE DATEDIFF('2019-06-30', login\_date) \\u003c= 90\\nGROUP BY login\_date\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1112-highest-grade-for-each-student--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1112-highest-grade-for-each-student--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1112. Highest Grade For Each Student | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/highest-grade-for-each-student\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Enrollments\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| student\_id | int |\\n| course\_id | int |\\n| grade | int |\\n+---------------+---------+\\n(student\_id, course\_id) is the primary key of this table.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write a SQL query to find the highest grade with its corresponding course for each student. In case of a tie, you should find the course with the smallest course\_id. The output must be sorted by increasing student\_id.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Enrollments table:\\n+------------+-------------------+\\n| student\_id | course\_id | grade |\\n+------------+-----------+-------+\\n| 2 | 2 | 95 |\\n| 2 | 3 | 95 |\\n| 1 | 1 | 90 |\\n| 1 | 2 | 99 |\\n| 3 | 1 | 80 |\\n| 3 | 2 | 75 |\\n| 3 | 3 | 82 |\\n+------------+-----------+-------+\\nResult table:\\n+------------+-------------------+\\n| student\_id | course\_id | grade |\\n+------------+-----------+-------+\\n| 1 | 2 | 99 |\\n| 2 | 2 | 95 |\\n| 3 | 3 | 82 |\\n+------------+-----------+-------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-58\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-58\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT student\_id, MIN(course\_id) course\_id, grade\\nFROM Enrollments\\nWHERE (student\_id, grade) IN\\n (SELECT student\_id, MAX(grade)\\n FROM Enrollments\\n GROUP BY student\_id)\\nGROUP BY student\_id\\nORDER BY student\_id;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1113reported-posts--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1113reported-posts--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1113.Reported Posts | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/reported-posts\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Actions\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| user\_id | int |\\n| post\_id | int |\\n| action\_date | date |\\n| action | enum |\\n| extra | varchar |\\n+---------------+---------+\\nThere is no primary key for this table, it may have duplicate rows.\\nThe action column is an ENUM type of ('view', 'like', 'reaction', 'comment', 'report', 'share').\\nThe extra column has optional information about the action such as a reason for report or a type of reaction.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query that reports the number of posts reported yesterday for each report reason. Assume today is 2019-07-05.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Actions table:\\n+---------+---------+-------------+--------+--------+\\n| user\_id | post\_id | action\_date | action | extra |\\n+---------+---------+-------------+--------+--------+\\n| 1 | 1 | 2019-07-01 | view | null |\\n| 1 | 1 | 2019-07-01 | like | null |\\n| 1 | 1 | 2019-07-01 | share | null |\\n| 2 | 4 | 2019-07-04 | view | null |\\n| 2 | 4 | 2019-07-04 | report | spam |\\n| 3 | 4 | 2019-07-04 | view | null |\\n| 3 | 4 | 2019-07-04 | report | spam |\\n| 4 | 3 | 2019-07-02 | view | null |\\n| 4 | 3 | 2019-07-02 | report | spam |\\n| 5 | 2 | 2019-07-04 | view | null |\\n| 5 | 2 | 2019-07-04 | report | racism |\\n| 5 | 5 | 2019-07-04 | view | null |\\n| 5 | 5 | 2019-07-04 | report | racism |\\n+---------+---------+-------------+--------+--------+\\nResult table:\\n+---------------+--------------+\\n| report\_reason | report\_count |\\n+---------------+--------------+\\n| spam | 1 |\\n| racism | 2 |\\n+---------------+--------------+\\n\`})}),(0,n.jsx)(e.p,{children:\\"Note that we only care about report reasons with non zero number of reports.\\"}),(0,n.jsxs)(e.h3,{id:\\"solution-59\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-59\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT extra report\_reason, COUNT(DISTINCT post\_id) report\_count\\nFROM\\n (SELECT post\_id, extra\\n FROM Actions\\n WHERE action\_date = DATE\_SUB('2019-07-05', INTERVAL 1 DAY) AND\\n action = 'report') AS tmp\\nGROUP BY extra\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1126-active-businesses--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1126-active-businesses--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1126. Active Businesses | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/active-businesses\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Events\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| business\_id | int |\\n| event\_type | varchar |\\n| occurences | int |\\n+---------------+---------+\\n(business\_id, event\_type) is the primary key of this table.\\nEach row in the table logs the info that an event of some type occured at some business for a number of times.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find all active businesses.\\"}),(0,n.jsx)(e.p,{children:\\"An active business is a business that has more than one event type with occurences greater than the average occurences of that event type among all businesses.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Events table:\\n+-------------+------------+------------+\\n| business\_id | event\_type | occurences |\\n+-------------+------------+------------+\\n| 1 | reviews | 7 |\\n| 3 | reviews | 3 |\\n| 1 | ads | 11 |\\n| 2 | ads | 7 |\\n| 3 | ads | 6 |\\n| 1 | page views | 3 |\\n| 2 | page views | 12 |\\n+-------------+------------+------------+\\n\\nResult table:\\n+-------------+\\n| business\_id |\\n+-------------+\\n| 1 |\\n+-------------+\\nAverage for 'reviews', 'ads' and 'page views' are (7+3)/2=5, (11+7+6)/3=8, (3+12)/2=7.5 respectively.\\nBusiness with id 1 has 7 'reviews' events (more than 5) and 11 'ads' events (more than 8) so it is an active business.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-60\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-60\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT business\_id\\nFROM (SELECT a.business\_id, a.event\_type, a.occurences, b.event\_avg -- sub 2\\n FROM Events a LEFT JOIN\\n (SELECT event\_type, AVG(occurences) event\_avg -- sub 1\\n FROM Events\\n GROUP BY event\_type) b ON\\n a.event\_type = b.event\_type) tmp\\nWHERE occurences \\u003e event\_avg\\nGROUP BY business\_id\\nHAVING COUNT(event\_type) \\u003e 1\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1127-user-purchase-platform--hard---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1127-user-purchase-platform--hard---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1127. User Purchase Platform | Hard | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/user-purchase-platform\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Spending\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| user\_id | int |\\n| spend\_date | date |\\n| platform | enum |\\n| amount | int |\\n+-------------+---------+\\nThe table logs the spendings history of users that make purchases from an online shopping website which has a desktop and a mobile application.\\n(user\_id, spend\_date, platform) is the primary key of this table.\\nThe platform column is an ENUM type of ('desktop', 'mobile').\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the total number of users and the total amount spent using mobile only, desktop only and both mobile and desktop together for each date.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Spending table:\\n+---------+------------+----------+--------+\\n| user\_id | spend\_date | platform | amount |\\n+---------+------------+----------+--------+\\n| 1 | 2019-07-01 | mobile | 100 |\\n| 1 | 2019-07-01 | desktop | 100 |\\n| 2 | 2019-07-01 | mobile | 100 |\\n| 2 | 2019-07-02 | mobile | 100 |\\n| 3 | 2019-07-01 | desktop | 100 |\\n| 3 | 2019-07-02 | desktop | 100 |\\n+---------+------------+----------+--------+\\n\\nResult table:\\n+------------+----------+--------------+-------------+\\n| spend\_date | platform | total\_amount | total\_users |\\n+------------+----------+--------------+-------------+\\n| 2019-07-01 | desktop | 100 | 1 |\\n| 2019-07-01 | mobile | 100 | 1 |\\n| 2019-07-01 | both | 200 | 1 |\\n| 2019-07-02 | desktop | 100 | 1 |\\n| 2019-07-02 | mobile | 100 | 1 |\\n| 2019-07-02 | both | 0 | 0 |\\n+------------+----------+--------------+-------------+\\nOn 2019-07-01, user 1 purchased using both desktop and mobile, user 2 purchased using mobile only and user 3 purchased using desktop only.\\nOn 2019-07-02, user 2 purchased using mobile only, user 3 purchased using desktop only and no one purchased using both platforms.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-61\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-61\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT aa.spend\_date,\\n aa.platform,\\n COALESCE(bb.total\_amount, 0) total\_amount,\\n COALESCE(bb.total\_users,0) total\_users\\nFROM\\n (SELECT DISTINCT(spend\_date), a.platform -- table aa\\n FROM Spending JOIN\\n (SELECT 'desktop' AS platform UNION\\n SELECT 'mobile' AS platform UNION\\n SELECT 'both' AS platform\\n ) a\\n ) aa\\n LEFT JOIN\\n (SELECT spend\_date, -- table bb\\n platform,\\n SUM(amount) total\_amount,\\n COUNT(user\_id) total\_users\\n FROM\\n (SELECT spend\_date,\\n user\_id,\\n (CASE COUNT(DISTINCT platform)\\n WHEN 1 THEN platform\\n WHEN 2 THEN 'both'\\n END) platform,\\n SUM(amount) amount\\n FROM Spending\\n GROUP BY spend\_date, user\_id\\n ) b\\n GROUP BY spend\_date, platform\\n ) bb\\n ON aa.platform = bb.platform AND\\n aa.spend\_date = bb.spend\_date\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1132-reported-posts-ii--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1132-reported-posts-ii--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1132. Reported Posts II | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/reported-posts-ii\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Actions\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| user\_id | int |\\n| post\_id | int |\\n| action\_date | date |\\n| action | enum |\\n| extra | varchar |\\n+---------------+---------+\\nThere is no primary key for this table, it may have duplicate rows.\\nThe action column is an ENUM type of ('view', 'like', 'reaction', 'comment', 'report', 'share').\\nThe extra column has optional information about the action such as a reason for report or a type of reaction.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Removals\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| post\_id | int |\\n| remove\_date | date |\\n+---------------+---------+\\npost\_id is the primary key of this table.\\nEach row in this table indicates that some post was removed as a result of being reported or as a result of an admin review.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the average for daily percentage of posts that got removed after being reported as spam, rounded to 2 decimal places.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Actions table:\\n+---------+---------+-------------+--------+--------+\\n| user\_id | post\_id | action\_date | action | extra |\\n+---------+---------+-------------+--------+--------+\\n| 1 | 1 | 2019-07-01 | view | null |\\n| 1 | 1 | 2019-07-01 | like | null |\\n| 1 | 1 | 2019-07-01 | share | null |\\n| 2 | 2 | 2019-07-04 | view | null |\\n| 2 | 2 | 2019-07-04 | report | spam |\\n| 3 | 4 | 2019-07-04 | view | null |\\n| 3 | 4 | 2019-07-04 | report | spam |\\n| 4 | 3 | 2019-07-02 | view | null |\\n| 4 | 3 | 2019-07-02 | report | spam |\\n| 5 | 2 | 2019-07-03 | view | null |\\n| 5 | 2 | 2019-07-03 | report | racism |\\n| 5 | 5 | 2019-07-03 | view | null |\\n| 5 | 5 | 2019-07-03 | report | racism |\\n+---------+---------+-------------+--------+--------+\\n\\nRemovals table:\\n+---------+-------------+\\n| post\_id | remove\_date |\\n+---------+-------------+\\n| 2 | 2019-07-20 |\\n| 3 | 2019-07-18 |\\n+---------+-------------+\\n\\nResult table:\\n+-----------------------+\\n| average\_daily\_percent |\\n+-----------------------+\\n| 75.00 |\\n+-----------------------+\\nThe percentage for 2019-07-04 is 50% because only one post of two spam reported posts was removed.\\nThe percentage for 2019-07-02 is 100% because one post was reported as spam and it was removed.\\nThe other days had no spam reports so the average is (50 + 100) / 2 = 75%\\nNote that the output is only one number and that we do not care about the remove dates.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-62\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-62\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`WITH t1 AS(\\nSELECT a.action\_date, (COUNT(DISTINCT r.post\_id))/(COUNT(DISTINCT a.post\_id)) AS result\\nFROM (SELECT action\_date, post\_id\\nFROM actions\\nWHERE extra = 'spam' AND action = 'report') a\\nLEFT JOIN\\nremovals r\\nON a.post\_id = r.post\_id\\nGROUP BY a.action\_date)\\n\\nSELECT ROUND(AVG(t1.result)\*100,2) AS average\_daily\_percent\\nFROM t1\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1141-user-activity-for-the-past-30-days-i--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1141-user-activity-for-the-past-30-days-i--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1141. User Activity for the Past 30 Days I | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/user-activity-for-the-past-30-days-i\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Activity\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| user\_id | int |\\n| session\_id | int |\\n| activity\_date | date |\\n| activity\_type | enum |\\n+---------------+---------+\\nThere is no primary key for this table, it may have duplicate rows.\\nThe activity\_type column is an ENUM of type ('open\_session', 'end\_session', 'scroll\_down', 'send\_message').\\nThe table shows the user activities for a social media website.\\nNote that each session belongs to exactly one user.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the daily active user count for a period of 30 days ending 2019-07-27 inclusively. A user was active on some day if he/she made at least one activity on that day.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Activity table:\\n+---------+------------+---------------+---------------+\\n| user\_id | session\_id | activity\_date | activity\_type |\\n+---------+------------+---------------+---------------+\\n| 1 | 1 | 2019-07-20 | open\_session |\\n| 1 | 1 | 2019-07-20 | scroll\_down |\\n| 1 | 1 | 2019-07-20 | end\_session |\\n| 2 | 4 | 2019-07-20 | open\_session |\\n| 2 | 4 | 2019-07-21 | send\_message |\\n| 2 | 4 | 2019-07-21 | end\_session |\\n| 3 | 2 | 2019-07-21 | open\_session |\\n| 3 | 2 | 2019-07-21 | send\_message |\\n| 3 | 2 | 2019-07-21 | end\_session |\\n| 4 | 3 | 2019-06-25 | open\_session |\\n| 4 | 3 | 2019-06-25 | end\_session |\\n+---------+------------+---------------+---------------+\\n\\nResult table:\\n+------------+--------------+\\n| day | active\_users |\\n+------------+--------------+\\n| 2019-07-20 | 2 |\\n| 2019-07-21 | 2 |\\n+------------+--------------+\\nNote that we do not care about days with zero active users.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-63\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-63\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT activity\_date AS day, COUNT(DISTINCT user\_id) AS active\_users\\nFROM activity\\nWHERE activity\_date \\u003e '2019-06-26' AND activity\_date \\u003c '2019-07-27'\\nGROUP BY activity\_date\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1142-user-activity-for-the-past-30-days-ii--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1142-user-activity-for-the-past-30-days-ii--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1142. User Activity for the Past 30 Days II | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/user-activity-for-the-past-30-days-ii\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Activity\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| user\_id | int |\\n| session\_id | int |\\n| activity\_date | date |\\n| activity\_type | enum |\\n+---------------+---------+\\nThere is no primary key for this table, it may have duplicate rows.\\nThe activity\_type column is an ENUM of type ('open\_session', 'end\_session', 'scroll\_down', 'send\_message').\\nThe table shows the user activities for a social media website.\\nNote that each session belongs to exactly one user.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the average number of sessions per user for a period of 30 days ending 2019-07-27 inclusively, rounded to 2 decimal places. The sessions we want to count for a user are those with at least one activity in that time period.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Activity table:\\n+---------+------------+---------------+---------------+\\n| user\_id | session\_id | activity\_date | activity\_type |\\n+---------+------------+---------------+---------------+\\n| 1 | 1 | 2019-07-20 | open\_session |\\n| 1 | 1 | 2019-07-20 | scroll\_down |\\n| 1 | 1 | 2019-07-20 | end\_session |\\n| 2 | 4 | 2019-07-20 | open\_session |\\n| 2 | 4 | 2019-07-21 | send\_message |\\n| 2 | 4 | 2019-07-21 | end\_session |\\n| 3 | 2 | 2019-07-21 | open\_session |\\n| 3 | 2 | 2019-07-21 | send\_message |\\n| 3 | 2 | 2019-07-21 | end\_session |\\n| 3 | 5 | 2019-07-21 | open\_session |\\n| 3 | 5 | 2019-07-21 | scroll\_down |\\n| 3 | 5 | 2019-07-21 | end\_session |\\n| 4 | 3 | 2019-06-25 | open\_session |\\n| 4 | 3 | 2019-06-25 | end\_session |\\n+---------+------------+---------------+---------------+\\n\\nResult table:\\n+---------------------------+\\n| average\_sessions\_per\_user |\\n+---------------------------+\\n| 1.33 |\\n+---------------------------+\\nUser 1 and 2 each had 1 session in the past 30 days while user 3 had 2 sessions so the average is (1 + 1 + 2) / 3 = 1.33.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-64\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-64\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT IFNULL(ROUND(AVG(a.num),2),0) AS average\_sessions\_per\_user\\nFROM (\\nSELECT COUNT(DISTINCT session\_id) AS num\\nFROM activity\\nWHERE activity\_date BETWEEN '2019-06-28' AND '2019-07-27'\\nGROUP BY user\_id) a\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1148-article-views-i--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1148-article-views-i--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1148. Article Views I | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/article-views-i\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Views\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| article\_id | int |\\n| author\_id | int |\\n| viewer\_id | int |\\n| view\_date | date |\\n+---------------+---------+\\nThere is no primary key for this table, it may have duplicate rows.\\nEach row of this table indicates that some viewer viewed an article (written by some author) on some date.\\nNote that equal author\_id and viewer\_id indicate the same person.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find all the authors that viewed at least one of their own articles, sorted in ascending order by their id.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Views table:\\n+------------+-----------+-----------+------------+\\n| article\_id | author\_id | viewer\_id | view\_date |\\n+------------+-----------+-----------+------------+\\n| 1 | 3 | 5 | 2019-08-01 |\\n| 1 | 3 | 6 | 2019-08-02 |\\n| 2 | 7 | 7 | 2019-08-01 |\\n| 2 | 7 | 6 | 2019-08-02 |\\n| 4 | 7 | 1 | 2019-07-22 |\\n| 3 | 4 | 4 | 2019-07-21 |\\n| 3 | 4 | 4 | 2019-07-21 |\\n+------------+-----------+-----------+------------+\\n\\nResult table:\\n+------+\\n| id |\\n+------+\\n| 4 |\\n| 7 |\\n+------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-65\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-65\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT DISTINCT author\_id AS id\\nFROM Views\\nWHERE author\_id = viewer\_id\\nORDER BY author\_id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1149-article-views-ii--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1149-article-views-ii--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1149. Article Views II | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/article-views-ii\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Views\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| article\_id | int |\\n| author\_id | int |\\n| viewer\_id | int |\\n| view\_date | date |\\n+---------------+---------+\\nThere is no primary key for this table, it may have duplicate rows.\\nEach row of this table indicates that some viewer viewed an article (written by some author) on some date.\\nNote that equal author\_id and viewer\_id indicate the same person.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find all the people who viewed more than one article on the same date, sorted in ascending order by their id.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Views table:\\n+------------+-----------+-----------+------------+\\n| article\_id | author\_id | viewer\_id | view\_date |\\n+------------+-----------+-----------+------------+\\n| 1 | 3 | 5 | 2019-08-01 |\\n| 3 | 4 | 5 | 2019-08-01 |\\n| 1 | 3 | 6 | 2019-08-02 |\\n| 2 | 7 | 7 | 2019-08-01 |\\n| 2 | 7 | 6 | 2019-08-02 |\\n| 4 | 7 | 1 | 2019-07-22 |\\n| 3 | 4 | 4 | 2019-07-21 |\\n| 3 | 4 | 4 | 2019-07-21 |\\n+------------+-----------+-----------+------------+\\n\\nResult table:\\n+------+\\n| id |\\n+------+\\n| 5 |\\n| 6 |\\n+------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-66\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-66\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT DISTINCT viewer\_id AS id#, COUNT(DISTINCT article\_id) AS total\\nFROM views\\nGROUP BY viewer\_id, view\_date\\nHAVING count(DISTINCT article\_id)\\u003e1\\nORDER BY 1\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1158-market-analysis-i--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1158-market-analysis-i--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1158. Market Analysis I | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/market-analysis-i\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Users\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----------------+---------+\\n| Column Name | Type |\\n+----------------+---------+\\n| user\_id | int |\\n| join\_date | date |\\n| favorite\_brand | varchar |\\n+----------------+---------+\\nuser\_id is the primary key of this table.\\nThis table has the info of the users of an online shopping website where users can sell and buy items.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Orders\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| order\_id | int |\\n| order\_date | date |\\n| item\_id | int |\\n| buyer\_id | int |\\n| seller\_id | int |\\n+---------------+---------+\\norder\_id is the primary key of this table.\\nitem\_id is a foreign key to the Items table.\\nbuyer\_id and seller\_id are foreign keys to the Users table.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Items\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| item\_id | int |\\n| item\_brand | varchar |\\n+---------------+---------+\\nitem\_id is the primary key of this table.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find for each user, the join date and the number of orders they made as a buyer in 2019.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Users table:\\n+---------+------------+----------------+\\n| user\_id | join\_date | favorite\_brand |\\n+---------+------------+----------------+\\n| 1 | 2018-01-01 | Lenovo |\\n| 2 | 2018-02-09 | Samsung |\\n| 3 | 2018-01-19 | LG |\\n| 4 | 2018-05-21 | HP |\\n+---------+------------+----------------+\\n\\nOrders table:\\n+----------+------------+---------+----------+-----------+\\n| order\_id | order\_date | item\_id | buyer\_id | seller\_id |\\n+----------+------------+---------+----------+-----------+\\n| 1 | 2019-08-01 | 4 | 1 | 2 |\\n| 2 | 2018-08-02 | 2 | 1 | 3 |\\n| 3 | 2019-08-03 | 3 | 2 | 3 |\\n| 4 | 2018-08-04 | 1 | 4 | 2 |\\n| 5 | 2018-08-04 | 1 | 3 | 4 |\\n| 6 | 2019-08-05 | 2 | 2 | 4 |\\n+----------+------------+---------+----------+-----------+\\n\\nItems table:\\n+---------+------------+\\n| item\_id | item\_brand |\\n+---------+------------+\\n| 1 | Samsung |\\n| 2 | Lenovo |\\n| 3 | LG |\\n| 4 | HP |\\n+---------+------------+\\n\\nResult table:\\n+-----------+------------+----------------+\\n| buyer\_id | join\_date | orders\_in\_2019 |\\n+-----------+------------+----------------+\\n| 1 | 2018-01-01 | 1 |\\n| 2 | 2018-02-09 | 2 |\\n| 3 | 2018-01-19 | 0 |\\n| 4 | 2018-05-21 | 0 |\\n+-----------+------------+----------------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-67\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-67\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT user\_id AS buyer\_id, join\_date, coalesce(a.orders\_in\_2019,0)\\nFROM users\\nLEFT JOIN\\n(\\nSELECT buyer\_id, coalesce(count(\*), 0) AS orders\_in\_2019\\nFROM orders o\\nJOIN users u\\nON u.user\_id = o.buyer\_id\\nWHERE extract('year' FROM order\_date) = 2019\\nGROUP BY buyer\_id) a\\nON users.user\_id = a.buyer\_id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1159-market-analysis-ii--hard---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1159-market-analysis-ii--hard---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1159. Market Analysis II | Hard | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/market-analysis-ii\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Users\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----------------+---------+\\n| Column Name | Type |\\n+----------------+---------+\\n| user\_id | int |\\n| join\_date | date |\\n| favorite\_brand | varchar |\\n+----------------+---------+\\nuser\_id is the primary key of this table.\\nThis table has the info of the users of an online shopping website where users can sell and buy items.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Orders\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| order\_id | int |\\n| order\_date | date |\\n| item\_id | int |\\n| buyer\_id | int |\\n| seller\_id | int |\\n+---------------+---------+\\norder\_id is the primary key of this table.\\nitem\_id is a foreign key to the Items table.\\nbuyer\_id and seller\_id are foreign keys to the Users table.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Items\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| item\_id | int |\\n| item\_brand | varchar |\\n+---------------+---------+\\nitem\_id is the primary key of this table.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find for each user, whether the brand of the second item (by date) they sold is their favorite brand. If a user sold less than two items, report the answer for that user as no.\\"}),(0,n.jsx)(e.p,{children:\\"It is guaranteed that no seller sold more than one item on a day.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Users table:\\n+---------+------------+----------------+\\n| user\_id | join\_date | favorite\_brand |\\n+---------+------------+----------------+\\n| 1 | 2019-01-01 | Lenovo |\\n| 2 | 2019-02-09 | Samsung |\\n| 3 | 2019-01-19 | LG |\\n| 4 | 2019-05-21 | HP |\\n+---------+------------+----------------+\\n\\nOrders table:\\n+----------+------------+---------+----------+-----------+\\n| order\_id | order\_date | item\_id | buyer\_id | seller\_id |\\n+----------+------------+---------+----------+-----------+\\n| 1 | 2019-08-01 | 4 | 1 | 2 |\\n| 2 | 2019-08-02 | 2 | 1 | 3 |\\n| 3 | 2019-08-03 | 3 | 2 | 3 |\\n| 4 | 2019-08-04 | 1 | 4 | 2 |\\n| 5 | 2019-08-04 | 1 | 3 | 4 |\\n| 6 | 2019-08-05 | 2 | 2 | 4 |\\n+----------+------------+---------+----------+-----------+\\n\\nItems table:\\n+---------+------------+\\n| item\_id | item\_brand |\\n+---------+------------+\\n| 1 | Samsung |\\n| 2 | Lenovo |\\n| 3 | LG |\\n| 4 | HP |\\n+---------+------------+\\n\\nResult table:\\n+-----------+--------------------+\\n| seller\_id | 2nd\_item\_fav\_brand |\\n+-----------+--------------------+\\n| 1 | no |\\n| 2 | yes |\\n| 3 | yes |\\n| 4 | no |\\n+-----------+--------------------+\\n\\nThe answer for the user with id 1 is no because they sold nothing.\\nThe answer for the users with id 2 and 3 is yes because the brands of their second sold items are their favorite brands.\\nThe answer for the user with id 4 is no because the brand of their second sold item is not their favorite brand.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-68\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-68\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution- 1:\\nSELECT user\_id AS seller\_id,\\n IF(ISNULL(item\_brand), \\"no\\", \\"yes\\") AS 2nd\_item\_fav\_brand\\nFROM Users LEFT JOIN\\n(SELECT seller\_id, item\_brand\\nFROM Orders INNER JOIN Items\\nON Orders.item\_id = Items.item\_id\\nWHERE (seller\_id, order\_date) IN\\n(SELECT seller\_id, MIN(order\_date) AS order\_date\\n FROM Orders\\n WHERE (seller\_id, order\_date) NOT IN\\n (SELECT seller\_id, MIN(order\_date) FROM Orders GROUP BY seller\_id)\\nGROUP BY seller\_id)\\n ) AS t\\nON Users.user\_id = t.seller\_id and favorite\_brand = item\_brand\\n\\n#Solution- 2:\\nWITH t1 AS(\\nSELECT user\_id,\\nCASE WHEN favorite\_brand = item\_brand THEN \\"yes\\"\\nELSE \\"no\\"\\nEND AS 2nd\_item\_fav\_brand\\nFROM users u LEFT JOIN\\n(SELECT o.item\_id, seller\_id, item\_brand, RANK() OVER(PARTITION BY seller\_id ORDER BY order\_date) AS rk\\nFROM orders o join items i\\nUSING (item\_id)) a\\nON u.user\_id = a.seller\_id\\nWHERE a.rk = 2)\\n\\nSELECT u.user\_id AS seller\_id, COALESCE(2nd\_item\_fav\_brand,\\"no\\") AS 2nd\_item\_fav\_brand\\nFROM users u LEFT JOIN t1\\nUSING(user\_id)\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1164-product-price-at-a-given-date--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1164-product-price-at-a-given-date--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1164. Product Price at a Given Date | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/product-price-at-a-given-date\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Products\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| product\_id | int |\\n| new\_price | int |\\n| change\_date | date |\\n+---------------+---------+\\n(product\_id, change\_date) is the primary key of this table.\\nEach row of this table indicates that the price of some product was changed to a new price at some date.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the prices of all products on 2019-08-16. Assume the price of all products before any change is 10.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Products table:\\n+------------+-----------+-------------+\\n| product\_id | new\_price | change\_date |\\n+------------+-----------+-------------+\\n| 1 | 20 | 2019-08-14 |\\n| 2 | 50 | 2019-08-14 |\\n| 1 | 30 | 2019-08-15 |\\n| 1 | 35 | 2019-08-16 |\\n| 2 | 65 | 2019-08-17 |\\n| 3 | 20 | 2019-08-18 |\\n+------------+-----------+-------------+\\n\\nResult table:\\n+------------+-------+\\n| product\_id | price |\\n+------------+-------+\\n| 2 | 50 |\\n| 1 | 35 |\\n| 3 | 10 |\\n+------------+-------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-69\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-69\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution- 1:\\nWITH t1 AS (\\nSELECT a.product\_id, new\_price\\nFROM(\\nSELECT product\_id, max(change\_date) AS date\\nFROM products\\nWHERE change\_date\\u003c='2019-08-16'\\nGROUP BY product\_id) a\\nJOIN products p\\nON a.product\_id = p.product\_id AND a.date = p.change\_date),\\n\\nt2 AS (\\nSELECT distinct product\_id\\n\\tFROM products)\\n\\nSELECT t2.product\_id, coalesce(new\_price,10) AS price\\nFROM t2 LEFT JOIN t1\\nON t2.product\_id = t1.product\_id\\nORDER BY price DESC\\n\\n#Solution- 2:\\nSELECT t1.product\_id AS product\_id, IF(ISNULL(t2.price), 10, t2.price) AS price\\nFROM\\n (SELECT distinct product\_id\\n FROM Products) AS t1 LEFT JOIN\\n (SELECT product\_id, new\_price AS price\\n FROM Products\\n WHERE (product\_id, change\_date) in\\n (SELECT product\_id, max(change\_date)\\n FROM Products\\n WHERE change\_date \\u003c='2019-08-16'\\n GROUP BY product\_id)) AS t2\\nON t1.product\_id = t2.product\_id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1173-immediate-food-delivery-i--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1173-immediate-food-delivery-i--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1173. Immediate Food Delivery I | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/immediate-food-delivery-i\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Delivery\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-----------------------------+---------+\\n| Column Name | Type |\\n+-----------------------------+---------+\\n| delivery\_id | int |\\n| customer\_id | int |\\n| order\_date | date |\\n| customer\_pref\_delivery\_date | date |\\n+-----------------------------+---------+\\ndelivery\_id is the primary key of this table.\\nThe table holds information about food delivery to customers that make orders at some date and specify a preferred delivery date (on the same order date or after it).\\n\`})}),(0,n.jsx)(e.p,{children:\\"If the preferred delivery date of the customer is the same as the order date then the order is called immediate otherwise it's called scheduled.\\"}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to find the percentage of immediate orders in the table, \\",(0,n.jsx)(e.strong,{children:\\"rounded to 2 decimal places\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Delivery table:\\n+-------------+-------------+------------+-----------------------------+\\n| delivery\_id | customer\_id | order\_date | customer\_pref\_delivery\_date |\\n+-------------+-------------+------------+-----------------------------+\\n| 1 | 1 | 2019-08-01 | 2019-08-02 |\\n| 2 | 5 | 2019-08-02 | 2019-08-02 |\\n| 3 | 1 | 2019-08-11 | 2019-08-11 |\\n| 4 | 3 | 2019-08-24 | 2019-08-26 |\\n| 5 | 4 | 2019-08-21 | 2019-08-22 |\\n| 6 | 2 | 2019-08-11 | 2019-08-13 |\\n+-------------+-------------+------------+-----------------------------+\\n\\nResult table:\\n+----------------------+\\n| immediate\_percentage |\\n+----------------------+\\n| 33.33 |\\n+----------------------+\\nThe orders with delivery id 2 and 3 are immediate while the others are scheduled.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-70\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-70\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution- 1:\\nSELECT\\nROUND(SUM(CASE WHEN order\_date=customer\_pref\_delivery\_date THEN 1 ELSE 0 END)/count(1)\*100, 2) immediate\_percentage\\nFROM Delivery;\\n\\n#Solution- 2:\\nSELECT\\nROUND(avg(CASE WHEN order\_date=customer\_pref\_delivery\_date THEN 1 ELSE 0 END)\*100,2) AS immediate\_percentage\\nFROM delivery\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1174-immediate-food-delivery-ii--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1174-immediate-food-delivery-ii--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1174. Immediate Food Delivery II | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/immediate-food-delivery-ii\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Delivery\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-----------------------------+---------+\\n| Column Name | Type |\\n+-----------------------------+---------+\\n| delivery\_id | int |\\n| customer\_id | int |\\n| order\_date | date |\\n| customer\_pref\_delivery\_date | date |\\n+-----------------------------+---------+\\ndelivery\_id is the primary key of this table.\\nThe table holds information about food delivery to customers that make orders at some date and specify a preferred delivery date (on the same order date or after it).\\n\`})}),(0,n.jsx)(e.p,{children:\\"If the preferred delivery date of the customer is the same as the order date then the order is called immediate otherwise it's called scheduled.\\"}),(0,n.jsx)(e.p,{children:\\"The first order of a customer is the order with the earliest order date that customer made. It is guaranteed that a customer has exactly one first order.\\"}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the percentage of immediate orders in the first orders of all customers, rounded to 2 decimal places.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Delivery table:\\n+-------------+-------------+------------+-----------------------------+\\n| delivery\_id | customer\_id | order\_date | customer\_pref\_delivery\_date |\\n+-------------+-------------+------------+-----------------------------+\\n| 1 | 1 | 2019-08-01 | 2019-08-02 |\\n| 2 | 2 | 2019-08-02 | 2019-08-02 |\\n| 3 | 1 | 2019-08-11 | 2019-08-12 |\\n| 4 | 3 | 2019-08-24 | 2019-08-24 |\\n| 5 | 3 | 2019-08-21 | 2019-08-22 |\\n| 6 | 2 | 2019-08-11 | 2019-08-13 |\\n| 7 | 4 | 2019-08-09 | 2019-08-09 |\\n+-------------+-------------+------------+-----------------------------+\\n\\nResult table:\\n+----------------------+\\n| immediate\_percentage |\\n+----------------------+\\n| 50.00 |\\n+----------------------+\\nThe customer id 1 has a first order with delivery id 1 and it is scheduled.\\nThe customer id 2 has a first order with delivery id 2 and it is immediate.\\nThe customer id 3 has a first order with delivery id 5 and it is scheduled.\\nThe customer id 4 has a first order with delivery id 7 and it is immediate.\\nHence, half the customers have immediate first orders.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-71\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-71\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution- 1:\\nSELECT ROUND(SUM(CASE WHEN order\_date=customer\_pref\_delivery\_date THEN 1 ELSE 0 END)/count(DISTINCT customer\_id)\*100, 2) immediate\_percentage\\nFROM Delivery\\nWHERE (customer\_id, order\_date) IN\\n (SELECT customer\_id, MIN(order\_date)\\n FROM Delivery\\n GROUP BY customer\_id)\\n#Solution- 2:\\nSELECT ROUND(AVG(CASE WHEN order\_date = customer\_pref\_delivery\_date THEN 1 ELSE 0 END)\*100,2) as\\nimmediate\_percentage\\nFROM\\n(SELECT \*,\\n RANK() OVER(PARTITION BY customer\_id ORDER BY order\_date) AS rk\\nFROM delivery) a\\nWHERE a.rk=1\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1179-reformat-department-table--easy--leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1179-reformat-department-table--easy--leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1179. Reformat Department Table | Easy | \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/reformat-department-table/\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Department\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| id | int |\\n| revenue | int |\\n| month | varchar |\\n+---------------+---------+\\n(id, month) is the primary key of this table.\\nThe table has information about the revenue of each department per month.\\nThe month has values in \[\\"Jan\\",\\"Feb\\",\\"Mar\\",\\"Apr\\",\\"May\\",\\"Jun\\",\\"Jul\\",\\"Aug\\",\\"Sep\\",\\"Oct\\",\\"Nov\\",\\"Dec\\"\].\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to reformat the table such that there is a department id column and a revenue column for each month.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Department table:\\n+------+---------+-------+\\n| id | revenue | month |\\n+------+---------+-------+\\n| 1 | 8000 | Jan |\\n| 2 | 9000 | Jan |\\n| 3 | 10000 | Feb |\\n| 1 | 7000 | Feb |\\n| 1 | 6000 | Mar |\\n+------+---------+-------+\\n\\nResult table:\\n+------+-------------+-------------+-------------+-----+-------------+\\n| id | Jan\_Revenue | Feb\_Revenue | Mar\_Revenue | ... | Dec\_Revenue |\\n+------+-------------+-------------+-------------+-----+-------------+\\n| 1 | 8000 | 7000 | 6000 | ... | null |\\n| 2 | 9000 | null | null | ... | null |\\n| 3 | null | 10000 | null | ... | null |\\n+------+-------------+-------------+-------------+-----+-------------+\\n\\nNote that the result table has 13 columns (1 for the department id + 12 for the months).\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-72\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-72\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT id,\\nSUM(IF(month='Jan', revenue, NULL)) AS Jan\_Revenue,\\nSUM(IF(month='Feb', revenue, NULL)) AS Feb\_Revenue,\\nSUM(IF(month='Mar', revenue, NULL)) AS Mar\_Revenue,\\nSUM(IF(month='Apr', revenue, NULL)) AS Apr\_Revenue,\\nSUM(IF(month='May', revenue, NULL)) AS May\_Revenue,\\nSUM(IF(month='Jun', revenue, NULL)) AS Jun\_Revenue,\\nSUM(IF(month='Jul', revenue, NULL)) AS Jul\_Revenue,\\nSUM(IF(month='Aug', revenue, NULL)) AS Aug\_Revenue,\\nSUM(IF(month='Sep', revenue, NULL)) AS Sep\_Revenue,\\nSUM(IF(month='Oct', revenue, NULL)) AS Oct\_Revenue,\\nSUM(IF(month='Nov', revenue, NULL)) AS Nov\_Revenue,\\nSUM(IF(month='Dec', revenue, NULL)) AS Dec\_Revenue\\nFROM Department\\nGroup BY id;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1193-monthly-transactions-i--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1193-monthly-transactions-i--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1193. Monthly Transactions I | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/monthly-transactions-i\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Transactions\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| id | int |\\n| country | varchar |\\n| state | enum |\\n| amount | int |\\n| trans\_date | date |\\n+---------------+---------+\\nid is the primary key of this table.\\nThe table has information about incoming transactions.\\nThe state column is an enum of type \[\\"approved\\", \\"declined\\"\].\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find for each month and country, the number of transactions and their total amount, the number of approved transactions and their total amount.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Transactions table:\\n+------+---------+----------+--------+------------+\\n| id | country | state | amount | trans\_date |\\n+------+---------+----------+--------+------------+\\n| 121 | US | approved | 1000 | 2018-12-18 |\\n| 122 | US | declined | 2000 | 2018-12-19 |\\n| 123 | US | approved | 2000 | 2019-01-01 |\\n| 124 | DE | approved | 2000 | 2019-01-07 |\\n+------+---------+----------+--------+------------+\\n\\nResult table:\\n+----------+---------+-------------+----------------+--------------------+-----------------------+\\n| month | country | trans\_count | approved\_count | trans\_total\_amount | approved\_total\_amount |\\n+----------+---------+-------------+----------------+--------------------+-----------------------+\\n| 2018-12 | US | 2 | 1 | 3000 | 1000 |\\n| 2019-01 | US | 1 | 1 | 2000 | 2000 |\\n| 2019-01 | DE | 1 | 1 | 2000 | 2000 |\\n+----------+---------+-------------+----------------+--------------------+-----------------------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-73\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-73\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`WITH t1 AS(\\nSELECT DATE\_FORMAT(trans\_date,'%Y-%m') AS month, country, COUNT(state) AS trans\_count, sum(amount) AS trans\_total\_amount\\nFROM transactions\\nGROUP BY country, month(trans\_date)),\\n\\nt2 AS (\\nSELECT DATE\_FORMAT(trans\_date,'%Y-%m') AS month, country, COUNT(state) AS approved\_count, sum(amount) AS approved\_total\_amount\\nFROM transactions\\nWHERE state = 'approved'\\nGROUP BY country, month(trans\_date))\\n\\nSELECT t1.month, t1.country, COALESCE(t1.trans\_count,0) AS trans\_count, COALESCE(t2.approved\_count,0) AS approved\_count, COALESCE(t1.trans\_total\_amount,0) AS trans\_total\_amount, COALESCE(t2.approved\_total\_amount,0) AS approved\_total\_amount\\nFROM t1 LEFT JOIN t2\\nON t1.country = t2.country and t1.month = t2.month\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1194-tournament-winners--hard---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1194-tournament-winners--hard---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1194. Tournament Winners | Hard | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/tournament-winners\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Players\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+-------+\\n| Column Name | Type |\\n+-------------+-------+\\n| player\_id | int |\\n| group\_id | int |\\n+-------------+-------+\\nplayer\_id is the primary key of this table.\\nEach row of this table indicates the group of each player.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Matches\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| match\_id | int |\\n| first\_player | int |\\n| second\_player | int |\\n| first\_score | int |\\n| second\_score | int |\\n+---------------+---------+\\nmatch\_id is the primary key of this table.\\nEach row is a record of a match, first\_player and second\_player contain the player\_id of each match.\\nfirst\_score and second\_score contain the number of points of the first\_player and second\_player respectively.\\nYou may assume that, in each match, players belongs to the same group.\\n\`})}),(0,n.jsx)(e.p,{children:\\"The winner in each group is the player who scored the maximum total points within the group. In the case of a tie, the lowest player\_id wins.\\"}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the winner in each group.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Players table:\\n+-----------+------------+\\n| player\_id | group\_id |\\n+-----------+------------+\\n| 15 | 1 |\\n| 25 | 1 |\\n| 30 | 1 |\\n| 45 | 1 |\\n| 10 | 2 |\\n| 35 | 2 |\\n| 50 | 2 |\\n| 20 | 3 |\\n| 40 | 3 |\\n+-----------+------------+\\n\\nMatches table:\\n+------------+--------------+---------------+-------------+--------------+\\n| match\_id | first\_player | second\_player | first\_score | second\_score |\\n+------------+--------------+---------------+-------------+--------------+\\n| 1 | 15 | 45 | 3 | 0 |\\n| 2 | 30 | 25 | 1 | 2 |\\n| 3 | 30 | 15 | 2 | 0 |\\n| 4 | 40 | 20 | 5 | 2 |\\n| 5 | 35 | 50 | 1 | 1 |\\n+------------+--------------+---------------+-------------+--------------+\\n\\nResult table:\\n+-----------+------------+\\n| group\_id | player\_id |\\n+-----------+------------+\\n| 1 | 15 |\\n| 2 | 35 |\\n| 3 | 40 |\\n+-----------+------------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-74\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-74\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`WITH t1 AS(\\nSELECT first\_player, SUM(first\_score) AS total\\nFROM\\n(SELECT first\_player, first\_score\\nFROM matches\\nUNION ALL\\nSELECT second\_player, second\_score\\nFROM matches) a\\nGROUP BY 1),\\n\\nt2 AS(\\nSELECT \*, COALESCE(total,0) AS score\\nFROM players p LEFT JOIN t1\\nON p.player\_id = t1.first\_player)\\n\\nSELECT group\_id, player\_id\\nFROM\\n(SELECT \*, ROW\_NUMBER() OVER(PARTITION BY group\_id ORDER BY group\_id, score DESC) AS rn\\nFROM t2) b\\nWHERE b.rn = 1\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1204-last-person-to-fit-in-the-elevator--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1204-last-person-to-fit-in-the-elevator--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1204. Last Person to Fit in the Elevator | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/last-person-to-fit-in-the-elevator\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Queue\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| person\_id | int |\\n| person\_name | varchar |\\n| weight | int |\\n| turn | int |\\n+-------------+---------+\\nperson\_id is the primary key column for this table.\\nThis table has the information about all people waiting for an elevator.\\nThe person\_id and turn columns will contain all numbers from 1 to n, where n is the number of rows in the table.\\n\`})}),(0,n.jsx)(e.p,{children:\\"The maximum weight the elevator can hold is 1000.\\"}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the person\_name of the last person who will fit in the elevator without exceeding the weight limit. It is guaranteed that the person who is first in the queue can fit in the elevator.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Queue table\\n+-----------+-------------------+--------+------+\\n| person\_id | person\_name | weight | turn |\\n+-----------+-------------------+--------+------+\\n| 5 | George Washington | 250 | 1 |\\n| 3 | John Adams | 350 | 2 |\\n| 6 | Thomas Jefferson | 400 | 3 |\\n| 2 | Will Johnliams | 200 | 4 |\\n| 4 | Thomas Jefferson | 175 | 5 |\\n| 1 | James Elephant | 500 | 6 |\\n+-----------+-------------------+--------+------+\\n\\nResult table\\n+-------------------+\\n| person\_name |\\n+-------------------+\\n| Thomas Jefferson |\\n+-------------------+\\n\\nQueue table is ordered by turn in the example for simplicity.\\nIn the example George Washington(id 5), John Adams(id 3) and Thomas Jefferson(id 6) will enter the elevator as their weight sum is 250 + 350 + 400 = 1000.\\nThomas Jefferson(id 6) is the last person to fit in the elevator because he has the last turn in these three people.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-75\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-75\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`WITH t1 AS\\n(\\nSELECT \*,\\nSUM(weight) OVER(ORDER BY turn) AS cum\_weight\\nFROM queue\\nORDER BY turn)\\n\\nSELECT t1.person\_name\\nFROM t1\\nWHERE turn = (SELECT MAX(turn) FROM t1 WHERE t1.cum\_weight\\u003c=1000)\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1205-monthly-transactions-ii--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1205-monthly-transactions-ii--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1205. Monthly Transactions II | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/monthly-transactions-ii\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Transactions\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----------------+---------+\\n| Column Name | Type |\\n+----------------+---------+\\n| id | int |\\n| country | varchar |\\n| state | enum |\\n| amount | int |\\n| trans\_date | date |\\n+----------------+---------+\\nid is the primary key of this table.\\nThe table has information about incoming transactions.\\nThe state column is an enum of type \[\\"approved\\", \\"declined\\"\].\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Chargebacks\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----------------+---------+\\n| Column Name | Type |\\n+----------------+---------+\\n| trans\_id | int |\\n| charge\_date | date |\\n+----------------+---------+\\nChargebacks contains basic information regarding incoming chargebacks from some transactions placed in Transactions table.\\ntrans\_id is a foreign key to the id column of Transactions table.\\nEach chargeback corresponds to a transaction made previously even if they were not approved.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find for each month and country, the number of approved transactions and their total amount, the number of chargebacks and their total amount.\\"}),(0,n.jsx)(e.p,{children:\\"Note: In your query, given the month and country, ignore rows with all zeros.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Transactions table:\\n+------+---------+----------+--------+------------+\\n| id | country | state | amount | trans\_date |\\n+------+---------+----------+--------+------------+\\n| 101 | US | approved | 1000 | 2019-05-18 |\\n| 102 | US | declined | 2000 | 2019-05-19 |\\n| 103 | US | approved | 3000 | 2019-06-10 |\\n| 104 | US | approved | 4000 | 2019-06-13 |\\n| 105 | US | approved | 5000 | 2019-06-15 |\\n+------+---------+----------+--------+------------+\\n\\nChargebacks table:\\n+------------+------------+\\n| trans\_id | trans\_date |\\n+------------+------------+\\n| 102 | 2019-05-29 |\\n| 101 | 2019-06-30 |\\n| 105 | 2019-09-18 |\\n+------------+------------+\\n\\nResult table:\\n+----------+---------+----------------+-----------------+-------------------+--------------------+\\n| month | country | approved\_count | approved\_amount | chargeback\_count | chargeback\_amount |\\n+----------+\\\\\`---------+----------------+-----------------+-------------------+--------------------+\\n| 2019-05 | US | 1 | 1000 | 1 | 2000 |\\n| 2019-06 | US | 3 | 12000 | 1 | 1000 |\\n| 2019-09 | US | 0 | 0 | 1 | 5000 |\\n+----------+---------+----------------+-----------------+-------------------+--------------------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-76\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-76\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nWITH t1 AS\\n(SELECT country, extract('month' FROM trans\_date), state, COUNT(\*) AS approved\_count, SUM(amount) AS approved\_amount\\nFROM transactions\\nWHERE state = 'approved'\\nGROUP BY 1, 2, 3),\\nt2 AS(\\nSELECT t.country, extract('month' FROM c.trans\_date), SUM(amount) AS chargeback\_amount, COUNT(\*) AS chargeback\_count\\nFROM chargebacks c LEFT JOIN transactions t\\nON trans\_id = id\\nGROUP BY t.country, extract('month' FROM c.trans\_date)),\\n\\nt3 AS(\\nSELECT t2.date\_part, t2.country, COALESCE(approved\_count,0) AS approved\_count, COALESCE(approved\_amount,0) AS approved\_amount, COALESCE(chargeback\_count,0) AS chargeback\_count, COALESCE(chargeback\_amount,0) AS chargeback\_amount\\nFROM t2 LEFT JOIN t1\\nON t2.date\_part = t1.date\_part AND t2.country = t1.country),\\n\\nt4 AS(\\nSELECT t1.date\_part, t1.country, COALESCE(approved\_count,0) AS approved\_count, COALESCE(approved\_amount,0) AS approved\_amount, COALESCE(chargeback\_count,0) AS chargeback\_count, COALESCE(chargeback\_amount,0) AS chargeback\_amount\\nFROM t2 RIGHT JOIN t1\\nON t2.date\_part = t1.date\_part AND t2.country = t1.country)\\n\\nSELECT \*\\nFROM t3\\nUNION\\nSELECT \*\\nFROM t4\\n\\n#Solution 2:\\nSELECT month, country,\\n SUM(CASE WHEN type='approved' THEN 1 ELSE 0 END) AS approved\_count,\\n SUM(CASE WHEN type='approved' THEN amount ELSE 0 END) AS approved\_amount,\\n SUM(CASE WHEN type='chargeback' THEN 1 ELSE 0 END) AS chargeback\_count,\\n SUM(CASE WHEN type='chargeback' THEN amount ELSE 0 END) AS chargeback\_amount\\nFROM (\\n (\\n SELECT left(t.trans\_date, 7) AS month, t.country, amount,'approved' AS type\\n FROM Transactions AS t\\n WHERE state='approved'\\n )\\n UNION ALL (\\n SELECT left(c.trans\_date, 7) AS month, t.country, amount,'chargeback' AS type\\n FROM Transactions AS t JOIN Chargebacks AS c\\n ON t.id = c.trans\_id\\n )\\n) AS tt\\nGROUP BY tt.month, tt.country\\n\\n#Solution 3:\\nSELECT month, country,\\n SUM(CASE WHEN type='approved' THEN count ELSE 0 END) AS approved\_count,\\n SUM(CASE WHEN type='approved' THEN amount ELSE 0 END) AS approved\_amount,\\n SUM(CASE WHEN type='chargeback' THEN count ELSE 0 END) AS chargeback\_count,\\n SUM(CASE WHEN type='chargeback' THEN amount ELSE 0 END) AS chargeback\_amount\\nFROM (\\n (\\n SELECT LEFT(t.trans\_date, 7) AS month, t.country,\\n COUNT(1) AS count, SUM(amount) AS amount,'approved' AS type\\n FROM Transactions AS t LEFT JOIN Chargebacks AS c\\n ON t.id = c.trans\_id\\n WHERE state='approved'\\n GROUP BY LEFT(t.trans\_date, 7), t.country\\n )\\n union (\\n SELECT LEFT(c.trans\_date, 7) AS month, t.country,\\n COUNT(1) AS count, SUM(amount) AS amount,'chargeback' AS type\\n FROM Transactions AS t JOIN Chargebacks AS c\\n ON t.id = c.trans\_id\\n GROUP BY LEFT(c.trans\_date, 7), t.country\\n )\\n) AS tt\\nGROUP BY tt.month, tt.country\\n\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1211-queries-quality-and-percentage--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1211-queries-quality-and-percentage--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1211. Queries Quality and Percentage | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/queries-quality-and-percentage\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Queries\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| query\_name | varchar |\\n| result | varchar |\\n| position | int |\\n| rating | int |\\n+-------------+---------+\\nThere is no primary key for this table, it may have duplicate rows.\\nThis table contains information collected from some queries on a database.\\nThe position column has a value from 1 to 500.\\nThe rating column has a value from 1 to 5. Query with rating less than 3 is a poor query.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"We define query \\",(0,n.jsx)(e.code,{children:\\"quality\\"}),\\" as:\\"\]}),(0,n.jsx)(e.ul,{children:(0,n.jsx)(e.li,{children:\\"The average of the ratio between query rating and its position.\\"})}),(0,n.jsxs)(e.p,{children:\[\\"We also define \\",(0,n.jsx)(e.code,{children:\\"poor query percentage\\"}),\\" as:\\"\]}),(0,n.jsx)(e.ul,{children:(0,n.jsx)(e.li,{children:\\"The percentage of all queries with rating less than 3.\\"})}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to find each \\",(0,n.jsx)(e.code,{children:\\"query\_name\\"}),\\", the \\",(0,n.jsx)(e.code,{children:\\"quality\\"}),\\" and \\",(0,n.jsx)(e.code,{children:\\"poor\_query\_percentage\\"}),\\".\\"\]}),(0,n.jsxs)(e.p,{children:\[\\"Both \\",(0,n.jsx)(e.code,{children:\\"quality\\"}),\\" and \\",(0,n.jsx)(e.code,{children:\\"poor\_query\_percentage\\"}),\\" should be rounded to \\",(0,n.jsx)(e.strong,{children:\\"2 decimal places\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Queries table:\\n+------------+-------------------+----------+--------+\\n| query\_name | result | position | rating |\\n+------------+-------------------+----------+--------+\\n| Dog | Golden Retriever | 1 | 5 |\\n| Dog | German Shepherd | 2 | 5 |\\n| Dog | Mule | 200 | 1 |\\n| Cat | Shirazi | 5 | 2 |\\n| Cat | Siamese | 3 | 3 |\\n| Cat | Sphynx | 7 | 4 |\\n+------------+-------------------+----------+--------+\\n\\nResult table:\\n+------------+---------+-----------------------+\\n| query\_name | quality | poor\_query\_percentage |\\n+------------+---------+-----------------------+\\n| Dog | 2.50 | 33.33 |\\n| Cat | 0.66 | 33.33 |\\n+------------+---------+-----------------------+\\n\\nDog queries quality is ((5 / 1) + (5 / 2) + (1 / 200)) / 3 = 2.50\\nDog queries poor\_ query\_percentage is (1 / 3) \* 100 = 33.33\\n\\nCat queries quality equals ((2 / 5) + (3 / 3) + (4 / 7)) / 3 = 0.66\\nCat queries poor\_ query\_percentage is (1 / 3) \* 100 = 33.33\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-77\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-77\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nSELECT query\_name, ROUND(SUM(rating/position)/COUNT(\*),2) AS quality,\\nROUND(AVG(CASE WHEN rating\\u003c3 THEN 1 ELSE 0 END)\*100,2) AS poor\_query\_percentage\\nFROM queries\\nGROUP BY query\_name\\n\\n#Solution 2:\\nSELECT query\_name, ROUND(AVG(rating/position), 2) AS quality,\\n ROUND(100\*SUM(CASE WHEN rating\\u003c3 THEN 1 ELSE 0 END)/COUNT(1), 2) AS poor\_query\_percentage\\nFROM Queries\\nGROUP BY query\_name\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1212-team-scores-in-football-tournament--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1212-team-scores-in-football-tournament--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1212. Team Scores in Football Tournament | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/team-scores-in-football-tournament\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Teams\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+----------+\\n| Column Name | Type |\\n+---------------+----------+\\n| team\_id | int |\\n| team\_name | varchar |\\n+---------------+----------+\\nteam\_id is the primary key of this table.\\nEach row of this table represents a single football team.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Matches\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| match\_id | int |\\n| host\_team | int |\\n| guest\_team | int |\\n| host\_goals | int |\\n| guest\_goals | int |\\n+---------------+---------+\\nmatch\_id is the primary key of this table.\\nEach row is a record of a finished match between two different teams.\\nTeams host\_team and guest\_team are represented by their IDs in the teams table (team\_id) and they scored host\_goals and guest\_goals goals respectively.\\n\`})}),(0,n.jsx)(e.p,{children:\\"You would like to compute the scores of all teams after all matches. Points are awarded as follows:\\"}),(0,n.jsxs)(e.ul,{children:\[(0,n.jsx)(e.li,{children:(0,n.jsx)(e.p,{children:\\"A team receives three points if they win a match (Score strictly more goals than the opponent team).\\"})}),(0,n.jsx)(e.li,{children:(0,n.jsx)(e.p,{children:\\"A team receives one point if they draw a match (Same number of goals as the opponent team).\\"})}),(0,n.jsxs)(e.li,{children:\[(0,n.jsx)(e.p,{children:\\"A team receives no points if they lose a match (Score less goals than the opponent team).\\"}),(0,n.jsx)(e.p,{children:\\"Write an SQL query that selects the team\_id, team\_name and num\_points of each team in the tournament after all described matches. Result table should be ordered by num\_points (decreasing order). In case of a tie, order the records by team\_id (increasing order).\\"})\]})\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Teams table:\\n+-----------+--------------+\\n| team\_id | team\_name |\\n+-----------+--------------+\\n| 10 | Leetcode FC |\\n| 20 | NewYork FC |\\n| 30 | Atlanta FC |\\n| 40 | Chicago FC |\\n| 50 | Toronto FC |\\n+-----------+--------------+\\n\\nMatches table:\\n+------------+--------------+---------------+-------------+--------------+\\n| match\_id | host\_team | guest\_team | host\_goals | guest\_goals |\\n+------------+--------------+---------------+-------------+--------------+\\n| 1 | 10 | 20 | 3 | 0 |\\n| 2 | 30 | 10 | 2 | 2 |\\n| 3 | 10 | 50 | 5 | 1 |\\n| 4 | 20 | 30 | 1 | 0 |\\n| 5 | 50 | 30 | 1 | 0 |\\n+------------+--------------+---------------+-------------+--------------+\\n\\nResult table:\\n+------------+--------------+---------------+\\n| team\_id | team\_name | num\_points |\\n+------------+--------------+---------------+\\n| 10 | Leetcode FC | 7 |\\n| 20 | NewYork FC | 3 |\\n| 50 | Toronto FC | 3 |\\n| 30 | Atlanta FC | 1 |\\n| 40 | Chicago FC | 0 |\\n+------------+--------------+---------------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-78\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-78\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nSELECT Teams.team\_id, Teams.team\_name,\\n SUM(CASE WHEN team\_id=host\_team AND host\_goals\\u003eguest\_goals THEN 3 ELSE 0 END) +\\n SUM(CASE WHEN team\_id=host\_team AND host\_goals=guest\_goals THEN 1 ELSE 0 END) +\\n SUM(CASE WHEN team\_id=guest\_team AND host\_goals\\u003cguest\_goals THEN 3 ELSE 0 END) +\\n SUM(CASE WHEN team\_id=guest\_team AND host\_goals=guest\_goals THEN 1 ELSE 0 END) AS num\_points\\nFROM Teams LEFT JOIN Matches\\nON Teams.team\_id = Matches.host\_team OR Teams.team\_id = Matches.guest\_team\\nGROUP BY Teams.team\_id\\nORDER BY num\_points DESC, Teams.team\_id ASC\\n\\n#Solution 2:\\nSELECT Teams.team\_id, Teams.team\_name, SUM(if(isnull(num\_points), 0, num\_points)) AS num\_points\\nFROM Teams LEFT JOIN\\n (\\n SELECT host\_team AS team\_id,\\n SUM(CASE WHEN host\_goals\\u003eguest\_goals THEN 3\\n WHEN host\_goals=guest\_goals THEN 1\\n ELSE 0 END) AS num\_points\\n FROM Matches\\n GROUP BY host\_team\\n UNION ALL\\n SELECT guest\_team AS team\_id,\\n SUM(CASE WHEN host\_goals\\u003cguest\_goals THEN 3\\n WHEN host\_goals=guest\_goals THEN 1\\n ELSE 0 END) AS num\_points\\n FROM Matches\\n GROUP BY guest\_team\\n ) AS tt\\nON Teams.team\_id = tt.team\_id\\nGROUP BY Teams.team\_id\\nORDER BY num\_points DESC, Teams.team\_id ASC\\n\\n#Solution 3:\\nSELECT Teams.team\_id, Teams.team\_name, IFNULL(SUM(num\_points), 0) AS num\_points\\nFROM Teams LEFT JOIN\\n (\\n SELECT host\_team AS team\_id,\\n SUM(CASE WHEN host\_goals\\u003eguest\_goals THEN 3\\n WHEN host\_goals=guest\_goals THEN 1\\n ELSE 0 END) AS num\_points\\n FROM Matches\\n GROUP BY host\_team\\n UNION ALL\\n SELECT guest\_team AS team\_id,\\n SUM(CASE WHEN host\_goals\\u003cguest\_goals THEN 3\\n WHEN host\_goals=guest\_goals THEN 1\\n ELSE 0 END) AS num\_points\\n FROM Matches\\n GROUP BY guest\_team\\n ) AS tt\\nON Teams.team\_id = tt.team\_id\\nGROUP BY Teams.team\_id\\nORDER BY num\_points DESC, Teams.team\_id ASC\\n\\n#Solution 4:\\nWITH t1 AS(\\nSELECT c.host\_id, c.host\_name, c.host\_points\\nFROM(\\nSELECT a.match\_id, a.team\_id AS host\_id, a.team\_name AS host\_name, b.team\_id AS guest\_id, b.team\_name AS guest\_name, a.host\_goals, a.guest\_goals,\\nCASE WHEN a.host\_goals \\u003e a.guest\_goals THEN 3\\n WHEN a.host\_goals = a.guest\_goals THEN 1\\n ELSE 0 END AS host\_points,\\nCASE WHEN a.host\_goals \\u003c a.guest\_goals THEN 3\\n WHEN a.host\_goals = a.guest\_goals THEN 1\\n ELSE 0 END AS guest\_points\\nFROM(\\nSELECT \*\\nFROM matches m\\nJOIN teams t\\nON t.team\_id = m.host\_team) a\\nJOIN\\n(SELECT \*\\nFROM matches m\\nJOIN teams t\\nON t.team\_id = m.guest\_team) b\\nON a.match\_id = b.match\_id) c\\nUNION ALL\\nSELECT d.guest\_id, d.guest\_name, d.guest\_points\\nFROM(\\nSELECT a.match\_id, a.team\_id AS host\_id, a.team\_name AS host\_name, b.team\_id AS guest\_id, b.team\_name AS guest\_name, a.host\_goals, a.guest\_goals,\\nCASE WHEN a.host\_goals \\u003e a.guest\_goals THEN 3\\n WHEN a.host\_goals = a.guest\_goals THEN 1\\n ELSE 0 END AS host\_points,\\nCASE WHEN a.host\_goals \\u003c a.guest\_goals THEN 3\\n WHEN a.host\_goals = a.guest\_goals THEN 1\\n ELSE 0 END AS guest\_points\\nFROM(\\nSELECT \*\\nFROM matches m\\nJOIN teams t\\nON t.team\_id = m.host\_team) a\\nJOIN\\n(SELECT \*\\nFROM matches m\\nJOIN teams t\\nON t.team\_id = m.guest\_team) b\\nON a.match\_id = b.match\_id) d)\\n\\nSELECT team\_id, team\_name, coalesce(total,0) AS num\_points\\nFROM teams t2\\nLEFT JOIN(\\nSELECT host\_id, host\_name, SUM(host\_points) AS total\\nFROM t1\\nGROUP BY host\_id, host\_name) e\\nON t2.team\_id = e.host\_id\\nORDER BY num\_points DESC, team\_id\\n\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1225-report-contiguous-dates--hard---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1225-report-contiguous-dates--hard---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1225. Report Contiguous Dates | Hard | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/report-contiguous-dates\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Failed\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+---------+\\n| Column Name | Type |\\n+--------------+---------+\\n| fail\_date | date |\\n+--------------+---------+\\nPrimary key for this table is fail\_date.\\nFailed table contains the days of failed tasks.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Succeeded\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+---------+\\n| Column Name | Type |\\n+--------------+---------+\\n| success\_date | date |\\n+--------------+---------+\\nPrimary key for this table is success\_date.\\nSucceeded table contains the days of succeeded tasks.\\n\`})}),(0,n.jsx)(e.p,{children:\\"A system is running one task every day. Every task is independent of the previous tasks. The tasks can fail or succeed.\\"}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to generate a report of period\_state for each continuous interval of days in the period from 2019-01-01 to 2019-12-31.\\"}),(0,n.jsx)(e.p,{children:\\"period\_state is 'failed' if tasks in this interval failed or 'succeeded' if tasks in this interval succeeded. Interval of days are retrieved as start\_date and end\_date.\\"}),(0,n.jsx)(e.p,{children:\\"Order result by start\_date.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Failed table:\\n+-------------------+\\n| fail\_date |\\n+-------------------+\\n| 2018-12-28 |\\n| 2018-12-29 |\\n| 2019-01-04 |\\n| 2019-01-05 |\\n+-------------------+\\n\\nSucceeded table:\\n+-------------------+\\n| success\_date |\\n+-------------------+\\n| 2018-12-30 |\\n| 2018-12-31 |\\n| 2019-01-01 |\\n| 2019-01-02 |\\n| 2019-01-03 |\\n| 2019-01-06 |\\n+-------------------+\\n\\n\\nResult table:\\n+--------------+--------------+--------------+\\n| period\_state | start\_date | end\_date |\\n+--------------+--------------+--------------+\\n| succeeded | 2019-01-01 | 2019-01-03 |\\n| failed | 2019-01-04 | 2019-01-05 |\\n| succeeded | 2019-01-06 | 2019-01-06 |\\n+--------------+--------------+--------------+\\n\\nThe report ignored the system state in 2018 as we care about the system in the period 2019-01-01 to 2019-12-31.\\nFrom 2019-01-01 to 2019-01-03 all tasks succeeded and the system state was \\"succeeded\\".\\nFrom 2019-01-04 to 2019-01-05 all tasks failed and system state was \\"failed\\".\\nFrom 2019-01-06 to 2019-01-06 all tasks succeeded and system state was \\"succeeded\\".\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-79\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-79\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nWITH t1 AS(\\nSELECT MIN(success\_date) AS start\_date, MAX(success\_date) AS end\_date, state\\nFROM(\\nSELECT \*, date\_sub(success\_date, interval ROW\_NUMBER() OVER(ORDER BY success\_date) day) AS diff, 1 AS state\\nFROM succeeded\\nWHERE success\_date BETWEEN \\"2019-01-01\\" AND \\"2019-12-31\\") a\\nGROUP BY diff),\\n\\nt2 AS(\\nSELECT MIN(fail\_date) AS start\_date, MAX(fail\_date) AS end\_date, state\\nFROM(\\nSELECT \*, date\_sub(fail\_date, interval ROW\_NUMBER() OVER(ORDER BY fail\_date) day) AS diff, 0 AS state\\nFROM failed\\nWHERE fail\_date BETWEEN \\"2019-01-01\\" AND \\"2019-12-31\\") b\\nGROUP BY diff)\\n\\n\\nSELECT\\nCASE WHEN c.state = 1 THEN \\"succeeded\\"\\nELSE \\"failed\\"\\nEND AS period\_state,start\_date, end\_date\\nFROM(\\nSELECT \*\\nFROM t1\\n\\nUNION ALL\\n\\nSELECT \*\\nFROM t2) c\\nORDER BY start\_date\\n\\n#Solution 2:\\n## First generate a list of dates\\n## succeeded 2019-01-01\\n## succeeded 2019-01-02\\n## ...\\n## failed 2019-01-04\\n## ...\\n## Add group id for contiguous ranges\\n## Notice: dates themselves are contiguous\\n##\\nSELECT period\_state, MIN(date) AS start\_date, MAX(date) AS end\_date\\nFROM (\\n SELECT period\_state, date,\\n @rank := CASE WHEN @prev = period\_state THEN @rank ELSE @rank+1 END AS rank,\\n @prev := period\_state AS prev\\n FROM (\\n SELECT 'failed' AS period\_state, fail\_date AS date\\n FROM Failed\\n WHERE fail\_date BETWEEN '2019-01-01' AND '2019-12-31'\\n UNION\\n SELECT 'succeeded' AS period\_state, success\_date AS date\\n FROM Succeeded\\n WHERE success\_date BETWEEN '2019-01-01' AND '2019-12-31') AS t,\\n (SELECT @rank:=0, @prev:='') AS rows\\n ORDER BY date ASC) AS tt\\nGROUP BY rank\\nORDER BY rank\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1241-number-of-comments-per-post--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1241-number-of-comments-per-post--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1241. Number of Comments per Post | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/number-of-comments-per-post\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Submissions\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+----------+\\n| Column Name | Type |\\n+---------------+----------+\\n| sub\_id | int |\\n| parent\_id | int |\\n+---------------+----------+\\nThere is no primary key for this table, it may have duplicate rows.\\nEach row can be a post or comment on the post.\\nparent\_id is null for posts.\\nparent\_id for comments is sub\_id for another post in the table.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find number of comments per each post.\\"}),(0,n.jsxs)(e.p,{children:\[\\"Result table should contain \\",(0,n.jsx)(e.code,{children:\\"post\_id\\"}),\\" and its corresponding \\",(0,n.jsx)(e.code,{children:\\"number\_of\_comments\\"}),\\", and must be sorted by \\",(0,n.jsx)(e.code,{children:\\"post\_id\\"}),\\" in ascending order.\\"\]}),(0,n.jsxs)(e.p,{children:\[(0,n.jsx)(e.code,{children:\\"Submissions\\"}),\\" may contain duplicate comments. You should count the number of unique comments per post.\\"\]}),(0,n.jsxs)(e.p,{children:\[(0,n.jsx)(e.code,{children:\\"Submissions\\"}),\\" may contain duplicate posts. You should treat them as one post.\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Submissions table:\\n+---------+------------+\\n| sub\_id | parent\_id |\\n+---------+------------+\\n| 1 | Null |\\n| 2 | Null |\\n| 1 | Null |\\n| 12 | Null |\\n| 3 | 1 |\\n| 5 | 2 |\\n| 3 | 1 |\\n| 4 | 1 |\\n| 9 | 1 |\\n| 10 | 2 |\\n| 6 | 7 |\\n+---------+------------+\\n\\nResult table:\\n+---------+--------------------+\\n| post\_id | number\_of\_comments |\\n+---------+--------------------+\\n| 1 | 3 |\\n| 2 | 2 |\\n| 12 | 0 |\\n+---------+--------------------+\\n\\nThe post with id 1 has three comments in the table with id 3, 4 and 9. The comment with id 3 is repeated in the table, we counted it only once.\\nThe post with id 2 has two comments in the table with id 5 and 10.\\nThe post with id 12 has no comments in the table.\\nThe comment with id 6 is a comment on a deleted post with id 7 so we ignored it.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-80\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-80\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT a.sub\_id AS post\_id, coalesce(b.number\_of\_comments,0) AS number\_of\_comments\\nFROM(\\nSELECT DISTINCT sub\_id FROM submissions WHERE parent\_id IS NULL) a\\nLEFT JOIN(\\nSELECT parent\_id, count(DISTINCT(sub\_id)) AS number\_of\_comments\\nFROM submissions\\nGROUP BY parent\_id\\nHAVING parent\_id = any(SELECT sub\_id from submissions WHERE parent\_id IS NULL)) b\\nON a.sub\_id = b.parent\_id\\nORDER BY post\_id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1251-average-selling-price--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1251-average-selling-price--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1251. Average Selling Price | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/average-selling-price\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Prices\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| product\_id | int |\\n| start\_date | date |\\n| end\_date | date |\\n| price | int |\\n+---------------+---------+\\n(product\_id, start\_date, end\_date) is the primary key for this table.\\nEach row of this table indicates the price of the product\_id in the period from start\_date to end\_date.\\nFor each product\_id there will be no two overlapping periods. That means there will be no two intersecting periods for the same product\_id.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"UnitsSold\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| product\_id | int |\\n| purchase\_date | date |\\n| units | int |\\n+---------------+---------+\\nThere is no primary key for this table, it may contain duplicates.\\nEach row of this table indicates the date, units and product\_id of each product sold.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the average selling price for each product.\\"}),(0,n.jsx)(e.p,{children:\\"average\_price should be rounded to 2 decimal places.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Prices table:\\n+------------+------------+------------+--------+\\n| product\_id | start\_date | end\_date | price |\\n+------------+------------+------------+--------+\\n| 1 | 2019-02-17 | 2019-02-28 | 5 |\\n| 1 | 2019-03-01 | 2019-03-22 | 20 |\\n| 2 | 2019-02-01 | 2019-02-20 | 15 |\\n| 2 | 2019-02-21 | 2019-03-31 | 30 |\\n+------------+------------+------------+--------+\\n\\nUnitsSold table:\\n+------------+---------------+-------+\\n| product\_id | purchase\_date | units |\\n+------------+---------------+-------+\\n| 1 | 2019-02-25 | 100 |\\n| 1 | 2019-03-01 | 15 |\\n| 2 | 2019-02-10 | 200 |\\n| 2 | 2019-03-22 | 30 |\\n+------------+---------------+-------+\\n\\nResult table:\\n+------------+---------------+\\n| product\_id | average\_price |\\n+------------+---------------+\\n| 1 | 6.96 |\\n| 2 | 16.96 |\\n+------------+---------------+\\nAverage selling price = Total Price of Product / Number of products sold.\\nAverage selling price for product 1 = ((100 \* 5) + (15 \* 20)) / 115 = 6.96\\nAverage selling price for product 2 = ((200 \* 15) + (30 \* 30)) / 230 = 16.96\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-81\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-81\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT UnitsSold.product\_id, ROUND(SUM(units\*price)/SUM(units), 2) AS average\_price\\nFROM UnitsSold INNER JOIN Prices\\nON UnitsSold.product\_id = Prices.product\_id\\nAND UnitsSold.purchase\_date BETWEEN Prices.start\_date AND Prices.end\_date\\nGROUP BY UnitsSold.product\_id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1264-page-recommendations--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1264-page-recommendations--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1264. Page Recommendations | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/page-recommendations\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Friendship\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| user1\_id | int |\\n| user2\_id | int |\\n+---------------+---------+\\n(user1\_id, user2\_id) is the primary key for this table.\\nEach row of this table indicates that there is a friendship relation between user1\_id and user2\_id.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Likes\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| user\_id | int |\\n| page\_id | int |\\n+-------------+---------+\\n(user\_id, page\_id) is the primary key for this table.\\nEach row of this table indicates that user\_id likes page\_id.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to recommend pages to the user with \\",(0,n.jsx)(e.code,{children:\\"user\_id\\"}),\\" = 1 using the pages that your friends liked. It should not recommend pages you already liked.\\"\]}),(0,n.jsx)(e.p,{children:\\"Return result table in any order without duplicates.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Friendship table:\\n+----------+----------+\\n| user1\_id | user2\_id |\\n+----------+----------+\\n| 1 | 2 |\\n| 1 | 3 |\\n| 1 | 4 |\\n| 2 | 3 |\\n| 2 | 4 |\\n| 2 | 5 |\\n| 6 | 1 |\\n+----------+----------+\\n\\nLikes table:\\n+---------+---------+\\n| user\_id | page\_id |\\n+---------+---------+\\n| 1 | 88 |\\n| 2 | 23 |\\n| 3 | 24 |\\n| 4 | 56 |\\n| 5 | 11 |\\n| 6 | 33 |\\n| 2 | 77 |\\n| 3 | 77 |\\n| 6 | 88 |\\n+---------+---------+\\n\\nResult table:\\n+------------------+\\n| recommended\_page |\\n+------------------+\\n| 23 |\\n| 24 |\\n| 56 |\\n| 33 |\\n| 77 |\\n+------------------+\\nUser one is friend with users 2, 3, 4 and 6.\\nSuggested pages are 23 from user 2, 24 from user 3, 56 from user 3 and 33 from user 6.\\nPage 77 is suggested from both user 2 and user 3.\\nPage 88 is not suggested because user 1 already likes it.\\n\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-82\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-82\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT DISTINCT page\_id AS recommended\_page\\nFROM Likes\\nWHERE user\_id IN (SELECT user2\_id\\n FROM Friendship\\n WHERE user1\_id=1\\n UNION\\n SELECT user1\_id\\n FROM Friendship\\n WHERE user2\_id=1)\\n AND page\_id NOT IN\\n (SELECT page\_id\\n FROM Likes\\n WHERE user\_id=1)\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1270-all-people-report-to-the-given-manager--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1270-all-people-report-to-the-given-manager--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1270. All People Report to the Given Manager | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/all-people-report-to-the-given-manager\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Employees\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| employee\_id | int |\\n| employee\_name | varchar |\\n| manager\_id | int |\\n+---------------+---------+\\nemployee\_id is the primary key for this table.\\nEach row of this table indicates that the employee with ID employee\_id and name employee\_name reports his work to his/her direct manager with manager\_id\\nThe head of the company is the employee with employee\_id = 1.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to find \\",(0,n.jsx)(e.code,{children:\\"employee\_id\\"}),\\" of all employees that directly or indirectly report their work to the head of the company.\\"\]}),(0,n.jsx)(e.p,{children:\\"The indirect relation between managers will not exceed 3 managers as the company is small.\\"}),(0,n.jsx)(e.p,{children:\\"Return result table in any order without duplicates.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Employees table:\\n+-------------+---------------+------------+\\n| employee\_id | employee\_name | manager\_id |\\n+-------------+---------------+------------+\\n| 1 | Boss | 1 |\\n| 3 | Alice | 3 |\\n| 2 | Bob | 1 |\\n| 4 | Daniel | 2 |\\n| 7 | Luis | 4 |\\n| 8 | Jhon | 3 |\\n| 9 | Angela | 8 |\\n| 77 | Robert | 1 |\\n+-------------+---------------+------------+\\n\\nResult table:\\n+-------------+\\n| employee\_id |\\n+-------------+\\n| 2 |\\n| 77 |\\n| 4 |\\n| 7 |\\n+-------------+\\n\\nThe head of the company is the employee with employee\_id 1.\\nThe employees with employee\_id 2 and 77 report their work directly to the head of the company.\\nThe employee with employee\_id 4 report his work indirectly to the head of the company 4 --\\u003e 2 --\\u003e 1.\\nThe employee with employee\_id 7 report his work indirectly to the head of the company 7 --\\u003e 4 --\\u003e 2 --\\u003e 1.\\nThe employees with employee\_id 3, 8 and 9 don't report their work to head of company directly or indirectly.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-83\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-83\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\n## t3: directly report to employee\_id 1\\n## t2: directly report to t3\\n## t1: directly report to t2\\nSELECT t1.employee\_id\\nFROM Employees AS t1 INNER JOIN Employees AS t2\\nON t1.manager\_id = t2.employee\_id\\nJOIN Employees AS t3\\nON t2.manager\_id = t3.employee\_id\\nWHERE t3.manager\_id = 1 AND t1.employee\_id != 1\\n\\n#Solution 2:\\nSELECT distinct employee\_id\\nFROM (\\nSELECT employee\_id\\nFROM Employees\\nWHERE manager\_id IN\\n(SELECT employee\_id\\nFROM Employees\\nWHERE manager\_id IN\\n (SELECT employee\_id\\n FROM Employees\\n WHERE manager\_id = 1))\\nUNION\\nSELECT employee\_id\\nFROM Employees\\nWHERE manager\_id IN\\n (SELECT employee\_id\\n FROM Employees\\n WHERE manager\_id = 1)\\nUNION\\nSELECT employee\_id\\n FROM Employees\\n WHERE manager\_id = 1) AS t\\nWHERE employee\_id != 1\\n\\n#Solution 3:\\nSELECT employee\_id\\nFROM employees\\nWHERE manager\_id = 1 AND employee\_id != 1\\nUNION\\nSELECT employee\_id\\nFROM employees\\nWHERE manager\_id = any (SELECT employee\_id\\nFROM employees\\nWHERE manager\_id = 1 AND employee\_id != 1)\\nUNION\\nSELECT employee\_id\\nFROM employees\\nWHERE manager\_id = any (SELECT employee\_id\\nFROM employees\\nWHERE manager\_id = any (SELECT employee\_id\\nFROM employees\\nWHERE manager\_id = 1 AND employee\_id != 1))\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1280-students-and-examinations-easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1280-students-and-examinations-easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1280. Students and Examinations| Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/students-and-examinations\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Students\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| student\_id | int |\\n| student\_name | varchar |\\n+---------------+---------+\\nstudent\_id is the primary key for this table.\\nEach row of this table contains the ID and the name of one student in the school.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Subjects\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+---------+\\n| Column Name | Type |\\n+--------------+---------+\\n| subject\_name | varchar |\\n+--------------+---------+\\nsubject\_name is the primary key for this table.\\nEach row of this table contains a name of one subject in the school.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Examinations\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+---------+\\n| Column Name | Type |\\n+--------------+---------+\\n| student\_id | int |\\n| subject\_name | varchar |\\n+--------------+---------+\\nThere is no primary key for this table. It may contain duplicates.\\nEach student from Students table takes every course from Subjects table.\\nEach row of this table indicates that a student with ID student\_id attended the exam of subject\_name.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the number of times each student attended each exam.\\"}),(0,n.jsx)(e.p,{children:\\"Order the result table by student\_id and subject\_name.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Students table:\\n+------------+--------------+\\n| student\_id | student\_name |\\n+------------+--------------+\\n| 1 | Alice |\\n| 2 | Bob |\\n| 13 | John |\\n| 6 | Alex |\\n+------------+--------------+\\nSubjects table:\\n+--------------+\\n| subject\_name |\\n+--------------+\\n| Math |\\n| Physics |\\n| Programming |\\n+--------------+\\nExaminations table:\\n+------------+--------------+\\n| student\_id | subject\_name |\\n+------------+--------------+\\n| 1 | Math |\\n| 1 | Physics |\\n| 1 | Programming |\\n| 2 | Programming |\\n| 1 | Physics |\\n| 1 | Math |\\n| 13 | Math |\\n| 13 | Programming |\\n| 13 | Physics |\\n| 2 | Math |\\n| 1 | Math |\\n+------------+--------------+\\nResult table:\\n+------------+--------------+--------------+----------------+\\n| student\_id | student\_name | subject\_name | attended\_exams |\\n+------------+--------------+--------------+----------------+\\n| 1 | Alice | Math | 3 |\\n| 1 | Alice | Physics | 2 |\\n| 1 | Alice | Programming | 1 |\\n| 2 | Bob | Math | 1 |\\n| 2 | Bob | Physics | 0 |\\n| 2 | Bob | Programming | 1 |\\n| 6 | Alex | Math | 0 |\\n| 6 | Alex | Physics | 0 |\\n| 6 | Alex | Programming | 0 |\\n| 13 | John | Math | 1 |\\n| 13 | John | Physics | 1 |\\n| 13 | John | Programming | 1 |\\n+------------+--------------+--------------+----------------+\\nThe result table should contain all students and all subjects.\\nAlice attended Math exam 3 times, Physics exam 2 times and Programming exam 1 time.\\nBob attended Math exam 1 time, Programming exam 1 time and didn't attend the Physics exam.\\nAlex didn't attend any exam.\\nJohn attended Math exam 1 time, Physics exam 1 time and Programming exam 1 time.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-84\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-84\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1: count with null\\nSELECT Students.student\_id, student\_name, Subjects.subject\_name, COUNT(Examinations.student\_id) AS attended\_exams\\nFROM Students JOIN Subjects\\nLEFT JOIN Examinations\\nON Students.student\_id = Examinations.student\_id AND Subjects.subject\_name = Examinations.subject\_name\\nGROUP BY Students.student\_id, subject\_name\\n\\n#Solution 2: using ISNULL\\nSELECT Students.student\_id, student\_name, Subjects.subject\_name, SUM(IF(ISNULL(Examinations.student\_id), 0, 1)) AS attended\_exams\\nFROM Students JOIN Subjects\\nLEFT JOIN Examinations\\nON Students.student\_id = Examinations.student\_id AND Subjects.subject\_name = Examinations.subject\_name\\nGROUP BY Students.student\_id, subject\_name\\n\\n#Solution 3: coalesce\\nSELECT a.student\_id AS student\_id, a.student\_name AS student\_name, a.subject\_name AS subject\_name, coalesce(attended\_exams,0) AS attended\_exams\\nFROM(\\nSELECT \*\\nFROM students\\nCROSS JOIN subjects\\nGROUP BY student\_id, student\_name, subject\_name) a\\nLEFT JOIN\\n(SELECT e.student\_id, student\_name, subject\_name, COUNT(\*) AS attended\_exams\\nFROM examinations e JOIN students s\\nON e.student\_id = s.student\_id\\nGROUP BY e.student\_id, student\_name, subject\_name) b\\nON a.student\_id = b.student\_id AND a.subject\_name =b.subject\_name\\nORDER BY a.student\_id ASC, a.subject\_name ASC\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1285-find-the-start-and-end-number-of-continuous-ranges--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1285-find-the-start-and-end-number-of-continuous-ranges--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1285. Find the Start and End Number of Continuous Ranges | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/find-the-start-and-end-number-of-continuous-ranges\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Logs\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| log\_id | int |\\n+---------------+---------+\\nid is the primary key for this table.\\nEach row of this table contains the ID in a log Table.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Since some IDs have been removed from Logs. Write an SQL query to find the start and end number of continuous ranges in table Logs.\\"}),(0,n.jsx)(e.p,{children:\\"Order the result table by start\_id.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Logs table:\\n+------------+\\n| log\_id |\\n+------------+\\n| 1 |\\n| 2 |\\n| 3 |\\n| 7 |\\n| 8 |\\n| 10 |\\n+------------+\\n\\nResult table:\\n+------------+--------------+\\n| start\_id | end\_id |\\n+------------+--------------+\\n| 1 | 3 |\\n| 7 | 8 |\\n| 10 | 10 |\\n+------------+--------------+\\nThe result table should contain all ranges in table Logs.\\nFrom 1 to 3 is contained in the table.\\nFrom 4 to 6 is missing in the table\\nFrom 7 to 8 is contained in the table.\\nNumber 9 is missing in the table.\\nNumber 10 is contained in the table.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-85\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-85\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nSELECT MIN(log\_id) AS start\_id, MAX(log\_id) AS end\_id\\nFROM(\\nSELECT log\_id, log\_id-ROW\_NUMBER() OVER (ORDER BY log\_id) AS rk\\nFROM logs) a\\nGROUP BY rk\\n\\n#Solution 2: Add temporary columns of rank and prev\\nSELECT MIN(log\_id) AS START\_ID, MAX(log\_id) AS END\_ID\\nFROM (SELECT log\_id,\\n @rank := CASE WHEN @prev = log\_id-1 THEN @rank ELSE @rank+1 END AS rank,\\n @prev := log\_id AS prev\\n FROM Logs,\\n (SELECT @rank:=0, @prev:=-1) AS rows) AS tt\\nGROUP BY rank\\nORDER BY START\_ID\\n\\n# Solution 3: Find the starting and ending sequences, then merge two AS one table\\n## find the starting sequence: 1, 7, 10\\n## find the ending sequence: 3, 8, 10\\n## merge them AS one table\\nSELECT start\_id, MIN(end\_id) AS end\_id\\nFROM (SELECT t1.log\_id AS start\_id\\n FROM logs AS t1 LEFT JOIN logs AS t2\\n ON t1.log\_id-1 = t2.log\_id\\n WHERE t2.log\_id IS NULL) tt\_start join\\n (SELECT t1.log\_id AS end\_id\\n FROM logs AS t1 LEFT JOIN logs AS t2\\n ON t1.log\_id+1 = t2.log\_id\\n WHERE t2.log\_id IS NULL) tt\_end\\nWHERE start\_id\\u003c=end\_id\\nGROUP BY start\_id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1294-weather-type-in-each-country--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1294-weather-type-in-each-country--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1294. Weather Type in Each Country | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/weather-type-in-each-country\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Countries\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| country\_id | int |\\n| country\_name | varchar |\\n+---------------+---------+\\ncountry\_id is the primary key for this table.\\nEach row of this table contains the ID and the name of one country.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Weather\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| country\_id | int |\\n| weather\_state | varchar |\\n| day | date |\\n+---------------+---------+\\n(country\_id, day) is the primary key for this table.\\nEach row of this table indicates the weather state in a country for one day.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the type of weather in each country for November 2019.\\"}),(0,n.jsx)(e.p,{children:\\"The type of weather is Cold if the average weather\_state is less than or equal 15, Hot if the average weather\_state is greater than or equal 25 and Warm otherwise.\\"}),(0,n.jsx)(e.p,{children:\\"Return result table in any order.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Countries table:\\n+------------+--------------+\\n| country\_id | country\_name |\\n+------------+--------------+\\n| 2 | USA |\\n| 3 | Australia |\\n| 7 | Peru |\\n| 5 | China |\\n| 8 | Morocco |\\n| 9 | Spain |\\n+------------+--------------+\\nWeather table:\\n+------------+---------------+------------+\\n| country\_id | weather\_state | day |\\n+------------+---------------+------------+\\n| 2 | 15 | 2019-11-01 |\\n| 2 | 12 | 2019-10-28 |\\n| 2 | 12 | 2019-10-27 |\\n| 3 | -2 | 2019-11-10 |\\n| 3 | 0 | 2019-11-11 |\\n| 3 | 3 | 2019-11-12 |\\n| 5 | 16 | 2019-11-07 |\\n| 5 | 18 | 2019-11-09 |\\n| 5 | 21 | 2019-11-23 |\\n| 7 | 25 | 2019-11-28 |\\n| 7 | 22 | 2019-12-01 |\\n| 7 | 20 | 2019-12-02 |\\n| 8 | 25 | 2019-11-05 |\\n| 8 | 27 | 2019-11-15 |\\n| 8 | 31 | 2019-11-25 |\\n| 9 | 7 | 2019-10-23 |\\n| 9 | 3 | 2019-12-23 |\\n+------------+---------------+------------+\\nResult table:\\n+--------------+--------------+\\n| country\_name | weather\_type |\\n+--------------+--------------+\\n| USA | Cold |\\n| Austraila | Cold |\\n| Peru | Hot |\\n| China | Warm |\\n| Morocco | Hot |\\n+--------------+--------------+\\nAverage weather\_state in USA in November is (15) / 1 = 15 so weather type is Cold.\\nAverage weather\_state in Austraila in November is (-2 + 0 + 3) / 3 = 0.333 so weather type is Cold.\\nAverage weather\_state in Peru in November is (25) / 1 = 25 so weather type is Hot.\\nAverage weather\_state in China in November is (16 + 18 + 21) / 3 = 18.333 so weather type is Warm.\\nAverage weather\_state in Morocco in November is (25 + 27 + 31) / 3 = 27.667 so weather type is Hot.\\nWe know nothing about average weather\_state in Spain in November so we don't include it in the result table.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-86\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-86\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT country\_name, CASE WHEN AVG(weather\_state) \\u003c= 15 THEN \\"Cold\\"\\n WHEN AVG(weather\_state) \\u003e= 25 THEN \\"Hot\\"\\n ELSE \\"Warm\\" END AS weather\_type\\nFROM Countries INNER JOIN Weather\\nON Countries.country\_id = Weather.country\_id\\nWHERE MONTH(day) = 11\\nGORUP BY country\_name\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1303-find-the-team-size--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1303-find-the-team-size--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1303. Find the Team Size | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/find-the-team-size\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Employee\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| employee\_id | int |\\n| team\_id | int |\\n+---------------+---------+\\nemployee\_id is the primary key for this table.\\nEach row of this table contains the ID of each employee and their respective team.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the team size of each of the employees.\\"}),(0,n.jsx)(e.p,{children:\\"Return result table in any order.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Employee Table:\\n+-------------+------------+\\n| employee\_id | team\_id |\\n+-------------+------------+\\n| 1 | 8 |\\n| 2 | 8 |\\n| 3 | 8 |\\n| 4 | 7 |\\n| 5 | 9 |\\n| 6 | 9 |\\n+-------------+------------+\\nResult table:\\n+-------------+------------+\\n| employee\_id | team\_size |\\n+-------------+------------+\\n| 1 | 3 |\\n| 2 | 3 |\\n| 3 | 3 |\\n| 4 | 1 |\\n| 5 | 2 |\\n| 6 | 2 |\\n+-------------+------------+\\nEmployees with Id 1,2,3 are part of a team with team\_id = 8.\\nEmployees with Id 4 is part of a team with team\_id = 7.\\nEmployees with Id 5,6 are part of a team with team\_id = 9.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-87\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-87\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT employee\_id, b.team\_size\\nFROM employee e\\nJOIN\\n(\\nSELECT team\_id, count(team\_id) AS team\_size\\nFROM employee\\nGROUP BY team\_id) b\\nON e.team\_id = b.team\_id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1308-running-total-for-different-genders--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1308-running-total-for-different-genders--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1308. Running Total for Different Genders | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/running-total-for-different-genders\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Scores\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| player\_name | varchar |\\n| gender | varchar |\\n| day | date |\\n| score\_points | int |\\n+---------------+---------+\\n(gender, day) is the primary key for this table.\\nA competition is held between females team and males team.\\nEach row of this table indicates that a player\_name and with gender has scored score\_point in someday.\\nGender is 'F' if the player is in females team and 'M' if the player is in males team.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the total score for each gender at each day.\\"}),(0,n.jsx)(e.p,{children:\\"Order the result table by gender and day\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Scores table:\\n+-------------+--------+------------+--------------+\\n| player\_name | gender | day | score\_points |\\n+-------------+--------+------------+--------------+\\n| Aron | F | 2020-01-01 | 17 |\\n| Alice | F | 2020-01-07 | 23 |\\n| Bajrang | M | 2020-01-07 | 7 |\\n| Khali | M | 2019-12-25 | 11 |\\n| Slaman | M | 2019-12-30 | 13 |\\n| Joe | M | 2019-12-31 | 3 |\\n| Jose | M | 2019-12-18 | 2 |\\n| Priya | F | 2019-12-31 | 23 |\\n| Priyanka | F | 2019-12-30 | 17 |\\n+-------------+--------+------------+--------------+\\nResult table:\\n+--------+------------+-------+\\n| gender | day | total |\\n+--------+------------+-------+\\n| F | 2019-12-30 | 17 |\\n| F | 2019-12-31 | 40 |\\n| F | 2020-01-01 | 57 |\\n| F | 2020-01-07 | 80 |\\n| M | 2019-12-18 | 2 |\\n| M | 2019-12-25 | 13 |\\n| M | 2019-12-30 | 26 |\\n| M | 2019-12-31 | 29 |\\n| M | 2020-01-07 | 36 |\\n+--------+------------+-------+\\nFor females team:\\nFirst day is 2019-12-30, Priyanka scored 17 points and the total score for the team is 17.\\nSecond day is 2019-12-31, Priya scored 23 points and the total score for the team is 40.\\nThird day is 2020-01-01, Aron scored 17 points and the total score for the team is 57.\\nFourth day is 2020-01-07, Alice scored 23 points and the total score for the team is 80.\\nFor males team:\\nFirst day is 2019-12-18, Jose scored 2 points and the total score for the team is 2.\\nSecond day is 2019-12-25, Khali scored 11 points and the total score for the team is 13.\\nThird day is 2019-12-30, Slaman scored 13 points and the total score for the team is 26.\\nFourth day is 2019-12-31, Joe scored 3 points and the total score for the team is 29.\\nFifth day is 2020-01-07, Bajrang scored 7 points and the total score for the team is 36.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-88\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-88\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nSELECT gender, day,\\nSUM(score\_points) OVER(PARTITION BY gender ORDER BY day) AS total\\nFROM scores\\nGROUP BY 1,2\\nORDER BY 1,2\\n\\n#Solution 2:\\nSELECT t1.gender, t1.day, SUM(t2.score\_points) AS total\\nFROM Scores AS t1 JOIN Scores AS t2\\nON t1.gender = t2.gender\\nAND t1.day\\u003e=t2.day\\nGROUP BY t1.gender, t1.day\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1321-restaurant-growth--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1321-restaurant-growth--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1321. Restaurant Growth | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/restaurant-growth\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Customer\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| customer\_id | int |\\n| name | varchar |\\n| visited\_on | date |\\n| amount | int |\\n+---------------+---------+\\n(customer\_id, visited\_on) is the primary key for this table.\\nThis table contains data about customer transactions in a restaurant.\\nvisited\_on is the date on which the customer with ID (customer\_id) have visited the restaurant.\\namount is the total paid by a customer.\\n\`})}),(0,n.jsx)(e.p,{children:\\"You are the restaurant owner and you want to analyze a possible expansion (there will be at least one customer every day).\\"}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to compute moving average of how much customer paid in a 7 days window (current day + 6 days before) .\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.p,{children:\\"Return result table ordered by visited\_on.\\"}),(0,n.jsxs)(e.p,{children:\[(0,n.jsx)(e.code,{children:\\"average\_amount\\"}),\\" should be rounded to 2 decimal places, all dates are in the format ('YYYY-MM-DD').\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`\\nCustomer table:\\n+-------------+--------------+--------------+-------------+\\n| customer\_id | name | visited\_on | amount |\\n+-------------+--------------+--------------+-------------+\\n| 1 | Jhon | 2019-01-01 | 100 |\\n| 2 | Daniel | 2019-01-02 | 110 |\\n| 3 | Jade | 2019-01-03 | 120 |\\n| 4 | Khaled | 2019-01-04 | 130 |\\n| 5 | Winston | 2019-01-05 | 110 |\\n| 6 | Elvis | 2019-01-06 | 140 |\\n| 7 | Anna | 2019-01-07 | 150 |\\n| 8 | Maria | 2019-01-08 | 80 |\\n| 9 | Jaze | 2019-01-09 | 110 |\\n| 1 | Jhon | 2019-01-10 | 130 |\\n| 3 | Jade | 2019-01-10 | 150 |\\n+-------------+--------------+--------------+-------------+\\n\\nResult table:\\n+--------------+--------------+----------------+\\n| visited\_on | amount | average\_amount |\\n+--------------+--------------+----------------+\\n| 2019-01-07 | 860 | 122.86 |\\n| 2019-01-08 | 840 | 120 |\\n| 2019-01-09 | 840 | 120 |\\n| 2019-01-10 | 1000 | 142.86 |\\n+--------------+--------------+----------------+\\n\\n1st moving average from 2019-01-01 to 2019-01-07 has an average\_amount of (100 + 110 + 120 + 130 + 110 + 140 + 150)/7 = 122.86\\n2nd moving average from 2019-01-02 to 2019-01-08 has an average\_amount of (110 + 120 + 130 + 110 + 140 + 150 + 80)/7 = 120\\n3rd moving average from 2019-01-03 to 2019-01-09 has an average\_amount of (120 + 130 + 110 + 140 + 150 + 80 + 110)/7 = 120\\n4th moving average from 2019-01-04 to 2019-01-10 has an average\_amount of (130 + 110 + 140 + 150 + 80 + 110 + 130 + 150)/7 = 142.86\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-89\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-89\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nSELECT visited\_on, SUM(amount) OVER(ORDER BY visited\_on ROWS 6 PRECEDING),\\nround(avg(amount) OVER(ORDER BY visited\_on ROWS 6 PRECEDING),2)\\nFROM\\n(\\n\\tSELECT visited\_on, SUM(amount) AS amount\\n\\tFROM customer\\n\\tGROUP BY visited\_on\\n\\tORDER BY visited\_on\\n) a\\nORDER BY visited\_on offset 6 ROWS\\n\\n#Solution 2:\\nSELECT t1.visited\_on,\\n SUM(t2.amount) AS amount,\\n round(avg(t2.amount), 2) AS average\_amount\\nFROM (\\n SELECT visited\_on, SUM(amount) AS amount\\n FROM Customer\\n GROUP BY visited\_on) AS t1\\n inner join\\n (\\n SELECT visited\_on, SUM(amount) AS amount\\n FROM Customer\\n GROUP BY visited\_on) AS t2\\nON t2.visited\_on BETWEEN DATE\_SUB(t1.visited\_on, INTERVAL 6 DAY) and t1.visited\_on\\nGROUP BY t1.visited\_on\\nHAVING COUNT(1)=7\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1322-ads-performance--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1322-ads-performance--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1322. Ads Performance | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/ads-performance\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Ads\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| ad\_id | int |\\n| user\_id | int |\\n| action | enum |\\n+---------------+---------+\\n(ad\_id, user\_id) is the primary key for this table.\\nEach row of this table contains the ID of an Ad, the ID of a user and the action taken by this user regarding this Ad.\\nThe action column is an ENUM type of ('Clicked', 'Viewed', 'Ignored').\\n\`})}),(0,n.jsx)(e.p,{children:\\"A company is running Ads and wants to calculate the performance of each Ad.\\"}),(0,n.jsx)(e.div,{children:(0,n.jsx)(i,{alt:\\"\\",src:\\"/static/images/articles/sql-questions/leetcode-sql-1322.png\\",width:\\"829\\",height:\\"75\\"})}),(0,n.jsxs)(e.p,{children:\[(0,n.jsx)(e.strong,{children:\\"Round\\"}),\\" \\",(0,n.jsx)(e.code,{children:\\"ctr\\"}),\\" to 2 decimal points. \\",(0,n.jsx)(e.strong,{children:\\"Order\\"}),\\" the result table by \\",(0,n.jsx)(e.code,{children:\\"ctr\\"}),\\" in descending order and by \\",(0,n.jsx)(e.code,{children:\\"ad\_id\\"}),\\" in ascending order in case of a tie.\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Ads table:\\n+-------+---------+---------+\\n| ad\_id | user\_id | action |\\n+-------+---------+---------+\\n| 1 | 1 | Clicked |\\n| 2 | 2 | Clicked |\\n| 3 | 3 | Viewed |\\n| 5 | 5 | Ignored |\\n| 1 | 7 | Ignored |\\n| 2 | 7 | Viewed |\\n| 3 | 5 | Clicked |\\n| 1 | 4 | Viewed |\\n| 2 | 11 | Viewed |\\n| 1 | 2 | Clicked |\\n+-------+---------+---------+\\nResult table:\\n+-------+-------+\\n| ad\_id | ctr |\\n+-------+-------+\\n| 1 | 66.67 |\\n| 3 | 50.00 |\\n| 2 | 33.33 |\\n| 5 | 0.00 |\\n+-------+-------+\\nfor ad\_id = 1, ctr = (2/(2+1)) \* 100 = 66.67\\nfor ad\_id = 2, ctr = (1/(1+2)) \* 100 = 33.33\\nfor ad\_id = 3, ctr = (1/(1+1)) \* 100 = 50.00\\nfor ad\_id = 5, ctr = 0.00, Note that ad\_id = 5 has no clicks or views.\\nNote that we don't care about Ignored Ads.\\nResult table is ordered by the ctr. in case of a tie we order them by ad\_id\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-90\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-90\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nSELECT ad\_id,\\n (CASE WHEN clicks+views = 0 THEN 0 ELSE ROUND(clicks/(clicks+views)\*100, 2) END) AS ctr\\nFROM\\n (SELECT ad\_id,\\n SUM(CASE WHEN action='Clicked' THEN 1 ELSE 0 END) AS clicks,\\n SUM(CASE WHEN action='Viewed' THEN 1 ELSE 0 END) AS views\\n FROM Ads\\n GROUP BY ad\_id) AS t\\nORDER BY ctr DESC, ad\_id ASC\\n\\n#Solution 2:\\nWITH t1 AS(\\nSELECT ad\_id, SUM(CASE WHEN action in ('Clicked') THEN 1 ELSE 0 END) AS clicked\\nFROM ads\\nGROUP BY ad\_id\\n)\\n\\n, t2 AS\\n(\\nSELECT ad\_id AS ad, SUM(CASE WHEN action in ('Clicked','Viewed') THEN 1 ELSE 0 END) AS total\\nFROM ads\\nGROUP BY ad\_id\\n)\\n\\nSELECT a.ad\_id, coalesce(round((clicked +0.0)/nullif((total +0.0),0)\*100,2),0) AS ctr\\nFROM\\n(\\nselect \*\\nFROM t1 JOIN t2\\nON t1.ad\_id = t2.ad) a\\nORDER BY ctr DESC, ad\_id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1327-list-the-products-ordered-in-a-period--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1327-list-the-products-ordered-in-a-period--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1327. List the Products Ordered in a Period | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/list-the-products-ordered-in-a-period\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Products\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+------------------+---------+\\n| Column Name | Type |\\n+------------------+---------+\\n| product\_id | int |\\n| product\_name | varchar |\\n| product\_category | varchar |\\n+------------------+---------+\\nproduct\_id is the primary key for this table.\\nThis table contains data about the company's products.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Orders\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| product\_id | int |\\n| order\_date | date |\\n| unit | int |\\n+---------------+---------+\\nThere is no primary key for this table. It may have duplicate rows.\\nproduct\_id is a foreign key to Products table.\\nunit is the number of products ordered in order\_date.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to get the names of products with greater than or equal to 100 units ordered in February 2020 and their amount.\\"}),(0,n.jsx)(e.p,{children:\\"Return result table in any order.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Products table:\\n+-------------+-----------------------+------------------+\\n| product\_id | product\_name | product\_category |\\n+-------------+-----------------------+------------------+\\n| 1 | Leetcode Solutions | Book |\\n| 2 | Jewels of Stringology | Book |\\n| 3 | HP | Laptop |\\n| 4 | Lenovo | Laptop |\\n| 5 | Leetcode Kit | T-shirt |\\n+-------------+-----------------------+------------------+\\n\\nOrders table:\\n+--------------+--------------+----------+\\n| product\_id | order\_date | unit |\\n+--------------+--------------+----------+\\n| 1 | 2020-02-05 | 60 |\\n| 1 | 2020-02-10 | 70 |\\n| 2 | 2020-01-18 | 30 |\\n| 2 | 2020-02-11 | 80 |\\n| 3 | 2020-02-17 | 2 |\\n| 3 | 2020-02-24 | 3 |\\n| 4 | 2020-03-01 | 20 |\\n| 4 | 2020-03-04 | 30 |\\n| 4 | 2020-03-04 | 60 |\\n| 5 | 2020-02-25 | 50 |\\n| 5 | 2020-02-27 | 50 |\\n| 5 | 2020-03-01 | 50 |\\n+--------------+--------------+----------+\\n\\nResult table:\\n+--------------------+---------+\\n| product\_name | unit |\\n+--------------------+---------+\\n| Leetcode Solutions | 130 |\\n| Leetcode Kit | 100 |\\n+--------------------+---------+\\n\\nProducts with product\_id = 1 is ordered in February a total of (60 + 70) = 130.\\nProducts with product\_id = 2 is ordered in February a total of 80.\\nProducts with product\_id = 3 is ordered in February a total of (2 + 3) = 5.\\nProducts with product\_id = 4 was not ordered in February 2020.\\nProducts with product\_id = 5 is ordered in February a total of (50 + 50) = 100.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-91\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-91\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nSELECT a.product\_name, a.unit\\nFROM\\n(SELECT p.product\_name, SUM(unit) AS unit\\nFROM orders o\\nJOIN products p\\nON o.product\_id = p.product\_id\\nWHERE MONTH(order\_date)=2 and YEAR(order\_date) = 2020\\nGROUP BY o.product\_id) a\\nWHERE a.unit\\u003e=100\\n\\n#Solution 2:\\nSELECT product\_name, SUM(unit) AS unit\\nFROM Products JOIN Orders\\nON Products.product\_id = Orders.product\_id\\nWHERE left(order\_date, 7) = \\"2020-02\\"\\nGROUP BY Products.product\_id\\nHAVING SUM(unit)\\u003e=100\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1336-number-of-transactions-per-visit--hard---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1336-number-of-transactions-per-visit--hard---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1336. Number of Transactions per Visit | Hard | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/number-of-transactions-per-visit\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Visits\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| user\_id | int |\\n| visit\_date | date |\\n+---------------+---------+\\n(user\_id, visit\_date) is the primary key for this table.\\nEach row of this table indicates that user\_id has visited the bank in visit\_date.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Transactions\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+------------------+---------+\\n| Column Name | Type |\\n+------------------+---------+\\n| user\_id | int |\\n| transaction\_date | date |\\n| amount | int |\\n+------------------+---------+\\nThere is no primary key for this table, it may contain duplicates.\\nEach row of this table indicates that user\_id has done a transaction of amount in transaction\_date.\\nIt is guaranteed that the user has visited the bank in the transaction\_date.(i.e The Visits table contains (user\_id, transaction\_date) in one row)\\n\`})}),(0,n.jsx)(e.p,{children:\\"A bank wants to draw a chart of the number of transactions bank visitors did in one visit to the bank and the corresponding number of visitors who have done this number of transaction in one visit.\\"}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find how many users visited the bank and didn't do any transactions, how many visited the bank and did one transaction and so on.\\"}),(0,n.jsx)(e.p,{children:\\"The result table will contain two columns:\\"}),(0,n.jsxs)(e.ul,{children:\[(0,n.jsxs)(e.li,{children:\[(0,n.jsx)(e.code,{children:\\"transactions\_count\\"}),\\" which is the number of transactions done in one visit.\\"\]}),(0,n.jsxs)(e.li,{children:\[(0,n.jsx)(e.code,{children:\\"visits\_count\\"}),\\" which is the corresponding number of users who did transactions\_count in one visit to the bank.\\",(0,n.jsx)(e.br,{}),(0,n.jsx)(e.code,{children:\\"transactions\_count\\"}),\\" should take all values from \\",(0,n.jsx)(e.code,{children:\\"0\\"}),\\" to \\",(0,n.jsx)(e.code,{children:\\"max(transactions\_count)\\"}),\\" done by one or more users.\\"\]})\]}),(0,n.jsxs)(e.p,{children:\[\\"Order the result table by \\",(0,n.jsx)(e.code,{children:\\"transactions\_count\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Visits table:\\n+---------+------------+\\n| user\_id | visit\_date |\\n+---------+------------+\\n| 1 | 2020-01-01 |\\n| 2 | 2020-01-02 |\\n| 12 | 2020-01-01 |\\n| 19 | 2020-01-03 |\\n| 1 | 2020-01-02 |\\n| 2 | 2020-01-03 |\\n| 1 | 2020-01-04 |\\n| 7 | 2020-01-11 |\\n| 9 | 2020-01-25 |\\n| 8 | 2020-01-28 |\\n+---------+------------+\\nTransactions table:\\n+---------+------------------+--------+\\n| user\_id | transaction\_date | amount |\\n+---------+------------------+--------+\\n| 1 | 2020-01-02 | 120 |\\n| 2 | 2020-01-03 | 22 |\\n| 7 | 2020-01-11 | 232 |\\n| 1 | 2020-01-04 | 7 |\\n| 9 | 2020-01-25 | 33 |\\n| 9 | 2020-01-25 | 66 |\\n| 8 | 2020-01-28 | 1 |\\n| 9 | 2020-01-25 | 99 |\\n+---------+------------------+--------+\\nResult table:\\n+--------------------+--------------+\\n| transactions\_count | visits\_count |\\n+--------------------+--------------+\\n| 0 | 4 |\\n| 1 | 5 |\\n| 2 | 0 |\\n| 3 | 1 |\\n+--------------------+--------------+\\n\* For transactions\_count = 0, The visits (1, \\"2020-01-01\\"), (2, \\"2020-01-02\\"), (12, \\"2020-01-01\\") and (19, \\"2020-01-03\\") did no transactions so visits\_count = 4.\\n\* For transactions\_count = 1, The visits (2, \\"2020-01-03\\"), (7, \\"2020-01-11\\"), (8, \\"2020-01-28\\"), (1, \\"2020-01-02\\") and (1, \\"2020-01-04\\") did one transaction so visits\_count = 5.\\n\* For transactions\_count = 2, No customers visited the bank and did two transactions so visits\_count = 0.\\n\* For transactions\_count = 3, The visit (9, \\"2020-01-25\\") did three transactions so visits\_count = 1.\\n\* For transactions\_count \\u003e= 4, No customers visited the bank and did more than three transactions so we will stop at transactions\_count = 3\\n\`})}),(0,n.jsx)(e.p,{children:\\"The chart drawn for this example is as follows:\\"}),(0,n.jsx)(e.div,{children:(0,n.jsx)(i,{alt:\\"\\",src:\\"/static/images/articles/sql-questions/leetcode-sql-1336.png\\",width:\\"1200\\",height:\\"718\\"})}),(0,n.jsxs)(e.h3,{id:\\"solution-92\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-92\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`WITH RECURSIVE t1 AS(\\n SELECT visit\_date,\\n COALESCE(num\_visits,0) as num\_visits,\\n COALESCE(num\_trans,0) as num\_trans\\n FROM ((\\n SELECT visit\_date, user\_id, COUNT(\*) as num\_visits\\n FROM visits\\n GROUP BY 1, 2) AS a\\n LEFT JOIN\\n (\\n SELECT transaction\_date,\\n user\_id,\\n count(\*) as num\_trans\\n FROM transactions\\n GROUP BY 1, 2) AS b\\n ON a.visit\_date = b.transaction\_date and a.user\_id = b.user\_id)\\n ),\\n\\n t2 AS (\\n SELECT MAX(num\_trans) as trans\\n FROM t1\\n UNION ALL\\n SELECT trans-1\\n FROM t2\\n WHERE trans \\u003e= 1)\\n\\nSELECT trans as transactions\_count,\\n COALESCE(visits\_count,0) as visits\_count\\n FROM t2 LEFT JOIN (\\n SELECT num\_trans as transactions\_count, COALESCE(COUNT(\*),0) as visits\_count\\n FROM t1\\n GROUP BY 1\\n ORDER BY 1) AS a\\nON a.transactions\_count = t2.trans\\nORDER BY 1\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1341-movie-rating--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1341-movie-rating--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1341. Movie Rating | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/movie-rating\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Movies\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| movie\_id | int |\\n| title | varchar |\\n+---------------+---------+\\nmovie\_id is the primary key for this table.\\ntitle is the name of the movie.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Users\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| user\_id | int |\\n| name | varchar |\\n+---------------+---------+\\nuser\_id is the primary key for this table.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Movie\_Rating\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| movie\_id | int |\\n| user\_id | int |\\n| rating | int |\\n| created\_at | date |\\n+---------------+---------+\\n(movie\_id, user\_id) is the primary key for this table.\\nThis table contains the rating of a movie by a user in their review.\\ncreated\_at is the user's review date.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write the following SQL query:\\"}),(0,n.jsxs)(e.ul,{children:\[(0,n.jsx)(e.li,{children:(0,n.jsxs)(e.p,{children:\[\\"Find the name of the user who has rated the greatest number of the movies.\\",(0,n.jsx)(e.br,{}),\\"In case of a tie, return lexicographically smaller user name.\\"\]})}),(0,n.jsx)(e.li,{children:(0,n.jsxs)(e.p,{children:\[\\"Find the movie name with the highest average rating in February 2020.\\",(0,n.jsx)(e.br,{}),\\"In case of a tie, return lexicographically smaller movie name..\\"\]})})\]}),(0,n.jsx)(e.p,{children:\\"Query is returned in 2 rows, the query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Movies table:\\n+-------------+--------------+\\n| movie\_id | title |\\n+-------------+--------------+\\n| 1 | Avengers |\\n| 2 | Frozen 2 |\\n| 3 | Joker |\\n+-------------+--------------+\\n\\nUsers table:\\n+-------------+--------------+\\n| user\_id | name |\\n+-------------+--------------+\\n| 1 | Daniel |\\n| 2 | Monica |\\n| 3 | Maria |\\n| 4 | James |\\n+-------------+--------------+\\n\\nMovie\_Rating table:\\n+-------------+--------------+--------------+-------------+\\n| movie\_id | user\_id | rating | created\_at |\\n+-------------+--------------+--------------+-------------+\\n| 1 | 1 | 3 | 2020-01-12 |\\n| 1 | 2 | 4 | 2020-02-11 |\\n| 1 | 3 | 2 | 2020-02-12 |\\n| 1 | 4 | 1 | 2020-01-01 |\\n| 2 | 1 | 5 | 2020-02-17 |\\n| 2 | 2 | 2 | 2020-02-01 |\\n| 2 | 3 | 2 | 2020-03-01 |\\n| 3 | 1 | 3 | 2020-02-22 |\\n| 3 | 2 | 4 | 2020-02-25 |\\n+-------------+--------------+--------------+-------------+\\n\\nResult table:\\n+--------------+\\n| results |\\n+--------------+\\n| Daniel |\\n| Frozen 2 |\\n+--------------+\\n\\nDaniel and Maria have rated 3 movies (\\"Avengers\\", \\"Frozen 2\\" and \\"Joker\\") but Daniel is smaller lexicographically.\\nFrozen 2 and Joker have a rating average of 3.5 in February but Frozen 2 is smaller lexicographically.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-93\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-93\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\n(SELECT name AS results\\nFROM Movie\_Rating JOIN Users\\nON Movie\_Rating.user\_id = Users.user\_id\\nGROUP BY Movie\_Rating.user\_id\\nORDER BY count(1) DESC, name\\nLIMIT 1)\\nUNION ALL\\n(SELECT title AS results\\nFROM Movie\_Rating JOIN Movies\\nON Movie\_Rating.movie\_id = Movies.movie\_id\\nWHERE left(created\_at, 7) = \\"2020-02\\"\\nGROUP BY Movie\_Rating.movie\_id\\nORDER BY avg(rating) DESC, title\\nLIMIT 1\\n)\\n\\n#Solution 2:\\nSELECT name AS results\\nFROM(\\n(SELECT a.name\\nFROM(\\nSELECT name, count(\*),\\nrank() OVER(ORDER BY count(\*) DESC) AS rk\\nFROM movie\_rating m\\nJOIN users u\\nON m.user\_id = u.user\_id\\nGROUP BY name, m.user\_id\\nORDER BY rk, name) a\\nLIMIT 1)\\nUNION\\n(SELECT title\\nFROM(\\nSELECT title, round(avg(rating),1) AS rnd\\nFROM movie\_rating m\\nJOIN movies u\\non m.movie\_id = u.movie\_id\\nWHERE month(created\_at) = 2\\nGROUP BY title\\nORDER BY rnd DESC, title) b\\nLIMIT 1)) AS d\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1350-students-with-invalid-departments--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1350-students-with-invalid-departments--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1350. Students With Invalid Departments | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/students-with-invalid-departments\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Departments\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| id | int |\\n| name | varchar |\\n+---------------+---------+\\nid is the primary key of this table.\\nThe table has information about the id of each department of a university.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Students\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| id | int |\\n| name | varchar |\\n| department\_id | int |\\n+---------------+---------+\\nid is the primary key of this table.\\nThe table has information about the id of each student at a university and the id of the department he/she studies at.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the id and the name of all students who are enrolled in departments that no longer exists.\\"}),(0,n.jsx)(e.p,{children:\\"Return the result table in any order.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Departments table:\\n+------+--------------------------+\\n| id | name |\\n+------+--------------------------+\\n| 1 | Electrical Engineering |\\n| 7 | Computer Engineering |\\n| 13 | Bussiness Administration |\\n+------+--------------------------+\\n\\nStudents table:\\n+------+----------+---------------+\\n| id | name | department\_id |\\n+------+----------+---------------+\\n| 23 | Alice | 1 |\\n| 1 | Bob | 7 |\\n| 5 | Jennifer | 13 |\\n| 2 | John | 14 |\\n| 4 | Jasmine | 77 |\\n| 3 | Steve | 74 |\\n| 6 | Luis | 1 |\\n| 8 | Jonathan | 7 |\\n| 7 | Daiana | 33 |\\n| 11 | Madelynn | 1 |\\n+------+----------+---------------+\\n\\nResult table:\\n+------+----------+\\n| id | name |\\n+------+----------+\\n| 2 | John |\\n| 7 | Daiana |\\n| 4 | Jasmine |\\n| 3 | Steve |\\n+------+----------+\\n\\nJohn, Daiana, Steve and Jasmine are enrolled in departments 14, 33, 74 and 77 respectively. department 14, 33, 74 and 77 doesn't exist in the Departments table.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-94\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-94\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nSELECT s.id, s.name\\nFROM students s LEFT JOIN\\ndepartments d\\nON s.department\_id = d.id\\nWHERE d.name IS NULL;\\n\\n#Solution 2:\\nSELECT id, name\\nFROM Students\\nWHERE department\_id NOT IN\\n (SELECT id FROM Departments)\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1355-activity-participants--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1355-activity-participants--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1355. Activity Participants | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/activity-participants\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Friends\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| id | int |\\n| name | varchar |\\n| activity | varchar |\\n+---------------+---------+\\nid is the id of the friend and primary key for this table.\\nname is the name of the friend.\\nactivity is the name of the activity which the friend takes part in.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Activities\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| id | int |\\n| name | varchar |\\n+---------------+---------+\\nid is the primary key for this table.\\nname is the name of the activity.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the names of all the activities with neither maximum, nor minimum number of participants.\\"}),(0,n.jsx)(e.p,{children:\\"Return the result table in any order. Each activity in table Activities is performed by any person in the table Friends.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Friends table:\\n+------+--------------+---------------+\\n| id | name | activity |\\n+------+--------------+---------------+\\n| 1 | Jonathan D. | Eating |\\n| 2 | Jade W. | Singing |\\n| 3 | Victor J. | Singing |\\n| 4 | Elvis Q. | Eating |\\n| 5 | Daniel A. | Eating |\\n| 6 | Bob B. | Horse Riding |\\n+------+--------------+---------------+\\n\\nActivities table:\\n+------+--------------+\\n| id | name |\\n+------+--------------+\\n| 1 | Eating |\\n| 2 | Singing |\\n| 3 | Horse Riding |\\n+------+--------------+\\n\\nResult table:\\n+--------------+\\n| results |\\n+--------------+\\n| Singing |\\n+--------------+\\n\\nEating activity is performed by 3 friends, maximum number of participants, (Jonathan D. , Elvis Q. and Daniel A.)\\nHorse Riding activity is performed by 1 friend, minimum number of participants, (Bob B.)\\nSinging is performed by 2 friends (Victor J. and Jade W.)\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-95\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-95\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nWITH CTE AS\\n(SELECT COUNT(\*) AS cnt, activity FROM Friends GROUP BY activity)\\n\\nSELECT activity FROM CTE\\nWHERE cnt NOT IN\\n (SELECT MAX(cnt) FROM CTE\\n UNION ALL\\n SELECT MIN(cnt) FROM CTE)\\n\\n#Solution 2:\\nWITH t1 AS(\\nSELECT MAX(a.total) AS total\\nFROM(\\n SELECT activity, COUNT(\*) AS total\\n FROM friends\\n GROUP BY activity) a\\n\\tUNION ALL\\n\\tSELECT MIN(b.total) AS low\\n FROM(\\n SELECT activity, COUNT(\*) AS total\\n FROM friends\\n GROUP BY activity) b),\\nt2 AS\\n(\\n SELECT activity, COUNT(\*) AS total\\n FROM friends\\n GROUP BY activity\\n)\\n\\nSELECT activity\\nFROM t1 RIGHT JOIN t2\\nON t1.total = t2.total\\nWHERE t1.total is null\\n\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1364-number-of-trusted-contacts-of-a-customer--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1364-number-of-trusted-contacts-of-a-customer--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1364. Number of Trusted Contacts of a Customer | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/number-of-trusted-contacts-of-a-customer\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Customers\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| customer\_id | int |\\n| customer\_name | varchar |\\n| email | varchar |\\n+---------------+---------+\\ncustomer\_id is the primary key for this table.\\nEach row of this table contains the name and the email of a customer of an online shop.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Contacts\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| user\_id | id |\\n| contact\_name | varchar |\\n| contact\_email | varchar |\\n+---------------+---------+\\n(user\_id, contact\_email) is the primary key for this table.\\nEach row of this table contains the name and email of one contact of customer with user\_id.\\nThis table contains information about people each customer trust. The contact may or may not exist in the Customers table.\\n\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Invoices\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+---------+\\n| Column Name | Type |\\n+--------------+---------+\\n| invoice\_id | int |\\n| price | int |\\n| user\_id | int |\\n+--------------+---------+\\ninvoice\_id is the primary key for this table.\\nEach row of this table indicates that user\_id has an invoice with invoice\_id and a price.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the following for each invoice\_id:\\"}),(0,n.jsxs)(e.ul,{children:\[(0,n.jsx)(e.li,{children:\\"customer\_name: The name of the customer the invoice is related to.\\"}),(0,n.jsx)(e.li,{children:\\"price: The price of the invoice.\\"}),(0,n.jsx)(e.li,{children:\\"contacts\_cnt: The number of contacts related to the customer.\\"}),(0,n.jsx)(e.li,{children:\\"trusted\_contacts\_cnt: The number of contacts related to the customer and at the same time they are customers to the shop. (i.e His/Her email exists in the Customers table.) Order the result table by invoice\_id.\\"})\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Customers table:\\n+-------------+---------------+--------------------+\\n| customer\_id | customer\_name | email |\\n+-------------+---------------+--------------------+\\n| 1 | Alice | alice@leetcode.com |\\n| 2 | Bob | bob@leetcode.com |\\n| 13 | John | john@leetcode.com |\\n| 6 | Alex | alex@leetcode.com |\\n+-------------+---------------+--------------------+\\nContacts table:\\n+-------------+--------------+--------------------+\\n| user\_id | contact\_name | contact\_email |\\n+-------------+--------------+--------------------+\\n| 1 | Bob | bob@leetcode.com |\\n| 1 | John | john@leetcode.com |\\n| 1 | Jal | jal@leetcode.com |\\n| 2 | Omar | omar@leetcode.com |\\n| 2 | Meir | meir@leetcode.com |\\n| 6 | Alice | alice@leetcode.com |\\n+-------------+--------------+--------------------+\\nInvoices table:\\n+------------+-------+---------+\\n| invoice\_id | price | user\_id |\\n+------------+-------+---------+\\n| 77 | 100 | 1 |\\n| 88 | 200 | 1 |\\n| 99 | 300 | 2 |\\n| 66 | 400 | 2 |\\n| 55 | 500 | 13 |\\n| 44 | 60 | 6 |\\n+------------+-------+---------+\\nResult table:\\n+------------+---------------+-------+--------------+----------------------+\\n| invoice\_id | customer\_name | price | contacts\_cnt | trusted\_contacts\_cnt |\\n+------------+---------------+-------+--------------+----------------------+\\n| 44 | Alex | 60 | 1 | 1 |\\n| 55 | John | 500 | 0 | 0 |\\n| 66 | Bob | 400 | 2 | 0 |\\n| 77 | Alice | 100 | 3 | 2 |\\n| 88 | Alice | 200 | 3 | 2 |\\n| 99 | Bob | 300 | 2 | 0 |\\n+------------+---------------+-------+--------------+----------------------+\\nAlice has three contacts, two of them are trusted contacts (Bob and John).\\nBob has two contacts, none of them is a trusted contact.\\nAlex has one contact and it is a trusted contact (Alice).\\nJohn doesn't have any contacts.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-96\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-96\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT invoice\_id, customer\_name, price,\\n COUNT(Contacts.user\_id) AS contacts\_cnt,\\n SUM(CASE WHEN Contacts.contact\_name IN\\n (SELECT customer\_name FROM Customers)\\n THEN 1 ELSE 0 END) AS trusted\_contacts\_cnt\\nFROM Invoices INNER JOIN Customers ON Invoices.user\_id = Customers.customer\_id\\nLEFT JOIN Contacts ON Customers.customer\_id = Contacts.user\_id\\nGROUP BY Invoices.invoice\_id, customer\_name\\nORDER BY Invoices.invoice\_id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1369-get-the-second-most-recent-activity--hard---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1369-get-the-second-most-recent-activity--hard---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1369. Get the Second Most Recent Activity | Hard | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/get-the-second-most-recent-activity\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"UserActivity\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| username | varchar |\\n| activity | varchar |\\n| startDate | Date |\\n| endDate | Date |\\n+---------------+---------+\\nThis table does not contain primary key.\\nThis table contain information about the activity performed of each user in a period of time.\\nA person with username performed a activity from startDate to endDate.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to show the second most recent activity of each user.\\"}),(0,n.jsx)(e.p,{children:\\"If the user only has one activity, return that one.\\"}),(0,n.jsx)(e.p,{children:\\"A user can't perform more than one activity at the same time. Return the result table in any order.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`UserActivity table:\\n+------------+--------------+-------------+-------------+\\n| username | activity | startDate | endDate |\\n+------------+--------------+-------------+-------------+\\n| Alice | Travel | 2020-02-12 | 2020-02-20 |\\n| Alice | Dancing | 2020-02-21 | 2020-02-23 |\\n| Alice | Travel | 2020-02-24 | 2020-02-28 |\\n| Bob | Travel | 2020-02-11 | 2020-02-18 |\\n+------------+--------------+-------------+-------------+\\n\\nResult table:\\n+------------+--------------+-------------+-------------+\\n| username | activity | startDate | endDate |\\n+------------+--------------+-------------+-------------+\\n| Alice | Dancing | 2020-02-21 | 2020-02-23 |\\n| Bob | Travel | 2020-02-11 | 2020-02-18 |\\n+------------+--------------+-------------+-------------+\\n\\nThe most recent activity of Alice is Travel from 2020-02-24 to 2020-02-28, before that she was dancing from 2020-02-21 to 2020-02-23.\\nBob only has one record, we just take that one.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-97\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-97\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`(SELECT \*\\nFROM UserActivity\\nGROUP BY username\\nHAVING count(1) = 1)\\nUNION\\n(SELECT a.\*\\nFROM UserActivity AS a LEFT JOIN UserActivity AS b\\non a.username = b.username AND a.endDate\\u003cb.endDate\\nGROUP BY a.username, a.endDate\\nHAVING count(b.endDate) = 1)\\n\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1378-replace-employee-id-with-the-unique-identifier--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1378-replace-employee-id-with-the-unique-identifier--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1378. Replace Employee ID With The Unique Identifier | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/replace-employee-id-with-the-unique-identifier\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Employees\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| id | int |\\n| name | varchar |\\n+---------------+---------+\\nid is the primary key for this table.\\nEach row of this table contains the id and the name of an employee in a company.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"EmployeeUNI\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| id | int |\\n| unique\_id | int |\\n+---------------+---------+\\n(id, unique\_id) is the primary key for this table.\\nEach row of this table contains the id and the corresponding unique id of an employee in the company.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to show the unique ID of each user, If a user doesn't have a unique ID replace just show null.\\"}),(0,n.jsx)(e.p,{children:\\"Return the result table in any order.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Employees table:\\n+----+----------+\\n| id | name |\\n+----+----------+\\n| 1 | Alice |\\n| 7 | Bob |\\n| 11 | Meir |\\n| 90 | Winston |\\n| 3 | Jonathan |\\n+----+----------+\\n\\nEmployeeUNI table:\\n+----+-----------+\\n| id | unique\_id |\\n+----+-----------+\\n| 3 | 1 |\\n| 11 | 2 |\\n| 90 | 3 |\\n+----+-----------+\\n\\nEmployeeUNI table:\\n+-----------+----------+\\n| unique\_id | name |\\n+-----------+----------+\\n| null | Alice |\\n| null | Bob |\\n| 2 | Meir |\\n| 3 | Winston |\\n| 1 | Jonathan |\\n+-----------+----------+\\n\\nAlice and Bob don't have a unique ID, We will show null instead.\\nThe unique ID of Meir is 2.\\nThe unique ID of Winston is 3.\\nThe unique ID of Jonathan is 1.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-98\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-98\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT unique\_id, name\\nFROM Employees\\nLEFT JOIN EmployeeUNI\\nON Employees.id = EmployeeUNI.id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1384-total-sales-amount-by-year--hard---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1384-total-sales-amount-by-year--hard---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1384. Total Sales Amount by Year | Hard | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/total-sales-amount-by-year\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Product\\"})\]}),(0,n.jsx)(e.p,{children:\\"+---------------+---------+ | Column Name | Type | +---------------+---------+ | product\_id | int | | product\_name | varchar | +---------------+---------+ product\_id is the primary key for this table. product\_name is the name of the product.\\"}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Sales\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------------+---------+\\n| Column Name | Type |\\n+---------------------+---------+\\n| product\_id | int |\\n| period\_start | varchar |\\n| period\_end | date |\\n| average\_daily\_sales | int |\\n+---------------------+---------+\\nproduct\_id is the primary key for this table.\\nperiod\_start and period\_end indicates the start and end date for sales period, both dates are inclusive.\\nThe average\_daily\_sales column holds the average daily sales amount of the items for the period.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to report the Total sales amount of each item for each year, with corresponding product name, product\_id, product\_name and report\_year.\\"}),(0,n.jsxs)(e.p,{children:\[\\"Dates of the sales years are between 2018 to 2020. Return the result table \\",(0,n.jsx)(e.strong,{children:\\"ordered\\"}),\\" by product\_id and report\_year.\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Product table:\\n+------------+--------------+\\n| product\_id | product\_name |\\n+------------+--------------+\\n| 1 | LC Phone |\\n| 2 | LC T-Shirt |\\n| 3 | LC Keychain |\\n+------------+--------------+\\n\\nSales table:\\n+------------+--------------+-------------+---------------------+\\n| product\_id | period\_start | period\_end | average\_daily\_sales |\\n+------------+--------------+-------------+---------------------+\\n| 1 | 2019-01-25 | 2019-02-28 | 100 |\\n| 2 | 2018-12-01 | 2020-01-01 | 10 |\\n| 3 | 2019-12-01 | 2020-01-31 | 1 |\\n+------------+--------------+-------------+---------------------+\\n\\nResult table:\\n+------------+--------------+-------------+--------------+\\n| product\_id | product\_name | report\_year | total\_amount |\\n+------------+--------------+-------------+--------------+\\n| 1 | LC Phone | 2019 | 3500 |\\n| 2 | LC T-Shirt | 2018 | 310 |\\n| 2 | LC T-Shirt | 2019 | 3650 |\\n| 2 | LC T-Shirt | 2020 | 10 |\\n| 3 | LC Keychain | 2019 | 31 |\\n| 3 | LC Keychain | 2020 | 31 |\\n+------------+--------------+-------------+--------------+\\nLC Phone was sold for the period of 2019-01-25 to 2019-02-28, and there are 35 days for this period. Total amount 35\*100 = 3500.\\nLC T-shirt was sold for the period of 2018-12-01 to 2020-01-01, and there are 31, 365, 1 days for years 2018, 2019 and 2020 respectively.\\nLC Keychain was sold for the period of 2019-12-01 to 2020-01-31, and there are 31, 31 days for years 2019 and 2020 respectively.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-99\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-99\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT\\n b.product\_id,\\n a.product\_name,\\n a.yr AS report\_year,\\n CASE\\n WHEN YEAR(b.period\_start)=YEAR(b.period\_end) AND a.yr=YEAR(b.period\_start) THEN DATEDIFF(b.period\_end,b.period\_start)+1\\n WHEN a.yr=YEAR(b.period\_start) THEN DATEDIFF(DATE\_FORMAT(b.period\_start,'%Y-12-31'),b.period\_start)+1\\n WHEN a.yr=YEAR(b.period\_end) THEN DAYOFYEAR(b.period\_end)\\n WHEN a.yr\\u003eYEAR(b.period\_start) AND a.yr\\u003cYEAR(b.period\_end) THEN 365\\n ELSE 0\\n END \* average\_daily\_sales AS total\_amount\\nFROM\\n (SELECT product\_id,product\_name,'2018' AS yr FROM Product\\n UNION\\n SELECT product\_id,product\_name,'2019' AS yr FROM Product\\n UNION\\n SELECT product\_id,product\_name,'2020' AS yr FROM Product) a\\n JOIN\\n Sales b\\n ON a.product\_id=b.product\_id\\nHAVING total\_amount \\u003e 0\\nORDER BY b.product\_id,a.yr\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1393-capital-gainloss--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1393-capital-gainloss--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1393. Capital Gain/Loss | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/capital-gainloss\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Stocks\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| stock\_name | varchar |\\n| operation | enum |\\n| operation\_day | int |\\n| price | int |\\n+---------------+---------+\\n(stock\_name, day) is the primary key for this table.\\nThe operation column is an ENUM of type ('Sell', 'Buy')\\nEach row of this table indicates that the stock which has stock\_name had an operation on the day operation\_day with the price.\\nIt is guaranteed that each 'Sell' operation for a stock has a corresponding 'Buy' operation in a previous day.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to report the Capital gain/loss for each stock.\\"}),(0,n.jsx)(e.p,{children:\\"The capital gain/loss of a stock is total gain or loss after buying and selling the stock one or many times.\\"}),(0,n.jsx)(e.p,{children:\\"Return the result table in any order.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Stocks table:\\n+---------------+-----------+---------------+--------+\\n| stock\_name | operation | operation\_day | price |\\n+---------------+-----------+---------------+--------+\\n| Leetcode | Buy | 1 | 1000 |\\n| Corona Masks | Buy | 2 | 10 |\\n| Leetcode | Sell | 5 | 9000 |\\n| Handbags | Buy | 17 | 30000 |\\n| Corona Masks | Sell | 3 | 1010 |\\n| Corona Masks | Buy | 4 | 1000 |\\n| Corona Masks | Sell | 5 | 500 |\\n| Corona Masks | Buy | 6 | 1000 |\\n| Handbags | Sell | 29 | 7000 |\\n| Corona Masks | Sell | 10 | 10000 |\\n+---------------+-----------+---------------+--------+\\n\\nResult table:\\n+---------------+-------------------+\\n| stock\_name | capital\_gain\_loss |\\n+---------------+-------------------+\\n| Corona Masks | 9500 |\\n| Leetcode | 8000 |\\n| Handbags | -23000 |\\n+---------------+-------------------+\\nLeetcode stock was bought at day 1 for 1000$ and was sold at day 5 for 9000$. Capital gain = 9000 - 1000 = 8000$.\\nHandbags stock was bought at day 17 for 30000$ and was sold at day 29 for 7000$. Capital loss = 7000 - 30000 = -23000$.\\nCorona Masks stock was bought at day 1 for 10$ and was sold at day 3 for 1010$. It was bought again at day 4 for 1000$ and was sold at day 5 for 500$. At last, it was bought at day 6 for 1000$ and was sold at day 10 for 10000$. Capital gain/loss is the sum of capital gains/losses for each ('Buy' --\\u003e 'Sell') operation = (1010 - 10) + (500 - 1000) + (10000 - 1000) = 1000 - 500 + 9000 = 9500$.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-100\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-100\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nSELECT stock\_name,\\n SUM(CASE WHEN operation = 'Buy' THEN -price ELSE price END) AS capital\_gain\_loss\\nFROM Stocks\\nGROUP BY stock\_name;\\n\\n#Solution 2:\\nSELECT stock\_name, (one-two) AS capital\_gain\_loss\\nFROM(\\n(SELECT stock\_name, sum(price) AS one\\nFROM stocks\\nWHERE operation = 'Sell'\\nGROUP BY stock\_name) b\\nLEFT JOIN\\n(SELECT stock\_name AS name, sum(price) AS two\\nFROM stocks\\nWHERE operation = 'Buy'\\nGROUP BY stock\_name) c\\nON b.stock\_name = c.name)\\nORDER BY capital\_gain\_loss DESC;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1398-customers-who-bought-products-a-and-b-but-not-c--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1398-customers-who-bought-products-a-and-b-but-not-c--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1398. Customers Who Bought Products A and B but Not C | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/customers-who-bought-products-a-and-b-but-not-c\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Customers\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------------+---------+\\n| Column Name | Type |\\n+---------------------+---------+\\n| customer\_id | int |\\n| customer\_name | varchar |\\n+---------------------+---------+\\ncustomer\_id is the primary key for this table.\\ncustomer\_name is the name of the customer.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Orders\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| order\_id | int |\\n| customer\_id | int |\\n| product\_name | varchar |\\n+---------------+---------+\\norder\_id is the primary key for this table.\\ncustomer\_id is the id of the customer who bought the product \\"product\_name\\".\\n\`})}),(0,n.jsx)(e.p,{children:'Write an SQL query to report the customer\_id and customer\_name of customers who bought products \\"A\\", \\"B\\" but did not buy the product \\"C\\" since we want to recommend them buy this product.'}),(0,n.jsx)(e.p,{children:\\"Return the result table ordered by customer\_id.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Customers table:\\n+-------------+---------------+\\n| customer\_id | customer\_name |\\n+-------------+---------------+\\n| 1 | Daniel |\\n| 2 | Diana |\\n| 3 | Elizabeth |\\n| 4 | Jhon |\\n+-------------+---------------+\\n\\nOrders table:\\n+------------+--------------+---------------+\\n| order\_id | customer\_id | product\_name |\\n+------------+--------------+---------------+\\n| 10 | 1 | A |\\n| 20 | 1 | B |\\n| 30 | 1 | D |\\n| 40 | 1 | C |\\n| 50 | 2 | A |\\n| 60 | 3 | A |\\n| 70 | 3 | B |\\n| 80 | 3 | D |\\n| 90 | 4 | C |\\n+------------+--------------+---------------+\\n\\nResult table:\\n+-------------+---------------+\\n| customer\_id | customer\_name |\\n+-------------+---------------+\\n| 3 | Elizabeth |\\n+-------------+---------------+\\nOnly the customer\_id with id 3 bought the product A and B but not the product C.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-101\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-101\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nWITH t1 AS\\n(\\nSELECT customer\_id\\nFROM orders\\nWHERE product\_name = 'B' AND\\ncustomer\_id IN (SELECT customer\_id\\nFROM orders\\nWHERE product\_name = 'A'))\\n\\nSELECT t1.customer\_id, c.customer\_name\\nFROM t1 JOIN customers c\\nON t1.customer\_id = c.customer\_id\\nWHERE t1.customer\_id != all(SELECT customer\_id\\nFROM orders\\nWHERE product\_name = 'C')\\n\\n#Solution 2:\\nSELECT \*\\nFROM Customers\\nWHERE customer\_id IN\\n (SELECT DISTINCT customer\_id\\n FROM Orders\\n WHERE product\_name = 'A'\\n ) AND\\n customer\_id IN\\n (SELECT DISTINCT customer\_id\\n FROM Orders\\n WHERE product\_name = 'B'\\n ) AND\\n customer\_id NOT IN\\n (SELECT DISTINCT customer\_id\\n FROM Orders\\n WHERE product\_name = 'C'\\n )\\nORDER BY customer\_id\\n\\n#Solution 3:\\nSELECT Customers.\*\\nFROM (\\n SELECT customer\_id,\\n sum(CASE WHEN product\_name = 'A' THEN 1 ELSE 0 END) AS product\_a,\\n sum(CASE WHEN product\_name = 'B' THEN 1 ELSE 0 END) AS product\_b\\n FROM Orders\\n GROUP BY customer\_id) AS t JOIN Customers\\nON t.customer\_id = Customers.customer\_id\\nWHERE t.product\_a\\u003e0 AND product\_b \\u003e0 AND Customers.customer\_id NOT IN (\\n SELECT DISTINCT customer\_id\\n FROM Orders\\n WHERE product\_name = 'C')\\nORDER BY Customers.customer\_id\\n\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1407-top-travellers--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1407-top-travellers--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1407. Top Travellers | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/top-travellers\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Users\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| id | int |\\n| name | varchar |\\n+---------------+---------+\\nid is the primary key for this table.\\nname is the name of the user.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Rides\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| id | int |\\n| user\_id | int |\\n| distance | int |\\n+---------------+---------+\\nid is the primary key for this table.\\ncity\_id is the id of the city who bought the product \\"product\_name\\".\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to report the distance travelled by each user.\\"}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table ordered by \\",(0,n.jsx)(e.code,{children:\\"travelled\_distance\\"}),\\" in descending order, if two or more users travelled the same distance, order them by their \\",(0,n.jsx)(e.code,{children:\\"name\\"}),\\" in ascending order.\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Users table:\\n+------+-----------+\\n| id | name |\\n+------+-----------+\\n| 1 | Alice |\\n| 2 | Bob |\\n| 3 | Alex |\\n| 4 | Donald |\\n| 7 | Lee |\\n| 13 | Jonathan |\\n| 19 | Elvis |\\n+------+-----------+\\n\\nRides table:\\n+------+----------+----------+\\n| id | user\_id | distance |\\n+------+----------+----------+\\n| 1 | 1 | 120 |\\n| 2 | 2 | 317 |\\n| 3 | 3 | 222 |\\n| 4 | 7 | 100 |\\n| 5 | 13 | 312 |\\n| 6 | 19 | 50 |\\n| 7 | 7 | 120 |\\n| 8 | 19 | 400 |\\n| 9 | 7 | 230 |\\n+------+----------+----------+\\n\\nResult table:\\n+----------+--------------------+\\n| name | travelled\_distance |\\n+----------+--------------------+\\n| Elvis | 450 |\\n| Lee | 450 |\\n| Bob | 317 |\\n| Jonathan | 312 |\\n| Alex | 222 |\\n| Alice | 120 |\\n| Donald | 0 |\\n+----------+--------------------+\\nElvis and Lee travelled 450 miles, Elvis is the top traveller as his name is alphabetically smaller than Lee.\\nBob, Jonathan, Alex and Alice have only one ride and we just order them by the total distances of the ride.\\nDonald didn't have any rides, the distance travelled by him is 0.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-102\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-102\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nSELECT U.name AS name, COALESCE(SUM(R.distance),0) AS travelled\_distance\\nFROM Users U LEFT JOIN Rides R\\nON R.user\_id = U.id\\nGROUP BY name\\nORDER BY travelled\_distance DESC, name\\n\\n#Solution 2:\\nSELECT name, IFNULL(SUM(distance), 0) AS travelled\_distance\\nFROM Users LEFT JOIN Rides\\nON Users.id = Rides.user\_id\\nGROUP BY Users.id\\nORDER BY travelled\_distance DESC, name\\n\\n#Solution 3:\\nSELECT name, SUM(IF(ISNULL(distance), 0, distance)) AS travelled\_distance\\nFROM Users LEFT JOIN Rides\\nON Users.id = Rides.user\_id\\nGROUP BY Users.id\\nORDER BY travelled\_distance DESC, name\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1412-find-the-quiet-students-in-all-exams--hard---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1412-find-the-quiet-students-in-all-exams--hard---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1412. Find the Quiet Students in All Exams | Hard | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/find-the-quiet-students-in-all-exams\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Student\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------------+---------+\\n| Column Name | Type |\\n+---------------------+---------+\\n| student\_id | int |\\n| student\_name | varchar |\\n+---------------------+---------+\\nstudent\_id is the primary key for this table.\\nstudent\_name is the name of the student.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Exam\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| exam\_id | int |\\n| student\_id | int |\\n| score | int |\\n+---------------+---------+\\n(exam\_id, student\_id) is the primary key for this table.\\nStudent with student\_id got score points in exam with id exam\_id.\\n\`})}),(0,n.jsx)(e.p,{children:\`A \\"quite\\" student is the one who took at least one exam and didn't score neither the high score nor the low score.\`}),(0,n.jsxs)(e.p,{children:\['Write an SQL query to report the students (student\_id, student\_name) being \\"quiet\\" in ',(0,n.jsx)(e.strong,{children:\\"ALL\\"}),\\" exams.\\"\]}),(0,n.jsx)(e.p,{children:\\"Don't return the student who has never taken any exam. Return the result table ordered by student\_id.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Student table:\\n+-------------+---------------+\\n| student\_id | student\_name |\\n+-------------+---------------+\\n| 1 | Daniel |\\n| 2 | Jade |\\n| 3 | Stella |\\n| 4 | Jonathan |\\n| 5 | Will |\\n+-------------+---------------+\\n\\nExam table:\\n+------------+--------------+-----------+\\n| exam\_id | student\_id | score |\\n+------------+--------------+-----------+\\n| 10 | 1 | 70 |\\n| 10 | 2 | 80 |\\n| 10 | 3 | 90 |\\n| 20 | 1 | 80 |\\n| 30 | 1 | 70 |\\n| 30 | 3 | 80 |\\n| 30 | 4 | 90 |\\n| 40 | 1 | 60 |\\n| 40 | 2 | 70 |\\n| 40 | 4 | 80 |\\n+------------+--------------+-----------+\\n\\nResult table:\\n+-------------+---------------+\\n| student\_id | student\_name |\\n+-------------+---------------+\\n| 2 | Jade |\\n+-------------+---------------+\\n\\nFor exam 1: Student 1 and 3 hold the lowest and high score respectively.\\nFor exam 2: Student 1 hold both highest and lowest score.\\nFor exam 3 and 4: Studnet 1 and 4 hold the lowest and high score respectively.\\nStudent 2 and 5 have never got the highest or lowest in any of the exam.\\nSince student 5 is not taking any exam, he is excluded from the result.\\nSo, we only return the information of Student 2.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-103\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-103\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nWITH t1 AS(\\nSELECT student\_id\\nFROM\\n(SELECT \*,\\nMIN(score) OVER(PARTITION BY exam\_id) AS least,\\nMAX(score) OVER(PARTITION BY exam\_id) AS most\\nFROM exam) a\\nWHERE least = score OR most = score)\\n\\nSELECT DISTINCT student\_id, student\_name\\nFROM exam JOIN student\\nUSING (student\_id)\\nWHERE student\_id != all(SELECT student\_id FROM t1)\\norder by 1\\n\\n#Solution 2:\\nSELECT DISTINCT Student.\*\\nFROM Student INNER JOIN Exam\\nON Student.student\_id = Exam.student\_id\\nWHERE student.student\_id NOT IN\\n (SELECT e1.student\_id\\n FROM Exam AS e1 INNER JOIN\\n (SELECT exam\_id, MIN(score) AS min\_score, MAX(score) AS max\_score\\n FROM Exam\\n GROUP BY exam\_id) AS e2\\n ON e1.exam\_id = e2.exam\_id\\n WHERE e1.score = e2.min\_score OR e1.score = e2.max\_score)\\nORDER BY student\_id\\n\\n\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1421-npv-queries--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1421-npv-queries--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1421. NPV Queries | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/npv-queries\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"NPV\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| id | int |\\n| year | int |\\n| npv | int |\\n+---------------+---------+\\n(id, year) is the primary key of this table.\\nThe table has information about the id and the year of each inventory and the corresponding net present value.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Queries\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| id | int |\\n| year | int |\\n+---------------+---------+\\n(id, year) is the primary key of this table.\\nThe table has information about the id and the year of each inventory query.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the npv of all each query of queries table.\\"}),(0,n.jsx)(e.p,{children:\\"Return the result table in any order.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`NPV table:\\n+------+--------+--------+\\n| id | year | npv |\\n+------+--------+--------+\\n| 1 | 2018 | 100 |\\n| 7 | 2020 | 30 |\\n| 13 | 2019 | 40 |\\n| 1 | 2019 | 113 |\\n| 2 | 2008 | 121 |\\n| 3 | 2009 | 12 |\\n| 11 | 2020 | 99 |\\n| 7 | 2019 | 0 |\\n+------+--------+--------+\\n\\nQueries table:\\n+------+--------+\\n| id | year |\\n+------+--------+\\n| 1 | 2019 |\\n| 2 | 2008 |\\n| 3 | 2009 |\\n| 7 | 2018 |\\n| 7 | 2019 |\\n| 7 | 2020 |\\n| 13 | 2019 |\\n+------+--------+\\n\\nResult table:\\n+------+--------+--------+\\n| id | year | npv |\\n+------+--------+--------+\\n| 1 | 2019 | 113 |\\n| 2 | 2008 | 121 |\\n| 3 | 2009 | 12 |\\n| 7 | 2018 | 0 |\\n| 7 | 2019 | 0 |\\n| 7 | 2020 | 30 |\\n| 13 | 2019 | 40 |\\n+------+--------+--------+\\n\\nThe npv value of (7, 2018) is not present in the NPV table, we consider it 0.\\nThe npv values of all other queries can be found in the NPV table.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-104\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-104\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nSELECT q.id, q.year, COALESCE(n.npv,0) AS npv\\nFROM queries q\\nLEFT JOIN npv n\\nON q.id = n.id AND q.year=n.year\\n\\n#Solution 2:\\nSELECT Queries.\*, IF(ISNULL(npv), 0, npv) AS npv\\nFROM Queries LEFT JOIN NPV\\nON Queries.id = NPV.id AND Queries.year = NPV.year\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1435-create-a-session-bar-chart--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1435-create-a-session-bar-chart--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1435. Create a Session Bar Chart | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/create-a-session-bar-chart\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Sessions\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------------+---------+\\n| Column Name | Type |\\n+---------------------+---------+\\n| session\_id | int |\\n| duration | int |\\n+---------------------+---------+\\nsession\_id is the primary key for this table.\\nduration is the time in seconds that a user has visited the application.\\n\`})}),(0,n.jsx)(e.p,{children:'You want to know how long a user visits your application. You decided to create bins of \\"\[0-5\\u003e\\", \\"\[5-10\\u003e\\", \\"\[10-15\\u003e\\" and \\"15 minutes or more\\" and count the number of sessions on it.'}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to report the (bin, total) in \\",(0,n.jsx)(e.strong,{children:\\"any\\"}),\\" order.\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`The query result format is in the following example.\\n\\nSessions table:\\n+-------------+---------------+\\n| session\_id | duration |\\n+-------------+---------------+\\n| 1 | 30 |\\n| 2 | 299 |\\n| 3 | 340 |\\n| 4 | 580 |\\n| 5 | 1000 |\\n+-------------+---------------+\\n\\nResult table:\\n+--------------+--------------+\\n| bin | total |\\n+--------------+--------------+\\n| \[0-5\\u003e | 3 |\\n| \[5-10\\u003e | 1 |\\n| \[10-15\\u003e | 0 |\\n| 15 or more | 1 |\\n+--------------+--------------+\\n\\nFor session\_id 1, 2 and 3 have a duration greater or equal than 0 minutes and less than 5 minutes.\\nFor session\_id 4 has a duration greater or equal than 5 minutes and less than 10 minutes.\\nThere are no session with a duration greater or equial than 10 minutes and less than 15 minutes.\\nFor session\_id 5 has a duration greater or equal than 15 minutes.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-105\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-105\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\n(SELECT '\[0-5\\u003e' AS bin,\\n SUM(CASE WHEN duration/60 \\u003c 5 THEN 1 ELSE 0 END) AS total FROM Sessions)\\n UNION\\n(SELECT '\[5-10\\u003e' AS bin,\\n SUM(CASE WHEN ((duration/60 \\u003e= 5) AND (duration/60 \\u003c 10)) THEN 1 ELSE 0 END) AS total FROM Sessions)\\n UNION\\n(SELECT '\[10-15\\u003e' AS bin,\\n SUM(CASE WHEN ((duration/60 \\u003e= 10) AND (duration/60 \\u003c 15)) THEN 1 ELSE 0 END) AS total FROM Sessions)\\n UNION\\n(SELECT '15 or more' AS bin,\\n SUM(CASE WHEN duration/60 \\u003e= 15 THEN 1 ELSE 0 END) AS total FROM Sessions)\\n\\n#Solution 2:\\nSELECT '\[0-5\\u003e' AS bin, count(1) AS total\\nFROM Sessions\\nWHERE duration\\u003e=0 AND duration \\u003c 300\\nUNION\\nSELECT '\[5-10\\u003e' AS bin, count(1) AS total\\nFROM Sessions\\nWHERE duration\\u003e=300 AND duration \\u003c 600\\nUNION\\nSELECT '\[10-15\\u003e' AS bin, count(1) AS total\\nFROM Sessions\\nWHERE duration\\u003e=600 AND duration \\u003c 900\\nUNION\\nSELECT '15 or more' AS bin, count(1) AS total\\nFROM Sessions\\nWHERE duration \\u003e= 900\\n\\n\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1440-evaluate-boolean-expression--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1440-evaluate-boolean-expression--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1440. Evaluate Boolean Expression | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/evaluate-boolean-expression\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table \\",(0,n.jsx)(e.code,{children:\\"Variables\\"}),\\":\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| name | varchar |\\n| value | int |\\n+---------------+---------+\\nname is the primary key for this table.\\nThis table contains the stored variables and their values.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table \\",(0,n.jsx)(e.code,{children:\\"Expressions\\"}),\\":\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| left\_operand | varchar |\\n| operator | enum |\\n| right\_operand | varchar |\\n+---------------+---------+\\n(left\_operand, operator, right\_operand) is the primary key for this table.\\nThis table contains a boolean expression that should be evaluated.\\noperator is an enum that takes one of the values ('\\u003c', '\\u003e', '=')\\nThe values of left\_operand and right\_operand are guaranteed to be in the Variables table.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to evaluate the boolean expressions in \\",(0,n.jsx)(e.code,{children:\\"Expressions\\"}),\\" table.\\"\]}),(0,n.jsx)(e.p,{children:\\"Return the result table in any order.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Variables table:\\n+------+-------+\\n| name | value |\\n+------+-------+\\n| x | 66 |\\n| y | 77 |\\n+------+-------+\\n\\nExpressions table:\\n+--------------+----------+---------------+\\n| left\_operand | operator | right\_operand |\\n+--------------+----------+---------------+\\n| x | \\u003e | y |\\n| x | \\u003c | y |\\n| x | = | y |\\n| y | \\u003e | x |\\n| y | \\u003c | x |\\n| x | = | x |\\n+--------------+----------+---------------+\\n\\nResult table:\\n+--------------+----------+---------------+-------+\\n| left\_operand | operator | right\_operand | value |\\n+--------------+----------+---------------+-------+\\n| x | \\u003e | y | false |\\n| x | \\u003c | y | true |\\n| x | = | y | false |\\n| y | \\u003e | x | true |\\n| y | \\u003c | x | false |\\n| x | = | x | true |\\n+--------------+----------+---------------+-------+\\nAs shown, you need find the value of each boolean exprssion in the table using the variables table.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-106\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-106\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nWITH t1 AS(\\nSELECT e.left\_operand, e.operator, e.right\_operand, v.value AS left\_val, v\_1.value AS right\_val\\nFROM expressions e\\nJOIN variables v\\nON v.name = e.left\_operand\\nJOIN variables v\_1\\nON v\_1.name = e.right\_operand)\\n\\nSELECT t1.left\_operand, t1.operator, t1.right\_operand,\\nCASE WHEN t1.operator = '\\u003c' THEN (SELECT t1.left\_val\\u003c t1.right\_val)\\nWHEN t1.operator = '\\u003e' THEN (SELECT t1.left\_val \\u003e t1.right\_val)\\nWHEN t1.operator = '=' THEN (SELECT t1.left\_val = t1.right\_val)\\nELSE FALSE\\nEND AS VALUE\\nFROM t1\\n\\n#Solution 2:\\n# nested INNER JOIN can trim the volume of the intermediate table, which gives us better performance\\nSELECT t.left\_operand, t.operator, t.right\_operand,\\n (CASE WHEN v1\_value\\u003ev2.value AND operator = '\\u003e' THEN \\"true\\"\\n WHEN v1\_value\\u003cv2.value AND operator = '\\u003c' THEN \\"true\\"\\n WHEN v1\_value=v2.value AND operator = '=' THEN \\"true\\"\\n ELSE \\"false\\"\\n END) AS value\\nFROM\\n (SELECT e.\*, v1.value AS v1\_value\\n FROM Expressions AS e INNER JOIN Variables AS v1\\n ON e.left\_operand = v1.name) AS t INNER JOIN Variables AS v2\\n ON t.right\_operand = v2.name\\n\\n#Solution 3:\\nSELECT t.left\_operand, t.operator, t.right\_operand,\\n (CASE WHEN operator = '\\u003e' THEN IF(v1\_value\\u003ev2.value, \\"true\\", \\"false\\")\\n WHEN operator = '\\u003c' THEN IF(v1\_value\\u003cv2.value, \\"true\\", \\"false\\")\\n WHEN operator = '=' THEN IF(v1\_value=v2.value, \\"true\\", \\"false\\")\\n END) AS value\\nFROM\\n (SELECT e.\*, v1.value AS v1\_value\\n FROM Expressions AS e INNER JOIN Variables AS v1\\n ON e.left\_operand = v1.name) AS t INNER JOIN Variables AS v2\\n ON t.right\_operand = v2.name\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1445-apples--oranges--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1445-apples--oranges--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1445. Apples \\u0026 Oranges | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/apples-oranges\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Sales\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| sale\_date | date |\\n| fruit | enum |\\n| sold\_num | int |\\n+---------------+---------+\\n(sale\_date,fruit) is the primary key for this table.\\nThis table contains the sales of \\"apples\\" and \\"oranges\\" sold each day.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to report the difference between number of \\",(0,n.jsx)(e.strong,{children:\\"apples\\"}),\\" and \\",(0,n.jsx)(e.strong,{children:\\"oranges\\"}),\\" sold each day.\\"\]}),(0,n.jsx)(e.p,{children:\\"Return the result table ordered by sale\_date in format ('YYYY-MM-DD').\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Sales table:\\n+------------+------------+-------------+\\n| sale\_date | fruit | sold\_num |\\n+------------+------------+-------------+\\n| 2020-05-01 | apples | 10 |\\n| 2020-05-01 | oranges | 8 |\\n| 2020-05-02 | apples | 15 |\\n| 2020-05-02 | oranges | 15 |\\n| 2020-05-03 | apples | 20 |\\n| 2020-05-03 | oranges | 0 |\\n| 2020-05-04 | apples | 15 |\\n| 2020-05-04 | oranges | 16 |\\n+------------+------------+-------------+\\n\\nResult table:\\n+------------+--------------+\\n| sale\_date | diff |\\n+------------+--------------+\\n| 2020-05-01 | 2 |\\n| 2020-05-02 | 0 |\\n| 2020-05-03 | 20 |\\n| 2020-05-04 | -1 |\\n+------------+--------------+\\n\\nDay 2020-05-01, 10 apples and 8 oranges were sold (Difference 10 - 8 = 2).\\nDay 2020-05-02, 15 apples and 15 oranges were sold (Difference 15 - 15 = 0).\\nDay 2020-05-03, 20 apples and 0 oranges were sold (Difference 20 - 0 = 20).\\nDay 2020-05-04, 15 apples and 16 oranges were sold (Difference 15 - 16 = -1).\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-107\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-107\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nSELECT sale\_date, sum(CASE WHEN fruit='apples' THEN sold\_num ELSE -sold\_num END) AS diff\\nFROM Sales\\nGROUP BY sale\_date\\n\\n#Solution 2:\\nSELECT sale\_date, sold\_num-sold AS diff\\nFROM\\n((SELECT \*\\nFROM sales\\nWHERE fruit = 'apples') a\\nJOIN\\n(SELECT sale\_date AS sale, fruit, sold\_num AS sold\\nFROM sales\\nWHERE fruit = 'oranges') b\\nON a.sale\_date = b.sale)\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1454-active-users--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1454-active-users--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1454. Active Users | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/active-users\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table \\",(0,n.jsx)(e.code,{children:\\"Accounts\\"}),\\":\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| id | int |\\n| name | varchar |\\n+---------------+---------+\\nthe id is the primary key for this table.\\nThis table contains the account id and the user name of each account.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table \\",(0,n.jsx)(e.code,{children:\\"Logins\\"}),\\":\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| id | int |\\n| login\_date | date |\\n+---------------+---------+\\nThere is no primary key for this table, it may contain duplicates.\\nThis table contains the account id of the user who logged in and the login date. A user may log in multiple times in the day.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the id and the name of active users.\\"}),(0,n.jsx)(e.p,{children:\\"Active users are those who logged in to their accounts for 5 or more consecutive days.\\"}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table \\",(0,n.jsx)(e.strong,{children:\\"ordered\\"}),\\" by the id.\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Accounts table:\\n+----+----------+\\n| id | name |\\n+----+----------+\\n| 1 | Winston |\\n| 7 | Jonathan |\\n+----+----------+\\n\\nLogins table:\\n+----+------------+\\n| id | login\_date |\\n+----+------------+\\n| 7 | 2020-05-30 |\\n| 1 | 2020-05-30 |\\n| 7 | 2020-05-31 |\\n| 7 | 2020-06-01 |\\n| 7 | 2020-06-02 |\\n| 7 | 2020-06-02 |\\n| 7 | 2020-06-03 |\\n| 1 | 2020-06-07 |\\n| 7 | 2020-06-10 |\\n+----+------------+\\n\\nResult table:\\n+----+----------+\\n| id | name |\\n+----+----------+\\n| 7 | Jonathan |\\n+----+----------+\\nUser Winston with id = 1 logged in 2 times only in 2 different days, so, Winston is not an active user.\\nUser Jonathan with id = 7 logged in 7 times in 6 different days, five of them were consecutive days, so, Jonathan is an active user.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Follow up question: Can you write a general solution if the active users are those who logged in to their accounts for n or more consecutive days?\\"}),(0,n.jsxs)(e.h3,{id:\\"solution-108\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-108\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nWITH t1 AS (\\nSELECT id,login\_date,\\nlead(login\_date,4) OVER(PARTITION BY id ORDER BY login\_date) date\_5\\nFROM (SELECT DISTINCT \* FROM Logins) b\\n)\\n\\nSELECT DISTINCT a.id, a.name FROM t1\\nINNER JOIN accounts a\\nON t1.id = a.id\\nWHERE DATEDIFF(t1.date\_5,login\_date) = 4\\nORDER BY id\\n\\n#Soltion 2:\\nSELECT \*\\nFROM Accounts\\nWHERE id IN\\n (SELECT DISTINCT t1.id\\n FROM Logins AS t1 INNER JOIN Logins AS t2\\n ON t1.id = t2.id AND datediff(t1.login\_date, t2.login\_date) BETWEEN 1 AND 4\\n GROUP BY t1.id, t1.login\_date\\n HAVING count(DISTINCT(t2.login\_date)) = 4)\\nORDER BY id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1459-rectangles-area--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1459-rectangles-area--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1459. Rectangles Area | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/rectangles-area\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Points\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| id | int |\\n| x\_value | int |\\n| y\_value | int |\\n+---------------+---------+\\nid is the primary key for this table.\\nEach point is represented as a 2D Dimensional (x\_value, y\_value).\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to report of all possible rectangles which can be formed by any two points of the table.\\"}),(0,n.jsx)(e.p,{children:\\"Each row in the result contains three columns (p1, p2, area) where:\\"}),(0,n.jsxs)(e.ul,{children:\[(0,n.jsxs)(e.li,{children:\[(0,n.jsx)(e.strong,{children:\\"p1\\"}),\\" and \\",(0,n.jsx)(e.strong,{children:\\"p2\\"}),\\" are the id of two opposite corners of a rectangle and p1 \\u003c p2.\\"\]}),(0,n.jsxs)(e.li,{children:\[\\"Area of this rectangle is represented by the column \\",(0,n.jsx)(e.strong,{children:\\"area\\"}),\\". Report the query in descending order by area in case of tie in ascending order by p1 and p2.\\"\]})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Points table:\\n+----------+-------------+-------------+\\n| id | x\_value | y\_value |\\n+----------+-------------+-------------+\\n| 1 | 2 | 8 |\\n| 2 | 4 | 7 |\\n| 3 | 2 | 10 |\\n+----------+-------------+-------------+\\n\\nResult table:\\n+----------+-------------+-------------+\\n| p1 | p2 | area |\\n+----------+-------------+-------------+\\n| 2 | 3 | 6 |\\n| 1 | 2 | 2 |\\n+----------+-------------+-------------+\\n\\np1 should be less than p2 and area greater than 0.\\np1 = 1 and p2 = 2, has an area equal to |2-4| \* |8-7| = 2.\\np1 = 2 and p2 = 3, has an area equal to |4-2| \* |7-10| = 2.\\np1 = 1 and p2 = 3 It's not possible because has an area equal to 0.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-109\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-109\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT t1.id AS p1, t2.id AS p2, ABS(t1.x\_value-t2.x\_value)\*ABS(t1.y\_value-t2.y\_value) AS area\\nFROM Points AS t1 INNER JOIN Points AS t2\\nON t1.id \\u003c t2.id\\nAND t1.x\_value != t2.x\_value AND t1.y\_value != t2.y\_value\\nORDER BY area DESC, p1, p2\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1468-calculate-salaries--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1468-calculate-salaries--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1468. Calculate Salaries | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/calculate-salaries\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table \\",(0,n.jsx)(e.code,{children:\\"Salaries\\"}),\\":\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| company\_id | int |\\n| employee\_id | int |\\n| employee\_name | varchar |\\n| salary | int |\\n+---------------+---------+\\n(company\_id, employee\_id) is the primary key for this table.\\nThis table contains the company id, the id, the name and the salary for an employee.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the salaries of the employees after applying taxes.\\"}),(0,n.jsx)(e.p,{children:\\"The tax rate is calculated for each company based on the following criteria:\\"}),(0,n.jsxs)(e.ul,{children:\[(0,n.jsx)(e.li,{children:\\"0% If the max salary of any employee in the company is less than 1000$.\\"}),(0,n.jsx)(e.li,{children:\\"24% If the max salary of any employee in the company is in the range \[1000, 10000\] inclusive.\\"}),(0,n.jsxs)(e.li,{children:\[\\"49% If the max salary of any employee in the company is greater than 10000$.\\",(0,n.jsx)(e.br,{}),\\"Return the result table \\",(0,n.jsx)(e.strong,{children:\\"in any order\\"}),\\". Round the salary to the nearest integer.\\"\]})\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Salaries table:\\n+------------+-------------+---------------+--------+\\n| company\_id | employee\_id | employee\_name | salary |\\n+------------+-------------+---------------+--------+\\n| 1 | 1 | Tony | 2000 |\\n| 1 | 2 | Pronub | 21300 |\\n| 1 | 3 | Tyrrox | 10800 |\\n| 2 | 1 | Pam | 300 |\\n| 2 | 7 | Bassem | 450 |\\n| 2 | 9 | Hermione | 700 |\\n| 3 | 7 | Bocaben | 100 |\\n| 3 | 2 | Ognjen | 2200 |\\n| 3 | 13 | Nyancat | 3300 |\\n| 3 | 15 | Morninngcat | 1866 |\\n+------------+-------------+---------------+--------+\\n\\nResult table:\\n+------------+-------------+---------------+--------+\\n| company\_id | employee\_id | employee\_name | salary |\\n+------------+-------------+---------------+--------+\\n| 1 | 1 | Tony | 1020 |\\n| 1 | 2 | Pronub | 10863 |\\n| 1 | 3 | Tyrrox | 5508 |\\n| 2 | 1 | Pam | 300 |\\n| 2 | 7 | Bassem | 450 |\\n| 2 | 9 | Hermione | 700 |\\n| 3 | 7 | Bocaben | 76 |\\n| 3 | 2 | Ognjen | 1672 |\\n| 3 | 13 | Nyancat | 2508 |\\n| 3 | 15 | Morninngcat | 5911 |\\n+------------+-------------+---------------+--------+\\nFor company 1, Max salary is 21300. Employees in company 1 have taxes = 49%\\nFor company 2, Max salary is 700. Employees in company 2 have taxes = 0%\\nFor company 3, Max salary is 7777. Employees in company 3 have taxes = 24%\\nThe salary after taxes = salary - (taxes percentage / 100) \* salary\\nFor example, Salary for Morninngcat (3, 15) after taxes = 7777 - 7777 \* (24 / 100) = 7777 - 1866.48 = 5910.52, which is rounded to 5911.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-110\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-110\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nWITH t1 AS (\\nSELECT company\_id, employee\_id, employee\_name, salary AS sa, MAX(salary) OVER(PARTITION BY company\_id) AS maximum\\nFROM salaries)\\n\\nSELECT company\_id, employee\_id, employee\_name,\\nCASE WHEN t1.maximum\\u003c1000 THEN t1.sa\\nWHEN t1.maximum BETWEEN 1000 AND 10000 THEN ROUND(t1.sa\*.76,0)\\nELSE ROUND(t1.sa\*.51,0)\\nEND AS salary\\nFROM t1\\n\\n#Soltion 2:\\nSELECT Salaries.company\_id, Salaries.employee\_id, Salaries.employee\_name,\\n ROUND(CASE WHEN salary\_max\\u003c1000 THEN Salaries.salary\\n WHEN salary\_max\\u003e=1000 AND salary\_max\\u003c=10000 THEN Salaries.salary \* 0.76\\n ELSE Salaries.salary \* 0.51 END, 0) AS salary\\nFROM Salaries INNER JOIN (\\n SELECT company\_id, MAX(salary) AS salary\_max\\n FROM Salaries\\n GROUP BY company\_id) AS t\\nON Salaries.company\_id = t.company\_id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1479-sales-by-day-of-the-week--hard---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1479-sales-by-day-of-the-week--hard---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1479. Sales by Day of the Week | Hard | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/sales-by-day-of-the-week\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Orders\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| order\_id | int |\\n| customer\_id | int |\\n| order\_date | date |\\n| item\_id | varchar |\\n| quantity | int |\\n+---------------+---------+\\n(ordered\_id, item\_id) is the primary key for this table.\\nThis table contains information of the orders placed.\\norder\_date is the date when item\_id was ordered by the customer with id customer\_id.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Items\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------------+---------+\\n| Column Name | Type |\\n+---------------------+---------+\\n| item\_id | varchar |\\n| item\_name | varchar |\\n| item\_category | varchar |\\n+---------------------+---------+\\nitem\_id is the primary key for this table.\\nitem\_name is the name of the item.\\nitem\_category is the category of the item.\\n\`})}),(0,n.jsx)(e.p,{children:\\"You are the business owner and would like to obtain a sales report for category items and day of the week.\\"}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to report how many units in each category have been ordered on each \\",(0,n.jsx)(e.strong,{children:\\"day of the week\\"}),\\".\\"\]}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table \\",(0,n.jsx)(e.strong,{children:\\"ordered\\"}),\\" by category.\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`\\nOrders table:\\n+------------+--------------+-------------+--------------+-------------+\\n| order\_id | customer\_id | order\_date | item\_id | quantity |\\n+------------+--------------+-------------+--------------+-------------+\\n| 1 | 1 | 2020-06-01 | 1 | 10 |\\n| 2 | 1 | 2020-06-08 | 2 | 10 |\\n| 3 | 2 | 2020-06-02 | 1 | 5 |\\n| 4 | 3 | 2020-06-03 | 3 | 5 |\\n| 5 | 4 | 2020-06-04 | 4 | 1 |\\n| 6 | 4 | 2020-06-05 | 5 | 5 |\\n| 7 | 5 | 2020-06-05 | 1 | 10 |\\n| 8 | 5 | 2020-06-14 | 4 | 5 |\\n| 9 | 5 | 2020-06-21 | 3 | 5 |\\n+------------+--------------+-------------+--------------+-------------+\\n\\nItems table:\\n+------------+----------------+---------------+\\n| item\_id | item\_name | item\_category |\\n+------------+----------------+---------------+\\n| 1 | LC Alg. Book | Book |\\n| 2 | LC DB. Book | Book |\\n| 3 | LC SmarthPhone | Phone |\\n| 4 | LC Phone 2020 | Phone |\\n| 5 | LC SmartGlass | Glasses |\\n| 6 | LC T-Shirt XL | T-Shirt |\\n+------------+----------------+---------------+\\n\\nResult table:\\n+------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+\\n| Category | Monday | Tuesday | Wednesday | Thursday | Friday | Saturday | Sunday |\\n+------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+\\n| Book | 20 | 5 | 0 | 0 | 10 | 0 | 0 |\\n| Glasses | 0 | 0 | 0 | 0 | 5 | 0 | 0 |\\n| Phone | 0 | 0 | 5 | 1 | 0 | 0 | 10 |\\n| T-Shirt | 0 | 0 | 0 | 0 | 0 | 0 | 0 |\\n+------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+\\nOn Monday (2020-06-01, 2020-06-08) were sold a total of 20 units (10 + 10) in the category Book (ids: 1, 2).\\nOn Tuesday (2020-06-02) were sold a total of 5 units in the category Book (ids: 1, 2).\\nOn Wednesday (2020-06-03) were sold a total of 5 units in the category Phone (ids: 3, 4).\\nOn Thursday (2020-06-04) were sold a total of 1 unit in the category Phone (ids: 3, 4).\\nOn Friday (2020-06-05) were sold 10 units in the category Book (ids: 1, 2) and 5 units in Glasses (ids: 5).\\nOn Saturday there are no items sold.\\nOn Sunday (2020-06-14, 2020-06-21) were sold a total of 10 units (5 +5) in the category Phone (ids: 3, 4).\\nThere are no sales of T-Shirt.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-111\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-111\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`WITH t1 AS(\\nSELECT DISTINCT item\_category,\\nCASE WHEN dayname(order\_date)='Monday' THEN SUM(quantity) OVER(PARTITION BY item\_category,dayname(order\_date)) ELSE 0 END AS Monday,\\nCASE WHEN dayname(order\_date)='Tuesday' THEN SUM(quantity) OVER(PARTITION BY item\_category,dayname(order\_date)) ELSE 0 END AS Tuesday,\\nCASE WHEN dayname(order\_date)='Wednesday' THEN SUM(quantity) OVER(PARTITION BY item\_category,dayname(order\_date)) ELSE 0 END AS Wednesday,\\nCASE WHEN dayname(order\_date)='Thursday' THEN SUM(quantity) OVER(PARTITION BY item\_category,dayname(order\_date)) ELSE 0 END AS Thursday,\\nCASE WHEN dayname(order\_date)='Friday' THEN SUM(quantity) OVER(PARTITION BY item\_category,dayname(order\_date)) ELSE 0 END AS Friday,\\nCASE WHEN dayname(order\_date)='Saturday' THEN SUM(quantity) OVER(PARTITION BY item\_category,dayname(order\_date)) ELSE 0 END AS Saturday,\\nCASE WHEN dayname(order\_date)='Sunday' THEN SUM(quantity) OVER(PARTITION BY item\_category,dayname(order\_date)) ELSE 0 END AS Sunday\\nFROM orders o\\nRIGHT JOIN items i\\nUSING (item\_id))\\n\\nSELECT item\_category AS category, SUM(Monday) AS Monday, SUM(Tuesday) AS Tuesday, SUM(Wednesday) Wednesday, SUM(Thursday) Thursday,\\nSUM(Friday) Friday, SUM(Saturday) Saturday, SUM(Sunday) Sunday\\nFROM t1\\nGROUP BY item\_category\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1484-group-sold-products-by-the-date--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1484-group-sold-products-by-the-date--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1484. Group Sold Products By The Date | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/group-sold-products-by-the-date\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table \\",(0,n.jsx)(e.code,{children:\\"Activities\\"}),\\":\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| sell\_date | date |\\n| product | varchar |\\n+-------------+---------+\\nThere is no primary key for this table, it may contains duplicates.\\nEach row of this table contains the product name and the date it was sold in a market.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find for each date, the number of distinct products sold and their names.\\"}),(0,n.jsx)(e.p,{children:\\"The sold-products names for each date should be sorted lexicographically.\\"}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table ordered by \\",(0,n.jsx)(e.code,{children:\\"sell\_date\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Activities table:\\n+------------+-------------+\\n| sell\_date | product |\\n+------------+-------------+\\n| 2020-05-30 | Headphone |\\n| 2020-06-01 | Pencil |\\n| 2020-06-02 | Mask |\\n| 2020-05-30 | Basketball |\\n| 2020-06-01 | Bible |\\n| 2020-06-02 | Mask |\\n| 2020-05-30 | T-Shirt |\\n+------------+-------------+\\n\\nResult table:\\n+------------+----------+------------------------------+\\n| sell\_date | num\_sold | products |\\n+------------+----------+------------------------------+\\n| 2020-05-30 | 3 | Basketball,Headphone,T-shirt |\\n| 2020-06-01 | 2 | Bible,Pencil |\\n| 2020-06-02 | 1 | Mask |\\n+------------+----------+------------------------------+\\nFor 2020-05-30, Sold items were (Headphone, Basketball, T-shirt), we sort them lexicographically and separate them by comma.\\nFor 2020-06-01, Sold items were (Pencil, Bible), we sort them lexicographically and separate them by comma.\\nFor 2020-06-02, Sold item is (Masks), we just return it.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-112\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-112\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT sell\_date, COUNT(DISTINCT product) AS num\_sold, group\_concat(DISTINCT product) AS products\\nFROM activities\\nGROUP BY 1\\nORDER BY 1\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1495-friendly-movies-streamed-last-month--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1495-friendly-movies-streamed-last-month--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1495. Friendly Movies Streamed Last Month | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/friendly-movies-streamed-last-month\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"TVProgram\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| program\_date | date |\\n| content\_id | int |\\n| channel | varchar |\\n+---------------+---------+\\n(program\_date, content\_id) is the primary key for this table.\\nThis table contains information of the programs on the TV.\\ncontent\_id is the id of the program in some channel on the TV.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Content\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+------------------+---------+\\n| Column Name | Type |\\n+------------------+---------+\\n| content\_id | varchar |\\n| title | varchar |\\n| Kids\_content | enum |\\n| content\_type | varchar |\\n+------------------+---------+\\ncontent\_id is the primary key for this table.\\nKids\_content is an enum that takes one of the values ('Y', 'N') where:\\n'Y' means is content for kids otherwise 'N' is not content for kids.\\ncontent\_type is the category of the content as movies, series, etc.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to report the distinct titles of the kid-friendly movies streamed in June 2020.\\"}),(0,n.jsx)(e.p,{children:\\"Return the result table in any order.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`\\nTVProgram table:\\n+--------------------+--------------+-------------+\\n| program\_date | content\_id | channel |\\n+--------------------+--------------+-------------+\\n| 2020-06-10 08:00 | 1 | LC-Channel |\\n| 2020-05-11 12:00 | 2 | LC-Channel |\\n| 2020-05-12 12:00 | 3 | LC-Channel |\\n| 2020-05-13 14:00 | 4 | Disney Ch |\\n| 2020-06-18 14:00 | 4 | Disney Ch |\\n| 2020-07-15 16:00 | 5 | Disney Ch |\\n+--------------------+--------------+-------------+\\n\\nContent table:\\n+------------+----------------+---------------+---------------+\\n| content\_id | title | Kids\_content | content\_type |\\n+------------+----------------+---------------+---------------+\\n| 1 | Leetcode Movie | N | Movies |\\n| 2 | Alg. for Kids | Y | Series |\\n| 3 | Database Sols | N | Series |\\n| 4 | Aladdin | Y | Movies |\\n| 5 | Cinderella | Y | Movies |\\n+------------+----------------+---------------+---------------+\\n\\nResult table:\\n+--------------+\\n| title |\\n+--------------+\\n| Aladdin |\\n+--------------+\\n\\"Leetcode Movie\\" is not a content for kids.\\n\\"Alg. for Kids\\" is not a movie.\\n\\"Database Sols\\" is not a movie\\n\\"Alladin\\" is a movie, content for kids and was streamed in June 2020.\\n\\"Cinderella\\" was not streamed in June 2020.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-113\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-113\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELCT DISTINCT title\\nFROM\\n(SELCT content\_id, title\\nFROM content\\nWHERE kids\_content = 'Y' AND content\_type = 'Movies') a\\nJOIN\\ntvprogram USING (content\_id)\\nWHERE month(program\_date) = 6\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1501-countries-you-can-safely-invest-in--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1501-countries-you-can-safely-invest-in--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1501. Countries You Can Safely Invest In | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/countries-you-can-safely-invest-in\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table \\",(0,n.jsx)(e.code,{children:\\"Person\\"}),\\":\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----------------+---------+\\n| Column Name | Type |\\n+----------------+---------+\\n| id | int |\\n| name | varchar |\\n| phone\_number | varchar |\\n+----------------+---------+\\nid is the primary key for this table.\\nEach row of this table contains the name of a person and their phone number.\\nPhone number will be in the form 'xxx-yyyyyyy' where xxx is the country code (3 characters) and yyyyyyy is the phone number (7 characters) where x and y are digits. Both can contain leading zeros.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table \\",(0,n.jsx)(e.code,{children:\\"Country\\"}),\\":\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----------------+---------+\\n| Column Name | Type |\\n+----------------+---------+\\n| name | varchar |\\n| country\_code | varchar |\\n+----------------+---------+\\ncountry\_code is the primary key for this table.\\nEach row of this table contains the country name and its code. country\_code will be in the form 'xxx' where x is digits.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table \\",(0,n.jsx)(e.code,{children:\\"Calls\\"}),\\":\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+------+\\n| Column Name | Type |\\n+-------------+------+\\n| caller\_id | int |\\n| callee\_id | int |\\n| duration | int |\\n+-------------+------+\\nThere is no primary key for this table, it may contain duplicates.\\nEach row of this table contains the caller id, callee id and the duration of the call in minutes. caller\_id != callee\_id\\nA telecommunications company wants to invest in new countries. The country intends to invest in the countries where the average call duration of the calls in this country is strictly greater than the global average call duration.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the countries where this company can invest.\\"}),(0,n.jsx)(e.p,{children:\\"Return the result table in any order.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Person table:\\n+----+----------+--------------+\\n| id | name | phone\_number |\\n+----+----------+--------------+\\n| 3 | Jonathan | 051-1234567 |\\n| 12 | Elvis | 051-7654321 |\\n| 1 | Moncef | 212-1234567 |\\n| 2 | Maroua | 212-6523651 |\\n| 7 | Meir | 972-1234567 |\\n| 9 | Rachel | 972-0011100 |\\n+----+----------+--------------+\\n\\nCountry table:\\n+----------+--------------+\\n| name | country\_code |\\n+----------+--------------+\\n| Peru | 051 |\\n| Israel | 972 |\\n| Morocco | 212 |\\n| Germany | 049 |\\n| Ethiopia | 251 |\\n+----------+--------------+\\n\\nCalls table:\\n+-----------+-----------+----------+\\n| caller\_id | callee\_id | duration |\\n+-----------+-----------+----------+\\n| 1 | 9 | 33 |\\n| 2 | 9 | 4 |\\n| 1 | 2 | 59 |\\n| 3 | 12 | 102 |\\n| 3 | 12 | 330 |\\n| 12 | 3 | 5 |\\n| 7 | 9 | 13 |\\n| 7 | 1 | 3 |\\n| 9 | 7 | 1 |\\n| 1 | 7 | 7 |\\n+-----------+-----------+----------+\\n\\nResult table:\\n+----------+\\n| country |\\n+----------+\\n| Peru |\\n+----------+\\nThe average call duration for Peru is (102 + 102 + 330 + 330 + 5 + 5) / 6 = 145.666667\\nThe average call duration for Israel is (33 + 4 + 13 + 13 + 3 + 1 + 1 + 7) / 8 = 9.37500\\nThe average call duration for Morocco is (33 + 4 + 59 + 59 + 3 + 7) / 6 = 27.5000\\nGlobal call duration average = (2 \* (33 + 3 + 59 + 102 + 330 + 5 + 13 + 3 + 1 + 7)) / 20 = 55.70000\\nSince Peru is the only country where average call duration is greater than the global average, it's the only recommended country.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-114\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-114\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`WITH t1 AS(\\nSELECT caller\_id AS id, duration AS total\\nFROM\\n(SELECT caller\_id, duration\\nFROM calls\\nUNION ALL\\nSELECT callee\_id, duration\\nFROM calls) a\\n)\\nSELECT name AS country\\nFROM\\n(SELECT distinct avg(total) OVER(PARTITION BY code) AS avg\_call, avg(total) OVER() AS global\_avg, c.name\\nFROM\\n((SELECT \*, coalesce(total,0) AS duration, SUBSTRING(phone\_number FROM 1 for 3) AS code\\nFROM person RIGHT JOIN t1\\nUSING (id)) b\\njoin country c\\nON c.country\_code = b.code)) d\\nWHERE avg\_call \\u003e global\_avg\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1511-customer-order-frequency--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1511-customer-order-frequency--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1511. Customer Order Frequency | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/customer-order-frequency\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Customers\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| customer\_id | int |\\n| name | varchar |\\n| country | varchar |\\n+---------------+---------+\\ncustomer\_id is the primary key for this table.\\nThis table contains information of the customers in the company.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Product\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| product\_id | int |\\n| description | varchar |\\n| price | int |\\n+---------------+---------+\\nproduct\_id is the primary key for this table.\\nThis table contains information of the products in the company.\\nprice is the product cost.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Orders\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| order\_id | int |\\n| customer\_id | int |\\n| product\_id | int |\\n| order\_date | date |\\n| quantity | int |\\n+---------------+---------+\\norder\_id is the primary key for this table.\\nThis table contains information on customer orders.\\ncustomer\_id is the id of the customer who bought \\"quantity\\" products with id \\"product\_id\\".\\nOrder\_date is the date in format ('YYYY-MM-DD') when the order was shipped.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to report the customer\_id and customer\_name of customers who have spent at least $100 in each month of June and July 2020.\\"}),(0,n.jsx)(e.p,{children:\\"Return the result table in any order.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Customers\\n+--------------+-----------+-------------+\\n| customer\_id | name | country |\\n+--------------+-----------+-------------+\\n| 1 | Winston | USA |\\n| 2 | Jonathan | Peru |\\n| 3 | Moustafa | Egypt |\\n+--------------+-----------+-------------+\\n\\nProduct\\n+--------------+-------------+-------------+\\n| product\_id | description | price |\\n+--------------+-------------+-------------+\\n| 10 | LC Phone | 300 |\\n| 20 | LC T-Shirt | 10 |\\n| 30 | LC Book | 45 |\\n| 40 | LC Keychain | 2 |\\n+--------------+-------------+-------------+\\n\\nOrders\\n+--------------+-------------+-------------+-------------+-----------+\\n| order\_id | customer\_id | product\_id | order\_date | quantity |\\n+--------------+-------------+-------------+-------------+-----------+\\n| 1 | 1 | 10 | 2020-06-10 | 1 |\\n| 2 | 1 | 20 | 2020-07-01 | 1 |\\n| 3 | 1 | 30 | 2020-07-08 | 2 |\\n| 4 | 2 | 10 | 2020-06-15 | 2 |\\n| 5 | 2 | 40 | 2020-07-01 | 10 |\\n| 6 | 3 | 20 | 2020-06-24 | 2 |\\n| 7 | 3 | 30 | 2020-06-25 | 2 |\\n| 9 | 3 | 30 | 2020-05-08 | 3 |\\n+--------------+-------------+-------------+-------------+-----------+\\n\\nResult table:\\n+--------------+------------+\\n| customer\_id | name |\\n+--------------+------------+\\n| 1 | Winston |\\n+--------------+------------+\\nWinston spent $300 (300 \* 1) in June and $100 ( 10 \* 1 + 45 \* 2) in July 2020.\\nJonathan spent $600 (300 \* 2) in June and $20 ( 2 \* 10) in July 2020.\\nMoustafa spent $110 (10 \* 2 + 45 \* 2) in June and $0 in July 2020.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-115\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-115\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nSELECT o.customer\_id, name\\nJOIN Product p\\nON o.product\_id = p.product\_id\\nJOIN Customers c\\nON o.customer\_id = c.customer\_id\\nGROUP BY 1, 2\\nHAVING SUM(CASE WHEN date\_format(order\_date, '%Y-%m')='2020-06'\\nTHEN price\*quantity END) \\u003e= 100\\nAND\\nSUM(CASE WHEN date\_format(order\_date, '%Y-%m')='2020-07'\\nTHEN price\*quantity END) \\u003e= 100;\\n\\n#Solution 2:\\nSELECT customer\_id, name\\nFROM\\n(\\n SELECT o.customer\_id, c.name,\\n sum(CASE WHEN left(o.order\_date,7) = '2020-06' THEN p.price \* o.quantity END) AS JuneSpend,\\n sum(CASE WHEN left(o.order\_date,7) = '2020-07' THEN p.price \* o.quantity END) AS JulySpend\\n FROM Orders o\\n LEFT JOIN Customers c ON o.customer\_id = c.customer\_id\\n lEFT JOIN Product p ON o.product\_id = p.product\_id\\n GROUP BY o.customer\_id\\n HAVING JuneSpend \\u003e= 100 AND JulySpend \\u003e= 100\\n) AS temp\\n\\n#Solution 3:\\nSELECT o.customer\_id, c.name\\nFROM Customers c, Product p, Orders o\\nWHERE c.customer\_id = o.customer\_id AND p.product\_id = o.product\_id\\nGROUP BY o.customer\_id\\nHAVING\\n(\\n SUM(CASE WHEN o.order\_date LIKE '2020-06%' THEN o.quantity\*p.price ELSE 0 END) \\u003e= 100\\n and\\n SUM(CASE WHEN o.order\_date LIKE '2020-07%' THEN o.quantity\*p.price ELSE 0 END) \\u003e= 100\\n);\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1517-find-users-with-valid-e-mails--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1517-find-users-with-valid-e-mails--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1517. Find Users With Valid E-Mails | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/find-users-with-valid-e-mails\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Users\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| user\_id | int |\\n| name | varchar |\\n| mail | varchar |\\n+---------------+---------+\\nuser\_id is the primary key for this table.\\nThis table contains information of the users signed up in a website. Some e-mails are invalid.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to find the users who have \\",(0,n.jsx)(e.strong,{children:\\"valid emails\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"A valid e-mail has a prefix name and a domain where:\\"}),(0,n.jsxs)(e.ul,{children:\[(0,n.jsxs)(e.li,{children:\[(0,n.jsx)(e.strong,{children:\\"The prefix name\\"}),\\" is a string that may contain letters (upper or lower case), digits, underscore \\",(0,n.jsx)(e.code,{children:\\"'\_'\\"}),\\", period \\",(0,n.jsx)(e.code,{children:\\"'.'\\"}),\\" and/or dash \\",(0,n.jsx)(e.code,{children:\\"'-'\\"}),\\". The prefix name \\",(0,n.jsx)(e.strong,{children:\\"must\\"}),\\" start with a letter.\\"\]}),(0,n.jsxs)(e.li,{children:\[\\"The domain is \\",(0,n.jsx)(e.code,{children:\\"'@leetcode.com'\\"}),\\".\\",(0,n.jsx)(e.br,{}),\\"Return the result table in any order.\\"\]})\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Users\\n+---------+-----------+-------------------------+\\n| user\_id | name | mail |\\n+---------+-----------+-------------------------+\\n| 1 | Winston | winston@leetcode.com |\\n| 2 | Jonathan | jonathanisgreat |\\n| 3 | Annabelle | bella-@leetcode.com |\\n| 4 | Sally | sally.come@leetcode.com |\\n| 5 | Marwan | quarz#2020@leetcode.com |\\n| 6 | David | david69@gmail.com |\\n| 7 | Shapiro | .shapo@leetcode.com |\\n+---------+-----------+-------------------------+\\n\\nResult table:\\n+---------+-----------+-------------------------+\\n| user\_id | name | mail |\\n+---------+-----------+-------------------------+\\n| 1 | Winston | winston@leetcode.com |\\n| 3 | Annabelle | bella-@leetcode.com |\\n| 4 | Sally | sally.come@leetcode.com |\\n+---------+-----------+-------------------------+\\nThe mail of user 2 doesn't have a domain.\\nThe mail of user 5 has # sign which is not allowed.\\nThe mail of user 6 doesn't have leetcode domain.\\nThe mail of user 7 starts with a period.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-116\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-116\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nSELECT user\_id, name, mail\\nFROM Users\\nWHERE mail regexp \\"^\[a-zA-Z\]+\[a-zA-Z0-9\_\\\\\\\\\\\\\\\\./\\\\\\\\\\\\\\\\-\]{0,}@leetcode\\\\\\\\\\\\\\\\.com$\\"\\nORDER BY user\_id\\n\\n#Solution 2:\\nSELECT \* FROM Users\\nWHERE regexp\_like(mail, '^\[A-Za-z\]+\[A-Za-z0-9\\\\\\\\\_\\\\\\\\.\\\\\\\\-\]\*@leetcode.com')\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1527-patients-with-a-condition--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1527-patients-with-a-condition--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1527. Patients With a Condition | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/patients-with-a-condition\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Patients\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+---------+\\n| Column Name | Type |\\n+--------------+---------+\\n| patient\_id | int |\\n| patient\_name | varchar |\\n| conditions | varchar |\\n+--------------+---------+\\npatient\_id is the primary key for this table.\\n'conditions' contains 0 or more code separated by spaces.\\nThis table contains information of the patients in the hospital.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to report the patient\_id, patient\_name all conditions of patients who have Type I Diabetes. Type I Diabetes always starts with \\",(0,n.jsx)(e.code,{children:\\"DIAB1\\"}),\\" prefix\\"\]}),(0,n.jsx)(e.p,{children:\\"Return the result table in any order.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Patients\\n+------------+--------------+--------------+\\n| patient\_id | patient\_name | conditions |\\n+------------+--------------+--------------+\\n| 1 | Daniel | YFEV COUGH |\\n| 2 | Alice | |\\n| 3 | Bob | DIAB100 MYOP |\\n| 4 | George | ACNE DIAB100 |\\n| 5 | Alain | DIAB201 |\\n+------------+--------------+--------------+\\n\\nResult table:\\n+------------+--------------+--------------+\\n| patient\_id | patient\_name | conditions |\\n+------------+--------------+--------------+\\n| 3 | Bob | DIAB100 MYOP |\\n| 4 | George | ACNE DIAB100 |\\n+------------+--------------+--------------+\\nBob and George both have a condition that starts with DIAB1.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-117\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-117\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT patient\_id, patient\_name, conditions\\nFROM Patients\\nWHERE conditions LIKE '%DIAB1%'\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1532-the-most-recent-three-orders--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1532-the-most-recent-three-orders--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1532. The Most Recent Three Orders | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/the-most-recent-three-orders\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Customers\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| customer\_id | int |\\n| name | varchar |\\n+---------------+---------+\\ncustomer\_id is the primary key for this table.\\nThis table contains information about customers.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Orders\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| order\_id | int |\\n| order\_date | date |\\n| customer\_id | int |\\n| cost | int |\\n+---------------+---------+\\norder\_id is the primary key for this table.\\nThis table contains information about the orders made customer\_id.\\nEach customer has one order per day.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the most recent 3 orders of each user. If a user ordered less than 3 orders return all of their orders.\\"}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table sorted by \\",(0,n.jsx)(e.code,{children:\\"customer\_name\\"}),\\" in ascending order and in case of a tie by the \\",(0,n.jsx)(e.code,{children:\\"customer\_id\\"}),\\" in ascending order. If there still a tie, order them by the \\",(0,n.jsx)(e.code,{children:\\"order\_date\\"}),\\" in descending order.\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Customers\\n+-------------+-----------+\\n| customer\_id | name |\\n+-------------+-----------+\\n| 1 | Winston |\\n| 2 | Jonathan |\\n| 3 | Annabelle |\\n| 4 | Marwan |\\n| 5 | Khaled |\\n+-------------+-----------+\\n\\nOrders\\n+----------+------------+-------------+------+\\n| order\_id | order\_date | customer\_id | cost |\\n+----------+------------+-------------+------+\\n| 1 | 2020-07-31 | 1 | 30 |\\n| 2 | 2020-07-30 | 2 | 40 |\\n| 3 | 2020-07-31 | 3 | 70 |\\n| 4 | 2020-07-29 | 4 | 100 |\\n| 5 | 2020-06-10 | 1 | 1010 |\\n| 6 | 2020-08-01 | 2 | 102 |\\n| 7 | 2020-08-01 | 3 | 111 |\\n| 8 | 2020-08-03 | 1 | 99 |\\n| 9 | 2020-08-07 | 2 | 32 |\\n| 10 | 2020-07-15 | 1 | 2 |\\n+----------+------------+-------------+------+\\n\\nResult table:\\n+---------------+-------------+----------+------------+\\n| customer\_name | customer\_id | order\_id | order\_date |\\n+---------------+-------------+----------+------------+\\n| Annabelle | 3 | 7 | 2020-08-01 |\\n| Annabelle | 3 | 3 | 2020-07-31 |\\n| Jonathan | 2 | 9 | 2020-08-07 |\\n| Jonathan | 2 | 6 | 2020-08-01 |\\n| Jonathan | 2 | 2 | 2020-07-30 |\\n| Marwan | 4 | 4 | 2020-07-29 |\\n| Winston | 1 | 8 | 2020-08-03 |\\n| Winston | 1 | 1 | 2020-07-31 |\\n| Winston | 1 | 10 | 2020-07-15 |\\n+---------------+-------------+----------+------------+\\nWinston has 4 orders, we discard the order of \\"2020-06-10\\" because it is the oldest order.\\nAnnabelle has only 2 orders, we return them.\\nJonathan has exactly 3 orders.\\nMarwan ordered only one time.\\nWe sort the result table by customer\_name in ascending order, by customer\_id in ascending order and by order\_date in descending order in case of a tie.\\nFollow-up:\\nCan you write a general solution for the most recent \\\\\`n\\\\\` orders?\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-118\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-118\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`WITH tmp AS (\\nSELECT a.name, a.customer\_id, b.order\_id, b.order\_date,\\nROW\_NUMBER() OVER(PARTITION BY a.name, a.customer\_id ORDER BY b.order\_date DESC) AS rnk\\nFROM Customers AS a\\nJOIN Orders AS b\\nON a.customer\_id = b.customer\_id\\n)\\n\\nSELECT name AS customer\_name, customer\_id, order\_id, order\_date\\nFROM tmp\\nWHERE rnk \\u003c= 3\\nORDER BY customer\_name, customer\_id, order\_date DESC;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1543-fix-product-name-format--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1543-fix-product-name-format--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1543. Fix Product Name Format | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/fix-product-name-format\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Sales\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+---------+\\n| Column Name | Type |\\n+--------------+---------+\\n| sale\_id | int |\\n| product\_name | varchar |\\n| sale\_date | date |\\n+--------------+---------+\\nsale\_id is the primary key for this table.\\nEach row of this table contains the product name and the date it was sold.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Since table Sales was filled manually in the year 2000, \\",(0,n.jsx)(e.code,{children:\\"product\_name\\"}),\\" may contain leading and/or trailing white spaces, also they are case-insensitive.\\"\]}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to report\\"}),(0,n.jsxs)(e.ul,{children:\[(0,n.jsxs)(e.li,{children:\[(0,n.jsx)(e.code,{children:\\"product\_name\\"}),\\" in lowercase without leading or trailing white spaces.\\"\]}),(0,n.jsxs)(e.li,{children:\[(0,n.jsx)(e.code,{children:\\"sale\_date\\"}),\\" in the format \\",(0,n.jsx)(e.code,{children:\\"('YYYY-MM')\\"})\]}),(0,n.jsxs)(e.li,{children:\[(0,n.jsx)(e.code,{children:\\"total\\"}),\\" the number of times the product was sold in this month.\\",(0,n.jsx)(e.br,{}),\\"Return the result table ordered by \\",(0,n.jsx)(e.code,{children:\\"product\_name\\"}),\\" in \\",(0,n.jsx)(e.strong,{children:\\"ascending order\\"}),\\", in case of a tie order it by \\",(0,n.jsx)(e.code,{children:\\"sale\_date\\"}),\\" in ascending order.\\"\]})\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Sales\\n+------------+------------------+--------------+\\n| sale\_id | product\_name | sale\_date |\\n+------------+------------------+--------------+\\n| 1 | LCPHONE | 2000-01-16 |\\n| 2 | LCPhone | 2000-01-17 |\\n| 3 | LcPhOnE | 2000-02-18 |\\n| 4 | LCKeyCHAiN | 2000-02-19 |\\n| 5 | LCKeyChain | 2000-02-28 |\\n| 6 | Matryoshka | 2000-03-31 |\\n+------------+------------------+--------------+\\n\\nResult table:\\n+--------------+--------------+----------+\\n| product\_name | sale\_date | total |\\n+--------------+--------------+----------+\\n| lcphone | 2000-01 | 2 |\\n| lckeychain | 2000-02 | 2 |\\n| lcphone | 2000-02 | 1 |\\n| matryoshka | 2000-03 | 1 |\\n+--------------+--------------+----------+\\n\\nIn January, 2 LcPhones were sold, please note that the product names are not case sensitive and may contain spaces.\\nIn Februery, 2 LCKeychains and 1 LCPhone were sold.\\nIn March, 1 matryoshka was sold.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-119\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-119\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT TRIM(LOWER(product\_name)) AS product\_name,\\n DATE\_FORMAT(sale\_date, '%Y-%m') AS sale\_date,\\n COUNT(\*) AS total\\nFROM Sales\\nGROUP BY 1, DATE\_FORMAT(sale\_date, '%Y-%m')\\nORDER BY 1, 2;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1549-the-most-recent-orders-for-each-product--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1549-the-most-recent-orders-for-each-product--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1549. The Most Recent Orders for Each Product | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/the-most-recent-orders-for-each-product\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Customers\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| customer\_id | int |\\n| name | varchar |\\n+---------------+---------+\\ncustomer\_id is the primary key for this table.\\nThis table contains information about the customers.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Orders\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| order\_id | int |\\n| order\_date | date |\\n| customer\_id | int |\\n| product\_id | int |\\n+---------------+---------+\\norder\_id is the primary key for this table.\\nThis table contains information about the orders made by customer\_id.\\nThere will be no product ordered by the same user more than once in one day.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Products\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| product\_id | int |\\n| product\_name | varchar |\\n| price | int |\\n+---------------+---------+\\nproduct\_id is the primary key for this table.\\nThis table contains information about the Products.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the most recent order(s) of each product.\\"}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table sorted by \\",(0,n.jsx)(e.code,{children:\\"product\_name\\"}),\\" in \\",(0,n.jsx)(e.strong,{children:\\"ascending\\"}),\\" order and in case of a tie by the \\",(0,n.jsx)(e.code,{children:\\"product\_id\\"}),\\" in \\",(0,n.jsx)(e.strong,{children:\\"ascending\\"}),\\" order. If there still a tie, order them by the \\",(0,n.jsx)(e.code,{children:\\"order\_id\\"}),\\" in \\",(0,n.jsx)(e.strong,{children:\\"ascending\\"}),\\" order.\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Customers\\n+-------------+-----------+\\n| customer\_id | name |\\n+-------------+-----------+\\n| 1 | Winston |\\n| 2 | Jonathan |\\n| 3 | Annabelle |\\n| 4 | Marwan |\\n| 5 | Khaled |\\n+-------------+-----------+\\n\\nOrders\\n+----------+------------+-------------+------------+\\n| order\_id | order\_date | customer\_id | product\_id |\\n+----------+------------+-------------+------------+\\n| 1 | 2020-07-31 | 1 | 1 |\\n| 2 | 2020-07-30 | 2 | 2 |\\n| 3 | 2020-08-29 | 3 | 3 |\\n| 4 | 2020-07-29 | 4 | 1 |\\n| 5 | 2020-06-10 | 1 | 2 |\\n| 6 | 2020-08-01 | 2 | 1 |\\n| 7 | 2020-08-01 | 3 | 1 |\\n| 8 | 2020-08-03 | 1 | 2 |\\n| 9 | 2020-08-07 | 2 | 3 |\\n| 10 | 2020-07-15 | 1 | 2 |\\n+----------+------------+-------------+------------+\\n\\nProducts\\n+------------+--------------+-------+\\n| product\_id | product\_name | price |\\n+------------+--------------+-------+\\n| 1 | keyboard | 120 |\\n| 2 | mouse | 80 |\\n| 3 | screen | 600 |\\n| 4 | hard disk | 450 |\\n+------------+--------------+-------+\\n\\nResult table:\\n+--------------+------------+----------+------------+\\n| product\_name | product\_id | order\_id | order\_date |\\n+--------------+------------+----------+------------+\\n| keyboard | 1 | 6 | 2020-08-01 |\\n| keyboard | 1 | 7 | 2020-08-01 |\\n| mouse | 2 | 8 | 2020-08-03 |\\n| screen | 3 | 3 | 2020-08-29 |\\n+--------------+------------+----------+------------+\\nkeyboard's most recent order is in 2020-08-01, it was ordered two times this day.\\nmouse's most recent order is in 2020-08-03, it was ordered only once this day.\\nscreen's most recent order is in 2020-08-29, it was ordered only once this day.\\nThe hard disk was never ordered and we don't include it in the result table.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-120\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-120\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT p.product\_name, o.product\_id, o.order\_id, o.order\_date\\nFROM(\\n SELECT product\_id, order\_id, order\_date,\\n RANK() OVER(PARTITION BY product\_id ORDER BY order\_date DESC) AS seq\\n FROM orders\\n) o\\nLEFT JOIN products p\\n ON o.product\_id = p.product\_id\\nWHERE o.seq = 1\\nORDER BY 1,2,3\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1555-bank-account-summary--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1555-bank-account-summary--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1555. Bank Account Summary | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/bank-account-summary\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Users\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+---------+\\n| Column Name | Type |\\n+--------------+---------+\\n| user\_id | int |\\n| user\_name | varchar |\\n| credit | int |\\n+--------------+---------+\\nuser\_id is the primary key for this table.\\nEach row of this table contains the current credit information for each user.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Transaction\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| trans\_id | int |\\n| paid\_by | int |\\n| paid\_to | int |\\n| amount | int |\\n| transacted\_on | date |\\n+---------------+---------+\\ntrans\_id is the primary key for this table.\\nEach row of this table contains the information about the transaction in the bank.\\nUser with id (paid\_by) transfer money to user with id (paid\_to).\\n\`})}),(0,n.jsx)(e.p,{children:\\"Leetcode Bank (LCB) helps its coders in making virtual payments. Our bank records all transactions in the table Transaction, we want to find out the current balance of all users and check wheter they have breached their credit limit (If their current credit is less than 0).\\"}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to report.\\"}),(0,n.jsxs)(e.ul,{children:\[(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:\\"user\_id\\"})}),(0,n.jsx)(e.li,{children:(0,n.jsx)(e.code,{children:\\"user\_name\\"})}),(0,n.jsxs)(e.li,{children:\[(0,n.jsx)(e.code,{children:\\"credit\\"}),\\", current balance after performing transactions.\\"\]}),(0,n.jsxs)(e.li,{children:\[(0,n.jsx)(e.code,{children:\\"credit\_limit\_breached\\"}),', check credit\_limit (\\"Yes\\" or \\"No\\") Return the result table in ',(0,n.jsx)(e.strong,{children:\\"any\\"}),\\" order.\\"\]})\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Users table:\\n+------------+--------------+-------------+\\n| user\_id | user\_name | credit |\\n+------------+--------------+-------------+\\n| 1 | Moustafa | 100 |\\n| 2 | Jonathan | 200 |\\n| 3 | Winston | 10000 |\\n| 4 | Luis | 800 |\\n+------------+--------------+-------------+\\n\\nTransaction table:\\n+------------+------------+------------+----------+---------------+\\n| trans\_id | paid\_by | paid\_to | amount | transacted\_on |\\n+------------+------------+------------+----------+---------------+\\n| 1 | 1 | 3 | 400 | 2020-08-01 |\\n| 2 | 3 | 2 | 500 | 2020-08-02 |\\n| 3 | 2 | 1 | 200 | 2020-08-03 |\\n+------------+------------+------------+----------+---------------+\\n\\nResult table:\\n+------------+------------+------------+-----------------------+\\n| user\_id | user\_name | credit | credit\_limit\_breached |\\n+------------+------------+------------+-----------------------+\\n| 1 | Moustafa | -100 | Yes |\\n| 2 | Jonathan | 500 | No |\\n| 3 | Winston | 9990 | No |\\n| 4 | Luis | 800 | No |\\n+------------+------------+------------+-----------------------+\\nMoustafa paid $400 on \\"2020-08-01\\" and received $200 on \\"2020-08-03\\", credit (100 -400 +200) = -$100\\nJonathan received $500 on \\"2020-08-02\\" and paid $200 on \\"2020-08-08\\", credit (200 +500 -200) = $500\\nWinston received $400 on \\"2020-08-01\\" and paid $500 on \\"2020-08-03\\", credit (10000 +400 -500) = $9990\\nLuis didn't received any transfer, credit = $800\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-121\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-121\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT Users.user\_id AS user\_id\\n , Users.user\_name AS user\_name\\n , credit+IFNULL(SUM(trans),0) AS credit\\n , CASE WHEN credit+IFNULL(SUM(trans),0)\\u003e0 THEN 'No' ELSE 'Yes' END AS credit\_limit\_breached\\nFROM(\\n SELECT paid\_by AS user\_id, -amount AS trans\\n FROM Transaction\\n UNION ALL\\n SELECT paid\_to AS user\_id, amount AS trans\\n FROM Transaction\\n) t RIGHT JOIN users ON t.user\_id=users.user\_id\\nGROUP BY user\_id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1565-unique-orders-and-customers-per-month--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1565-unique-orders-and-customers-per-month--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1565. Unique Orders and Customers Per Month | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/unique-orders-and-customers-per-month\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Orders\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| order\_id | int |\\n| order\_date | date |\\n| customer\_id | int |\\n| invoice | int |\\n+---------------+---------+\\norder\_id is the primary key for this table.\\nThis table contains information about the orders made by customer\_id.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to find the number of \\",(0,n.jsx)(e.strong,{children:\\"unique orders\\"}),\\" and the number of \\",(0,n.jsx)(e.strong,{children:\\"unique users\\"}),\\" with invoices \\u003e \\",(0,n.jsx)(e.strong,{children:\\"$20\\"}),\\" for each \\",(0,n.jsx)(e.strong,{children:\\"different month\\"}),\\".\\"\]}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table sorted in \\",(0,n.jsx)(e.strong,{children:\\"any order\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Orders\\n+----------+------------+-------------+------------+\\n| order\_id | order\_date | customer\_id | invoice |\\n+----------+------------+-------------+------------+\\n| 1 | 2020-09-15 | 1 | 30 |\\n| 2 | 2020-09-17 | 2 | 90 |\\n| 3 | 2020-10-06 | 3 | 20 |\\n| 4 | 2020-10-20 | 3 | 21 |\\n| 5 | 2020-11-10 | 1 | 10 |\\n| 6 | 2020-11-21 | 2 | 15 |\\n| 7 | 2020-12-01 | 4 | 55 |\\n| 8 | 2020-12-03 | 4 | 77 |\\n| 9 | 2021-01-07 | 3 | 31 |\\n| 10 | 2021-01-15 | 2 | 20 |\\n+----------+------------+-------------+------------+\\n\\nResult table:\\n+---------+-------------+----------------+\\n| month | order\_count | customer\_count |\\n+---------+-------------+----------------+\\n| 2020-09 | 2 | 2 |\\n| 2020-10 | 1 | 1 |\\n| 2020-12 | 2 | 1 |\\n| 2021-01 | 1 | 1 |\\n+---------+-------------+----------------+\\nIn September 2020 we have two orders from 2 different customers with invoices \\u003e $20.\\nIn October 2020 we have two orders from 1 customer, and only one of the two orders has invoice \\u003e $20.\\nIn November 2020 we have two orders from 2 different customers but invoices \\u003c $20, so we don't include that month.\\nIn December 2020 we have two orders from 1 customer both with invoices \\u003e $20.\\nIn January 2021 we have two orders from 2 different customers, but only one of them with invoice \\u003e $20.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-122\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-122\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nSELECT DATE\_FORMAT(order\_date, '%Y-%m') AS month, COUNT(DISTINCT order\_id) AS order\_count, COUNT(DISTINCT customer\_id) AS customer\_count\\n FROM Orders\\n WHERE invoice \\u003e 20\\n GROUP BY YEAR(order\_date), MONTH(order\_date);\\n\\n#Solution 2:\\nSELECT LEFT(order\_date, 7) AS month, COUNT(DISTINCT order\_id) AS order\_count,\\n\\tCOUNT(DISTINCT customer\_id) AS customer\_count\\nFROM orders\\nWHERE invoice \\u003e 20\\nGROUP BY month\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1571-warehouse-manager--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1571-warehouse-manager--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1571. Warehouse Manager | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/warehouse-manager\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Warehouse\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+---------+\\n| Column Name | Type |\\n+--------------+---------+\\n| name | varchar |\\n| product\_id | int |\\n| units | int |\\n+--------------+---------+\\n(name, product\_id) is the primary key for this table.\\nEach row of this table contains the information of the products in each warehouse.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Products\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| product\_id | int |\\n| product\_name | varchar |\\n| Width | int |\\n| Length | int |\\n| Height | int |\\n+---------------+---------+\\nproduct\_id is the primary key for this table.\\nEach row of this table contains the information about the product dimensions (Width, Lenght and Height) in feets of each product.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to report, How much cubic feet of \\",(0,n.jsx)(e.strong,{children:\\"volume\\"}),\\" does the inventory occupy in each warehouse.\\"\]}),(0,n.jsxs)(e.ul,{children:\[(0,n.jsx)(e.li,{children:\\"warehouse\_name\\"}),(0,n.jsxs)(e.li,{children:\[\\"volume\\",(0,n.jsx)(e.br,{}),\\"Return the result table in \\",(0,n.jsx)(e.strong,{children:\\"any\\"}),\\" order.\\"\]})\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Warehouse table:\\n+------------+--------------+-------------+\\n| name | product\_id | units |\\n+------------+--------------+-------------+\\n| LCHouse1 | 1 | 1 |\\n| LCHouse1 | 2 | 10 |\\n| LCHouse1 | 3 | 5 |\\n| LCHouse2 | 1 | 2 |\\n| LCHouse2 | 2 | 2 |\\n| LCHouse3 | 4 | 1 |\\n+------------+--------------+-------------+\\n\\nProducts table:\\n+------------+--------------+------------+----------+-----------+\\n| product\_id | product\_name | Width | Length | Height |\\n+------------+--------------+------------+----------+-----------+\\n| 1 | LC-TV | 5 | 50 | 40 |\\n| 2 | LC-KeyChain | 5 | 5 | 5 |\\n| 3 | LC-Phone | 2 | 10 | 10 |\\n| 4 | LC-T-Shirt | 4 | 10 | 20 |\\n+------------+--------------+------------+----------+-----------+\\n\\nResult table:\\n+----------------+------------+\\n| warehouse\_name | volume |\\n+----------------+------------+\\n| LCHouse1 | 12250 |\\n| LCHouse2 | 20250 |\\n| LCHouse3 | 800 |\\n+----------------+------------+\\nVolume of product\_id = 1 (LC-TV), 5x50x40 = 10000\\nVolume of product\_id = 2 (LC-KeyChain), 5x5x5 = 125\\nVolume of product\_id = 3 (LC-Phone), 2x10x10 = 200\\nVolume of product\_id = 4 (LC-T-Shirt), 4x10x20 = 800\\nLCHouse1: 1 unit of LC-TV + 10 units of LC-KeyChain + 5 units of LC-Phone.\\n Total volume: 1\*10000 + 10\*125 + 5\*200 = 12250 cubic feet\\nLCHouse2: 2 units of LC-TV + 2 units of LC-KeyChain.\\n Total volume: 2\*10000 + 2\*125 = 20250 cubic feet\\nLCHouse3: 1 unit of LC-T-Shirt.\\n Total volume: 1\*800 = 800 cubic feet.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-123\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-123\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT a.name AS warehouse\_name,\\nSUM(a.units \* b.Width \* b.Length \* b.Height) AS volume\\nFROM Warehouse AS a\\nLEFT JOIN Products AS b\\nON a.product\_id = b.product\_id\\nGROUP BY a.name;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1581-customer-who-visited-but-did-not-make-any-transactions--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1581-customer-who-visited-but-did-not-make-any-transactions--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1581. Customer Who Visited but Did Not Make Any Transactions | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/customer-who-visited-but-did-not-make-any-transactions\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Visits\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| visit\_id | int |\\n| customer\_id | int |\\n+-------------+---------+\\nvisit\_id is the primary key for this table.\\nThis table contains information about the customers who visited the mall.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Transactions\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----------------+---------+\\n| Column Name | Type |\\n+----------------+---------+\\n| transaction\_id | int |\\n| visit\_id | int |\\n| amount | int |\\n+----------------+---------+\\ntransaction\_id is the primary key for this table.\\nThis table contains information about the customers who visited the mall.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the IDs of the users who visited without making any transactions and the number of times they made these types of visits.\\"}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table sorted in \\",(0,n.jsx)(e.strong,{children:\\"any orders\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Visits\\n+----------+-------------+\\n| visit\_id | customer\_id |\\n+----------+-------------+\\n| 1 | 23 |\\n| 2 | 9 |\\n| 4 | 30 |\\n| 5 | 54 |\\n| 6 | 96 |\\n| 7 | 54 |\\n| 8 | 54 |\\n+----------+-------------+\\n\\nTransactions\\n+----------------+----------+--------+\\n| transaction\_id | visit\_id | amount |\\n+----------------+----------+--------+\\n| 2 | 5 | 310 |\\n| 3 | 5 | 300 |\\n| 9 | 5 | 200 |\\n| 12 | 1 | 910 |\\n| 13 | 2 | 970 |\\n+----------------+----------+--------+\\n\\nResult table:\\n+-------------+----------------+\\n| customer\_id | count\_no\_trans |\\n+-------------+----------------+\\n| 54 | 2 |\\n| 30 | 1 |\\n| 96 | 1 |\\n+-------------+----------------+\\nCustomer with id = 23 visited the mall once and made one transaction during the visit with id = 12.\\nCustomer with id = 9 visited the mall once and made one transaction during the visit with id = 13.\\nCustomer with id = 30 visited the mall once and did not make any transactions.\\nCustomer with id = 54 visited the mall three times. During 2 visits they did not make any transactions, and during one visit they made 3 transactions.\\nCustomer with id = 96 visited the mall once and did not make any transactions.\\nAs we can see, users with IDs 30 and 96 visited the mall one time without making any transactions. Also user 54 visited the mall twice and did not make any transactions.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-124\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-124\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nSELECT a.customer\_id, COUNT(a.visit\_id) AS count\_no\_trans FROM Visits AS a\\nLEFT JOIN Transactions AS b\\nON a.visit\_id = b.visit\_id\\nWHERE b.transaction\_id IS NULL\\nGROUP BY a.customer\_id;\\n\\n#Solution 2:\\nSELECT customer\_id, count(visit\_id) AS count\_no\_trans\\nFROM Visits\\nWHERE visit\_id NOT IN\\n (SELECT visit\_id\\n FROM Transactions\\n GROUP BY visit\_id)\\nGROUP BY customer\_id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1587-bank-account-summary-ii--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1587-bank-account-summary-ii--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1587. Bank Account Summary II | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/bank-account-summary-ii\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Users\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+---------+\\n| Column Name | Type |\\n+--------------+---------+\\n| account | int |\\n| name | varchar |\\n+--------------+---------+\\naccount is the primary key for this table.\\nEach row of this table contains the account number of each user in the bank.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Transactions\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| trans\_id | int |\\n| account | int |\\n| amount | int |\\n| transacted\_on | date |\\n+---------------+---------+\\ntrans\_id is the primary key for this table.\\nEach row of this table contains all changes made to all accounts.\\namount is positive if the user received money and negative if they transferred money.\\nAll accounts start with a balance 0.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to report the name and balance of users with a balance higher than 10000. The balance of an account is equal to the sum of the amounts of all transactions involving that account.\\"}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table in \\",(0,n.jsx)(e.strong,{children:\\"any\\"}),\\" order.\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Users table:\\n+------------+--------------+\\n| account | name |\\n+------------+--------------+\\n| 900001 | Alice |\\n| 900002 | Bob |\\n| 900003 | Charlie |\\n+------------+--------------+\\n\\nTransactions table:\\n+------------+------------+------------+---------------+\\n| trans\_id | account | amount | transacted\_on |\\n+------------+------------+------------+---------------+\\n| 1 | 900001 | 7000 | 2020-08-01 |\\n| 2 | 900001 | 7000 | 2020-09-01 |\\n| 3 | 900001 | -3000 | 2020-09-02 |\\n| 4 | 900002 | 1000 | 2020-09-12 |\\n| 5 | 900003 | 6000 | 2020-08-07 |\\n| 6 | 900003 | 6000 | 2020-09-07 |\\n| 7 | 900003 | -4000 | 2020-09-11 |\\n+------------+------------+------------+---------------+\\n\\nResult table:\\n+------------+------------+\\n| name | balance |\\n+------------+------------+\\n| Alice | 11000 |\\n+------------+------------+\\nAlice's balance is (7000 + 7000 - 3000) = 11000.\\nBob's balance is 1000.\\nCharlie's balance is (6000 + 6000 - 4000) = 8000.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-125\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-125\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nSELECT u.name AS NAME,SUM(t.amount) AS BALANCE\\nFROM Transactions t LEFT JOIN Users u\\nON u.account = t.account\\nGROUP BY u.account\\nHAVING SUM(t.amount)\\u003e10000;\\n\\n\\n#Solution 2:\\nWITH tmp AS(\\nSELECT t.account, u.name, SUM(amount) AS balance\\nFROM Transactions t\\nLEFT JOIN Users u ON t.account = u.account\\nGROUP BY account )\\n\\nSELECT name, balance\\nFROM tmp\\nWHERE balance \\u003e 10000\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1596-the-most-frequently-ordered-products-for-each-customer--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1596-the-most-frequently-ordered-products-for-each-customer--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1596. The Most Frequently Ordered Products for Each Customer | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/the-most-frequently-ordered-products-for-each-customer\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Customers\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| customer\_id | int |\\n| name | varchar |\\n+---------------+---------+\\ncustomer\_id is the primary key for this table.\\nThis table contains information about the customers.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Orders\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| order\_id | int |\\n| order\_date | date |\\n| customer\_id | int |\\n| product\_id | int |\\n+---------------+---------+\\norder\_id is the primary key for this table.\\nThis table contains information about the orders made by customer\_id.\\nNo customer will order the same product more than once in a single day.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Products\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| product\_id | int |\\n| product\_name | varchar |\\n| price | int |\\n+---------------+---------+\\nproduct\_id is the primary key for this table.\\nThis table contains information about the products.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the most frequently ordered product(s) for each customer.\\"}),(0,n.jsxs)(e.p,{children:\[\\"The result table should have the \\",(0,n.jsx)(e.code,{children:\\"product\_id\\"}),\\" and \\",(0,n.jsx)(e.code,{children:\\"product\_name\\"}),\\" for each \\",(0,n.jsx)(e.code,{children:\\"customer\_id\\"}),\\" who ordered at least one order. Return the result table in \\",(0,n.jsx)(e.strong,{children:\\"any order\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Customers\\n+-------------+-------+\\n| customer\_id | name |\\n+-------------+-------+\\n| 1 | Alice |\\n| 2 | Bob |\\n| 3 | Tom |\\n| 4 | Jerry |\\n| 5 | John |\\n+-------------+-------+\\n\\nOrders\\n+----------+------------+-------------+------------+\\n| order\_id | order\_date | customer\_id | product\_id |\\n+----------+------------+-------------+------------+\\n| 1 | 2020-07-31 | 1 | 1 |\\n| 2 | 2020-07-30 | 2 | 2 |\\n| 3 | 2020-08-29 | 3 | 3 |\\n| 4 | 2020-07-29 | 4 | 1 |\\n| 5 | 2020-06-10 | 1 | 2 |\\n| 6 | 2020-08-01 | 2 | 1 |\\n| 7 | 2020-08-01 | 3 | 3 |\\n| 8 | 2020-08-03 | 1 | 2 |\\n| 9 | 2020-08-07 | 2 | 3 |\\n| 10 | 2020-07-15 | 1 | 2 |\\n+----------+------------+-------------+------------+\\n\\nProducts\\n+------------+--------------+-------+\\n| product\_id | product\_name | price |\\n+------------+--------------+-------+\\n| 1 | keyboard | 120 |\\n| 2 | mouse | 80 |\\n| 3 | screen | 600 |\\n| 4 | hard disk | 450 |\\n+------------+--------------+-------+\\nResult table:\\n+-------------+------------+--------------+\\n| customer\_id | product\_id | product\_name |\\n+-------------+------------+--------------+\\n| 1 | 2 | mouse |\\n| 2 | 1 | keyboard |\\n| 2 | 2 | mouse |\\n| 2 | 3 | screen |\\n| 3 | 3 | screen |\\n| 4 | 1 | keyboard |\\n+-------------+------------+--------------+\\n\\nAlice (customer 1) ordered the mouse three times and the keyboard one time, so the mouse is the most frquently ordered product for them.\\nBob (customer 2) ordered the keyboard, the mouse, and the screen one time, so those are the most frquently ordered products for them.\\nTom (customer 3) only ordered the screen (two times), so that is the most frquently ordered product for them.\\nJerry (customer 4) only ordered the keyboard (one time), so that is the most frquently ordered product for them.\\nJohn (customer 5) did not order anything, so we do not include them in the result table.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-126\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-126\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nSELECT customer\_id, Products.product\_id, Products.product\_name FROM\\n(SELECT customer\_id, product\_id, order\_count, RANK() OVER(PARTITION BY customer\_id ORDER BY order\_count DESC) r From\\n(SELECT customer\_id, product\_id, COUNT(DISTINCT order\_id) AS order\_count FROM Orders\\nGROUP BY customer\_id, product\_id) order\_counts) order\_counts\_ranked\\nJOIN Products ON order\_counts\_ranked.product\_id = Products.product\_id\\nWHERE r = 1;\\n\\n#solution- 2:\\n\\nSELECT customer\_id, T.product\_id, product\_name\\nFROM(\\n SELECT customer\_id, product\_id,\\n RANK() OVER( PARTITION BY customer\_id ORDER BY COUNT(\*) DESC ) AS RK\\n FROM Orders o\\n GROUP BY customer\_id, product\_id\\n) T\\nLEFT JOIN Products p on p.product\_id = t.product\_id\\nWHERE RK=1\\n\\n\\n#Solution-3:\\n\\nWITH\\n\\ntmp AS (\\n SELECT a.customer\_id, b.product\_id, c.product\_name,\\n COUNT(b.order\_id) OVER(PARTITION BY a.customer\_id, b.product\_id) AS freq\\n FROM Customers AS a\\n JOIN Orders AS b\\n ON a.customer\_id = b.customer\_id\\n JOIN Products AS c\\n ON b.product\_id = c.product\_id\\n),\\n\\ntmp1 AS (\\n SELECT customer\_id, product\_id, product\_name, freq,\\n DENSE\_RANK() OVER(PARTITION BY customer\_id ORDER BY freq DESC) AS rnk\\n FROM tmp\\n)\\n\\nSELECT DISTINCT customer\_id, product\_id, product\_name FROM tmp1\\nWHERE rnk = 1;\\n\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1607-sellers-with-no-sales--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1607-sellers-with-no-sales--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1607. Sellers With No Sales | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/sellers-with-no-sales\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Customer\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| customer\_id | int |\\n| customer\_name | varchar |\\n+---------------+---------+\\ncustomer\_id is the primary key for this table.\\nEach row of this table contains the information of each customer in the WebStore.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Orders\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| order\_id | int |\\n| sale\_date | date |\\n| order\_cost | int |\\n| customer\_id | int |\\n| seller\_id | int |\\n+---------------+---------+\\norder\_id is the primary key for this table.\\nEach row of this table contains all orders made in the webstore.\\nsale\_date is the date when the transaction was made between the customer (customer\_id) and the seller (seller\_id).\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Seller\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| seller\_id | int |\\n| seller\_name | varchar |\\n+---------------+---------+\\nseller\_id is the primary key for this table.\\nEach row of this table contains the information of each seller.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to report the names of all sellers who did not make any sales in 2020.\\"}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table ordered by \\",(0,n.jsx)(e.code,{children:\\"seller\_name\\"}),\\" in ascending order.\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Customer table:\\n+--------------+---------------+\\n| customer\_id | customer\_name |\\n+--------------+---------------+\\n| 101 | Alice |\\n| 102 | Bob |\\n| 103 | Charlie |\\n+--------------+---------------+\\n\\nOrders table:\\n+-------------+------------+--------------+-------------+-------------+\\n| order\_id | sale\_date | order\_cost | customer\_id | seller\_id |\\n+-------------+------------+--------------+-------------+-------------+\\n| 1 | 2020-03-01 | 1500 | 101 | 1 |\\n| 2 | 2020-05-25 | 2400 | 102 | 2 |\\n| 3 | 2019-05-25 | 800 | 101 | 3 |\\n| 4 | 2020-09-13 | 1000 | 103 | 2 |\\n| 5 | 2019-02-11 | 700 | 101 | 2 |\\n+-------------+------------+--------------+-------------+-------------+\\n\\nSeller table:\\n+-------------+-------------+\\n| seller\_id | seller\_name |\\n+-------------+-------------+\\n| 1 | Daniel |\\n| 2 | Elizabeth |\\n| 3 | Frank |\\n+-------------+-------------+\\n\\nResult table:\\n+-------------+\\n| seller\_name |\\n+-------------+\\n| Frank |\\n+-------------+\\nDaniel made 1 sale in March 2020.\\nElizabeth made 2 sales in 2020 and 1 sale in 2019.\\nFrank made 1 sale in 2019 but no sales in 2020.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-127\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-127\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT seller\_name FROM Seller\\nWHERE seller\_id NOT IN (\\nSELECT DISTINCT seller\_id FROM Orders\\nWHERE YEAR(sale\_date)='2020'\\n)\\nORDER BY seller\_name;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1613-find-the-missing-ids--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1613-find-the-missing-ids--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1613. Find the Missing IDs | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/find-the-missing-ids\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Customers\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| customer\_id | int |\\n| customer\_name | varchar |\\n+---------------+---------+\\ncustomer\_id is the primary key for this table.\\nEach row of this table contains the name and the id customer.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to find the missing customer IDs. The missing IDs are ones that are not in the \\",(0,n.jsx)(e.code,{children:\\"Customers\\"}),\\" table but are in the range between \\",(0,n.jsx)(e.code,{children:\\"1\\"}),\\" and the \\",(0,n.jsx)(e.strong,{children:\\"maximum\\"}),\\" \\",(0,n.jsx)(e.code,{children:\\"customer\_id\\"}),\\" present in the table.\\"\]}),(0,n.jsxs)(e.p,{children:\[(0,n.jsx)(e.strong,{children:\\"Notice\\"}),\\" that the maximum \\",(0,n.jsx)(e.code,{children:\\"customer\_id\\"}),\\" will not exceed 100.\\"\]}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table ordered by \\",(0,n.jsx)(e.strong,{children:\\"ids\\"}),\\" in \\",(0,n.jsx)(e.strong,{children:(0,n.jsx)(e.em,{children:\\"ascending order\\"})}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`\\nCustomer table:\\n+-------------+---------------+\\n| customer\_id | customer\_name |\\n+-------------+---------------+\\n| 1 | Alice |\\n| 4 | Bob |\\n| 5 | Charlie |\\n+-------------+---------------+\\n\\nResult table:\\n+-----+\\n| ids |\\n+-----+\\n| 2 |\\n| 3 |\\n+-----+\\nThe maximum customer\_id present in the table is 5, so in the range \[1,5\], IDs 2 and 3 are missing from the table.\\n\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-128\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-128\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`WITH RECURSIVE CTE AS(\\n SELECT 1 AS 'id', MAX(c.customer\_id) AS 'Max\_Id'\\n FROM Customers c\\n UNION ALL\\n SELECT id+1, Max\_Id\\n FROM CTE\\n WHERE id \\u003c Max\_id\\n)\\n\\nSELECT id AS 'ids'\\nFROM CTE c\\nWHERE c.id NOT IN (SELECT customer\_id FROM Customers)\\nORDER BY 1 ASC\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1623-all-valid-triplets-that-can-represent-a-country--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1623-all-valid-triplets-that-can-represent-a-country--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1623. All Valid Triplets That Can Represent a Country | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/all-valid-triplets-that-can-represent-a-country\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"SchoolA\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| student\_id | int |\\n| student\_name | varchar |\\n+---------------+---------+\\nstudent\_id is the primary key for this table.\\nEach row of this table contains the name and the id of a student in school A.\\nAll student\_name are distinct.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"SchoolB\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| student\_id | int |\\n| student\_name | varchar |\\n+---------------+---------+\\nstudent\_id is the primary key for this table.\\nEach row of this table contains the name and the id of a student in school B.\\nAll student\_name are distinct.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"SchoolC\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| student\_id | int |\\n| student\_name | varchar |\\n+---------------+---------+\\nstudent\_id is the primary key for this table.\\nEach row of this table contains the name and the id of a student in school C.\\nAll student\_name are distinct.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"There is a country with three schools, where each student is enrolled in \\",(0,n.jsx)(e.strong,{children:\\"exactly one\\"}),\\" school. The country is joining a competition and wants to select one student from each school to represent the country such that:\\"\]}),(0,n.jsxs)(e.ul,{children:\[(0,n.jsxs)(e.li,{children:\[(0,n.jsx)(e.code,{children:\\"member\_A\\"}),\\" is selected from \\",(0,n.jsx)(e.code,{children:\\"SchoolA\\"}),\\",\\"\]}),(0,n.jsxs)(e.li,{children:\[(0,n.jsx)(e.code,{children:\\"member\_B\\"}),\\" is selected from \\",(0,n.jsx)(e.code,{children:\\"SchoolB\\"}),\\",\\"\]}),(0,n.jsxs)(e.li,{children:\[(0,n.jsx)(e.code,{children:\\"member\_C\\"}),\\" is selected from \\",(0,n.jsx)(e.code,{children:\\"SchoolC\\"}),\\", and The selected students' names and IDs are pairwise distinct (i.e. no two students share the same name, and no two students share the same ID). Write an SQL query to find all the possible triplets representing the country under the given constraints.\\"\]})\]}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table in \\",(0,n.jsx)(e.strong,{children:\\"any order\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`SchoolA table:\\n+------------+--------------+\\n| student\_id | student\_name |\\n+------------+--------------+\\n| 1 | Alice |\\n| 2 | Bob |\\n+------------+--------------+\\n\\nSchoolB table:\\n+------------+--------------+\\n| student\_id | student\_name |\\n+------------+--------------+\\n| 3 | Tom |\\n+------------+--------------+\\n\\nSchoolC table:\\n+------------+--------------+\\n| student\_id | student\_name |\\n+------------+--------------+\\n| 3 | Tom |\\n| 2 | Jerry |\\n| 10 | Alice |\\n+------------+--------------+\\n\\nResult table:\\n+----------+----------+----------+\\n| member\_A | member\_B | member\_C |\\n+----------+----------+----------+\\n| Alice | Tom | Jerry |\\n| Bob | Tom | Alice |\\n+----------+----------+----------+\\nLet us see all the possible triplets.\\n- (Alice, Tom, Tom) --\\u003e Rejected because member\_B and member\_C have the same name and the same ID.\\n- (Alice, Tom, Jerry) --\\u003e Valid triplet.\\n- (Alice, Tom, Alice) --\\u003e Rejected because member\_A and member\_C have the same name.\\n- (Bob, Tom, Tom) --\\u003e Rejected because member\_B and member\_C have the same name and the same ID.\\n- (Bob, Tom, Jerry) --\\u003e Rejected because member\_A and member\_C have the same ID.\\n- (Bob, Tom, Alice) --\\u003e Valid triplet.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-129\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-129\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT a.student\_name AS 'member\_A',\\nb.student\_name AS 'member\_B',\\nc.student\_name AS 'member\_C'\\nFROM SchoolA AS a\\nJOIN SchoolB AS b\\nON a.student\_id \\u003c\\u003e b.student\_id\\nAND a.student\_name \\u003c\\u003e b.student\_name\\nJOIN SchoolC AS c\\nON a.student\_id \\u003c\\u003e c.student\_id\\nAND b.student\_id \\u003c\\u003e c.student\_id\\nAND a.student\_name \\u003c\\u003e c.student\_name\\nAND b.student\_name \\u003c\\u003e c.student\_name;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1633-percentage-of-users-attended-a-contest--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1633-percentage-of-users-attended-a-contest--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1633. Percentage of Users Attended a Contest | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/percentage-of-users-attended-a-contest\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Users\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| user\_id | int |\\n| user\_name | varchar |\\n+-------------+---------+\\nuser\_id is the primary key for this table.\\nEach row of this table contains the name and the id of a user.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Register\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| contest\_id | int |\\n| user\_id | int |\\n+-------------+---------+\\n(contest\_id, user\_id) is the primary key for this table.\\nEach row of this table contains the id of a user and the contest they registered into.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the percentage of the users registered in each contest rounded to two decimals.\\"}),(0,n.jsx)(e.p,{children:\\"Return the result table ordered by percentage in descending order. In case of a tie, order it by contest\_id in ascending order.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Users table:\\n+---------+-----------+\\n| user\_id | user\_name |\\n+---------+-----------+\\n| 6 | Alice |\\n| 2 | Bob |\\n| 7 | Alex |\\n+---------+-----------+\\n\\nRegister table:\\n+------------+---------+\\n| contest\_id | user\_id |\\n+------------+---------+\\n| 215 | 6 |\\n| 209 | 2 |\\n| 208 | 2 |\\n| 210 | 6 |\\n| 208 | 6 |\\n| 209 | 7 |\\n| 209 | 6 |\\n| 215 | 7 |\\n| 208 | 7 |\\n| 210 | 2 |\\n| 207 | 2 |\\n| 210 | 7 |\\n+------------+---------+\\n\\nResult table:\\n+------------+------------+\\n| contest\_id | percentage |\\n+------------+------------+\\n| 208 | 100.0 |\\n| 209 | 100.0 |\\n| 210 | 100.0 |\\n| 215 | 66.67 |\\n| 207 | 33.33 |\\n+------------+------------+\\nAll the users registered in contests 208, 209, and 210. The percentage is 100% and we sort them in the answer table in ascending order.\\nAlice and Alex registered in contest 215 and the percentage is ((2/3) \* 100) = 66.67%\\nBob registered in contest 207 and the percentage is ((1/3) \* 100) = 33.33%\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-130\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-130\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT contest\_id, ROUND(COUNT(user\_id)\*100.00/(SELECT COUNT(\*) FROM users),2) as percentage\\nFROM register\\nGROUP BY contest\_id\\nORDER BY percentage desc, contest\_id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1635-hopper-company-queries-i--hard---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1635-hopper-company-queries-i--hard---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1635. Hopper Company Queries I | Hard | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/hopper-company-queries-i\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Drivers\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| driver\_id | int |\\n| join\_date | date |\\n+-------------+---------+\\ndriver\_id is the primary key for this table.\\nEach row of this table contains the driver's ID and the date they joined the Hopper company.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Rides\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+---------+\\n| Column Name | Type |\\n+--------------+---------+\\n| ride\_id | int |\\n| user\_id | int |\\n| requested\_at | date |\\n+--------------+---------+\\nride\_id is the primary key for this table.\\nEach row of this table contains the ID of a ride, the user's ID that requested it, and the day they requested it.\\nThere may be some ride requests in this table that were not accepted.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"AcceptedRides\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| ride\_id | int |\\n| driver\_id | int |\\n| ride\_distance | int |\\n| ride\_duration | int |\\n+---------------+---------+\\nride\_id is the primary key for this table.\\nEach row of this table contains some information about an accepted ride.\\nIt is guaranteed that each accepted ride exists in the Rides table.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to report the following statistics for each month of \\",(0,n.jsx)(e.strong,{children:\\"2020\\"}),\\":\\"\]}),(0,n.jsxs)(e.p,{children:\[\\"The number of drivers currently with the Hopper company by the end of the month (\\",(0,n.jsx)(e.strong,{children:\\"active\_drivers\\"}),\\"). The number of accepted rides in that month (\\",(0,n.jsx)(e.strong,{children:\\"accepted\_rides\\"}),\\"). Return the result table ordered by \\",(0,n.jsx)(e.strong,{children:\\"month\\"}),\\" in ascending order, where \\",(0,n.jsx)(e.strong,{children:\\"month\\"}),\\" is the month's number (January is \\",(0,n.jsx)(e.strong,{children:\\"1\\"}),\\", February is \\",(0,n.jsx)(e.strong,{children:\\"2\\"}),\\", etc.).\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Drivers table:\\n+-----------+------------+\\n| driver\_id | join\_date |\\n+-----------+------------+\\n| 10 | 2019-12-10 |\\n| 8 | 2020-1-13 |\\n| 5 | 2020-2-16 |\\n| 7 | 2020-3-8 |\\n| 4 | 2020-5-17 |\\n| 1 | 2020-10-24 |\\n| 6 | 2021-1-5 |\\n+-----------+------------+\\n\\nRides table:\\n+---------+---------+--------------+\\n| ride\_id | user\_id | requested\_at |\\n+---------+---------+--------------+\\n| 6 | 75 | 2019-12-9 |\\n| 1 | 54 | 2020-2-9 |\\n| 10 | 63 | 2020-3-4 |\\n| 19 | 39 | 2020-4-6 |\\n| 3 | 41 | 2020-6-3 |\\n| 13 | 52 | 2020-6-22 |\\n| 7 | 69 | 2020-7-16 |\\n| 17 | 70 | 2020-8-25 |\\n| 20 | 81 | 2020-11-2 |\\n| 5 | 57 | 2020-11-9 |\\n| 2 | 42 | 2020-12-9 |\\n| 11 | 68 | 2021-1-11 |\\n| 15 | 32 | 2021-1-17 |\\n| 12 | 11 | 2021-1-19 |\\n| 14 | 18 | 2021-1-27 |\\n+---------+---------+--------------+\\n\\nAcceptedRides table:\\n+---------+-----------+---------------+---------------+\\n| ride\_id | driver\_id | ride\_distance | ride\_duration |\\n+---------+-----------+---------------+---------------+\\n| 10 | 10 | 63 | 38 |\\n| 13 | 10 | 73 | 96 |\\n| 7 | 8 | 100 | 28 |\\n| 17 | 7 | 119 | 68 |\\n| 20 | 1 | 121 | 92 |\\n| 5 | 7 | 42 | 101 |\\n| 2 | 4 | 6 | 38 |\\n| 11 | 8 | 37 | 43 |\\n| 15 | 8 | 108 | 82 |\\n| 12 | 8 | 38 | 34 |\\n| 14 | 1 | 90 | 74 |\\n+---------+-----------+---------------+---------------+\\n\\nResult table:\\n+-------+----------------+----------------+\\n| month | active\_drivers | accepted\_rides |\\n+-------+----------------+----------------+\\n| 1 | 2 | 0 |\\n| 2 | 3 | 0 |\\n| 3 | 4 | 1 |\\n| 4 | 4 | 0 |\\n| 5 | 5 | 0 |\\n| 6 | 5 | 1 |\\n| 7 | 5 | 1 |\\n| 8 | 5 | 1 |\\n| 9 | 5 | 0 |\\n| 10 | 6 | 0 |\\n| 11 | 6 | 2 |\\n| 12 | 6 | 1 |\\n+-------+----------------+----------------+\\n\\nBy the end of January --\\u003e two active drivers (10, 8) and no accepted rides.\\nBy the end of February --\\u003e three active drivers (10, 8, 5) and no accepted rides.\\nBy the end of March --\\u003e four active drivers (10, 8, 5, 7) and one accepted ride (10).\\nBy the end of April --\\u003e four active drivers (10, 8, 5, 7) and no accepted rides.\\nBy the end of May --\\u003e five active drivers (10, 8, 5, 7, 4) and no accepted rides.\\nBy the end of June --\\u003e five active drivers (10, 8, 5, 7, 4) and one accepted ride (13).\\nBy the end of July --\\u003e five active drivers (10, 8, 5, 7, 4) and one accepted ride (7).\\nBy the end of August --\\u003e five active drivers (10, 8, 5, 7, 4) and one accepted ride (17).\\nBy the end of Septemeber --\\u003e five active drivers (10, 8, 5, 7, 4) and no accepted rides.\\nBy the end of October --\\u003e six active drivers (10, 8, 5, 7, 4, 1) and no accepted rides.\\nBy the end of November --\\u003e six active drivers (10, 8, 5, 7, 4, 1) and two accepted rides (20, 5).\\nBy the end of December --\\u003e six active drivers (10, 8, 5, 7, 4, 1) and one accepted ride (2).\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-131\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-131\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT t.month,\\n COUNT(DISTINCT driver\_id) active\_drivers,\\n COUNT(DISTINCT rides.ride\_id) accepted\_rides\\nFROM\\n ((SELECT 1 AS month)\\n UNION (SELECT 2 AS month)\\n UNION (SELECT 3 AS month)\\n UNION (SELECT 4 AS month)\\n UNION (SELECT 5 AS month)\\n UNION (SELECT 6 AS month)\\n UNION (SELECT 7 AS month)\\n UNION (SELECT 8 AS month)\\n UNION (SELECT 9 AS month)\\n UNION (SELECT 10 AS month)\\n UNION (SELECT 11 AS month)\\n UNION (SELECT 12 AS month)) t\\nLEFT JOIN\\n (SELECT driver\_id,\\n (CASE WHEN year(join\_date) = 2019 THEN '1' ELSE month(join\_date) END) \\\\\`month\\\\\`\\n FROM Drivers\\n WHERE year(join\_date) \\u003c= 2020) d\\nON d.month \\u003c= t.month\\nLEFT JOIN\\n (SELECT month(requested\_at) AS \\\\\`month\\\\\`, a.ride\_id\\n FROM AcceptedRides a\\n JOIN Rides r\\n ON r.ride\_id = a.ride\_id\\n WHERE year(requested\_at) = 2020) rides\\nON t.month = rides.month\\nGROUP BY t.month\\nORDER BY t.month\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1645-hopper-company-queries-ii--hard---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1645-hopper-company-queries-ii--hard---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1645. Hopper Company Queries II | Hard | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/hopper-company-queries-ii\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Drivers\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| driver\_id | int |\\n| join\_date | date |\\n+-------------+---------+\\ndriver\_id is the primary key for this table.\\nEach row of this table contains the driver's ID and the date they joined the Hopper company.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Rides\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+---------+\\n| Column Name | Type |\\n+--------------+---------+\\n| ride\_id | int |\\n| user\_id | int |\\n| requested\_at | date |\\n+--------------+---------+\\nride\_id is the primary key for this table.\\nEach row of this table contains the ID of a ride, the user's ID that requested it, and the day they requested it.\\nThere may be some ride requests in this table that were not accepted.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"AcceptedRides\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| ride\_id | int |\\n| driver\_id | int |\\n| ride\_distance | int |\\n| ride\_duration | int |\\n+---------------+---------+\\nride\_id is the primary key for this table.\\nEach row of this table contains some information about an accepted ride.\\nIt is guaranteed that each accepted ride exists in the Rides table.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to report the percentage of working drivers (\\",(0,n.jsx)(e.code,{children:\\"working\_percentage\\"}),\\") for each month of \\",(0,n.jsx)(e.strong,{children:\\"2020\\"}),\\" where:\\"\]}),(0,n.jsx)(e.div,{children:(0,n.jsx)(i,{alt:\\"\\",src:\\"/static/images/articles/sql-questions/leetcode-sql-1645.png\\",width:\\"970\\",height:\\"44\\"})}),(0,n.jsxs)(e.p,{children:\[(0,n.jsx)(e.strong,{children:\\"Note\\"}),\\" that if the number of available drivers during a month is zero, we consider the \\",(0,n.jsx)(e.code,{children:\\"working\_percentage\\"}),\\" to be \\",(0,n.jsx)(e.code,{children:\\"0\\"}),\\".\\"\]}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table ordered by \\",(0,n.jsx)(e.code,{children:\\"month\\"}),\\" in \\",(0,n.jsx)(e.strong,{children:\\"ascending\\"}),\\" order, where \\",(0,n.jsx)(e.strong,{children:\\"month\\"}),\\" is the month's number (January is \\",(0,n.jsx)(e.strong,{children:\\"1\\"}),\\", February is \\",(0,n.jsx)(e.strong,{children:\\"2\\"}),\\", etc.). Round \\",(0,n.jsx)(e.strong,{children:\\"working\_percentage\\"}),\\" to the nearest \\",(0,n.jsx)(e.strong,{children:\\"2 decimal places\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Drivers table:\\n+-----------+------------+\\n| driver\_id | join\_date |\\n+-----------+------------+\\n| 10 | 2019-12-10 |\\n| 8 | 2020-1-13 |\\n| 5 | 2020-2-16 |\\n| 7 | 2020-3-8 |\\n| 4 | 2020-5-17 |\\n| 1 | 2020-10-24 |\\n| 6 | 2021-1-5 |\\n+-----------+------------+\\n\\nRides table:\\n+---------+---------+--------------+\\n| ride\_id | user\_id | requested\_at |\\n+---------+---------+--------------+\\n| 6 | 75 | 2019-12-9 |\\n| 1 | 54 | 2020-2-9 |\\n| 10 | 63 | 2020-3-4 |\\n| 19 | 39 | 2020-4-6 |\\n| 3 | 41 | 2020-6-3 |\\n| 13 | 52 | 2020-6-22 |\\n| 7 | 69 | 2020-7-16 |\\n| 17 | 70 | 2020-8-25 |\\n| 20 | 81 | 2020-11-2 |\\n| 5 | 57 | 2020-11-9 |\\n| 2 | 42 | 2020-12-9 |\\n| 11 | 68 | 2021-1-11 |\\n| 15 | 32 | 2021-1-17 |\\n| 12 | 11 | 2021-1-19 |\\n| 14 | 18 | 2021-1-27 |\\n+---------+---------+--------------+\\n\\nAcceptedRides table:\\n+---------+-----------+---------------+---------------+\\n| ride\_id | driver\_id | ride\_distance | ride\_duration |\\n+---------+-----------+---------------+---------------+\\n| 10 | 10 | 63 | 38 |\\n| 13 | 10 | 73 | 96 |\\n| 7 | 8 | 100 | 28 |\\n| 17 | 7 | 119 | 68 |\\n| 20 | 1 | 121 | 92 |\\n| 5 | 7 | 42 | 101 |\\n| 2 | 4 | 6 | 38 |\\n| 11 | 8 | 37 | 43 |\\n| 15 | 8 | 108 | 82 |\\n| 12 | 8 | 38 | 34 |\\n| 14 | 1 | 90 | 74 |\\n+---------+-----------+---------------+---------------+\\n\\nResult table:\\n+-------+--------------------+\\n| month | working\_percentage |\\n+-------+--------------------+\\n| 1 | 0.00 |\\n| 2 | 0.00 |\\n| 3 | 25.00 |\\n| 4 | 0.00 |\\n| 5 | 0.00 |\\n| 6 | 20.00 |\\n| 7 | 20.00 |\\n| 8 | 20.00 |\\n| 9 | 0.00 |\\n| 10 | 0.00 |\\n| 11 | 33.33 |\\n| 12 | 16.67 |\\n+-------+--------------------+\\n\\nBy the end of January --\\u003e two active drivers (10, 8) and no accepted rides. The percentage is 0%.\\nBy the end of February --\\u003e three active drivers (10, 8, 5) and no accepted rides. The percentage is 0%.\\nBy the end of March --\\u003e four active drivers (10, 8, 5, 7) and one accepted ride by driver (10). The percentage is (1 / 4) \* 100 = 25%.\\nBy the end of April --\\u003e four active drivers (10, 8, 5, 7) and no accepted rides. The percentage is 0%.\\nBy the end of May --\\u003e five active drivers (10, 8, 5, 7, 4) and no accepted rides. The percentage is 0%.\\nBy the end of June --\\u003e five active drivers (10, 8, 5, 7, 4) and one accepted ride by driver (10). The percentage is (1 / 5) \* 100 = 20%.\\nBy the end of July --\\u003e five active drivers (10, 8, 5, 7, 4) and one accepted ride by driver (8). The percentage is (1 / 5) \* 100 = 20%.\\nBy the end of August --\\u003e five active drivers (10, 8, 5, 7, 4) and one accepted ride by driver (7). The percentage is (1 / 5) \* 100 = 20%.\\nBy the end of Septemeber --\\u003e five active drivers (10, 8, 5, 7, 4) and no accepted rides. The percentage is 0%.\\nBy the end of October --\\u003e six active drivers (10, 8, 5, 7, 4, 1) and no accepted rides. The percentage is 0%.\\nBy the end of November --\\u003e six active drivers (10, 8, 5, 7, 4, 1) and two accepted rides by two different drivers (1, 7). The percentage is (2 / 6) \* 100 = 33.33%.\\nBy the end of December --\\u003e six active drivers (10, 8, 5, 7, 4, 1) and one accepted ride by driver (4). The percentage is (1 / 6) \* 100 = 16.67%.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-132\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-132\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT months\_drivers.month, ROUND(COALESCE(100 \* COALESCE(total\_active\_drivers, 0) / total\_drivers, 0), 2) AS working\_percentage\\nFROM\\n(\\n SELECT month, COUNT(driver\_id) AS total\_drivers\\n FROM Drivers AS a\\n RIGHT JOIN\\n (\\n SELECT \\"2020-1-31\\" AS day, 1 AS month\\n UNION SELECT \\"2020-2-29\\", 2\\n UNION SELECT \\"2020-3-31\\", 3\\n UNION SELECT \\"2020-4-30\\", 4\\n UNION SELECT \\"2020-5-31\\", 5\\n UNION SELECT \\"2020-6-30\\", 6\\n UNION SELECT \\"2020-7-31\\", 7\\n UNION SELECT \\"2020-8-31\\", 8\\n UNION SELECT \\"2020-9-30\\", 9\\n UNION SELECT \\"2020-10-31\\", 10\\n UNION SELECT \\"2020-11-30\\", 11\\n UNION SELECT \\"2020-12-31\\", 12\\n ) AS months\\n ON join\_date \\u003c= day\\n GROUP BY month\\n) months\_drivers\\nLEFT JOIN\\n(\\n SELECT month, COUNT(DISTINCT b.driver\_id) AS total\_active\_drivers\\n FROM\\n (\\n SELECT ride\_id, CAST(substr(requested\_at, 6, 2) AS unsigned) AS month\\n FROM Rides\\n WHERE substr(requested\_at, 1, 4) = \\"2020\\"\\n ) month\_rides\\n JOIN AcceptedRides AS b\\n ON month\_rides.ride\_id = b.ride\_id\\n GROUP BY month\\n) months\_active\_drivers\\nON months\_drivers.month = months\_active\_drivers.month;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1651-hopper-company-queries-iii--hard---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1651-hopper-company-queries-iii--hard---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1651. Hopper Company Queries III | Hard | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/hopper-company-queries-iii\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Drivers\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| driver\_id | int |\\n| join\_date | date |\\n+-------------+---------+\\ndriver\_id is the primary key for this table.\\nEach row of this table contains the driver's ID and the date they joined the Hopper company.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Rides\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+---------+\\n| Column Name | Type |\\n+--------------+---------+\\n| ride\_id | int |\\n| user\_id | int |\\n| requested\_at | date |\\n+--------------+---------+\\nride\_id is the primary key for this table.\\nEach row of this table contains the ID of a ride, the user's ID that requested it, and the day they requested it.\\nThere may be some ride requests in this table that were not accepted.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"AcceptedRides\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| ride\_id | int |\\n| driver\_id | int |\\n| ride\_distance | int |\\n| ride\_duration | int |\\n+---------------+---------+\\nride\_id is the primary key for this table.\\nEach row of this table contains some information about an accepted ride.\\nIt is guaranteed that each accepted ride exists in the Rides table.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to compute the \\",(0,n.jsx)(e.code,{children:\\"average\_ride\_distance\\"}),\\" and \\",(0,n.jsx)(e.code,{children:\\"average\_ride\_duration\\"}),\\" of every 3-month window starting from \\",(0,n.jsx)(e.strong,{children:\\"January - March 2020 to October - December 2020\\"}),\\". Round \\",(0,n.jsx)(e.code,{children:\\"average\_ride\_distance\\"}),\\" and \\",(0,n.jsx)(e.code,{children:\\"average\_ride\_duration\\"}),\\" to the nearest two decimal places.\\"\]}),(0,n.jsxs)(e.p,{children:\[\\"The \\",(0,n.jsx)(e.code,{children:\\"average\_ride\_distance\\"}),\\" is calculated by summing up the total \\",(0,n.jsx)(e.code,{children:\\"ride\_distance\\"}),\\" values from the three months and dividing it by \\",(0,n.jsx)(e.code,{children:\\"3\\"}),\\". The \\",(0,n.jsx)(e.code,{children:\\"average\_ride\_duration\\"}),\\" is calculated in a similar way.\\"\]}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table ordered by \\",(0,n.jsx)(e.code,{children:\\"month\\"}),\\" in ascending order, where \\",(0,n.jsx)(e.code,{children:\\"month\\"}),\\" is the starting month's number (January is \\",(0,n.jsx)(e.code,{children:\\"1\\"}),\\", February is \\",(0,n.jsx)(e.code,{children:\\"2\\"}),\\", etc.).\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Drivers table:\\n+-----------+------------+\\n| driver\_id | join\_date |\\n+-----------+------------+\\n| 10 | 2019-12-10 |\\n| 8 | 2020-1-13 |\\n| 5 | 2020-2-16 |\\n| 7 | 2020-3-8 |\\n| 4 | 2020-5-17 |\\n| 1 | 2020-10-24 |\\n| 6 | 2021-1-5 |\\n+-----------+------------+\\n\\nRides table:\\n+---------+---------+--------------+\\n| ride\_id | user\_id | requested\_at |\\n+---------+---------+--------------+\\n| 6 | 75 | 2019-12-9 |\\n| 1 | 54 | 2020-2-9 |\\n| 10 | 63 | 2020-3-4 |\\n| 19 | 39 | 2020-4-6 |\\n| 3 | 41 | 2020-6-3 |\\n| 13 | 52 | 2020-6-22 |\\n| 7 | 69 | 2020-7-16 |\\n| 17 | 70 | 2020-8-25 |\\n| 20 | 81 | 2020-11-2 |\\n| 5 | 57 | 2020-11-9 |\\n| 2 | 42 | 2020-12-9 |\\n| 11 | 68 | 2021-1-11 |\\n| 15 | 32 | 2021-1-17 |\\n| 12 | 11 | 2021-1-19 |\\n| 14 | 18 | 2021-1-27 |\\n+---------+---------+--------------+\\n\\nAcceptedRides table:\\n+---------+-----------+---------------+---------------+\\n| ride\_id | driver\_id | ride\_distance | ride\_duration |\\n+---------+-----------+---------------+---------------+\\n| 10 | 10 | 63 | 38 |\\n| 13 | 10 | 73 | 96 |\\n| 7 | 8 | 100 | 28 |\\n| 17 | 7 | 119 | 68 |\\n| 20 | 1 | 121 | 92 |\\n| 5 | 7 | 42 | 101 |\\n| 2 | 4 | 6 | 38 |\\n| 11 | 8 | 37 | 43 |\\n| 15 | 8 | 108 | 82 |\\n| 12 | 8 | 38 | 34 |\\n| 14 | 1 | 90 | 74 |\\n+---------+-----------+---------------+---------------+\\n\\nResult table:\\n+-------+-----------------------+-----------------------+\\n| month | average\_ride\_distance | average\_ride\_duration |\\n+-------+-----------------------+-----------------------+\\n| 1 | 21.00 | 12.67 |\\n| 2 | 21.00 | 12.67 |\\n| 3 | 21.00 | 12.67 |\\n| 4 | 24.33 | 32.00 |\\n| 5 | 57.67 | 41.33 |\\n| 6 | 97.33 | 64.00 |\\n| 7 | 73.00 | 32.00 |\\n| 8 | 39.67 | 22.67 |\\n| 9 | 54.33 | 64.33 |\\n| 10 | 56.33 | 77.00 |\\n+-------+-----------------------+-----------------------+\\n\\nBy the end of January --\\u003e average\_ride\_distance = (0+0+63)/3=21, average\_ride\_duration = (0+0+38)/3=12.67\\nBy the end of February --\\u003e average\_ride\_distance = (0+63+0)/3=21, average\_ride\_duration = (0+38+0)/3=12.67\\nBy the end of March --\\u003e average\_ride\_distance = (63+0+0)/3=21, average\_ride\_duration = (38+0+0)/3=12.67\\nBy the end of April --\\u003e average\_ride\_distance = (0+0+73)/3=24.33, average\_ride\_duration = (0+0+96)/3=32.00\\nBy the end of May --\\u003e average\_ride\_distance = (0+73+100)/3=57.67, average\_ride\_duration = (0+96+28)/3=41.33\\nBy the end of June --\\u003e average\_ride\_distance = (73+100+119)/3=97.33, average\_ride\_duration = (96+28+68)/3=64.00\\nBy the end of July --\\u003e average\_ride\_distance = (100+119+0)/3=73.00, average\_ride\_duration = (28+68+0)/3=32.00\\nBy the end of August --\\u003e average\_ride\_distance = (119+0+0)/3=39.67, average\_ride\_duration = (68+0+0)/3=22.67\\nBy the end of Septemeber --\\u003e average\_ride\_distance = (0+0+163)/3=54.33, average\_ride\_duration = (0+0+193)/3=64.33\\nBy the end of October --\\u003e average\_ride\_distance = (0+163+6)/3=56.33, average\_ride\_duration = (0+193+38)/3=77.00\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-133\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-133\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT month,\\n COALESCE(ROUND(SUM(ride\_distance)/3,2),0) AS average\_ride\_distance,\\n COALESCE(ROUND(SUM(ride\_duration)/3,2),0) AS average\_ride\_duration\\nFROM\\n(\\n SELECT months.month, ride\_id\\n FROM Rides\\n RIGHT JOIN\\n (\\n SELECT \\"2020-1-1\\" AS start, \\"2020-3-31\\" AS last, 1 AS month\\n UNION SELECT \\"2020-2-1\\", \\"2020-4-30\\", 2\\n UNION SELECT \\"2020-3-1\\", \\"2020-5-31\\", 3\\n UNION SELECT \\"2020-4-1\\", \\"2020-6-30\\", 4\\n UNION SELECT \\"2020-5-1\\", \\"2020-7-31\\", 5\\n UNION SELECT \\"2020-6-1\\", \\"2020-8-31\\", 6\\n UNION SELECT \\"2020-7-1\\", \\"2020-9-30\\", 7\\n UNION SELECT \\"2020-8-1\\", \\"2020-10-31\\", 8\\n UNION SELECT \\"2020-9-1\\", \\"2020-11-30\\", 9\\n UNION SELECT \\"2020-10-1\\", \\"2020-12-31\\", 10\\n ) AS months\\n ON months.start \\u003c= requested\_at AND months.last \\u003e= requested\_at\\n) total\\nLEFT JOIN AcceptedRides AS a\\nON total.ride\_id=a.ride\_id\\nGROUP BY month\\nORDER BY month;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1661-average-time-of-process-per-machine--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1661-average-time-of-process-per-machine--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1661. Average Time of Process per Machine | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/average-time-of-process-per-machine\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Activity\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----------------+---------+\\n| Column Name | Type |\\n+----------------+---------+\\n| machine\_id | int |\\n| process\_id | int |\\n| activity\_type | enum |\\n| timestamp | float |\\n+----------------+---------+\\nThe table shows the user activities for a factory website.\\n(machine\_id, process\_id, activity\_type) is the primary key of this table.\\nmachine\_id is the ID of a machine.\\nprocess\_id is the ID of a process running on the machine with ID machine\_id.\\nactivity\_type is an ENUM of type ('start', 'end').\\ntimestamp is a float representing the current time in seconds.\\n'start' means the machine starts the process at the given timestamp and 'end' means the machine ends the process at the given timestamp.\\nThe 'start' timestamp will always be before the 'end' timestamp for every (machine\_id, process\_id) pair.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"There is a factory website that has several machines each running the \\",(0,n.jsx)(e.strong,{children:\\"same number of processes\\"}),\\". Write an SQL query to find the \\",(0,n.jsx)(e.strong,{children:\\"average time\\"}),\\" each machine takes to complete a process.\\"\]}),(0,n.jsxs)(e.p,{children:\[\\"The time to complete a process is the \\",(0,n.jsx)(e.code,{children:\\"'end' timestamp\\"}),\\" minus the \\",(0,n.jsx)(e.code,{children:\\"'start' timestamp\\"}),\\". The average time is calculated by the total time to complete every process on the machine divided by the number of processes that were run.\\"\]}),(0,n.jsxs)(e.p,{children:\[\\"The resulting table should have the \\",(0,n.jsx)(e.code,{children:\\"machine\_id\\"}),\\" along with the \\",(0,n.jsx)(e.strong,{children:\\"average time\\"}),\\" as \\",(0,n.jsx)(e.code,{children:\\"processing\_time\\"}),\\", which should be \\",(0,n.jsx)(e.strong,{children:\\"rounded to 3 decimal places\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Activity table:\\n+------------+------------+---------------+-----------+\\n| machine\_id | process\_id | activity\_type | timestamp |\\n+------------+------------+---------------+-----------+\\n| 0 | 0 | start | 0.712 |\\n| 0 | 0 | end | 1.520 |\\n| 0 | 1 | start | 3.140 |\\n| 0 | 1 | end | 4.120 |\\n| 1 | 0 | start | 0.550 |\\n| 1 | 0 | end | 1.550 |\\n| 1 | 1 | start | 0.430 |\\n| 1 | 1 | end | 1.420 |\\n| 2 | 0 | start | 4.100 |\\n| 2 | 0 | end | 4.512 |\\n| 2 | 1 | start | 2.500 |\\n| 2 | 1 | end | 5.000 |\\n+------------+------------+---------------+-----------+\\n\\nResult table:\\n+------------+-----------------+\\n| machine\_id | processing\_time |\\n+------------+-----------------+\\n| 0 | 0.894 |\\n| 1 | 0.995 |\\n| 2 | 1.456 |\\n+------------+-----------------+\\n\\nThere are 3 machines running 2 processes each.\\nMachine 0's average time is ((1.520 - 0.712) + (4.120 - 3.140)) / 2 = 0.894\\nMachine 1's average time is ((1.550 - 0.550) + (1.420 - 0.430)) / 2 = 0.995\\nMachine 2's average time is ((4.512 - 4.100) + (5.000 - 2.500)) / 2 = 1.456\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-134\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-134\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT machine\_id,\\n\\tROUND(SUM(IF(activity\_type='start', -timestamp, timestamp)) / COUNT(DISTINCT process\_id), 3) AS processing\_time\\nFROM Activity\\nGROUP BY machine\_id\\nORDER BY machine\_id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1667-fix-names-in-a-table--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1667-fix-names-in-a-table--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1667. Fix Names in a Table | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/fix-names-in-a-table\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Users\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----------------+---------+\\n| Column Name | Type |\\n+----------------+---------+\\n| user\_id | int |\\n| name | varchar |\\n+----------------+---------+\\nuser\_id is the primary key for this table.\\nThis table contains the ID and the name of the user. The name consists of only lowercase and uppercase characters.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to fix the names so that only the first character is uppercase and the rest are lowercase.\\"}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table ordered by \\",(0,n.jsx)(e.code,{children:\\"user\_id\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Users table:\\n+---------+-------+\\n| user\_id | name |\\n+---------+-------+\\n| 1 | aLice |\\n| 2 | bOB |\\n+---------+-------+\\n\\nResult table:\\n+---------+-------+\\n| user\_id | name |\\n+---------+-------+\\n| 1 | Alice |\\n| 2 | Bob |\\n+---------+-------+\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-135\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-135\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`select user\_id,\\n CONCAT(UPPER(LEFT(name,1)),LOWER(SUBSTRING(name,2))) AS name\\nFROM Users\\nORDER BY user\_id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1677-products-worth-over-invoices--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1677-products-worth-over-invoices--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1677. Product's Worth Over Invoices | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/products-worth-over-invoices\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Product\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| product\_id | int |\\n| name | varchar |\\n+-------------+---------+\\nproduct\_id is the primary key for this table.\\nThis table contains the ID and the name of the product. The name consists of only lowercase English letters. No two products have the same name.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Invoice\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+------+\\n| Column Name | Type |\\n+-------------+------+\\n| invoice\_id | int |\\n| product\_id | int |\\n| rest | int |\\n| paid | int |\\n| canceled | int |\\n| refunded | int |\\n+-------------+------+\\ninvoice\_id is the primary key for this table and the id of this invoice.\\nproduct\_id is the id of the product for this invoice.\\nrest is the amount left to pay for this invoice.\\npaid is the amount paid for this invoice.\\ncanceled is the amount canceled for this invoice.\\nrefunded is the amount refunded for this invoice.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query that will, for all products, return each product name with total amount due, paid, canceled, and refunded across all invoices.\\"}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table ordered by \\",(0,n.jsx)(e.code,{children:\\"product\_name\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Product table:\\n+------------+-------+\\n| product\_id | name |\\n+------------+-------+\\n| 0 | ham |\\n| 1 | bacon |\\n+------------+-------+\\nInvoice table:\\n+------------+------------+------+------+----------+----------+\\n| invoice\_id | product\_id | rest | paid | canceled | refunded |\\n+------------+------------+------+------+----------+----------+\\n| 23 | 0 | 2 | 0 | 5 | 0 |\\n| 12 | 0 | 0 | 4 | 0 | 3 |\\n| 1 | 1 | 1 | 1 | 0 | 1 |\\n| 2 | 1 | 1 | 0 | 1 | 1 |\\n| 3 | 1 | 0 | 1 | 1 | 1 |\\n| 4 | 1 | 1 | 1 | 1 | 0 |\\n+------------+------------+------+------+----------+----------+\\nResult table:\\n+-------+------+------+----------+----------+\\n| name | rest | paid | canceled | refunded |\\n+-------+------+------+----------+----------+\\n| bacon | 3 | 3 | 3 | 3 |\\n| ham | 2 | 4 | 5 | 3 |\\n+-------+------+------+----------+----------+\\n- The amount of money left to pay for bacon is 1 + 1 + 0 + 1 = 3\\n- The amount of money paid for bacon is 1 + 0 + 1 + 1 = 3\\n- The amount of money canceled for bacon is 0 + 1 + 1 + 1 = 3\\n- The amount of money refunded for bacon is 1 + 1 + 1 + 0 = 3\\n- The amount of money left to pay for ham is 2 + 0 = 2\\n- The amount of money paid for ham is 0 + 4 = 4\\n- The amount of money canceled for ham is 5 + 0 = 5\\n- The amount of money refunded for ham is 0 + 3 = 3\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-136\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-136\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT p.name AS name,\\n SUM(i.rest) AS rest,\\n SUM(i.paid) AS paid,\\n SUM(i.canceled) AS canceled,\\n SUM(i.refunded) AS refunded\\nFROM Invoice i\\nLEFT JOIN Product p ON p.product\_id = i.product\_id\\nGROUP BY name\\nORDER BY name;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1683-invalid-tweets--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1683-invalid-tweets--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1683. Invalid Tweets | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/invalid-tweets\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Tweets\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----------------+---------+\\n| Column Name | Type |\\n+----------------+---------+\\n| tweet\_id | int |\\n| content | varchar |\\n+----------------+---------+\\ntweet\_id is the primary key for this table.\\nThis table contains all the tweets in a social media app.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to find the IDs of the invalid tweets. The tweet is invalid if the number of characters used in the content of the tweet is \\",(0,n.jsx)(e.code,{children:\\"strictly greater\\"}),\\" than \\",(0,n.jsx)(e.code,{children:\\"15\\"}),\\".\\"\]}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table \\",(0,n.jsx)(e.code,{children:\\"in any order\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Tweets table:\\n+----------+----------------------------------+\\n| tweet\_id | content |\\n+----------+----------------------------------+\\n| 1 | Vote for Biden |\\n| 2 | Let us make America great again! |\\n+----------+----------------------------------+\\n\\nResult table:\\n+----------+\\n| tweet\_id |\\n+----------+\\n| 2 |\\n+----------+\\nTweet 1 has length = 14. It is a valid tweet.\\nTweet 2 has length = 32. It is an invalid tweet.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-137\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-137\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT tweet\_id\\nFROM Tweets\\nWHERE LENGTH(content) \\u003e 15;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1693-daily-leads-and-partners--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1693-daily-leads-and-partners--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1693. Daily Leads and Partners | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/daily-leads-and-partners\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"DailySales\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| date\_id | date |\\n| make\_name | varchar |\\n| lead\_id | int |\\n| partner\_id | int |\\n+-------------+---------+\\nThis table does not have a primary key.\\nThis table contains the date and the name of the product sold and the IDs of the lead and partner it was sold to.\\nThe name consists of only lowercase English letters.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query that will, for each \\",(0,n.jsx)(e.code,{children:\\"date\_id\\"}),\\" and \\",(0,n.jsx)(e.code,{children:\\"make\_name\\"}),\\", return the number of distinct \\",(0,n.jsx)(e.code,{children:\\"lead\_id\\"}),\\"'s and distinct \\",(0,n.jsx)(e.code,{children:\\"partner\_id\\"}),\\"'s.\\"\]}),(0,n.jsx)(e.p,{children:\\"Return the result table in any order.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`DailySales table:\\n+-----------+-----------+---------+------------+\\n| date\_id | make\_name | lead\_id | partner\_id |\\n+-----------+-----------+---------+------------+\\n| 2020-12-8 | toyota | 0 | 1 |\\n| 2020-12-8 | toyota | 1 | 0 |\\n| 2020-12-8 | toyota | 1 | 2 |\\n| 2020-12-7 | toyota | 0 | 2 |\\n| 2020-12-7 | toyota | 0 | 1 |\\n| 2020-12-8 | honda | 1 | 2 |\\n| 2020-12-8 | honda | 2 | 1 |\\n| 2020-12-7 | honda | 0 | 1 |\\n| 2020-12-7 | honda | 1 | 2 |\\n| 2020-12-7 | honda | 2 | 1 |\\n+-----------+-----------+---------+------------+\\nResult table:\\n+-----------+-----------+--------------+-----------------+\\n| date\_id | make\_name | unique\_leads | unique\_partners |\\n+-----------+-----------+--------------+-----------------+\\n| 2020-12-8 | toyota | 2 | 3 |\\n| 2020-12-7 | toyota | 1 | 2 |\\n| 2020-12-8 | honda | 2 | 2 |\\n| 2020-12-7 | honda | 3 | 2 |\\n+-----------+-----------+--------------+-----------------+\\nFor 2020-12-8, toyota gets leads = \[0, 1\] and partners = \[0, 1, 2\] while honda gets leads = \[1, 2\] and partners = \[1, 2\].\\nFor 2020-12-7, toyota gets leads = \[0\] and partners = \[1, 2\] while honda gets leads = \[0, 1, 2\] and partners = \[1, 2\].\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-138\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-138\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT date\_id, make\_name,\\n COUNT(DISTINCT lead\_id) AS unique\_leads,\\n COUNT(DISTINCT partner\_id) AS unique\_partners\\nFROM DailySales\\nGROUP BY date\_id, make\_name\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1699-number-of-calls-between-two-persons--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1699-number-of-calls-between-two-persons--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1699. Number of Calls Between Two Persons | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/number-of-calls-between-two-persons\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Calls\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| from\_id | int |\\n| to\_id | int |\\n| duration | int |\\n+-------------+---------+\\nThis table does not have a primary key, it may contain duplicates.\\nThis table contains the duration of a phone call between from\_id and to\_id.\\nfrom\_id != to\_id\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to report the number of calls and the total call duration between each pair of distinct persons \\",(0,n.jsx)(e.code,{children:\\"(person1, person2)\\"}),\\" where \\",(0,n.jsx)(e.code,{children:\\"person1 \\u003c person2\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"Return the result table in any order.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Calls table:\\n+---------+-------+----------+\\n| from\_id | to\_id | duration |\\n+---------+-------+----------+\\n| 1 | 2 | 59 |\\n| 2 | 1 | 11 |\\n| 1 | 3 | 20 |\\n| 3 | 4 | 100 |\\n| 3 | 4 | 200 |\\n| 3 | 4 | 200 |\\n| 4 | 3 | 499 |\\n+---------+-------+----------+\\n\\nResult table:\\n+---------+---------+------------+----------------+\\n| person1 | person2 | call\_count | total\_duration |\\n+---------+---------+------------+----------------+\\n| 1 | 2 | 2 | 70 |\\n| 1 | 3 | 1 | 20 |\\n| 3 | 4 | 4 | 999 |\\n+---------+---------+------------+----------------+\\nUsers 1 and 2 had 2 calls and the total duration is 70 (59 + 11).\\nUsers 1 and 3 had 1 call and the total duration is 20.\\nUsers 3 and 4 had 4 calls and the total duration is 999 (100 + 200 + 200 + 499).\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-139\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-139\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nSELECT from\_id AS person1,to\_id AS person2,\\n COUNT(duration) AS call\_count, SUM(duration) AS total\_duration\\nFROM (SELECT \*\\n FROM Calls\\n\\n UNION ALL\\n\\n SELECT to\_id, from\_id, duration\\n FROM Calls) t1\\nWHERE from\_id \\u003c to\_id\\nGROUP BY person1, person2\\n\\n#Solution 2:\\nSELECT\\n IF(from\_id\\u003cto\_id,from\_id,to\_id) person1,\\n IF(from\_id\\u003eto\_id,from\_id,to\_id) person2,\\n COUNT(\*) call\_count,\\n SUM(duration) total\_duration\\nFROM\\n Calls\\nGROUP BY\\n IF(from\_id\\u003cto\_id,from\_id,to\_id),\\n IF(from\_id\\u003eto\_id,from\_id,to\_id);\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1709-biggest-window-between-visits--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1709-biggest-window-between-visits--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1709. Biggest Window Between Visits | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/biggest-window-between-visits\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"UserVisits\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+------+\\n| Column Name | Type |\\n+-------------+------+\\n| user\_id | int |\\n| visit\_date | date |\\n+-------------+------+\\nThis table does not have a primary key.\\nThis table contains logs of the dates that users vistied a certain retailer.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Assume today's date is \\",(0,n.jsx)(e.code,{children:\\"'2021-1-1'\\"}),\\".\\"\]}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query that will, for each \\",(0,n.jsx)(e.code,{children:\\"user\_id\\"}),\\", find out the largest \\",(0,n.jsx)(e.code,{children:\\"window\\"}),\\" of days between each visit and the one right after it (or today if you are considering the last visit).\\"\]}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table ordered by \\",(0,n.jsx)(e.code,{children:\\"user\_id\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`UserVisits table:\\n+---------+------------+\\n| user\_id | visit\_date |\\n+---------+------------+\\n| 1 | 2020-11-28 |\\n| 1 | 2020-10-20 |\\n| 1 | 2020-12-3 |\\n| 2 | 2020-10-5 |\\n| 2 | 2020-12-9 |\\n| 3 | 2020-11-11 |\\n+---------+------------+\\nResult table:\\n+---------+---------------+\\n| user\_id | biggest\_window|\\n+---------+---------------+\\n| 1 | 39 |\\n| 2 | 65 |\\n| 3 | 51 |\\n+---------+---------------+\\nFor the first user, the windows in question are between dates:\\n - 2020-10-20 and 2020-11-28 with a total of 39 days.\\n - 2020-11-28 and 2020-12-3 with a total of 5 days.\\n - 2020-12-3 and 2021-1-1 with a total of 29 days.\\nMaking the biggest window the one with 39 days.\\nFor the second user, the windows in question are between dates:\\n - 2020-10-5 and 2020-12-9 with a total of 65 days.\\n - 2020-12-9 and 2021-1-1 with a total of 23 days.\\nMaking the biggest window the one with 65 days.\\nFor the third user, the only window in question is between dates 2020-11-11 and 2021-1-1 with a total of 51 days.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-140\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-140\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT user\_id, max(diff) AS biggest\_window\\nFROM\\n(\\n SELECT user\_id,\\n datediff(coalesce(lead(visit\_date) OVER (PARTITION BY user\_id ORDER BY visit\_date), '2021-01-01'), visit\_date) AS diff\\n FROM userVisits\\n) t\\nGROUP BY user\_id\\nORDER BY user\_id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1715-count-apples-and-oranges--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1715-count-apples-and-oranges--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1715. Count Apples and Oranges | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/count-apples-and-oranges\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Boxes\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+------+\\n| Column Name | Type |\\n+--------------+------+\\n| box\_id | int |\\n| chest\_id | int |\\n| apple\_count | int |\\n| orange\_count | int |\\n+--------------+------+\\nbox\_id is the primary key for this table.\\nchest\_id is a foreign key of the chests table.\\nThis table contains information about the boxes and the number of oranges and apples they contain. Each box may contain a chest, which also can contain oranges and apples.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Chests\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+------+\\n| Column Name | Type |\\n+--------------+------+\\n| chest\_id | int |\\n| apple\_count | int |\\n| orange\_count | int |\\n+--------------+------+\\nchest\_id is the primary key for this table.\\nThis table contains information about the chests we have, and the corresponding number if oranges and apples they contain.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to count the number of apples and oranges in all the boxes. If a box contains a chest, you should also include the number of apples and oranges it has.\\"}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table in \\",(0,n.jsx)(e.strong,{children:\\"any order\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`\\nBoxes table:\\n+--------+----------+-------------+--------------+\\n| box\_id | chest\_id | apple\_count | orange\_count |\\n+--------+----------+-------------+--------------+\\n| 2 | null | 6 | 15 |\\n| 18 | 14 | 4 | 15 |\\n| 19 | 3 | 8 | 4 |\\n| 12 | 2 | 19 | 20 |\\n| 20 | 6 | 12 | 9 |\\n| 8 | 6 | 9 | 9 |\\n| 3 | 14 | 16 | 7 |\\n+--------+----------+-------------+--------------+\\n\\nChests table:\\n+----------+-------------+--------------+\\n| chest\_id | apple\_count | orange\_count |\\n+----------+-------------+--------------+\\n| 6 | 5 | 6 |\\n| 14 | 20 | 10 |\\n| 2 | 8 | 8 |\\n| 3 | 19 | 4 |\\n| 16 | 19 | 19 |\\n+----------+-------------+--------------+\\n\\nResult table:\\n+-------------+--------------+\\n| apple\_count | orange\_count |\\n+-------------+--------------+\\n| 151 | 123 |\\n+-------------+--------------+\\nbox 2 has 6 apples and 15 oranges.\\nbox 18 has 4 + 20 (from the chest) = 24 apples and 15 + 10 (from the chest) = 25 oranges.\\nbox 19 has 8 + 19 (from the chest) = 27 apples and 4 + 4 (from the chest) = 8 oranges.\\nbox 12 has 19 + 8 (from the chest) = 27 apples and 20 + 8 (from the chest) = 28 oranges.\\nbox 20 has 12 + 5 (from the chest) = 17 apples and 9 + 6 (from the chest) = 15 oranges.\\nbox 8 has 9 + 5 (from the chest) = 14 apples and 9 + 6 (from the chest) = 15 oranges.\\nbox 3 has 16 + 20 (from the chest) = 36 apples and 7 + 10 (from the chest) = 17 oranges.\\nTotal number of apples = 6 + 24 + 27 + 27 + 17 + 14 + 36 = 151\\nTotal number of oranges = 15 + 25 + 8 + 28 + 15 + 15 + 17 = 123\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-141\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-141\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT sum(IFNULL(box.apple\_count, 0) + IFNULL(chest.apple\_count, 0)) AS apple\_count,\\n sum(IFNULL(box.orange\_count, 0) + IFNULL(chest.orange\_count, 0)) AS orange\_count\\n FROM Boxes AS box\\n LEFT JOIN Chests AS chest\\n ON box.chest\_id = chest.chest\_id;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1729-find-followers-count--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1729-find-followers-count--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1729. Find Followers Count | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/find-followers-count\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Followers\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+------+\\n| Column Name | Type |\\n+-------------+------+\\n| user\_id | int |\\n| follower\_id | int |\\n+-------------+------+\\n(user\_id, follower\_id) is the primary key for this table.\\nThis table contains the IDs of a user and a follower in a social media app where the follower follows the user.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query that will, for each user, return the number of followers.\\"}),(0,n.jsx)(e.p,{children:\\"Return the result table ordered by user\_id.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Followers table:\\n+---------+-------------+\\n| user\_id | follower\_id |\\n+---------+-------------+\\n| 0 | 1 |\\n| 1 | 0 |\\n| 2 | 0 |\\n| 2 | 1 |\\n+---------+-------------+\\nResult table:\\n+---------+----------------+\\n| user\_id | followers\_count|\\n+---------+----------------+\\n| 0 | 1 |\\n| 1 | 1 |\\n| 2 | 2 |\\n+---------+----------------+\\nThe followers of 0 are {1}\\nThe followers of 1 are {0}\\nThe followers of 2 are {0,1}\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-142\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-142\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT user\_id, COUNT(DISTINCT follower\_id) followers\_count\\nFROM followers\\nGROUP BY user\_id\\nORDER BY user\_id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1731-the-number-of-employees-which-report-to-each-employee--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1731-the-number-of-employees-which-report-to-each-employee--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1731. The Number of Employees Which Report to Each Employee | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/the-number-of-employees-which-report-to-each-employee\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Employees\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+----------+\\n| Column Name | Type |\\n+-------------+----------+\\n| employee\_id | int |\\n| name | varchar |\\n| reports\_to | int |\\n| age | int |\\n+-------------+----------+\\nemployee\_id is the primary key for this table.\\nThis table contains information about the employees and the id of the manager they report to. Some employees do not report to anyone (reports\_to is null).\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"For this problem, we will consider a \\",(0,n.jsx)(e.strong,{children:\\"manager\\"}),\\" an employee who has at least 1 other employee reporting to them.\\"\]}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to report the ids and the names of all \\",(0,n.jsx)(e.strong,{children:\\"managers\\"}),\\", the number of employees who report \\",(0,n.jsx)(e.strong,{children:\\"directly\\"}),\\" to them, and the average age of the reports rounded to the nearest integer.\\"\]}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table ordered by \\",(0,n.jsx)(e.code,{children:\\"employee\_id\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Employees table:\\n+-------------+---------+------------+-----+\\n| employee\_id | name | reports\_to | age |\\n+-------------+---------+------------+-----+\\n| 9 | Hercy | null | 43 |\\n| 6 | Alice | 9 | 41 |\\n| 4 | Bob | 9 | 36 |\\n| 2 | Winston | null | 37 |\\n+-------------+---------+------------+-----+\\n\\nResult table:\\n+-------------+-------+---------------+-------------+\\n| employee\_id | name | reports\_count | average\_age |\\n+-------------+-------+---------------+-------------+\\n| 9 | Hercy | 2 | 39 |\\n+-------------+-------+---------------+-------------+\\nHercy has 2 people report directly to him, Alice and Bob. Their average age is (41+36)/2 = 38.5, which is 39 after rounding it to the nearest integer.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-143\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-143\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT e1.reports\_to AS employee\_id,\\n e2.name,\\n COUNT(e1.reports\_to) AS reports\_count,\\n ROUND(AVG(e1.age),0) AS average\_age\\nFROM employees e1\\nJOIN employees e2\\nON e1.reports\_to=e2.employee\_id\\nGROUP BY e1.reports\_to\\nORDER BY e1.reports\_to\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1741-find-total-time-spent-by-each-employee--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1741-find-total-time-spent-by-each-employee--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1741. Find Total Time Spent by Each Employee | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/find-total-time-spent-by-each-employee\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Employees\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+------+\\n| Column Name | Type |\\n+-------------+------+\\n| emp\_id | int |\\n| event\_day | date |\\n| in\_time | int |\\n| out\_time | int |\\n+-------------+------+\\n(emp\_id, event\_day, in\_time) is the primary key of this table.\\nThe table shows the employees' entries and exits in an office.\\nevent\_day is the day at which this event happened and in\_time is the minute at which the employee entered the office and out\_time is the time at which he got outnumbered from 1 to 1440.\\nIt's guaranteed that no two events on the same day intersect in time.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to calculate the total time \\",(0,n.jsx)(e.strong,{children:\\"in minutes\\"}),\\" spent by each employee on each day at the office. Note that within one day, an employee can enter and leave more than once.\\"\]}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table in \\",(0,n.jsx)(e.strong,{children:\\"any order\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Employees table:\\n+--------+------------+---------+----------+\\n| emp\_id | event\_day | in\_time | out\_time |\\n+--------+------------+---------+----------+\\n| 1 | 2020-11-28 | 4 | 32 |\\n| 1 | 2020-11-28 | 55 | 200 |\\n| 1 | 2020-12-03 | 1 | 42 |\\n| 2 | 2020-11-28 | 3 | 33 |\\n| 2 | 2020-12-09 | 47 | 74 |\\n+--------+------------+---------+----------+\\nResult table:\\n+------------+--------+------------+\\n| day | emp\_id | total\_time |\\n+------------+--------+------------+\\n| 2020-11-28 | 1 | 173 |\\n| 2020-11-28 | 2 | 30 |\\n| 2020-12-03 | 1 | 41 |\\n| 2020-12-09 | 2 | 27 |\\n+------------+--------+------------+\\nEmployee 1 has three events two on day 2020-11-28 with a total of (32 - 4) + (200-55) = 173 and one on day 2020-12-03 with a total of (42 - 1) = 41.\\nEmployee 2 has two events one on day 2020-11-28 with a total of (33-3) = 30 and one on day 2020-12-09 with a total of (74 - 47) = 27.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-144\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-144\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT event\_day AS day, emp\_id, SUM(out\_time - in\_time) AS total\_time\\nFROM Employees\\nGROUP BY day, emp\_id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1747-leetflex-banned-accounts--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1747-leetflex-banned-accounts--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1747. Leetflex Banned Accounts | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/leetflex-banned-accounts\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"LogInfo\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+----------+\\n| Column Name | Type |\\n+-------------+----------+\\n| account\_id | int |\\n| ip\_address | int |\\n| login | datetime |\\n| logout | datetime |\\n+-------------+----------+\\nThere is no primary key for this table, and it may contain duplicates.\\nThe table contains information about the login and logout dates of Leetflex accounts. It also contains the IP address from which the account logged in and out.\\nIt is guaranteed that the logout time is after the login time.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to find the \\",(0,n.jsx)(e.code,{children:\\"account\_id\\"}),\\" of the accounts that should be banned from Leetflex. An account should be banned if it was logged in at some moment from two different IP addresses.\\"\]}),(0,n.jsx)(e.p,{children:\\"Return the result table in any order.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`LogInfo table:\\n+------------+------------+---------------------+---------------------+\\n| account\_id | ip\_address | login | logout |\\n+------------+------------+---------------------+---------------------+\\n| 1 | 1 | 2021-02-01 09:00:00 | 2021-02-01 09:30:00 |\\n| 1 | 2 | 2021-02-01 08:00:00 | 2021-02-01 11:30:00 |\\n| 2 | 6 | 2021-02-01 20:30:00 | 2021-02-01 22:00:00 |\\n| 2 | 7 | 2021-02-02 20:30:00 | 2021-02-02 22:00:00 |\\n| 3 | 9 | 2021-02-01 16:00:00 | 2021-02-01 16:59:59 |\\n| 3 | 13 | 2021-02-01 17:00:00 | 2021-02-01 17:59:59 |\\n| 4 | 10 | 2021-02-01 16:00:00 | 2021-02-01 17:00:00 |\\n| 4 | 11 | 2021-02-01 17:00:00 | 2021-02-01 17:59:59 |\\n+------------+------------+---------------------+---------------------+\\n\\nResult table:\\n+------------+\\n| account\_id |\\n+------------+\\n| 1 |\\n| 4 |\\n+------------+\\nAccount ID 1 --\\u003e The account was active from \\"2021-02-01 09:00:00\\" to \\"2021-02-01 09:30:00\\" with two different IP addresses (1 and 2). It should be banned.\\nAccount ID 2 --\\u003e The account was active from two different addresses (6, 7) but in two different times.\\nAccount ID 3 --\\u003e The account was active from two different addresses (9, 13) on the same day but they do not intersect at any moment.\\nAccount ID 4 --\\u003e The account was active from \\"2021-02-01 17:00:00\\" to \\"2021-02-01 17:00:00\\" with two different IP addresses (10 and 11). It should be banned.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-145\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-145\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT DISTINCT l1.account\_id\\nFROM LogInfo l1\\nJOIN LogInfo l2\\nON l1.account\_id = l2.account\_id AND l1.ip\_address != l2.ip\_address\\nWHERE NOT (l1.login \\u003e l2.logout OR l1.logout \\u003c l2.login)\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1757-recyclable-and-low-fat-products--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1757-recyclable-and-low-fat-products--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1757. Recyclable and Low Fat Products | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/recyclable-and-low-fat-products\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Products\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| product\_id | int |\\n| low\_fats | enum |\\n| recyclable | enum |\\n+-------------+---------+\\nproduct\_id is the primary key for this table.\\nlow\_fats is an ENUM of type ('Y', 'N') where 'Y' means this product is low fat and 'N' means it is not.\\nrecyclable is an ENUM of types ('Y', 'N') where 'Y' means this product is recyclable and 'N' means it is not.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the ids of products that are both low fat and recyclable.\\"}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table in \\",(0,n.jsx)(e.strong,{children:\\"any order\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Products table:\\n+-------------+----------+------------+\\n| product\_id | low\_fats | recyclable |\\n+-------------+----------+------------+\\n| 0 | Y | N |\\n| 1 | Y | Y |\\n| 2 | N | Y |\\n| 3 | Y | Y |\\n| 4 | N | N |\\n+-------------+----------+------------+\\nResult table:\\n+-------------+\\n| product\_id |\\n+-------------+\\n| 1 |\\n| 3 |\\n+-------------+\\nOnly products 1 and 3 are both low fat and recyclable.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-146\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-146\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT product\_id\\nFROM Products\\nWHERE low\_fats = \\"Y\\" AND recyclable = \\"Y\\"\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1767-find-the-subtasks-that-did-not-execute--hard---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1767-find-the-subtasks-that-did-not-execute--hard---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1767. Find the Subtasks That Did Not Execute | Hard | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/find-the-subtasks-that-did-not-execute\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Tasks\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----------------+---------+\\n| Column Name | Type |\\n+----------------+---------+\\n| task\_id | int |\\n| subtasks\_count | int |\\n+----------------+---------+\\ntask\_id is the primary key for this table.\\nEach row in this table indicates that task\_id was divided into subtasks\_count subtasks labelled from 1 to subtasks\_count.\\nIt is guaranteed that 2 \\u003c= subtasks\_count \\u003c= 20.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Executed\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| task\_id | int |\\n| subtask\_id | int |\\n+---------------+---------+\\n(task\_id, subtask\_id) is the primary key for this table.\\nEach row in this table indicates that for the task task\_id, the subtask with ID subtask\_id was executed successfully.\\nIt is guaranteed that subtask\_id \\u003c= subtasks\_count for each task\_id.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Write an SQL query to report the IDs of the missing subtasks for each \\",(0,n.jsx)(e.code,{children:\\"task\_id\\"}),\\".\\"\]}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table in \\",(0,n.jsx)(e.strong,{children:\\"any order\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Tasks table:\\n+---------+----------------+\\n| task\_id | subtasks\_count |\\n+---------+----------------+\\n| 1 | 3 |\\n| 2 | 2 |\\n| 3 | 4 |\\n+---------+----------------+\\n\\nExecuted table:\\n+---------+------------+\\n| task\_id | subtask\_id |\\n+---------+------------+\\n| 1 | 2 |\\n| 3 | 1 |\\n| 3 | 2 |\\n| 3 | 3 |\\n| 3 | 4 |\\n+---------+------------+\\n\\nResult table:\\n+---------+------------+\\n| task\_id | subtask\_id |\\n+---------+------------+\\n| 1 | 1 |\\n| 1 | 3 |\\n| 2 | 1 |\\n| 2 | 2 |\\n+---------+------------+\\nTask 1 was divided into 3 subtasks (1, 2, 3). Only subtask 2 was executed successfully, so we include (1, 1) and (1, 3) in the answer.\\nTask 2 was divided into 2 subtasks (1, 2). No subtask was executed successfully, so we include (2, 1) and (2, 2) in the answer.\\nTask 3 was divided into 4 subtasks (1, 2, 3, 4). All of the subtasks were executed successfully.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-147\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-147\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`WITH RECURSIVE CTE AS\\n (SELECT 1 AS subtask\_id\\n UNION ALL SELECT subtask\_id + 1\\n FROM CTE\\n WHERE subtask\_id \\u003c\\n (SELECT MAX(subtasks\_count)\\n FROM Tasks) )\\nSELECT Tasks.task\_id,\\n CTE.subtask\_id\\nFROM CTE\\nINNER JOIN Tasks ON CTE.subtask\_id \\u003c= Tasks.subtasks\_count\\nLEFT JOIN Executed ON Tasks.task\_id = Executed.task\_id\\n AND CTE.subtask\_id = Executed.subtask\_id\\nWHERE Executed.subtask\_id IS NULL\\nORDER BY NULL\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1777-products-price-for-each-store--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1777-products-price-for-each-store--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1777. Product's Price for Each Store | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/products-price-for-each-store\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Products\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+-------------+---------+\\n| Column Name | Type |\\n+-------------+---------+\\n| product\_id | int |\\n| store | enum |\\n| price | int |\\n+-------------+---------+\\n(product\_id,store) is the primary key for this table.\\nstore is an ENUM of type ('store1', 'store2', 'store3') where each represents the store this product is available at.\\nprice is the price of the product at this store.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to find the price of each product in each store.\\"}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table in \\",(0,n.jsx)(e.strong,{children:\\"any order\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Products table:\\n+-------------+--------+-------+\\n| product\_id | store | price |\\n+-------------+--------+-------+\\n| 0 | store1 | 95 |\\n| 0 | store3 | 105 |\\n| 0 | store2 | 100 |\\n| 1 | store1 | 70 |\\n| 1 | store3 | 80 |\\n+-------------+--------+-------+\\nResult table:\\n+-------------+--------+--------+--------+\\n| product\_id | store1 | store2 | store3 |\\n+-------------+--------+--------+--------+\\n| 0 | 95 | 100 | 105 |\\n| 1 | 70 | null | 80 |\\n+-------------+--------+--------+--------+\\nProduct 0 price's are 95 for store1, 100 for store2 and, 105 for store3.\\nProduct 1 price's are 70 for store1, 80 for store3 and, it's not sold in store2.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-148\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-148\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`SELECT product\_id,\\n SUM(CASE WHEN store='store1' THEN price END) AS store1,\\n SUM(CASE WHEN store='store2' THEN price END) AS store2,\\n SUM(CASE WHEN store='store3' THEN price END) AS store3\\nFROM Products\\nGROUP BY product\_id\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1783-grand-slam-titles--medium---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1783-grand-slam-titles--medium---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1783. Grand Slam Titles | Medium | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/grand-slam-titles\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Players\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+----------------+---------+\\n| Column Name | Type |\\n+----------------+---------+\\n| player\_id | int |\\n| player\_name | varchar |\\n+----------------+---------+\\nplayer\_id is the primary key for this table.\\nEach row in this table contains the name and the ID of a tennis player.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Championships\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+---------------+---------+\\n| Column Name | Type |\\n+---------------+---------+\\n| year | int |\\n| Wimbledon | int |\\n| Fr\_open | int |\\n| US\_open | int |\\n| Au\_open | int |\\n+---------------+---------+\\nyear is the primary key for this table.\\nEach row of this table containts the IDs of the players who won one each tennis tournament of the grand slam.\\n\`})}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to report the number of grand slam tournaments won by each player. Do not include the players who did not win any tournament.\\"}),(0,n.jsxs)(e.p,{children:\[\\"Return the result table in \\",(0,n.jsx)(e.strong,{children:\\"any order\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example:\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Players table:\\n+-----------+-------------+\\n| player\_id | player\_name |\\n+-----------+-------------+\\n| 1 | Nadal |\\n| 2 | Federer |\\n| 3 | Novak |\\n+-----------+-------------+\\n\\nChampionships table:\\n+------+-----------+---------+---------+---------+\\n| year | Wimbledon | Fr\_open | US\_open | Au\_open |\\n+------+-----------+---------+---------+---------+\\n| 2018 | 1 | 1 | 1 | 1 |\\n| 2019 | 1 | 1 | 2 | 2 |\\n| 2020 | 2 | 1 | 2 | 2 |\\n+------+-----------+---------+---------+---------+\\n\\nResult table:\\n+-----------+-------------+-------------------+\\n| player\_id | player\_name | grand\_slams\_count |\\n+-----------+-------------+-------------------+\\n| 2 | Federer | 5 |\\n| 1 | Nadal | 7 |\\n+-----------+-------------+-------------------+\\n\\nPlayer 1 (Nadal) won 7 titles: Wimbledon (2018, 2019), Fr\_open (2018, 2019, 2020), US\_open (2018), and Au\_open (2018).\\nPlayer 2 (Federer) won 5 titles: Wimbledon (2020), US\_open (2019, 2020), and Au\_open (2019, 2020).\\nPlayer 3 (Novak) did not win anything, we did not include them in the result table.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-149\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-149\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nSELECT player\_id, player\_name,\\n\\tSUM((IF(Wimbledon = player\_id,1,0) +\\n\\t\\tIF(Fr\_open = player\_id,1,0) +\\n\\t\\tIF(US\_open = player\_id,1,0) +\\n\\t\\tIF(Au\_open = player\_id,1,0))) as grand\_slams\_count\\nFROM Players INNER JOIN Championships\\nON Wimbledon = player\_id OR Fr\_open = player\_id OR US\_open = player\_id OR Au\_open = player\_id\\nGROUP BY player\_id;\\n\\n#Solution 2:\\nWITH cte\\n AS (SELECT wimbledon AS id\\n FROM championships\\n UNION ALL\\n SELECT fr\_open AS id\\n FROM championships\\n UNION ALL\\n SELECT us\_open AS id\\n FROM championships\\n UNION ALL\\n SELECT au\_open AS id\\n FROM championships)\\nSELECT player\_id,\\n player\_name,\\n Count(\*) AS grand\_slams\_count\\nFROM players\\n INNER JOIN cte\\n ON players.player\_id = cte.id\\nGROUP BY 1, 2\\nORDER BY NULL;\\n\`})}),(0,n.jsxs)(e.h2,{id:\\"1789-primary-department-for-each-employee--easy---leetcode\\",children:\[(0,n.jsx)(e.a,{href:\\"#1789-primary-department-for-each-employee--easy---leetcode\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"1789. Primary Department for Each Employee | Easy | \\\\u{1F512} \\",(0,n.jsx)(e.a,{href:\\"https://leetcode.com/problems/primary-department-for-each-employee\\",children:\\"LeetCode\\"})\]}),(0,n.jsxs)(e.p,{children:\[\\"Table: \\",(0,n.jsx)(e.code,{children:\\"Employee\\"})\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`+--------------+---------+\\n| Column Name | Type |\\n+--------------+---------+\\n| employee\_id | int |\\n| deprtment\_id | int |\\n| primary\_flag | varchar |\\n+--------------+---------+\\n(employee\_id, department\_id) is the primary key for this table.\\nemployee\_id is the id of the employee.\\ndepartment\_id is the id of the department to which the employee belongs.\\nprimary\_flag is an ENUM of type ('Y', 'N'). If the flag is 'Y', the department is the primary department for the employee. If the flag is 'N', the department is not the primary.\\n\`})}),(0,n.jsxs)(e.p,{children:\[\\"Employees can belong to multiple departments. When the employee joins other departments, they need to decide which department is their primary department. Note that when an employee belongs to only one department, their primary column is \\",(0,n.jsx)(e.code,{children:\\"'N'\\"}),\\".\\"\]}),(0,n.jsx)(e.p,{children:\\"Write an SQL query to report all the employees with their primary department. For employees who belong to one department, report their only department.\\"}),(0,n.jsx)(e.p,{children:\\"Return the result table in any order.\\"}),(0,n.jsx)(e.p,{children:\\"The query result format is in the following example.\\"}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:\`Employee table:\\n+-------------+---------------+--------------+\\n| employee\_id | department\_id | primary\_flag |\\n+-------------+---------------+--------------+\\n| 1 | 1 | N |\\n| 2 | 1 | Y |\\n| 2 | 2 | N |\\n| 3 | 3 | N |\\n| 4 | 2 | N |\\n| 4 | 3 | Y |\\n| 4 | 4 | N |\\n+-------------+---------------+--------------+\\n\\nResult table:\\n+-------------+---------------+\\n| employee\_id | department\_id |\\n+-------------+---------------+\\n| 1 | 1 |\\n| 2 | 1 |\\n| 3 | 3 |\\n| 4 | 3 |\\n+-------------+---------------+\\n- The Primary department for employee 1 is 1.\\n- The Primary department for employee 2 is 1.\\n- The Primary department for employee 3 is 3.\\n- The Primary department for employee 4 is 3.\\n\`})}),(0,n.jsxs)(e.h3,{id:\\"solution-150\\",children:\[(0,n.jsx)(e.a,{href:\\"#solution-150\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,n.jsx)(e.span,{className:\\"icon icon-link\\"})}),\\"Solution\\"\]}),(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:\\"language-sql\\",children:\`#Solution 1:\\nSELECT employee\_id,department\_id\\nFROM employee\\nWHERE primary\_flag = 'Y' OR employee\_id IN\\n (SELECT employee\_id\\n FROM employee\\n GROUP BY employee\_id\\n HAVING COUNT(department\_id) = 1)\\n\\n#Solution 2:\\n(SELECT employee\_id,\\n department\_id\\nFROM Employee\\nWHERE primary\_flag = 'Y')\\nUNION\\n(SELECT employee\_id,\\n department\_id\\nFROM Employee\\nGROUP BY employee\_id\\nHAVING COUNT(employee\_id) = 1\\nORDER BY NULL);\\n\`})})\]})}function h(t={}){let{wrapper:e}=t.components||{};return e?(0,n.jsx)(e,{...t,children:(0,n.jsx)(c,{...t})}):c(t)}function T(t,e){throw new Error(\\"Expected \\"+(e?\\"component\\":\\"object\\")+\\" \`\\"+t+\\"\` to be defined: you likely forgot to import, pass, or provide it.\\")}return S(g);})();\\n;return Component;","toc":\[{"value":"175. Combine Two Tables | Easy | LeetCode","url":"#175-combine-two-tables--easy--leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"176. Second Highest Salary | Easy | LeetCode","url":"#176-second-highest-salary--easy--leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"177. Nth Highest Salary | Medium | LeetCode","url":"#177-nth-highest-salary--medium--leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"178. Rank Scores | Medium | LeetCode","url":"#178-rank-scores--medium--leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"180. Consecutive Numbers | Medium | LeetCode","url":"#180-consecutive-numbers--medium--leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"181. Employees Earning More Than Their Managers | Easy | LeetCode","url":"#181-employees-earning-more-than-their-managers--easy--leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"182. Duplicate Emails | Easy | LeetCode","url":"#182-duplicate-emails--easy--leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"183. Customers Who Never Order | Easy | LeetCode","url":"#183-customers-who-never-order--easy--leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"184. Department Highest Salary | Medium | LeetCode","url":"#184-department-highest-salary--medium--leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"185. Department Top Three Salaries | Hard | LeetCode","url":"#185-department-top-three-salaries--hard--leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"196. Delete Duplicate Emails | Easy | LeetCode","url":"#196-delete-duplicate-emails--easy--leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"197. Rising Temperature | Easy | LeetCode","url":"#197-rising-temperature--easy--leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"262. Trips and Users | Hard | LeetCode","url":"#262-trips-and-users--hard--leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"511. Game Play Analysis I | Easy | 🔒 LeetCode","url":"#511-game-play-analysis-i--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"512. Game Play Analysis II | Easy | 🔒 LeetCode","url":"#512-game-play-analysis-ii--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"534. Game Play Analysis III | Medium | 🔒 LeetCode","url":"#534-game-play-analysis-iii--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"550. Game Play Analysis IV | Medium | 🔒 LeetCode","url":"#550-game-play-analysis-iv--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"569. Median Employee Salary | Hard | 🔒 LeetCode","url":"#569-median-employee-salary--hard---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"570. Managers with at Least 5 Direct Reports | Medium | 🔒 LeetCode","url":"#570-managers-with-at-least-5-direct-reports--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"571. Find Median Given Frequency of Numbers | 🔒 LeetCode","url":"#571-find-median-given-frequency-of-numbers---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"574. Winning Candidate | Medium | 🔒 LeetCode","url":"#574-winning-candidate--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"577. Employee Bonus | Easy | 🔒 LeetCode","url":"#577-employee-bonus--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"578. Get Highest Answer Rate Question | Medium | 🔒 LeetCode","url":"#578-get-highest-answer-rate-question--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"579. Find Cumulative Salary of an Employee | Hard | 🔒 LeetCode","url":"#579-find-cumulative-salary-of-an-employee--hard---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"580. Count Student Number in Departments | Medium | 🔒 LeetCode","url":"#580-count-student-number-in-departments--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"584. Find Customer Referee | Easy | 🔒 LeetCode","url":"#584-find-customer-referee--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"585. Investments in 2016 | Medium | 🔒 LeetCode","url":"#585-investments-in-2016--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"586. Customer Placing the Largest Number of Orders | Easy | 🔒 LeetCode","url":"#586-customer-placing-the-largest-number-of-orders--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"595. Big Countries | Easy | LeetCode","url":"#595-big-countries--easy--leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"596. Classes More Than 5 Students | Easy | LeetCode","url":"#596-classes-more-than-5-students--easy--leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"597. Friend Requests I: Overall Acceptance Rate | Easy | 🔒 LeetCode","url":"#597-friend-requests-i-overall-acceptance-rate--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"601. Human Traffic of Stadium | Hard | LeetCode","url":"#601-human-traffic-of-stadium--hard--leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"602. Friend Requests II: Who Has the Most Friends | Medium | 🔒 LeetCode","url":"#602-friend-requests-ii-who-has-the-most-friends--medium---leetcode","depth":2},{"value":"603. Consecutive Available Seats | Easy | 🔒 LeetCode","url":"#603-consecutive-available-seats--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"607.Sales Person | Easy | 🔒 LeetCode","url":"#607sales-person--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"608. Tree Node | Medium | 🔒 LeetCode","url":"#608-tree-node--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"610. Triangle Judgement | Easy | 🔒 LeetCode","url":"#610-triangle-judgement--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"612. Shortest Distance in a Plane | Medium | 🔒 LeetCode","url":"#612-shortest-distance-in-a-plane--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"613. Shortest Distance in a Line | Easy | 🔒 LeetCode","url":"#613-shortest-distance-in-a-line--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"614. Second Degree Follower | Medium | 🔒 LeetCode","url":"#614-second-degree-follower--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"615. Average Salary: Departments VS Company | Hard | 🔒 LeetCode","url":"#615-average-salary-departments-vs-company--hard---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"618. Students Report By Geography | Hard | 🔒 LeetCode","url":"#618-students-report-by-geography--hard---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"619. Biggest Single Number | Easy | 🔒 LeetCode","url":"#619-biggest-single-number--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"620. Not Boring Movies | Easy | LeetCode","url":"#620-not-boring-movies--easy--leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"626. Exchange Seats | Medium | LeetCode","url":"#626-exchange-seats--medium--leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"627. Swap Salary | LeetCode","url":"#627-swap-salary--leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1045. Customers Who Bought All Products | Medium | 🔒 LeetCode","url":"#1045-customers-who-bought-all-products--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1050. Actors and Directors Who Cooperated At Least Three Times | Easy | 🔒 LeetCode","url":"#1050-actors-and-directors-who-cooperated-at-least-three-times--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1068. Product Sales Analysis I | Easy | 🔒 LeetCode","url":"#1068-product-sales-analysis-i--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1069. Product Sales Analysis II | Easy | 🔒 LeetCode","url":"#1069-product-sales-analysis-ii--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1070. Product Sales Analysis III | Medium | 🔒 LeetCode","url":"#1070-product-sales-analysis-iii--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1075. Project Employees I | Easy | 🔒 LeetCode","url":"#1075-project-employees-i--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1076. Project Employees II | Easy | 🔒 LeetCode","url":"#1076-project-employees-ii--easy---leetcode","depth":2},{"value":"1077. Project Employees III | Medium | 🔒 LeetCode","url":"#1077-project-employees-iii--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1082. Sales Analysis I | Easy | 🔒 LeetCode","url":"#1082-sales-analysis-i--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1083. Sales Analysis II | Easy | 🔒 LeetCode","url":"#1083-sales-analysis-ii--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1084. Sales Analysis III | Easy | 🔒 LeetCode","url":"#1084-sales-analysis-iii--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1097. Game Play Analysis V | Hard | 🔒 LeetCode","url":"#1097-game-play-analysis-v--hard---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1098. Unpopular Books | Medium | 🔒 LeetCode","url":"#1098-unpopular-books--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1107. New Users Daily Count | Medium | 🔒 LeetCode","url":"#1107-new-users-daily-count--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1112. Highest Grade For Each Student | Medium | 🔒 LeetCode","url":"#1112-highest-grade-for-each-student--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1113.Reported Posts | Easy | 🔒 LeetCode","url":"#1113reported-posts--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1126. Active Businesses | Medium | 🔒 LeetCode","url":"#1126-active-businesses--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1127. User Purchase Platform | Hard | 🔒 LeetCode","url":"#1127-user-purchase-platform--hard---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1132. Reported Posts II | Medium | 🔒 LeetCode","url":"#1132-reported-posts-ii--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1141. User Activity for the Past 30 Days I | Easy | 🔒 LeetCode","url":"#1141-user-activity-for-the-past-30-days-i--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1142. User Activity for the Past 30 Days II | Easy | 🔒 LeetCode","url":"#1142-user-activity-for-the-past-30-days-ii--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1148. Article Views I | Easy | 🔒 LeetCode","url":"#1148-article-views-i--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1149. Article Views II | Medium | 🔒 LeetCode","url":"#1149-article-views-ii--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1158. Market Analysis I | Medium | 🔒 LeetCode","url":"#1158-market-analysis-i--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1159. Market Analysis II | Hard | 🔒 LeetCode","url":"#1159-market-analysis-ii--hard---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1164. Product Price at a Given Date | Medium | 🔒 LeetCode","url":"#1164-product-price-at-a-given-date--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1173. Immediate Food Delivery I | Easy | 🔒 LeetCode","url":"#1173-immediate-food-delivery-i--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1174. Immediate Food Delivery II | Medium | 🔒 LeetCode","url":"#1174-immediate-food-delivery-ii--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1179. Reformat Department Table | Easy | LeetCode","url":"#1179-reformat-department-table--easy--leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1193. Monthly Transactions I | Medium | 🔒 LeetCode","url":"#1193-monthly-transactions-i--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1194. Tournament Winners | Hard | 🔒 LeetCode","url":"#1194-tournament-winners--hard---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1204. Last Person to Fit in the Elevator | Medium | 🔒 LeetCode","url":"#1204-last-person-to-fit-in-the-elevator--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1205. Monthly Transactions II | Medium | 🔒 LeetCode","url":"#1205-monthly-transactions-ii--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1211. Queries Quality and Percentage | Easy | 🔒 LeetCode","url":"#1211-queries-quality-and-percentage--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1212. Team Scores in Football Tournament | Medium | 🔒 LeetCode","url":"#1212-team-scores-in-football-tournament--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1225. Report Contiguous Dates | Hard | 🔒 LeetCode","url":"#1225-report-contiguous-dates--hard---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1241. Number of Comments per Post | Easy | 🔒 LeetCode","url":"#1241-number-of-comments-per-post--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1251. Average Selling Price | Easy | 🔒 LeetCode","url":"#1251-average-selling-price--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1264. Page Recommendations | Medium | 🔒 LeetCode","url":"#1264-page-recommendations--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1270. All People Report to the Given Manager | Medium | 🔒 LeetCode","url":"#1270-all-people-report-to-the-given-manager--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1280. Students and Examinations| Easy | 🔒 LeetCode","url":"#1280-students-and-examinations-easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1285. Find the Start and End Number of Continuous Ranges | Medium | 🔒 LeetCode","url":"#1285-find-the-start-and-end-number-of-continuous-ranges--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1294. Weather Type in Each Country | Easy | 🔒 LeetCode","url":"#1294-weather-type-in-each-country--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1303. Find the Team Size | Easy | 🔒 LeetCode","url":"#1303-find-the-team-size--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1308. Running Total for Different Genders | Medium | 🔒 LeetCode","url":"#1308-running-total-for-different-genders--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1321. Restaurant Growth | Medium | 🔒 LeetCode","url":"#1321-restaurant-growth--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1322. Ads Performance | Easy | 🔒 LeetCode","url":"#1322-ads-performance--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1327. List the Products Ordered in a Period | Easy | 🔒 LeetCode","url":"#1327-list-the-products-ordered-in-a-period--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1336. Number of Transactions per Visit | Hard | 🔒 LeetCode","url":"#1336-number-of-transactions-per-visit--hard---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1341. Movie Rating | Medium | 🔒 LeetCode","url":"#1341-movie-rating--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1350. Students With Invalid Departments | Easy | 🔒 LeetCode","url":"#1350-students-with-invalid-departments--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1355. Activity Participants | Medium | 🔒 LeetCode","url":"#1355-activity-participants--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1364. Number of Trusted Contacts of a Customer | Medium | 🔒 LeetCode","url":"#1364-number-of-trusted-contacts-of-a-customer--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1369. Get the Second Most Recent Activity | Hard | 🔒 LeetCode","url":"#1369-get-the-second-most-recent-activity--hard---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1378. Replace Employee ID With The Unique Identifier | Easy | 🔒 LeetCode","url":"#1378-replace-employee-id-with-the-unique-identifier--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1384. Total Sales Amount by Year | Hard | 🔒 LeetCode","url":"#1384-total-sales-amount-by-year--hard---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1393. Capital Gain/Loss | Medium | 🔒 LeetCode","url":"#1393-capital-gainloss--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1398. Customers Who Bought Products A and B but Not C | Medium | 🔒 LeetCode","url":"#1398-customers-who-bought-products-a-and-b-but-not-c--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1407. Top Travellers | Easy | 🔒 LeetCode","url":"#1407-top-travellers--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1412. Find the Quiet Students in All Exams | Hard | 🔒 LeetCode","url":"#1412-find-the-quiet-students-in-all-exams--hard---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1421. NPV Queries | Medium | 🔒 LeetCode","url":"#1421-npv-queries--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1435. Create a Session Bar Chart | Easy | 🔒 LeetCode","url":"#1435-create-a-session-bar-chart--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1440. Evaluate Boolean Expression | Medium | 🔒 LeetCode","url":"#1440-evaluate-boolean-expression--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1445. Apples \\u0026 Oranges | Medium | 🔒 LeetCode","url":"#1445-apples--oranges--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1454. Active Users | Medium | 🔒 LeetCode","url":"#1454-active-users--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1459. Rectangles Area | Medium | 🔒 LeetCode","url":"#1459-rectangles-area--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1468. Calculate Salaries | Medium | 🔒 LeetCode","url":"#1468-calculate-salaries--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1479. Sales by Day of the Week | Hard | 🔒 LeetCode","url":"#1479-sales-by-day-of-the-week--hard---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1484. Group Sold Products By The Date | Easy | 🔒 LeetCode","url":"#1484-group-sold-products-by-the-date--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1495. Friendly Movies Streamed Last Month | Easy | 🔒 LeetCode","url":"#1495-friendly-movies-streamed-last-month--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1501. Countries You Can Safely Invest In | Medium | 🔒 LeetCode","url":"#1501-countries-you-can-safely-invest-in--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1511. Customer Order Frequency | Easy | 🔒 LeetCode","url":"#1511-customer-order-frequency--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1517. Find Users With Valid E-Mails | Easy | 🔒 LeetCode","url":"#1517-find-users-with-valid-e-mails--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1527. Patients With a Condition | Easy | 🔒 LeetCode","url":"#1527-patients-with-a-condition--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1532. The Most Recent Three Orders | Medium | 🔒 LeetCode","url":"#1532-the-most-recent-three-orders--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1543. Fix Product Name Format | Easy | 🔒 LeetCode","url":"#1543-fix-product-name-format--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1549. The Most Recent Orders for Each Product | Medium | 🔒 LeetCode","url":"#1549-the-most-recent-orders-for-each-product--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1555. Bank Account Summary | Medium | 🔒 LeetCode","url":"#1555-bank-account-summary--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1565. Unique Orders and Customers Per Month | Easy | 🔒 LeetCode","url":"#1565-unique-orders-and-customers-per-month--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1571. Warehouse Manager | Easy | 🔒 LeetCode","url":"#1571-warehouse-manager--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1581. Customer Who Visited but Did Not Make Any Transactions | Easy | 🔒 LeetCode","url":"#1581-customer-who-visited-but-did-not-make-any-transactions--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1587. Bank Account Summary II | Easy | 🔒 LeetCode","url":"#1587-bank-account-summary-ii--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1596. The Most Frequently Ordered Products for Each Customer | Medium | 🔒 LeetCode","url":"#1596-the-most-frequently-ordered-products-for-each-customer--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1607. Sellers With No Sales | Easy | 🔒 LeetCode","url":"#1607-sellers-with-no-sales--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1613. Find the Missing IDs | Medium | 🔒 LeetCode","url":"#1613-find-the-missing-ids--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1623. All Valid Triplets That Can Represent a Country | Easy | 🔒 LeetCode","url":"#1623-all-valid-triplets-that-can-represent-a-country--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1633. Percentage of Users Attended a Contest | Easy | 🔒 LeetCode","url":"#1633-percentage-of-users-attended-a-contest--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1635. Hopper Company Queries I | Hard | 🔒 LeetCode","url":"#1635-hopper-company-queries-i--hard---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1645. Hopper Company Queries II | Hard | 🔒 LeetCode","url":"#1645-hopper-company-queries-ii--hard---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1651. Hopper Company Queries III | Hard | 🔒 LeetCode","url":"#1651-hopper-company-queries-iii--hard---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1661. Average Time of Process per Machine | Easy | 🔒 LeetCode","url":"#1661-average-time-of-process-per-machine--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1667. Fix Names in a Table | Easy | 🔒 LeetCode","url":"#1667-fix-names-in-a-table--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1677. Product's Worth Over Invoices | Easy | 🔒 LeetCode","url":"#1677-products-worth-over-invoices--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1683. Invalid Tweets | Easy | 🔒 LeetCode","url":"#1683-invalid-tweets--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1693. Daily Leads and Partners | Easy | 🔒 LeetCode","url":"#1693-daily-leads-and-partners--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1699. Number of Calls Between Two Persons | Medium | 🔒 LeetCode","url":"#1699-number-of-calls-between-two-persons--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1709. Biggest Window Between Visits | Medium | 🔒 LeetCode","url":"#1709-biggest-window-between-visits--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1715. Count Apples and Oranges | Medium | 🔒 LeetCode","url":"#1715-count-apples-and-oranges--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1729. Find Followers Count | Easy | 🔒 LeetCode","url":"#1729-find-followers-count--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1731. The Number of Employees Which Report to Each Employee | Easy | 🔒 LeetCode","url":"#1731-the-number-of-employees-which-report-to-each-employee--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1741. Find Total Time Spent by Each Employee | Easy | 🔒 LeetCode","url":"#1741-find-total-time-spent-by-each-employee--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1747. Leetflex Banned Accounts | Medium | 🔒 LeetCode","url":"#1747-leetflex-banned-accounts--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1757. Recyclable and Low Fat Products | Easy | 🔒 LeetCode","url":"#1757-recyclable-and-low-fat-products--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1767. Find the Subtasks That Did Not Execute | Hard | 🔒 LeetCode","url":"#1767-find-the-subtasks-that-did-not-execute--hard---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1777. Product's Price for Each Store | Easy | 🔒 LeetCode","url":"#1777-products-price-for-each-store--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1783. Grand Slam Titles | Medium | 🔒 LeetCode","url":"#1783-grand-slam-titles--medium---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3},{"value":"1789. Primary Department for Each Employee | Easy | 🔒 LeetCode","url":"#1789-primary-department-for-each-employee--easy---leetcode","depth":2},{"value":"Solution","url":"#solution","depth":3}\],"frontMatter":{"readingTime":{"text":"265 min read","minutes":264.15,"time":15849000,"words":52830},"slug":"sql/leetcode-sql-problem-solving","fileName":"sql/leetcode-sql-problem-solving.md","title":"LeetCode SQL Problem Solving Questions With Solutions","date":"2020-11-06T00:00:00.000Z","lastmod":"2020-11-06","path":"/articles","draft":false,"tags":\["SQL","SQL Problem Solving","LeetCode"\],"summary":"Post displaying LeetCode sql problem solving questions and solution.","images":\["/static/images/articles/leetcode-sql.png"\],"featured":true,"comment":true,"showTOC":true}},"authorDetails":\[{"readingTime":{"text":"3 min read","minutes":2.9,"time":174000,"words":580},"slug":\["default"\],"fileName":"default.md","title":"About Faisal Akbar","path":"/about","date":"2016-08-26T00:00:00.000Z","lastmod":"2020-01-16","summary":"Get to know me better","images":\["/static/images/others/about.jpg"\]}\],"prev":{"title":"HackerRank SQL Problem Solving Questions With Solutions","date":"2020-11-05T00:00:00.000Z","lastmod":"2020-11-05","path":"/articles","tags":\["SQL","SQL Problem Solving","HackerRank"\],"draft":false,"summary":"Post displaying HackerRank sql problem solving questions and solution.","images":\["/static/images/articles/hackerrank-sql.png"\],"featured":true,"comment":true,"showTOC":true,"slug":"sql/hackerrank-sql-problem-solving"},"next":null},"\_\_N\_SSG":true},"page":"/articles/\[...slug\]","query":{"slug":\["sql","leetcode-sql-problem-solving"\]},"buildId":"yMzAJQCsxoid1zIU3Y59r","isFallback":false,"gsp":true,"scriptLoader":\[\]}
